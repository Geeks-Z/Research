nohup: 忽略输入
2024-04-19 21:25:24,730 [trainer.py] => config: ./exps/loramoe_inc.json
2024-04-19 21:25:24,730 [trainer.py] => prefix: reproduce
2024-04-19 21:25:24,730 [trainer.py] => dataset: cifar224
2024-04-19 21:25:24,731 [trainer.py] => memory_size: 0
2024-04-19 21:25:24,731 [trainer.py] => memory_per_class: 0
2024-04-19 21:25:24,731 [trainer.py] => fixed_memory: False
2024-04-19 21:25:24,731 [trainer.py] => shuffle: True
2024-04-19 21:25:24,731 [trainer.py] => init_cls: 20
2024-04-19 21:25:24,731 [trainer.py] => increment: 20
2024-04-19 21:25:24,731 [trainer.py] => model_name: loramoeinc
2024-04-19 21:25:24,731 [trainer.py] => backbone_type: pretrained_vit_b16_224_inc
2024-04-19 21:25:24,731 [trainer.py] => device: [device(type='cuda', index=3)]
2024-04-19 21:25:24,731 [trainer.py] => seed: 1993
2024-04-19 21:25:24,731 [trainer.py] => tuned_epoch: 20
2024-04-19 21:25:24,731 [trainer.py] => init_lr: 0.01
2024-04-19 21:25:24,731 [trainer.py] => batch_size: 48
2024-04-19 21:25:24,731 [trainer.py] => weight_decay: 0.0005
2024-04-19 21:25:24,731 [trainer.py] => min_lr: 0
2024-04-19 21:25:24,731 [trainer.py] => ffn_num: 4
2024-04-19 21:25:24,731 [trainer.py] => optimizer: sgd
2024-04-19 21:25:24,731 [trainer.py] => vpt_type: shallow
2024-04-19 21:25:24,731 [trainer.py] => prompt_token_num: 5
2024-04-19 21:25:24,731 [trainer.py] => expert_num: 5
2024-04-19 21:25:26,603 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
/home/team/zhaohongwei/anaconda3/envs/peft/lib/python3.10/site-packages/bitsandbytes/cuda_setup/main.py:136: UserWarning: /home/team/zhaohongwei/anaconda3/envs/peft did not contain libcudart.so as expected! Searching further paths...
  warn(msg)

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please submit your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
CUDA SETUP: CUDA runtime path found: /usr/local/cuda-11.8/lib64/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 8.6
CUDA SETUP: Detected CUDA version 118
CUDA SETUP: Loading binary /home/team/zhaohongwei/anaconda3/envs/peft/lib/python3.10/site-packages/bitsandbytes/libbitsandbytes_cuda118.so...
I'm using ViT with adapters.
2024-04-19 21:25:37,894 [trainer.py] => All params: 85833236
2024-04-19 21:25:37,895 [trainer.py] => Trainable params: 34580
2024-04-19 21:25:38,029 [loramoeinc.py] => Learning on 0-20
  0%|          | 0/20 [00:00<?, ?it/s]Task 0, Epoch 1/20 => Loss 2.589, Train_accy 52.17:   0%|          | 0/20 [00:26<?, ?it/s]Task 0, Epoch 1/20 => Loss 2.589, Train_accy 52.17:   5%|▌         | 1/20 [00:26<08:25, 26.61s/it]Task 0, Epoch 2/20 => Loss 1.251, Train_accy 74.86:   5%|▌         | 1/20 [00:52<08:25, 26.61s/it]Task 0, Epoch 2/20 => Loss 1.251, Train_accy 74.86:  10%|█         | 2/20 [00:52<07:56, 26.46s/it]Task 0, Epoch 3/20 => Loss 0.939, Train_accy 76.82:  10%|█         | 2/20 [01:18<07:56, 26.46s/it]Task 0, Epoch 3/20 => Loss 0.939, Train_accy 76.82:  15%|█▌        | 3/20 [01:18<07:26, 26.24s/it]Task 0, Epoch 4/20 => Loss 0.821, Train_accy 78.06:  15%|█▌        | 3/20 [01:45<07:26, 26.24s/it]Task 0, Epoch 4/20 => Loss 0.821, Train_accy 78.06:  20%|██        | 4/20 [01:45<06:59, 26.24s/it]Task 0, Epoch 5/20 => Loss 0.773, Train_accy 78.71:  20%|██        | 4/20 [02:11<06:59, 26.24s/it]Task 0, Epoch 5/20 => Loss 0.773, Train_accy 78.71:  25%|██▌       | 5/20 [02:11<06:33, 26.26s/it]Task 0, Epoch 6/20 => Loss 0.745, Train_accy 79.30:  25%|██▌       | 5/20 [02:38<06:33, 26.26s/it]Task 0, Epoch 6/20 => Loss 0.745, Train_accy 79.30:  30%|███       | 6/20 [02:38<06:09, 26.40s/it]Task 0, Epoch 7/20 => Loss 0.727, Train_accy 80.01:  30%|███       | 6/20 [03:04<06:09, 26.40s/it]Task 0, Epoch 7/20 => Loss 0.727, Train_accy 80.01:  35%|███▌      | 7/20 [03:04<05:44, 26.46s/it]Task 0, Epoch 8/20 => Loss 0.683, Train_accy 81.03:  35%|███▌      | 7/20 [03:30<05:44, 26.46s/it]Task 0, Epoch 8/20 => Loss 0.683, Train_accy 81.03:  40%|████      | 8/20 [03:30<05:16, 26.37s/it]Task 0, Epoch 9/20 => Loss 0.682, Train_accy 80.67:  40%|████      | 8/20 [03:56<05:16, 26.37s/it]Task 0, Epoch 9/20 => Loss 0.682, Train_accy 80.67:  45%|████▌     | 9/20 [03:56<04:48, 26.27s/it]Task 0, Epoch 10/20 => Loss 0.670, Train_accy 80.81:  45%|████▌     | 9/20 [04:23<04:48, 26.27s/it]Task 0, Epoch 10/20 => Loss 0.670, Train_accy 80.81:  50%|█████     | 10/20 [04:23<04:24, 26.40s/it]Task 0, Epoch 11/20 => Loss 0.639, Train_accy 81.59:  50%|█████     | 10/20 [04:50<04:24, 26.40s/it]Task 0, Epoch 11/20 => Loss 0.639, Train_accy 81.59:  55%|█████▌    | 11/20 [04:50<03:58, 26.52s/it]Task 0, Epoch 12/20 => Loss 0.644, Train_accy 81.35:  55%|█████▌    | 11/20 [05:16<03:58, 26.52s/it]Task 0, Epoch 12/20 => Loss 0.644, Train_accy 81.35:  60%|██████    | 12/20 [05:16<03:32, 26.51s/it]Task 0, Epoch 13/20 => Loss 0.622, Train_accy 82.39:  60%|██████    | 12/20 [05:43<03:32, 26.51s/it]Task 0, Epoch 13/20 => Loss 0.622, Train_accy 82.39:  65%|██████▌   | 13/20 [05:43<03:06, 26.63s/it]Task 0, Epoch 14/20 => Loss 0.626, Train_accy 81.87:  65%|██████▌   | 13/20 [06:10<03:06, 26.63s/it]Task 0, Epoch 14/20 => Loss 0.626, Train_accy 81.87:  70%|███████   | 14/20 [06:10<02:40, 26.68s/it]Task 0, Epoch 15/20 => Loss 0.625, Train_accy 82.18:  70%|███████   | 14/20 [06:37<02:40, 26.68s/it]Task 0, Epoch 15/20 => Loss 0.625, Train_accy 82.18:  75%|███████▌  | 15/20 [06:37<02:13, 26.67s/it]Task 0, Epoch 16/20 => Loss 0.615, Train_accy 82.26:  75%|███████▌  | 15/20 [07:04<02:13, 26.67s/it]Task 0, Epoch 16/20 => Loss 0.615, Train_accy 82.26:  80%|████████  | 16/20 [07:04<01:46, 26.72s/it]Task 0, Epoch 17/20 => Loss 0.614, Train_accy 82.46:  80%|████████  | 16/20 [07:31<01:46, 26.72s/it]Task 0, Epoch 17/20 => Loss 0.614, Train_accy 82.46:  85%|████████▌ | 17/20 [07:31<01:20, 26.79s/it]Task 0, Epoch 18/20 => Loss 0.617, Train_accy 82.29:  85%|████████▌ | 17/20 [07:57<01:20, 26.79s/it]Task 0, Epoch 18/20 => Loss 0.617, Train_accy 82.29:  90%|█████████ | 18/20 [07:57<00:53, 26.78s/it]Task 0, Epoch 19/20 => Loss 0.610, Train_accy 82.23:  90%|█████████ | 18/20 [08:24<00:53, 26.78s/it]Task 0, Epoch 19/20 => Loss 0.610, Train_accy 82.23:  95%|█████████▌| 19/20 [08:24<00:26, 26.65s/it]Task 0, Epoch 20/20 => Loss 0.604, Train_accy 82.69:  95%|█████████▌| 19/20 [08:50<00:26, 26.65s/it]Task 0, Epoch 20/20 => Loss 0.604, Train_accy 82.69: 100%|██████████| 20/20 [08:50<00:00, 26.55s/it]Task 0, Epoch 20/20 => Loss 0.604, Train_accy 82.69: 100%|██████████| 20/20 [08:50<00:00, 26.52s/it]
2024-04-19 21:34:28,691 [loramoeinc.py] => Task 0, Epoch 20/20 => Loss 0.604, Train_accy 82.69
2024-04-19 21:35:56,628 [trainer.py] => No NME accuracy.
2024-04-19 21:35:56,628 [trainer.py] => CNN: {'total': 91.45, '00-19': 91.45, 'old': 0, 'new': 91.45}
2024-04-19 21:35:56,628 [trainer.py] => Route: {'total': 92.2, '00-19': 92.2, 'old': 0, 'new': 92.2}
2024-04-19 21:35:56,628 [trainer.py] => CNN top1 curve: [91.45]
2024-04-19 21:35:56,628 [trainer.py] => CNN top5 curve: [99.3]
2024-04-19 21:35:56,628 [trainer.py] => Route top1 curve: [92.2]
2024-04-19 21:35:56,628 [trainer.py] => Route top5 curve: [98.7]

Average Accuracy (CNN): 91.45
Average Accuracy (Route): 92.2
2024-04-19 21:35:56,628 [trainer.py] => Average Accuracy (CNN): 91.45
2024-04-19 21:35:56,628 [trainer.py] => Average Accuracy (Route): 92.2

2024-04-19 21:35:56,628 [trainer.py] => Train Time: 530.46
2024-04-19 21:35:56,628 [trainer.py] => Test Time: 10.34 

2024-04-19 21:35:56,629 [trainer.py] => All params: 85863958
2024-04-19 21:35:56,630 [trainer.py] => Trainable params: 43025
2024-04-19 21:35:56,632 [loramoeinc.py] => Learning on 20-40
  0%|          | 0/20 [00:00<?, ?it/s]Task 1, Epoch 1/20 => Loss 1.803, Train_accy 54.14:   0%|          | 0/20 [00:26<?, ?it/s]Task 1, Epoch 1/20 => Loss 1.803, Train_accy 54.14:   5%|▌         | 1/20 [00:26<08:15, 26.10s/it]Task 1, Epoch 2/20 => Loss 1.223, Train_accy 66.38:   5%|▌         | 1/20 [00:52<08:15, 26.10s/it]Task 1, Epoch 2/20 => Loss 1.223, Train_accy 66.38:  10%|█         | 2/20 [00:52<07:52, 26.24s/it]Task 1, Epoch 3/20 => Loss 1.102, Train_accy 70.06:  10%|█         | 2/20 [01:19<07:52, 26.24s/it]Task 1, Epoch 3/20 => Loss 1.102, Train_accy 70.06:  15%|█▌        | 3/20 [01:19<07:30, 26.49s/it]Task 1, Epoch 4/20 => Loss 1.032, Train_accy 71.26:  15%|█▌        | 3/20 [01:45<07:30, 26.49s/it]Task 1, Epoch 4/20 => Loss 1.032, Train_accy 71.26:  20%|██        | 4/20 [01:45<07:04, 26.52s/it]Task 1, Epoch 5/20 => Loss 0.987, Train_accy 72.40:  20%|██        | 4/20 [02:12<07:04, 26.52s/it]Task 1, Epoch 5/20 => Loss 0.987, Train_accy 72.40:  25%|██▌       | 5/20 [02:12<06:37, 26.52s/it]Task 1, Epoch 6/20 => Loss 0.994, Train_accy 72.01:  25%|██▌       | 5/20 [02:38<06:37, 26.52s/it]Task 1, Epoch 6/20 => Loss 0.994, Train_accy 72.01:  30%|███       | 6/20 [02:38<06:09, 26.41s/it]Task 1, Epoch 7/20 => Loss 0.976, Train_accy 72.30:  30%|███       | 6/20 [03:04<06:09, 26.41s/it]Task 1, Epoch 7/20 => Loss 0.976, Train_accy 72.30:  35%|███▌      | 7/20 [03:04<05:42, 26.34s/it]Task 1, Epoch 8/20 => Loss 0.927, Train_accy 73.28:  35%|███▌      | 7/20 [03:30<05:42, 26.34s/it]Task 1, Epoch 8/20 => Loss 0.927, Train_accy 73.28:  40%|████      | 8/20 [03:30<05:15, 26.27s/it]Task 1, Epoch 9/20 => Loss 0.892, Train_accy 74.20:  40%|████      | 8/20 [03:57<05:15, 26.27s/it]Task 1, Epoch 9/20 => Loss 0.892, Train_accy 74.20:  45%|████▌     | 9/20 [03:57<04:50, 26.45s/it]Task 1, Epoch 10/20 => Loss 0.886, Train_accy 74.70:  45%|████▌     | 9/20 [04:24<04:50, 26.45s/it]Task 1, Epoch 10/20 => Loss 0.886, Train_accy 74.70:  50%|█████     | 10/20 [04:24<04:24, 26.49s/it]Task 1, Epoch 11/20 => Loss 0.887, Train_accy 74.34:  50%|█████     | 10/20 [04:50<04:24, 26.49s/it]Task 1, Epoch 11/20 => Loss 0.887, Train_accy 74.34:  55%|█████▌    | 11/20 [04:50<03:58, 26.46s/it]Task 1, Epoch 12/20 => Loss 0.880, Train_accy 74.61:  55%|█████▌    | 11/20 [05:17<03:58, 26.46s/it]Task 1, Epoch 12/20 => Loss 0.880, Train_accy 74.61:  60%|██████    | 12/20 [05:17<03:31, 26.48s/it]Task 1, Epoch 13/20 => Loss 0.883, Train_accy 74.74:  60%|██████    | 12/20 [05:43<03:31, 26.48s/it]Task 1, Epoch 13/20 => Loss 0.883, Train_accy 74.74:  65%|██████▌   | 13/20 [05:43<03:04, 26.41s/it]Task 1, Epoch 14/20 => Loss 0.860, Train_accy 75.08:  65%|██████▌   | 13/20 [06:09<03:04, 26.41s/it]Task 1, Epoch 14/20 => Loss 0.860, Train_accy 75.08:  70%|███████   | 14/20 [06:09<02:38, 26.42s/it]Task 1, Epoch 15/20 => Loss 0.858, Train_accy 74.96:  70%|███████   | 14/20 [06:36<02:38, 26.42s/it]Task 1, Epoch 15/20 => Loss 0.858, Train_accy 74.96:  75%|███████▌  | 15/20 [06:36<02:12, 26.43s/it]Task 1, Epoch 16/20 => Loss 0.865, Train_accy 74.91:  75%|███████▌  | 15/20 [07:02<02:12, 26.43s/it]Task 1, Epoch 16/20 => Loss 0.865, Train_accy 74.91:  80%|████████  | 16/20 [07:02<01:45, 26.42s/it]Task 1, Epoch 17/20 => Loss 0.838, Train_accy 75.37:  80%|████████  | 16/20 [07:29<01:45, 26.42s/it]Task 1, Epoch 17/20 => Loss 0.838, Train_accy 75.37:  85%|████████▌ | 17/20 [07:29<01:19, 26.45s/it]Task 1, Epoch 18/20 => Loss 0.842, Train_accy 75.48:  85%|████████▌ | 17/20 [07:55<01:19, 26.45s/it]Task 1, Epoch 18/20 => Loss 0.842, Train_accy 75.48:  90%|█████████ | 18/20 [07:55<00:52, 26.44s/it]Task 1, Epoch 19/20 => Loss 0.842, Train_accy 75.23:  90%|█████████ | 18/20 [08:22<00:52, 26.44s/it]Task 1, Epoch 19/20 => Loss 0.842, Train_accy 75.23:  95%|█████████▌| 19/20 [08:22<00:26, 26.43s/it]Task 1, Epoch 20/20 => Loss 0.838, Train_accy 75.40:  95%|█████████▌| 19/20 [08:48<00:26, 26.43s/it]Task 1, Epoch 20/20 => Loss 0.838, Train_accy 75.40: 100%|██████████| 20/20 [08:48<00:00, 26.51s/it]Task 1, Epoch 20/20 => Loss 0.838, Train_accy 75.40: 100%|██████████| 20/20 [08:48<00:00, 26.44s/it]
2024-04-19 21:44:45,454 [loramoeinc.py] => Task 1, Epoch 20/20 => Loss 0.838, Train_accy 75.40
2024-04-19 21:46:08,677 [trainer.py] => No NME accuracy.
2024-04-19 21:46:08,678 [trainer.py] => CNN: {'total': 90.4, '00-19': 91.35, '20-39': 89.45, 'old': 91.35, 'new': 89.45}
2024-04-19 21:46:08,678 [trainer.py] => Route: {'total': 89.1, '00-19': 88.6, '20-39': 89.6, 'old': 88.6, 'new': 89.6}
2024-04-19 21:46:08,678 [trainer.py] => CNN top1 curve: [91.45, 90.4]
2024-04-19 21:46:08,678 [trainer.py] => CNN top5 curve: [99.3, 98.08]
2024-04-19 21:46:08,678 [trainer.py] => Route top1 curve: [92.2, 89.1]
2024-04-19 21:46:08,678 [trainer.py] => Route top5 curve: [98.7, 97.92]

Average Accuracy (CNN): 90.92500000000001
Average Accuracy (Route): 90.65
2024-04-19 21:46:08,678 [trainer.py] => Average Accuracy (CNN): 90.92500000000001
2024-04-19 21:46:08,678 [trainer.py] => Average Accuracy (Route): 90.65

2024-04-19 21:46:08,678 [trainer.py] => Train Time: 1059.22
2024-04-19 21:46:08,678 [trainer.py] => Test Time: 30.51 

2024-04-19 21:46:08,679 [trainer.py] => All params: 85894678
2024-04-19 21:46:08,680 [trainer.py] => Trainable params: 51469
2024-04-19 21:46:08,682 [loramoeinc.py] => Learning on 40-60
  0%|          | 0/20 [00:00<?, ?it/s]Task 2, Epoch 1/20 => Loss 1.570, Train_accy 63.13:   0%|          | 0/20 [00:26<?, ?it/s]Task 2, Epoch 1/20 => Loss 1.570, Train_accy 63.13:   5%|▌         | 1/20 [00:26<08:18, 26.23s/it]Task 2, Epoch 2/20 => Loss 1.133, Train_accy 72.17:   5%|▌         | 1/20 [00:52<08:18, 26.23s/it]Task 2, Epoch 2/20 => Loss 1.133, Train_accy 72.17:  10%|█         | 2/20 [00:52<07:54, 26.37s/it]Task 2, Epoch 3/20 => Loss 1.018, Train_accy 74.36:  10%|█         | 2/20 [01:19<07:54, 26.37s/it]Task 2, Epoch 3/20 => Loss 1.018, Train_accy 74.36:  15%|█▌        | 3/20 [01:19<07:29, 26.41s/it]Task 2, Epoch 4/20 => Loss 0.964, Train_accy 75.00:  15%|█▌        | 3/20 [01:45<07:29, 26.41s/it]Task 2, Epoch 4/20 => Loss 0.964, Train_accy 75.00:  20%|██        | 4/20 [01:45<07:03, 26.47s/it]Task 2, Epoch 5/20 => Loss 0.936, Train_accy 76.08:  20%|██        | 4/20 [02:12<07:03, 26.47s/it]Task 2, Epoch 5/20 => Loss 0.936, Train_accy 76.08:  25%|██▌       | 5/20 [02:12<06:38, 26.55s/it]Task 2, Epoch 6/20 => Loss 0.942, Train_accy 75.95:  25%|██▌       | 5/20 [02:39<06:38, 26.55s/it]Task 2, Epoch 6/20 => Loss 0.942, Train_accy 75.95:  30%|███       | 6/20 [02:39<06:12, 26.59s/it]Task 2, Epoch 7/20 => Loss 0.902, Train_accy 76.18:  30%|███       | 6/20 [03:05<06:12, 26.59s/it]Task 2, Epoch 7/20 => Loss 0.902, Train_accy 76.18:  35%|███▌      | 7/20 [03:05<05:44, 26.51s/it]Task 2, Epoch 8/20 => Loss 0.889, Train_accy 76.76:  35%|███▌      | 7/20 [03:31<05:44, 26.51s/it]Task 2, Epoch 8/20 => Loss 0.889, Train_accy 76.76:  40%|████      | 8/20 [03:31<05:17, 26.44s/it]Task 2, Epoch 9/20 => Loss 0.878, Train_accy 77.12:  40%|████      | 8/20 [03:58<05:17, 26.44s/it]Task 2, Epoch 9/20 => Loss 0.878, Train_accy 77.12:  45%|████▌     | 9/20 [03:58<04:50, 26.42s/it]Task 2, Epoch 10/20 => Loss 0.842, Train_accy 78.42:  45%|████▌     | 9/20 [04:24<04:50, 26.42s/it]Task 2, Epoch 10/20 => Loss 0.842, Train_accy 78.42:  50%|█████     | 10/20 [04:24<04:23, 26.38s/it]Task 2, Epoch 11/20 => Loss 0.852, Train_accy 77.64:  50%|█████     | 10/20 [04:50<04:23, 26.38s/it]Task 2, Epoch 11/20 => Loss 0.852, Train_accy 77.64:  55%|█████▌    | 11/20 [04:50<03:57, 26.38s/it]Task 2, Epoch 12/20 => Loss 0.836, Train_accy 78.19:  55%|█████▌    | 11/20 [05:17<03:57, 26.38s/it]Task 2, Epoch 12/20 => Loss 0.836, Train_accy 78.19:  60%|██████    | 12/20 [05:17<03:30, 26.35s/it]Task 2, Epoch 13/20 => Loss 0.845, Train_accy 78.00:  60%|██████    | 12/20 [05:43<03:30, 26.35s/it]Task 2, Epoch 13/20 => Loss 0.845, Train_accy 78.00:  65%|██████▌   | 13/20 [05:43<03:04, 26.32s/it]Task 2, Epoch 14/20 => Loss 0.839, Train_accy 77.93:  65%|██████▌   | 13/20 [06:09<03:04, 26.32s/it]Task 2, Epoch 14/20 => Loss 0.839, Train_accy 77.93:  70%|███████   | 14/20 [06:09<02:38, 26.34s/it]Task 2, Epoch 15/20 => Loss 0.810, Train_accy 78.83:  70%|███████   | 14/20 [06:36<02:38, 26.34s/it]Task 2, Epoch 15/20 => Loss 0.810, Train_accy 78.83:  75%|███████▌  | 15/20 [06:36<02:11, 26.39s/it]Task 2, Epoch 16/20 => Loss 0.809, Train_accy 79.05:  75%|███████▌  | 15/20 [07:02<02:11, 26.39s/it]Task 2, Epoch 16/20 => Loss 0.809, Train_accy 79.05:  80%|████████  | 16/20 [07:02<01:46, 26.50s/it]Task 2, Epoch 17/20 => Loss 0.813, Train_accy 78.40:  80%|████████  | 16/20 [07:29<01:46, 26.50s/it]Task 2, Epoch 17/20 => Loss 0.813, Train_accy 78.40:  85%|████████▌ | 17/20 [07:29<01:19, 26.49s/it]Task 2, Epoch 18/20 => Loss 0.787, Train_accy 79.35:  85%|████████▌ | 17/20 [07:55<01:19, 26.49s/it]Task 2, Epoch 18/20 => Loss 0.787, Train_accy 79.35:  90%|█████████ | 18/20 [07:55<00:53, 26.51s/it]Task 2, Epoch 19/20 => Loss 0.809, Train_accy 78.67:  90%|█████████ | 18/20 [08:22<00:53, 26.51s/it]Task 2, Epoch 19/20 => Loss 0.809, Train_accy 78.67:  95%|█████████▌| 19/20 [08:22<00:26, 26.48s/it]Task 2, Epoch 20/20 => Loss 0.798, Train_accy 79.08:  95%|█████████▌| 19/20 [08:48<00:26, 26.48s/it]Task 2, Epoch 20/20 => Loss 0.798, Train_accy 79.08: 100%|██████████| 20/20 [08:48<00:00, 26.49s/it]Task 2, Epoch 20/20 => Loss 0.798, Train_accy 79.08: 100%|██████████| 20/20 [08:48<00:00, 26.45s/it]
2024-04-19 21:54:57,705 [loramoeinc.py] => Task 2, Epoch 20/20 => Loss 0.798, Train_accy 79.08
2024-04-19 21:56:40,300 [trainer.py] => No NME accuracy.
2024-04-19 21:56:40,300 [trainer.py] => CNN: {'total': 88.9, '00-19': 91.2, '20-39': 88.65, '40-59': 86.85, 'old': 89.92, 'new': 86.85}
2024-04-19 21:56:40,300 [trainer.py] => Route: {'total': 85.43, '00-19': 85.95, '20-39': 86.45, '40-59': 83.9, 'old': 86.2, 'new': 83.9}
2024-04-19 21:56:40,300 [trainer.py] => CNN top1 curve: [91.45, 90.4, 88.9]
2024-04-19 21:56:40,300 [trainer.py] => CNN top5 curve: [99.3, 98.08, 97.4]
2024-04-19 21:56:40,300 [trainer.py] => Route top1 curve: [92.2, 89.1, 85.43]
2024-04-19 21:56:40,300 [trainer.py] => Route top5 curve: [98.7, 97.92, 96.65]

Average Accuracy (CNN): 90.25
Average Accuracy (Route): 88.91000000000001
2024-04-19 21:56:40,300 [trainer.py] => Average Accuracy (CNN): 90.25
2024-04-19 21:56:40,300 [trainer.py] => Average Accuracy (Route): 88.91000000000001

2024-04-19 21:56:40,300 [trainer.py] => Train Time: 1588.13
2024-04-19 21:56:40,300 [trainer.py] => Test Time: 60.38 

2024-04-19 21:56:40,301 [trainer.py] => All params: 85925398
2024-04-19 21:56:40,302 [trainer.py] => Trainable params: 59913
2024-04-19 21:56:40,305 [loramoeinc.py] => Learning on 60-80
  0%|          | 0/20 [00:00<?, ?it/s]Task 3, Epoch 1/20 => Loss 1.521, Train_accy 64.08:   0%|          | 0/20 [00:26<?, ?it/s]Task 3, Epoch 1/20 => Loss 1.521, Train_accy 64.08:   5%|▌         | 1/20 [00:26<08:21, 26.40s/it]Task 3, Epoch 2/20 => Loss 0.970, Train_accy 74.39:   5%|▌         | 1/20 [00:52<08:21, 26.40s/it]Task 3, Epoch 2/20 => Loss 0.970, Train_accy 74.39:  10%|█         | 2/20 [00:52<07:54, 26.39s/it]Task 3, Epoch 3/20 => Loss 0.914, Train_accy 75.61:  10%|█         | 2/20 [01:19<07:54, 26.39s/it]Task 3, Epoch 3/20 => Loss 0.914, Train_accy 75.61:  15%|█▌        | 3/20 [01:19<07:28, 26.39s/it]Task 3, Epoch 4/20 => Loss 0.873, Train_accy 76.33:  15%|█▌        | 3/20 [01:45<07:28, 26.39s/it]Task 3, Epoch 4/20 => Loss 0.873, Train_accy 76.33:  20%|██        | 4/20 [01:45<07:04, 26.53s/it]Task 3, Epoch 5/20 => Loss 0.850, Train_accy 77.11:  20%|██        | 4/20 [02:12<07:04, 26.53s/it]Task 3, Epoch 5/20 => Loss 0.850, Train_accy 77.11:  25%|██▌       | 5/20 [02:12<06:38, 26.58s/it]Task 3, Epoch 6/20 => Loss 0.846, Train_accy 76.83:  25%|██▌       | 5/20 [02:39<06:38, 26.58s/it]Task 3, Epoch 6/20 => Loss 0.846, Train_accy 76.83:  30%|███       | 6/20 [02:39<06:11, 26.55s/it]Task 3, Epoch 7/20 => Loss 0.803, Train_accy 78.16:  30%|███       | 6/20 [03:05<06:11, 26.55s/it]Task 3, Epoch 7/20 => Loss 0.803, Train_accy 78.16:  35%|███▌      | 7/20 [03:05<05:44, 26.50s/it]Task 3, Epoch 8/20 => Loss 0.800, Train_accy 78.54:  35%|███▌      | 7/20 [03:31<05:44, 26.50s/it]Task 3, Epoch 8/20 => Loss 0.800, Train_accy 78.54:  40%|████      | 8/20 [03:31<05:17, 26.47s/it]Task 3, Epoch 9/20 => Loss 0.796, Train_accy 78.12:  40%|████      | 8/20 [03:58<05:17, 26.47s/it]Task 3, Epoch 9/20 => Loss 0.796, Train_accy 78.12:  45%|████▌     | 9/20 [03:58<04:50, 26.44s/it]Task 3, Epoch 10/20 => Loss 0.770, Train_accy 79.13:  45%|████▌     | 9/20 [04:24<04:50, 26.44s/it]Task 3, Epoch 10/20 => Loss 0.770, Train_accy 79.13:  50%|█████     | 10/20 [04:24<04:23, 26.37s/it]Task 3, Epoch 11/20 => Loss 0.779, Train_accy 79.31:  50%|█████     | 10/20 [04:50<04:23, 26.37s/it]Task 3, Epoch 11/20 => Loss 0.779, Train_accy 79.31:  55%|█████▌    | 11/20 [04:50<03:57, 26.35s/it]Task 3, Epoch 12/20 => Loss 0.783, Train_accy 79.21:  55%|█████▌    | 11/20 [05:17<03:57, 26.35s/it]Task 3, Epoch 12/20 => Loss 0.783, Train_accy 79.21:  60%|██████    | 12/20 [05:17<03:30, 26.32s/it]Task 3, Epoch 13/20 => Loss 0.745, Train_accy 79.76:  60%|██████    | 12/20 [05:43<03:30, 26.32s/it]Task 3, Epoch 13/20 => Loss 0.745, Train_accy 79.76:  65%|██████▌   | 13/20 [05:43<03:04, 26.35s/it]Task 3, Epoch 14/20 => Loss 0.762, Train_accy 79.84:  65%|██████▌   | 13/20 [06:09<03:04, 26.35s/it]Task 3, Epoch 14/20 => Loss 0.762, Train_accy 79.84:  70%|███████   | 14/20 [06:09<02:37, 26.33s/it]Task 3, Epoch 15/20 => Loss 0.766, Train_accy 79.21:  70%|███████   | 14/20 [06:36<02:37, 26.33s/it]Task 3, Epoch 15/20 => Loss 0.766, Train_accy 79.21:  75%|███████▌  | 15/20 [06:36<02:12, 26.40s/it]Task 3, Epoch 16/20 => Loss 0.734, Train_accy 80.04:  75%|███████▌  | 15/20 [07:02<02:12, 26.40s/it]Task 3, Epoch 16/20 => Loss 0.734, Train_accy 80.04:  80%|████████  | 16/20 [07:02<01:45, 26.45s/it]Task 3, Epoch 17/20 => Loss 0.736, Train_accy 79.99:  80%|████████  | 16/20 [07:29<01:45, 26.45s/it]Task 3, Epoch 17/20 => Loss 0.736, Train_accy 79.99:  85%|████████▌ | 17/20 [07:29<01:19, 26.47s/it]Task 3, Epoch 18/20 => Loss 0.727, Train_accy 80.19:  85%|████████▌ | 17/20 [07:55<01:19, 26.47s/it]Task 3, Epoch 18/20 => Loss 0.727, Train_accy 80.19:  90%|█████████ | 18/20 [07:55<00:52, 26.48s/it]Task 3, Epoch 19/20 => Loss 0.746, Train_accy 79.76:  90%|█████████ | 18/20 [08:22<00:52, 26.48s/it]Task 3, Epoch 19/20 => Loss 0.746, Train_accy 79.76:  95%|█████████▌| 19/20 [08:22<00:26, 26.42s/it]Task 3, Epoch 20/20 => Loss 0.736, Train_accy 80.31:  95%|█████████▌| 19/20 [08:48<00:26, 26.42s/it]Task 3, Epoch 20/20 => Loss 0.736, Train_accy 80.31: 100%|██████████| 20/20 [08:48<00:00, 26.43s/it]Task 3, Epoch 20/20 => Loss 0.736, Train_accy 80.31: 100%|██████████| 20/20 [08:48<00:00, 26.43s/it]
2024-04-19 22:05:28,999 [loramoeinc.py] => Task 3, Epoch 20/20 => Loss 0.736, Train_accy 80.31
2024-04-19 22:07:18,163 [trainer.py] => No NME accuracy.
2024-04-19 22:07:18,163 [trainer.py] => CNN: {'total': 88.49, '00-19': 91.2, '20-39': 88.6, '40-59': 86.8, '60-79': 87.35, 'old': 88.87, 'new': 87.35}
2024-04-19 22:07:18,163 [trainer.py] => Route: {'total': 82.54, '00-19': 83.75, '20-39': 85.9, '40-59': 80.0, '60-79': 80.5, 'old': 83.22, 'new': 80.5}
2024-04-19 22:07:18,163 [trainer.py] => CNN top1 curve: [91.45, 90.4, 88.9, 88.49]
2024-04-19 22:07:18,163 [trainer.py] => CNN top5 curve: [99.3, 98.08, 97.4, 97.3]
2024-04-19 22:07:18,164 [trainer.py] => Route top1 curve: [92.2, 89.1, 85.43, 82.54]
2024-04-19 22:07:18,164 [trainer.py] => Route top5 curve: [98.7, 97.92, 96.65, 95.8]

Average Accuracy (CNN): 89.81
Average Accuracy (Route): 87.31750000000001
2024-04-19 22:07:18,164 [trainer.py] => Average Accuracy (CNN): 89.81
2024-04-19 22:07:18,164 [trainer.py] => Average Accuracy (Route): 87.31750000000001

2024-04-19 22:07:18,164 [trainer.py] => Train Time: 2116.73
2024-04-19 22:07:18,164 [trainer.py] => Test Time: 100.43 

2024-04-19 22:07:18,165 [trainer.py] => All params: 85956118
2024-04-19 22:07:18,166 [trainer.py] => Trainable params: 68357
2024-04-19 22:07:18,170 [loramoeinc.py] => Learning on 80-100
  0%|          | 0/20 [00:00<?, ?it/s]Task 4, Epoch 1/20 => Loss 2.029, Train_accy 56.19:   0%|          | 0/20 [00:26<?, ?it/s]Task 4, Epoch 1/20 => Loss 2.029, Train_accy 56.19:   5%|▌         | 1/20 [00:26<08:21, 26.39s/it]Task 4, Epoch 2/20 => Loss 1.342, Train_accy 65.54:   5%|▌         | 1/20 [00:52<08:21, 26.39s/it]Task 4, Epoch 2/20 => Loss 1.342, Train_accy 65.54:  10%|█         | 2/20 [00:52<07:53, 26.28s/it]Task 4, Epoch 3/20 => Loss 1.244, Train_accy 67.81:  10%|█         | 2/20 [01:19<07:53, 26.28s/it]Task 4, Epoch 3/20 => Loss 1.244, Train_accy 67.81:  15%|█▌        | 3/20 [01:19<07:29, 26.44s/it]Task 4, Epoch 4/20 => Loss 1.220, Train_accy 68.20:  15%|█▌        | 3/20 [01:45<07:29, 26.44s/it]Task 4, Epoch 4/20 => Loss 1.220, Train_accy 68.20:  20%|██        | 4/20 [01:45<07:04, 26.52s/it]Task 4, Epoch 5/20 => Loss 1.192, Train_accy 68.73:  20%|██        | 4/20 [02:12<07:04, 26.52s/it]Task 4, Epoch 5/20 => Loss 1.192, Train_accy 68.73:  25%|██▌       | 5/20 [02:12<06:38, 26.56s/it]Task 4, Epoch 6/20 => Loss 1.146, Train_accy 69.22:  25%|██▌       | 5/20 [02:39<06:38, 26.56s/it]Task 4, Epoch 6/20 => Loss 1.146, Train_accy 69.22:  30%|███       | 6/20 [02:39<06:13, 26.65s/it]Task 4, Epoch 7/20 => Loss 1.138, Train_accy 69.45:  30%|███       | 6/20 [03:05<06:13, 26.65s/it]Task 4, Epoch 7/20 => Loss 1.138, Train_accy 69.45:  35%|███▌      | 7/20 [03:05<05:44, 26.49s/it]Task 4, Epoch 8/20 => Loss 1.104, Train_accy 70.07:  35%|███▌      | 7/20 [03:31<05:44, 26.49s/it]Task 4, Epoch 8/20 => Loss 1.104, Train_accy 70.07:  40%|████      | 8/20 [03:31<05:17, 26.46s/it]Task 4, Epoch 9/20 => Loss 1.080, Train_accy 71.31:  40%|████      | 8/20 [03:58<05:17, 26.46s/it]Task 4, Epoch 9/20 => Loss 1.080, Train_accy 71.31:  45%|████▌     | 9/20 [03:58<04:51, 26.48s/it]Task 4, Epoch 10/20 => Loss 1.106, Train_accy 70.17:  45%|████▌     | 9/20 [04:24<04:51, 26.48s/it]Task 4, Epoch 10/20 => Loss 1.106, Train_accy 70.17:  50%|█████     | 10/20 [04:24<04:24, 26.49s/it]Task 4, Epoch 11/20 => Loss 1.090, Train_accy 70.46:  50%|█████     | 10/20 [04:51<04:24, 26.49s/it]Task 4, Epoch 11/20 => Loss 1.090, Train_accy 70.46:  55%|█████▌    | 11/20 [04:51<03:57, 26.41s/it]Task 4, Epoch 12/20 => Loss 1.084, Train_accy 70.56:  55%|█████▌    | 11/20 [05:17<03:57, 26.41s/it]Task 4, Epoch 12/20 => Loss 1.084, Train_accy 70.56:  60%|██████    | 12/20 [05:17<03:30, 26.37s/it]Task 4, Epoch 13/20 => Loss 1.070, Train_accy 70.59:  60%|██████    | 12/20 [05:43<03:30, 26.37s/it]Task 4, Epoch 13/20 => Loss 1.070, Train_accy 70.59:  65%|██████▌   | 13/20 [05:43<03:04, 26.31s/it]Task 4, Epoch 14/20 => Loss 1.063, Train_accy 70.59:  65%|██████▌   | 13/20 [06:09<03:04, 26.31s/it]Task 4, Epoch 14/20 => Loss 1.063, Train_accy 70.59:  70%|███████   | 14/20 [06:09<02:37, 26.33s/it]Task 4, Epoch 15/20 => Loss 1.041, Train_accy 71.77:  70%|███████   | 14/20 [06:36<02:37, 26.33s/it]Task 4, Epoch 15/20 => Loss 1.041, Train_accy 71.77:  75%|███████▌  | 15/20 [06:36<02:11, 26.36s/it]Task 4, Epoch 16/20 => Loss 1.051, Train_accy 71.03:  75%|███████▌  | 15/20 [07:02<02:11, 26.36s/it]Task 4, Epoch 16/20 => Loss 1.051, Train_accy 71.03:  80%|████████  | 16/20 [07:02<01:45, 26.32s/it]Task 4, Epoch 17/20 => Loss 1.047, Train_accy 70.99:  80%|████████  | 16/20 [07:28<01:45, 26.32s/it]Task 4, Epoch 17/20 => Loss 1.047, Train_accy 70.99:  85%|████████▌ | 17/20 [07:28<01:18, 26.31s/it]Task 4, Epoch 18/20 => Loss 1.021, Train_accy 71.70:  85%|████████▌ | 17/20 [07:55<01:18, 26.31s/it]Task 4, Epoch 18/20 => Loss 1.021, Train_accy 71.70:  90%|█████████ | 18/20 [07:55<00:52, 26.30s/it]Task 4, Epoch 19/20 => Loss 1.031, Train_accy 71.36:  90%|█████████ | 18/20 [08:21<00:52, 26.30s/it]Task 4, Epoch 19/20 => Loss 1.031, Train_accy 71.36:  95%|█████████▌| 19/20 [08:21<00:26, 26.27s/it]Task 4, Epoch 20/20 => Loss 1.029, Train_accy 71.32:  95%|█████████▌| 19/20 [08:47<00:26, 26.27s/it]Task 4, Epoch 20/20 => Loss 1.029, Train_accy 71.32: 100%|██████████| 20/20 [08:47<00:00, 26.28s/it]Task 4, Epoch 20/20 => Loss 1.029, Train_accy 71.32: 100%|██████████| 20/20 [08:47<00:00, 26.39s/it]
2024-04-19 22:16:05,966 [loramoeinc.py] => Task 4, Epoch 20/20 => Loss 1.029, Train_accy 71.32
2024-04-19 22:18:17,978 [trainer.py] => No NME accuracy.
2024-04-19 22:18:17,979 [trainer.py] => CNN: {'total': 88.06, '00-19': 91.05, '20-39': 88.6, '40-59': 86.8, '60-79': 87.35, '80-99': 86.5, 'old': 88.45, 'new': 86.5}
2024-04-19 22:18:17,979 [trainer.py] => Route: {'total': 81.26, '00-19': 81.7, '20-39': 84.65, '40-59': 78.35, '60-79': 79.2, '80-99': 82.4, 'old': 80.97, 'new': 82.4}
2024-04-19 22:18:17,979 [trainer.py] => CNN top1 curve: [91.45, 90.4, 88.9, 88.49, 88.06]
2024-04-19 22:18:17,979 [trainer.py] => CNN top5 curve: [99.3, 98.08, 97.4, 97.3, 97.02]
2024-04-19 22:18:17,979 [trainer.py] => Route top1 curve: [92.2, 89.1, 85.43, 82.54, 81.26]
2024-04-19 22:18:17,979 [trainer.py] => Route top5 curve: [98.7, 97.92, 96.65, 95.8, 94.98]

Average Accuracy (CNN): 89.46000000000001
Average Accuracy (Route): 86.10600000000001
2024-04-19 22:18:17,979 [trainer.py] => Average Accuracy (CNN): 89.46000000000001
2024-04-19 22:18:17,979 [trainer.py] => Average Accuracy (Route): 86.10600000000001

2024-04-19 22:18:17,979 [trainer.py] => Train Time: 2644.44
2024-04-19 22:18:17,979 [trainer.py] => Test Time: 149.5 

