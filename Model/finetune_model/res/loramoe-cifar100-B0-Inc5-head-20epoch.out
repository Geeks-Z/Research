nohup: 忽略输入
2024-04-19 19:54:30,191 [trainer.py] => config: ./exps/loramoe_inc.json
2024-04-19 19:54:30,191 [trainer.py] => prefix: reproduce
2024-04-19 19:54:30,192 [trainer.py] => dataset: cifar224
2024-04-19 19:54:30,192 [trainer.py] => memory_size: 0
2024-04-19 19:54:30,192 [trainer.py] => memory_per_class: 0
2024-04-19 19:54:30,192 [trainer.py] => fixed_memory: False
2024-04-19 19:54:30,192 [trainer.py] => shuffle: True
2024-04-19 19:54:30,192 [trainer.py] => init_cls: 20
2024-04-19 19:54:30,192 [trainer.py] => increment: 20
2024-04-19 19:54:30,192 [trainer.py] => model_name: loramoeinc
2024-04-19 19:54:30,192 [trainer.py] => backbone_type: pretrained_vit_b16_224_inc
2024-04-19 19:54:30,192 [trainer.py] => device: [device(type='cuda', index=3)]
2024-04-19 19:54:30,192 [trainer.py] => seed: 1993
2024-04-19 19:54:30,192 [trainer.py] => tuned_epoch: 20
2024-04-19 19:54:30,192 [trainer.py] => init_lr: 0.01
2024-04-19 19:54:30,192 [trainer.py] => batch_size: 48
2024-04-19 19:54:30,192 [trainer.py] => weight_decay: 0.0005
2024-04-19 19:54:30,192 [trainer.py] => min_lr: 0
2024-04-19 19:54:30,192 [trainer.py] => ffn_num: 4
2024-04-19 19:54:30,192 [trainer.py] => optimizer: sgd
2024-04-19 19:54:30,192 [trainer.py] => vpt_type: shallow
2024-04-19 19:54:30,192 [trainer.py] => prompt_token_num: 5
2024-04-19 19:54:30,192 [trainer.py] => expert_num: 5
2024-04-19 19:54:31,400 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
/home/team/zhaohongwei/anaconda3/envs/peft/lib/python3.10/site-packages/bitsandbytes/cuda_setup/main.py:136: UserWarning: /home/team/zhaohongwei/anaconda3/envs/peft did not contain libcudart.so as expected! Searching further paths...
  warn(msg)

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please submit your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
CUDA SETUP: CUDA runtime path found: /usr/local/cuda-11.8/lib64/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 8.6
CUDA SETUP: Detected CUDA version 118
CUDA SETUP: Loading binary /home/team/zhaohongwei/anaconda3/envs/peft/lib/python3.10/site-packages/bitsandbytes/libbitsandbytes_cuda118.so...
I'm using ViT with adapters.
2024-04-19 19:54:40,083 [trainer.py] => All params: 85833236
2024-04-19 19:54:40,085 [trainer.py] => Trainable params: 34580
2024-04-19 19:54:40,206 [loramoeinc.py] => Learning on 0-20
  0%|          | 0/20 [00:00<?, ?it/s]Task 0, Epoch 1/20 => Loss 2.520, Train_accy 55.48:   0%|          | 0/20 [00:48<?, ?it/s]Task 0, Epoch 1/20 => Loss 2.520, Train_accy 55.48:   5%|▌         | 1/20 [00:48<15:21, 48.52s/it]Task 0, Epoch 2/20 => Loss 0.880, Train_accy 83.46:   5%|▌         | 1/20 [01:36<15:21, 48.52s/it]Task 0, Epoch 2/20 => Loss 0.880, Train_accy 83.46:  10%|█         | 2/20 [01:36<14:31, 48.42s/it]Task 0, Epoch 3/20 => Loss 0.637, Train_accy 84.51:  10%|█         | 2/20 [02:25<14:31, 48.42s/it]Task 0, Epoch 3/20 => Loss 0.637, Train_accy 84.51:  15%|█▌        | 3/20 [02:25<13:42, 48.37s/it]Task 0, Epoch 4/20 => Loss 0.554, Train_accy 85.79:  15%|█▌        | 3/20 [03:13<13:42, 48.37s/it]Task 0, Epoch 4/20 => Loss 0.554, Train_accy 85.79:  20%|██        | 4/20 [03:13<12:52, 48.29s/it]Task 0, Epoch 5/20 => Loss 0.524, Train_accy 85.89:  20%|██        | 4/20 [04:01<12:52, 48.29s/it]Task 0, Epoch 5/20 => Loss 0.524, Train_accy 85.89:  25%|██▌       | 5/20 [04:01<12:04, 48.27s/it]Task 0, Epoch 6/20 => Loss 0.508, Train_accy 86.28:  25%|██▌       | 5/20 [04:50<12:04, 48.27s/it]Task 0, Epoch 6/20 => Loss 0.508, Train_accy 86.28:  30%|███       | 6/20 [04:50<11:16, 48.33s/it]Task 0, Epoch 7/20 => Loss 0.485, Train_accy 86.78:  30%|███       | 6/20 [05:38<11:16, 48.33s/it]Task 0, Epoch 7/20 => Loss 0.485, Train_accy 86.78:  35%|███▌      | 7/20 [05:38<10:29, 48.39s/it]Task 0, Epoch 8/20 => Loss 0.457, Train_accy 87.51:  35%|███▌      | 7/20 [06:27<10:29, 48.39s/it]Task 0, Epoch 8/20 => Loss 0.457, Train_accy 87.51:  40%|████      | 8/20 [06:27<09:41, 48.42s/it]Task 0, Epoch 9/20 => Loss 0.461, Train_accy 87.24:  40%|████      | 8/20 [07:15<09:41, 48.42s/it]Task 0, Epoch 9/20 => Loss 0.461, Train_accy 87.24:  45%|████▌     | 9/20 [07:15<08:54, 48.57s/it]Task 0, Epoch 10/20 => Loss 0.451, Train_accy 87.42:  45%|████▌     | 9/20 [08:04<08:54, 48.57s/it]Task 0, Epoch 10/20 => Loss 0.451, Train_accy 87.42:  50%|█████     | 10/20 [08:04<08:05, 48.51s/it]Task 0, Epoch 11/20 => Loss 0.418, Train_accy 88.37:  50%|█████     | 10/20 [08:52<08:05, 48.51s/it]Task 0, Epoch 11/20 => Loss 0.418, Train_accy 88.37:  55%|█████▌    | 11/20 [08:52<07:15, 48.41s/it]Task 0, Epoch 12/20 => Loss 0.433, Train_accy 88.14:  55%|█████▌    | 11/20 [09:41<07:15, 48.41s/it]Task 0, Epoch 12/20 => Loss 0.433, Train_accy 88.14:  60%|██████    | 12/20 [09:41<06:28, 48.51s/it]Task 0, Epoch 13/20 => Loss 0.418, Train_accy 88.16:  60%|██████    | 12/20 [10:30<06:28, 48.51s/it]Task 0, Epoch 13/20 => Loss 0.418, Train_accy 88.16:  65%|██████▌   | 13/20 [10:30<05:40, 48.62s/it]Task 0, Epoch 14/20 => Loss 0.424, Train_accy 88.00:  65%|██████▌   | 13/20 [11:18<05:40, 48.62s/it]Task 0, Epoch 14/20 => Loss 0.424, Train_accy 88.00:  70%|███████   | 14/20 [11:18<04:51, 48.63s/it]Task 0, Epoch 15/20 => Loss 0.415, Train_accy 88.35:  70%|███████   | 14/20 [12:07<04:51, 48.63s/it]Task 0, Epoch 15/20 => Loss 0.415, Train_accy 88.35:  75%|███████▌  | 15/20 [12:07<04:02, 48.58s/it]Task 0, Epoch 16/20 => Loss 0.403, Train_accy 88.50:  75%|███████▌  | 15/20 [12:55<04:02, 48.58s/it]Task 0, Epoch 16/20 => Loss 0.403, Train_accy 88.50:  80%|████████  | 16/20 [12:55<03:14, 48.58s/it]Task 0, Epoch 17/20 => Loss 0.414, Train_accy 88.61:  80%|████████  | 16/20 [13:44<03:14, 48.58s/it]Task 0, Epoch 17/20 => Loss 0.414, Train_accy 88.61:  85%|████████▌ | 17/20 [13:44<02:25, 48.55s/it]Task 0, Epoch 18/20 => Loss 0.401, Train_accy 88.92:  85%|████████▌ | 17/20 [14:32<02:25, 48.55s/it]Task 0, Epoch 18/20 => Loss 0.401, Train_accy 88.92:  90%|█████████ | 18/20 [14:32<01:37, 48.51s/it]Task 0, Epoch 19/20 => Loss 0.401, Train_accy 88.76:  90%|█████████ | 18/20 [15:21<01:37, 48.51s/it]Task 0, Epoch 19/20 => Loss 0.401, Train_accy 88.76:  95%|█████████▌| 19/20 [15:21<00:48, 48.64s/it]Task 0, Epoch 20/20 => Loss 0.407, Train_accy 88.26:  95%|█████████▌| 19/20 [16:10<00:48, 48.64s/it]Task 0, Epoch 20/20 => Loss 0.407, Train_accy 88.26: 100%|██████████| 20/20 [16:10<00:00, 48.72s/it]Task 0, Epoch 20/20 => Loss 0.407, Train_accy 88.26: 100%|██████████| 20/20 [16:10<00:00, 48.53s/it]
2024-04-19 20:10:50,899 [loramoeinc.py] => Task 0, Epoch 20/20 => Loss 0.407, Train_accy 88.26
2024-04-19 20:12:11,358 [trainer.py] => No NME accuracy.
2024-04-19 20:12:11,359 [trainer.py] => CNN: {'total': 96.05, '00-19': 96.05, 'old': 0, 'new': 96.05}
2024-04-19 20:12:11,359 [trainer.py] => Route: {'total': 92.2, '00-19': 92.2, 'old': 0, 'new': 92.2}
2024-04-19 20:12:11,359 [trainer.py] => CNN top1 curve: [96.05]
2024-04-19 20:12:11,359 [trainer.py] => CNN top5 curve: [99.7]
2024-04-19 20:12:11,359 [trainer.py] => Route top1 curve: [92.2]
2024-04-19 20:12:11,359 [trainer.py] => Route top5 curve: [98.7]

Average Accuracy (CNN): 96.05
Average Accuracy (Route): 92.2
2024-04-19 20:12:11,359 [trainer.py] => Average Accuracy (CNN): 96.05
2024-04-19 20:12:11,359 [trainer.py] => Average Accuracy (Route): 92.2

2024-04-19 20:12:11,359 [trainer.py] => Train Time: 970.55
2024-04-19 20:12:11,359 [trainer.py] => Test Time: 10.55 

2024-04-19 20:12:11,360 [trainer.py] => All params: 85863958
2024-04-19 20:12:11,361 [trainer.py] => Trainable params: 43025
2024-04-19 20:12:11,365 [loramoeinc.py] => Learning on 20-40
  0%|          | 0/20 [00:00<?, ?it/s]Task 1, Epoch 1/20 => Loss 2.000, Train_accy 53.11:   0%|          | 0/20 [00:48<?, ?it/s]Task 1, Epoch 1/20 => Loss 2.000, Train_accy 53.11:   5%|▌         | 1/20 [00:48<15:29, 48.92s/it]Task 1, Epoch 2/20 => Loss 1.473, Train_accy 62.94:   5%|▌         | 1/20 [01:37<15:29, 48.92s/it]Task 1, Epoch 2/20 => Loss 1.473, Train_accy 62.94:  10%|█         | 2/20 [01:37<14:40, 48.90s/it]Task 1, Epoch 3/20 => Loss 1.350, Train_accy 65.84:  10%|█         | 2/20 [02:26<14:40, 48.90s/it]Task 1, Epoch 3/20 => Loss 1.350, Train_accy 65.84:  15%|█▌        | 3/20 [02:26<13:51, 48.93s/it]Task 1, Epoch 4/20 => Loss 1.255, Train_accy 67.13:  15%|█▌        | 3/20 [03:15<13:51, 48.93s/it]Task 1, Epoch 4/20 => Loss 1.255, Train_accy 67.13:  20%|██        | 4/20 [03:15<13:01, 48.85s/it]Task 1, Epoch 5/20 => Loss 1.210, Train_accy 68.19:  20%|██        | 4/20 [04:04<13:01, 48.85s/it]Task 1, Epoch 5/20 => Loss 1.210, Train_accy 68.19:  25%|██▌       | 5/20 [04:04<12:12, 48.80s/it]Task 1, Epoch 6/20 => Loss 1.154, Train_accy 69.12:  25%|██▌       | 5/20 [04:52<12:12, 48.80s/it]Task 1, Epoch 6/20 => Loss 1.154, Train_accy 69.12:  30%|███       | 6/20 [04:52<11:21, 48.71s/it]Task 1, Epoch 7/20 => Loss 1.119, Train_accy 70.30:  30%|███       | 6/20 [05:41<11:21, 48.71s/it]Task 1, Epoch 7/20 => Loss 1.119, Train_accy 70.30:  35%|███▌      | 7/20 [05:41<10:33, 48.77s/it]Task 1, Epoch 8/20 => Loss 1.078, Train_accy 71.22:  35%|███▌      | 7/20 [06:30<10:33, 48.77s/it]Task 1, Epoch 8/20 => Loss 1.078, Train_accy 71.22:  40%|████      | 8/20 [06:30<09:45, 48.83s/it]Task 1, Epoch 9/20 => Loss 1.024, Train_accy 72.47:  40%|████      | 8/20 [07:19<09:45, 48.83s/it]Task 1, Epoch 9/20 => Loss 1.024, Train_accy 72.47:  45%|████▌     | 9/20 [07:19<08:57, 48.88s/it]Task 1, Epoch 10/20 => Loss 0.996, Train_accy 73.23:  45%|████▌     | 9/20 [08:08<08:57, 48.88s/it]Task 1, Epoch 10/20 => Loss 0.996, Train_accy 73.23:  50%|█████     | 10/20 [08:08<08:08, 48.86s/it]Task 1, Epoch 11/20 => Loss 0.969, Train_accy 73.91:  50%|█████     | 10/20 [08:56<08:08, 48.86s/it]Task 1, Epoch 11/20 => Loss 0.969, Train_accy 73.91:  55%|█████▌    | 11/20 [08:56<07:18, 48.74s/it]Task 1, Epoch 12/20 => Loss 0.961, Train_accy 73.75:  55%|█████▌    | 11/20 [09:45<07:18, 48.74s/it]Task 1, Epoch 12/20 => Loss 0.961, Train_accy 73.75:  60%|██████    | 12/20 [09:45<06:29, 48.69s/it]Task 1, Epoch 13/20 => Loss 0.945, Train_accy 74.56:  60%|██████    | 12/20 [10:34<06:29, 48.69s/it]Task 1, Epoch 13/20 => Loss 0.945, Train_accy 74.56:  65%|██████▌   | 13/20 [10:34<05:40, 48.70s/it]Task 1, Epoch 14/20 => Loss 0.897, Train_accy 75.38:  65%|██████▌   | 13/20 [11:23<05:40, 48.70s/it]Task 1, Epoch 14/20 => Loss 0.897, Train_accy 75.38:  70%|███████   | 14/20 [11:23<04:52, 48.80s/it]Task 1, Epoch 15/20 => Loss 0.898, Train_accy 75.43:  70%|███████   | 14/20 [12:11<04:52, 48.80s/it]Task 1, Epoch 15/20 => Loss 0.898, Train_accy 75.43:  75%|███████▌  | 15/20 [12:11<04:03, 48.77s/it]Task 1, Epoch 16/20 => Loss 0.880, Train_accy 76.09:  75%|███████▌  | 15/20 [13:00<04:03, 48.77s/it]Task 1, Epoch 16/20 => Loss 0.880, Train_accy 76.09:  80%|████████  | 16/20 [13:00<03:14, 48.74s/it]Task 1, Epoch 17/20 => Loss 0.857, Train_accy 76.96:  80%|████████  | 16/20 [13:49<03:14, 48.74s/it]Task 1, Epoch 17/20 => Loss 0.857, Train_accy 76.96:  85%|████████▌ | 17/20 [13:49<02:26, 48.77s/it]Task 1, Epoch 18/20 => Loss 0.860, Train_accy 76.51:  85%|████████▌ | 17/20 [14:38<02:26, 48.77s/it]Task 1, Epoch 18/20 => Loss 0.860, Train_accy 76.51:  90%|█████████ | 18/20 [14:38<01:37, 48.80s/it]Task 1, Epoch 19/20 => Loss 0.861, Train_accy 76.62:  90%|█████████ | 18/20 [15:26<01:37, 48.80s/it]Task 1, Epoch 19/20 => Loss 0.861, Train_accy 76.62:  95%|█████████▌| 19/20 [15:26<00:48, 48.71s/it]Task 1, Epoch 20/20 => Loss 0.842, Train_accy 76.90:  95%|█████████▌| 19/20 [16:15<00:48, 48.71s/it]Task 1, Epoch 20/20 => Loss 0.842, Train_accy 76.90: 100%|██████████| 20/20 [16:15<00:00, 48.75s/it]Task 1, Epoch 20/20 => Loss 0.842, Train_accy 76.90: 100%|██████████| 20/20 [16:15<00:00, 48.78s/it]
2024-04-19 20:28:27,149 [loramoeinc.py] => Task 1, Epoch 20/20 => Loss 0.842, Train_accy 76.90
2024-04-19 20:29:59,361 [trainer.py] => No NME accuracy.
2024-04-19 20:29:59,361 [trainer.py] => CNN: {'total': 95.15, '00-19': 96.05, '20-39': 94.25, 'old': 96.05, 'new': 94.25}
2024-04-19 20:29:59,361 [trainer.py] => Route: {'total': 89.1, '00-19': 88.6, '20-39': 89.6, 'old': 88.6, 'new': 89.6}
2024-04-19 20:29:59,361 [trainer.py] => CNN top1 curve: [96.05, 95.15]
2024-04-19 20:29:59,361 [trainer.py] => CNN top5 curve: [99.7, 99.55]
2024-04-19 20:29:59,361 [trainer.py] => Route top1 curve: [92.2, 89.1]
2024-04-19 20:29:59,361 [trainer.py] => Route top5 curve: [98.7, 97.92]

Average Accuracy (CNN): 95.6
Average Accuracy (Route): 90.65
2024-04-19 20:29:59,361 [trainer.py] => Average Accuracy (CNN): 95.6
2024-04-19 20:29:59,361 [trainer.py] => Average Accuracy (Route): 90.65

2024-04-19 20:29:59,361 [trainer.py] => Train Time: 1946.1599999999999
2024-04-19 20:29:59,361 [trainer.py] => Test Time: 30.79 

2024-04-19 20:29:59,362 [trainer.py] => All params: 85894678
2024-04-19 20:29:59,363 [trainer.py] => Trainable params: 51469
2024-04-19 20:29:59,365 [loramoeinc.py] => Learning on 40-60
  0%|          | 0/20 [00:00<?, ?it/s]Task 2, Epoch 1/20 => Loss 1.844, Train_accy 64.01:   0%|          | 0/20 [00:48<?, ?it/s]Task 2, Epoch 1/20 => Loss 1.844, Train_accy 64.01:   5%|▌         | 1/20 [00:48<15:27, 48.81s/it]Task 2, Epoch 2/20 => Loss 1.487, Train_accy 67.81:   5%|▌         | 1/20 [01:37<15:27, 48.81s/it]Task 2, Epoch 2/20 => Loss 1.487, Train_accy 67.81:  10%|█         | 2/20 [01:37<14:40, 48.91s/it]Task 2, Epoch 3/20 => Loss 1.368, Train_accy 69.16:  10%|█         | 2/20 [02:26<14:40, 48.91s/it]Task 2, Epoch 3/20 => Loss 1.368, Train_accy 69.16:  15%|█▌        | 3/20 [02:26<13:49, 48.82s/it]Task 2, Epoch 4/20 => Loss 1.330, Train_accy 69.22:  15%|█▌        | 3/20 [03:15<13:49, 48.82s/it]Task 2, Epoch 4/20 => Loss 1.330, Train_accy 69.22:  20%|██        | 4/20 [03:15<12:59, 48.71s/it]Task 2, Epoch 5/20 => Loss 1.292, Train_accy 70.15:  20%|██        | 4/20 [04:03<12:59, 48.71s/it]Task 2, Epoch 5/20 => Loss 1.292, Train_accy 70.15:  25%|██▌       | 5/20 [04:03<12:10, 48.71s/it]Task 2, Epoch 6/20 => Loss 1.232, Train_accy 71.26:  25%|██▌       | 5/20 [04:52<12:10, 48.71s/it]Task 2, Epoch 6/20 => Loss 1.232, Train_accy 71.26:  30%|███       | 6/20 [04:52<11:23, 48.83s/it]Task 2, Epoch 7/20 => Loss 1.210, Train_accy 72.02:  30%|███       | 6/20 [05:41<11:23, 48.83s/it]Task 2, Epoch 7/20 => Loss 1.210, Train_accy 72.02:  35%|███▌      | 7/20 [05:41<10:34, 48.84s/it]Task 2, Epoch 8/20 => Loss 1.148, Train_accy 73.08:  35%|███▌      | 7/20 [06:30<10:34, 48.84s/it]Task 2, Epoch 8/20 => Loss 1.148, Train_accy 73.08:  40%|████      | 8/20 [06:30<09:44, 48.73s/it]Task 2, Epoch 9/20 => Loss 1.114, Train_accy 74.17:  40%|████      | 8/20 [07:18<09:44, 48.73s/it]Task 2, Epoch 9/20 => Loss 1.114, Train_accy 74.17:  45%|████▌     | 9/20 [07:18<08:55, 48.72s/it]Task 2, Epoch 10/20 => Loss 1.087, Train_accy 73.27:  45%|████▌     | 9/20 [08:07<08:55, 48.72s/it]Task 2, Epoch 10/20 => Loss 1.087, Train_accy 73.27:  50%|█████     | 10/20 [08:07<08:08, 48.81s/it]Task 2, Epoch 11/20 => Loss 1.045, Train_accy 74.82:  50%|█████     | 10/20 [08:56<08:08, 48.81s/it]Task 2, Epoch 11/20 => Loss 1.045, Train_accy 74.82:  55%|█████▌    | 11/20 [08:56<07:18, 48.75s/it]Task 2, Epoch 12/20 => Loss 1.012, Train_accy 75.68:  55%|█████▌    | 11/20 [09:45<07:18, 48.75s/it]Task 2, Epoch 12/20 => Loss 1.012, Train_accy 75.68:  60%|██████    | 12/20 [09:45<06:29, 48.75s/it]Task 2, Epoch 13/20 => Loss 1.000, Train_accy 76.08:  60%|██████    | 12/20 [10:33<06:29, 48.75s/it]Task 2, Epoch 13/20 => Loss 1.000, Train_accy 76.08:  65%|██████▌   | 13/20 [10:33<05:41, 48.75s/it]Task 2, Epoch 14/20 => Loss 0.990, Train_accy 76.25:  65%|██████▌   | 13/20 [11:22<05:41, 48.75s/it]Task 2, Epoch 14/20 => Loss 0.990, Train_accy 76.25:  70%|███████   | 14/20 [11:22<04:52, 48.74s/it]Task 2, Epoch 15/20 => Loss 0.936, Train_accy 77.62:  70%|███████   | 14/20 [12:11<04:52, 48.74s/it]Task 2, Epoch 15/20 => Loss 0.936, Train_accy 77.62:  75%|███████▌  | 15/20 [12:11<04:03, 48.77s/it]Task 2, Epoch 16/20 => Loss 0.928, Train_accy 77.69:  75%|███████▌  | 15/20 [13:00<04:03, 48.77s/it]Task 2, Epoch 16/20 => Loss 0.928, Train_accy 77.69:  80%|████████  | 16/20 [13:00<03:15, 48.77s/it]Task 2, Epoch 17/20 => Loss 0.939, Train_accy 77.42:  80%|████████  | 16/20 [13:48<03:15, 48.77s/it]Task 2, Epoch 17/20 => Loss 0.939, Train_accy 77.42:  85%|████████▌ | 17/20 [13:48<02:26, 48.71s/it]Task 2, Epoch 18/20 => Loss 0.901, Train_accy 78.16:  85%|████████▌ | 17/20 [14:37<02:26, 48.71s/it]Task 2, Epoch 18/20 => Loss 0.901, Train_accy 78.16:  90%|█████████ | 18/20 [14:37<01:37, 48.77s/it]Task 2, Epoch 19/20 => Loss 0.886, Train_accy 78.55:  90%|█████████ | 18/20 [15:27<01:37, 48.77s/it]Task 2, Epoch 19/20 => Loss 0.886, Train_accy 78.55:  95%|█████████▌| 19/20 [15:27<00:48, 48.97s/it]Task 2, Epoch 20/20 => Loss 0.904, Train_accy 78.20:  95%|█████████▌| 19/20 [16:16<00:48, 48.97s/it]Task 2, Epoch 20/20 => Loss 0.904, Train_accy 78.20: 100%|██████████| 20/20 [16:16<00:00, 49.12s/it]Task 2, Epoch 20/20 => Loss 0.904, Train_accy 78.20: 100%|██████████| 20/20 [16:16<00:00, 48.83s/it]
2024-04-19 20:46:16,141 [loramoeinc.py] => Task 2, Epoch 20/20 => Loss 0.904, Train_accy 78.20
2024-04-19 20:48:15,510 [trainer.py] => No NME accuracy.
2024-04-19 20:48:15,511 [trainer.py] => CNN: {'total': 94.07, '00-19': 96.05, '20-39': 93.45, '40-59': 92.7, 'old': 94.75, 'new': 92.7}
2024-04-19 20:48:15,511 [trainer.py] => Route: {'total': 85.43, '00-19': 85.95, '20-39': 86.45, '40-59': 83.9, 'old': 86.2, 'new': 83.9}
2024-04-19 20:48:15,511 [trainer.py] => CNN top1 curve: [96.05, 95.15, 94.07]
2024-04-19 20:48:15,511 [trainer.py] => CNN top5 curve: [99.7, 99.55, 99.27]
2024-04-19 20:48:15,511 [trainer.py] => Route top1 curve: [92.2, 89.1, 85.43]
2024-04-19 20:48:15,511 [trainer.py] => Route top5 curve: [98.7, 97.92, 96.65]

Average Accuracy (CNN): 95.08999999999999
Average Accuracy (Route): 88.91000000000001
2024-04-19 20:48:15,511 [trainer.py] => Average Accuracy (CNN): 95.08999999999999
2024-04-19 20:48:15,511 [trainer.py] => Average Accuracy (Route): 88.91000000000001

2024-04-19 20:48:15,511 [trainer.py] => Train Time: 2922.8599999999997
2024-04-19 20:48:15,511 [trainer.py] => Test Time: 60.61 

2024-04-19 20:48:15,512 [trainer.py] => All params: 85925398
2024-04-19 20:48:15,513 [trainer.py] => Trainable params: 59913
2024-04-19 20:48:15,515 [loramoeinc.py] => Learning on 60-80
  0%|          | 0/20 [00:00<?, ?it/s]Task 3, Epoch 1/20 => Loss 1.893, Train_accy 60.13:   0%|          | 0/20 [00:48<?, ?it/s]Task 3, Epoch 1/20 => Loss 1.893, Train_accy 60.13:   5%|▌         | 1/20 [00:48<15:27, 48.83s/it]Task 3, Epoch 2/20 => Loss 1.465, Train_accy 66.41:   5%|▌         | 1/20 [01:38<15:27, 48.83s/it]Task 3, Epoch 2/20 => Loss 1.465, Train_accy 66.41:  10%|█         | 2/20 [01:38<14:43, 49.10s/it]Task 3, Epoch 3/20 => Loss 1.555, Train_accy 62.71:  10%|█         | 2/20 [02:27<14:43, 49.10s/it]Task 3, Epoch 3/20 => Loss 1.555, Train_accy 62.71:  15%|█▌        | 3/20 [02:27<13:58, 49.32s/it]Task 3, Epoch 4/20 => Loss 1.314, Train_accy 68.63:  15%|█▌        | 3/20 [03:16<13:58, 49.32s/it]Task 3, Epoch 4/20 => Loss 1.314, Train_accy 68.63:  20%|██        | 4/20 [03:16<13:07, 49.23s/it]Task 3, Epoch 5/20 => Loss 1.174, Train_accy 71.27:  20%|██        | 4/20 [04:05<13:07, 49.23s/it]Task 3, Epoch 5/20 => Loss 1.174, Train_accy 71.27:  25%|██▌       | 5/20 [04:05<12:17, 49.15s/it]Task 3, Epoch 6/20 => Loss 1.117, Train_accy 72.68:  25%|██▌       | 5/20 [04:54<12:17, 49.15s/it]Task 3, Epoch 6/20 => Loss 1.117, Train_accy 72.68:  30%|███       | 6/20 [04:54<11:27, 49.08s/it]Task 3, Epoch 7/20 => Loss 1.042, Train_accy 74.64:  30%|███       | 6/20 [05:43<11:27, 49.08s/it]Task 3, Epoch 7/20 => Loss 1.042, Train_accy 74.64:  35%|███▌      | 7/20 [05:43<10:37, 49.05s/it]Task 3, Epoch 8/20 => Loss 1.037, Train_accy 74.53:  35%|███▌      | 7/20 [06:32<10:37, 49.05s/it]Task 3, Epoch 8/20 => Loss 1.037, Train_accy 74.53:  40%|████      | 8/20 [06:32<09:49, 49.10s/it]Task 3, Epoch 9/20 => Loss 0.974, Train_accy 75.92:  40%|████      | 8/20 [07:22<09:49, 49.10s/it]Task 3, Epoch 9/20 => Loss 0.974, Train_accy 75.92:  45%|████▌     | 9/20 [07:22<09:01, 49.20s/it]Task 3, Epoch 10/20 => Loss 0.943, Train_accy 76.46:  45%|████▌     | 9/20 [08:11<09:01, 49.20s/it]Task 3, Epoch 10/20 => Loss 0.943, Train_accy 76.46:  50%|█████     | 10/20 [08:11<08:11, 49.15s/it]Task 3, Epoch 11/20 => Loss 0.922, Train_accy 77.12:  50%|█████     | 10/20 [09:00<08:11, 49.15s/it]Task 3, Epoch 11/20 => Loss 0.922, Train_accy 77.12:  55%|█████▌    | 11/20 [09:00<07:21, 49.01s/it]Task 3, Epoch 12/20 => Loss 0.906, Train_accy 77.43:  55%|█████▌    | 11/20 [09:48<07:21, 49.01s/it]Task 3, Epoch 12/20 => Loss 0.906, Train_accy 77.43:  60%|██████    | 12/20 [09:48<06:31, 48.97s/it]Task 3, Epoch 13/20 => Loss 0.868, Train_accy 78.05:  60%|██████    | 12/20 [10:37<06:31, 48.97s/it]Task 3, Epoch 13/20 => Loss 0.868, Train_accy 78.05:  65%|██████▌   | 13/20 [10:37<05:42, 48.98s/it]Task 3, Epoch 14/20 => Loss 0.862, Train_accy 77.72:  65%|██████▌   | 13/20 [11:27<05:42, 48.98s/it]Task 3, Epoch 14/20 => Loss 0.862, Train_accy 77.72:  70%|███████   | 14/20 [11:27<04:54, 49.03s/it]Task 3, Epoch 15/20 => Loss 0.843, Train_accy 78.29:  70%|███████   | 14/20 [12:16<04:54, 49.03s/it]Task 3, Epoch 15/20 => Loss 0.843, Train_accy 78.29:  75%|███████▌  | 15/20 [12:16<04:05, 49.11s/it]Task 3, Epoch 16/20 => Loss 0.814, Train_accy 79.56:  75%|███████▌  | 15/20 [13:05<04:05, 49.11s/it]Task 3, Epoch 16/20 => Loss 0.814, Train_accy 79.56:  80%|████████  | 16/20 [13:05<03:16, 49.11s/it]Task 3, Epoch 17/20 => Loss 0.816, Train_accy 78.91:  80%|████████  | 16/20 [13:54<03:16, 49.11s/it]Task 3, Epoch 17/20 => Loss 0.816, Train_accy 78.91:  85%|████████▌ | 17/20 [13:54<02:27, 49.04s/it]Task 3, Epoch 18/20 => Loss 0.804, Train_accy 79.20:  85%|████████▌ | 17/20 [14:43<02:27, 49.04s/it]Task 3, Epoch 18/20 => Loss 0.804, Train_accy 79.20:  90%|█████████ | 18/20 [14:43<01:37, 48.97s/it]Task 3, Epoch 19/20 => Loss 0.806, Train_accy 79.30:  90%|█████████ | 18/20 [15:32<01:37, 48.97s/it]Task 3, Epoch 19/20 => Loss 0.806, Train_accy 79.30:  95%|█████████▌| 19/20 [15:32<00:48, 48.98s/it]Task 3, Epoch 20/20 => Loss 0.788, Train_accy 79.68:  95%|█████████▌| 19/20 [16:21<00:48, 48.98s/it]Task 3, Epoch 20/20 => Loss 0.788, Train_accy 79.68: 100%|██████████| 20/20 [16:21<00:00, 49.00s/it]Task 3, Epoch 20/20 => Loss 0.788, Train_accy 79.68: 100%|██████████| 20/20 [16:21<00:00, 49.06s/it]
2024-04-19 21:04:36,875 [loramoeinc.py] => Task 3, Epoch 20/20 => Loss 0.788, Train_accy 79.68
2024-04-19 21:06:29,096 [trainer.py] => No NME accuracy.
2024-04-19 21:06:29,097 [trainer.py] => CNN: {'total': 93.72, '00-19': 96.05, '20-39': 93.45, '40-59': 92.7, '60-79': 92.7, 'old': 94.07, 'new': 92.7}
2024-04-19 21:06:29,097 [trainer.py] => Route: {'total': 82.54, '00-19': 83.75, '20-39': 85.9, '40-59': 80.0, '60-79': 80.5, 'old': 83.22, 'new': 80.5}
2024-04-19 21:06:29,097 [trainer.py] => CNN top1 curve: [96.05, 95.15, 94.07, 93.72]
2024-04-19 21:06:29,097 [trainer.py] => CNN top5 curve: [99.7, 99.55, 99.27, 99.4]
2024-04-19 21:06:29,097 [trainer.py] => Route top1 curve: [92.2, 89.1, 85.43, 82.54]
2024-04-19 21:06:29,097 [trainer.py] => Route top5 curve: [98.7, 97.92, 96.65, 95.8]

Average Accuracy (CNN): 94.7475
Average Accuracy (Route): 87.31750000000001
2024-04-19 21:06:29,097 [trainer.py] => Average Accuracy (CNN): 94.7475
2024-04-19 21:06:29,097 [trainer.py] => Average Accuracy (Route): 87.31750000000001

2024-04-19 21:06:29,097 [trainer.py] => Train Time: 3904.1099999999997
2024-04-19 21:06:29,097 [trainer.py] => Test Time: 100.43 

2024-04-19 21:06:29,098 [trainer.py] => All params: 85956118
2024-04-19 21:06:29,099 [trainer.py] => Trainable params: 68357
2024-04-19 21:06:29,103 [loramoeinc.py] => Learning on 80-100
  0%|          | 0/20 [00:00<?, ?it/s]Task 4, Epoch 1/20 => Loss 2.823, Train_accy 46.26:   0%|          | 0/20 [00:48<?, ?it/s]Task 4, Epoch 1/20 => Loss 2.823, Train_accy 46.26:   5%|▌         | 1/20 [00:48<15:23, 48.61s/it]Task 4, Epoch 2/20 => Loss 1.990, Train_accy 55.59:   5%|▌         | 1/20 [01:37<15:23, 48.61s/it]Task 4, Epoch 2/20 => Loss 1.990, Train_accy 55.59:  10%|█         | 2/20 [01:37<14:40, 48.93s/it]Task 4, Epoch 3/20 => Loss 1.823, Train_accy 59.77:  10%|█         | 2/20 [02:27<14:40, 48.93s/it]Task 4, Epoch 3/20 => Loss 1.823, Train_accy 59.77:  15%|█▌        | 3/20 [02:27<13:54, 49.10s/it]Task 4, Epoch 4/20 => Loss 1.739, Train_accy 60.49:  15%|█▌        | 3/20 [03:15<13:54, 49.10s/it]Task 4, Epoch 4/20 => Loss 1.739, Train_accy 60.49:  20%|██        | 4/20 [03:15<13:04, 49.00s/it]Task 4, Epoch 5/20 => Loss 1.638, Train_accy 62.20:  20%|██        | 4/20 [04:04<13:04, 49.00s/it]Task 4, Epoch 5/20 => Loss 1.638, Train_accy 62.20:  25%|██▌       | 5/20 [04:04<12:15, 49.02s/it]Task 4, Epoch 6/20 => Loss 1.554, Train_accy 63.48:  25%|██▌       | 5/20 [04:54<12:15, 49.02s/it]Task 4, Epoch 6/20 => Loss 1.554, Train_accy 63.48:  30%|███       | 6/20 [04:54<11:26, 49.04s/it]Task 4, Epoch 7/20 => Loss 1.504, Train_accy 65.01:  30%|███       | 6/20 [05:43<11:26, 49.04s/it]Task 4, Epoch 7/20 => Loss 1.504, Train_accy 65.01:  35%|███▌      | 7/20 [05:43<10:37, 49.07s/it]Task 4, Epoch 8/20 => Loss 1.438, Train_accy 66.09:  35%|███▌      | 7/20 [06:32<10:37, 49.07s/it]Task 4, Epoch 8/20 => Loss 1.438, Train_accy 66.09:  40%|████      | 8/20 [06:32<09:49, 49.14s/it]Task 4, Epoch 9/20 => Loss 1.388, Train_accy 66.98:  40%|████      | 8/20 [07:21<09:49, 49.14s/it]Task 4, Epoch 9/20 => Loss 1.388, Train_accy 66.98:  45%|████▌     | 9/20 [07:21<09:01, 49.21s/it]Task 4, Epoch 10/20 => Loss 1.339, Train_accy 67.78:  45%|████▌     | 9/20 [08:10<09:01, 49.21s/it]Task 4, Epoch 10/20 => Loss 1.339, Train_accy 67.78:  50%|█████     | 10/20 [08:10<08:10, 49.10s/it]Task 4, Epoch 11/20 => Loss 1.308, Train_accy 67.86:  50%|█████     | 10/20 [08:59<08:10, 49.10s/it]Task 4, Epoch 11/20 => Loss 1.308, Train_accy 67.86:  55%|█████▌    | 11/20 [08:59<07:21, 49.03s/it]Task 4, Epoch 12/20 => Loss 1.263, Train_accy 68.93:  55%|█████▌    | 11/20 [09:48<07:21, 49.03s/it]Task 4, Epoch 12/20 => Loss 1.263, Train_accy 68.93:  60%|██████    | 12/20 [09:48<06:32, 49.11s/it]Task 4, Epoch 13/20 => Loss 1.213, Train_accy 69.94:  60%|██████    | 12/20 [10:38<06:32, 49.11s/it]Task 4, Epoch 13/20 => Loss 1.213, Train_accy 69.94:  65%|██████▌   | 13/20 [10:38<05:44, 49.16s/it]Task 4, Epoch 14/20 => Loss 1.196, Train_accy 70.05:  65%|██████▌   | 13/20 [11:27<05:44, 49.16s/it]Task 4, Epoch 14/20 => Loss 1.196, Train_accy 70.05:  70%|███████   | 14/20 [11:27<04:55, 49.31s/it]Task 4, Epoch 15/20 => Loss 1.151, Train_accy 70.95:  70%|███████   | 14/20 [12:16<04:55, 49.31s/it]Task 4, Epoch 15/20 => Loss 1.151, Train_accy 70.95:  75%|███████▌  | 15/20 [12:16<04:05, 49.20s/it]Task 4, Epoch 16/20 => Loss 1.155, Train_accy 70.43:  75%|███████▌  | 15/20 [13:05<04:05, 49.20s/it]Task 4, Epoch 16/20 => Loss 1.155, Train_accy 70.43:  80%|████████  | 16/20 [13:05<03:16, 49.06s/it]Task 4, Epoch 17/20 => Loss 1.128, Train_accy 71.17:  80%|████████  | 16/20 [13:54<03:16, 49.06s/it]Task 4, Epoch 17/20 => Loss 1.128, Train_accy 71.17:  85%|████████▌ | 17/20 [13:54<02:26, 48.92s/it]Task 4, Epoch 18/20 => Loss 1.106, Train_accy 71.82:  85%|████████▌ | 17/20 [14:42<02:26, 48.92s/it]Task 4, Epoch 18/20 => Loss 1.106, Train_accy 71.82:  90%|█████████ | 18/20 [14:42<01:37, 48.89s/it]Task 4, Epoch 19/20 => Loss 1.107, Train_accy 71.96:  90%|█████████ | 18/20 [15:32<01:37, 48.89s/it]Task 4, Epoch 19/20 => Loss 1.107, Train_accy 71.96:  95%|█████████▌| 19/20 [15:32<00:49, 49.06s/it]Task 4, Epoch 20/20 => Loss 1.098, Train_accy 71.75:  95%|█████████▌| 19/20 [16:21<00:49, 49.06s/it]Task 4, Epoch 20/20 => Loss 1.098, Train_accy 71.75: 100%|██████████| 20/20 [16:21<00:00, 49.16s/it]Task 4, Epoch 20/20 => Loss 1.098, Train_accy 71.75: 100%|██████████| 20/20 [16:21<00:00, 49.09s/it]
2024-04-19 21:22:50,933 [loramoeinc.py] => Task 4, Epoch 20/20 => Loss 1.098, Train_accy 71.75
2024-04-19 21:24:44,378 [trainer.py] => No NME accuracy.
2024-04-19 21:24:44,378 [trainer.py] => CNN: {'total': 93.02, '00-19': 96.05, '20-39': 93.45, '40-59': 92.7, '60-79': 92.7, '80-99': 90.2, 'old': 93.72, 'new': 90.2}
2024-04-19 21:24:44,378 [trainer.py] => Route: {'total': 81.26, '00-19': 81.7, '20-39': 84.65, '40-59': 78.35, '60-79': 79.2, '80-99': 82.4, 'old': 80.97, 'new': 82.4}
2024-04-19 21:24:44,378 [trainer.py] => CNN top1 curve: [96.05, 95.15, 94.07, 93.72, 93.02]
2024-04-19 21:24:44,378 [trainer.py] => CNN top5 curve: [99.7, 99.55, 99.27, 99.4, 99.21]
2024-04-19 21:24:44,378 [trainer.py] => Route top1 curve: [92.2, 89.1, 85.43, 82.54, 81.26]
2024-04-19 21:24:44,378 [trainer.py] => Route top5 curve: [98.7, 97.92, 96.65, 95.8, 94.98]

Average Accuracy (CNN): 94.402
Average Accuracy (Route): 86.10600000000001
2024-04-19 21:24:44,378 [trainer.py] => Average Accuracy (CNN): 94.402
2024-04-19 21:24:44,378 [trainer.py] => Average Accuracy (Route): 86.10600000000001

2024-04-19 21:24:44,378 [trainer.py] => Train Time: 4885.83
2024-04-19 21:24:44,378 [trainer.py] => Test Time: 149.88 

