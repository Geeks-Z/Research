nohup: 忽略输入
2024-04-19 18:33:39,459 [trainer.py] => config: ./exps/loramoe_inc.json
2024-04-19 18:33:39,463 [trainer.py] => prefix: reproduce
2024-04-19 18:33:39,463 [trainer.py] => dataset: cifar224
2024-04-19 18:33:39,463 [trainer.py] => memory_size: 0
2024-04-19 18:33:39,463 [trainer.py] => memory_per_class: 0
2024-04-19 18:33:39,463 [trainer.py] => fixed_memory: False
2024-04-19 18:33:39,463 [trainer.py] => shuffle: True
2024-04-19 18:33:39,463 [trainer.py] => init_cls: 20
2024-04-19 18:33:39,463 [trainer.py] => increment: 20
2024-04-19 18:33:39,463 [trainer.py] => model_name: loramoeinc
2024-04-19 18:33:39,463 [trainer.py] => backbone_type: pretrained_vit_b16_224_inc
2024-04-19 18:33:39,463 [trainer.py] => device: [device(type='cuda', index=0)]
2024-04-19 18:33:39,463 [trainer.py] => seed: 1993
2024-04-19 18:33:39,463 [trainer.py] => tuned_epoch: 20
2024-04-19 18:33:39,463 [trainer.py] => init_lr: 0.01
2024-04-19 18:33:39,463 [trainer.py] => batch_size: 48
2024-04-19 18:33:39,463 [trainer.py] => weight_decay: 0.0005
2024-04-19 18:33:39,463 [trainer.py] => min_lr: 0
2024-04-19 18:33:39,463 [trainer.py] => ffn_num: 4
2024-04-19 18:33:39,463 [trainer.py] => optimizer: sgd
2024-04-19 18:33:39,463 [trainer.py] => vpt_type: shallow
2024-04-19 18:33:39,463 [trainer.py] => prompt_token_num: 5
2024-04-19 18:33:39,463 [trainer.py] => expert_num: 5
2024-04-19 18:33:40,967 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
/home/team/zhaohongwei/anaconda3/envs/peft/lib/python3.10/site-packages/bitsandbytes/cuda_setup/main.py:136: UserWarning: /home/team/zhaohongwei/anaconda3/envs/peft did not contain libcudart.so as expected! Searching further paths...
  warn(msg)

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please submit your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
CUDA SETUP: CUDA runtime path found: /usr/local/cuda-11.8/lib64/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 8.6
CUDA SETUP: Detected CUDA version 118
CUDA SETUP: Loading binary /home/team/zhaohongwei/anaconda3/envs/peft/lib/python3.10/site-packages/bitsandbytes/libbitsandbytes_cuda118.so...
I'm using ViT with adapters.
2024-04-19 18:33:57,064 [trainer.py] => All params: 85867816
2024-04-19 18:33:57,065 [trainer.py] => Trainable params: 69160
2024-04-19 18:33:57,200 [loramoeinc.py] => Learning on 0-20
  0%|          | 0/20 [00:00<?, ?it/s]Task 0, Epoch 1/20 => Loss 2.455, Train_accy 56.59:   0%|          | 0/20 [01:16<?, ?it/s]Task 0, Epoch 1/20 => Loss 2.455, Train_accy 56.59:   5%|▌         | 1/20 [01:16<24:10, 76.34s/it]Task 0, Epoch 2/20 => Loss 0.825, Train_accy 82.40:   5%|▌         | 1/20 [02:30<24:10, 76.34s/it]Task 0, Epoch 2/20 => Loss 0.825, Train_accy 82.40:  10%|█         | 2/20 [02:30<22:33, 75.18s/it]Task 0, Epoch 3/20 => Loss 0.591, Train_accy 84.87:  10%|█         | 2/20 [03:44<22:33, 75.18s/it]Task 0, Epoch 3/20 => Loss 0.591, Train_accy 84.87:  15%|█▌        | 3/20 [03:44<21:08, 74.64s/it]Task 0, Epoch 4/20 => Loss 0.535, Train_accy 85.67:  15%|█▌        | 3/20 [04:59<21:08, 74.64s/it]Task 0, Epoch 4/20 => Loss 0.535, Train_accy 85.67:  20%|██        | 4/20 [04:59<19:54, 74.69s/it]Task 0, Epoch 5/20 => Loss 0.499, Train_accy 86.47:  20%|██        | 4/20 [05:59<19:54, 74.69s/it]Task 0, Epoch 5/20 => Loss 0.499, Train_accy 86.47:  25%|██▌       | 5/20 [05:59<17:22, 69.53s/it]Task 0, Epoch 6/20 => Loss 0.471, Train_accy 86.78:  25%|██▌       | 5/20 [06:54<17:22, 69.53s/it]Task 0, Epoch 6/20 => Loss 0.471, Train_accy 86.78:  30%|███       | 6/20 [06:54<15:04, 64.61s/it]Task 0, Epoch 7/20 => Loss 0.461, Train_accy 87.05:  30%|███       | 6/20 [07:50<15:04, 64.61s/it]Task 0, Epoch 7/20 => Loss 0.461, Train_accy 87.05:  35%|███▌      | 7/20 [07:50<13:19, 61.52s/it]Task 0, Epoch 8/20 => Loss 0.449, Train_accy 87.34:  35%|███▌      | 7/20 [08:49<13:19, 61.52s/it]Task 0, Epoch 8/20 => Loss 0.449, Train_accy 87.34:  40%|████      | 8/20 [08:49<12:11, 60.98s/it]Task 0, Epoch 9/20 => Loss 0.439, Train_accy 87.67:  40%|████      | 8/20 [10:04<12:11, 60.98s/it]Task 0, Epoch 9/20 => Loss 0.439, Train_accy 87.67:  45%|████▌     | 9/20 [10:04<11:57, 65.25s/it]Task 0, Epoch 10/20 => Loss 0.422, Train_accy 87.73:  45%|████▌     | 9/20 [11:19<11:57, 65.25s/it]Task 0, Epoch 10/20 => Loss 0.422, Train_accy 87.73:  50%|█████     | 10/20 [11:19<11:21, 68.13s/it]Task 0, Epoch 11/20 => Loss 0.414, Train_accy 88.26:  50%|█████     | 10/20 [12:33<11:21, 68.13s/it]Task 0, Epoch 11/20 => Loss 0.414, Train_accy 88.26:  55%|█████▌    | 11/20 [12:33<10:30, 70.04s/it]Task 0, Epoch 12/20 => Loss 0.404, Train_accy 88.30:  55%|█████▌    | 11/20 [13:48<10:30, 70.04s/it]Task 0, Epoch 12/20 => Loss 0.404, Train_accy 88.30:  60%|██████    | 12/20 [13:48<09:32, 71.51s/it]Task 0, Epoch 13/20 => Loss 0.391, Train_accy 88.56:  60%|██████    | 12/20 [15:02<09:32, 71.51s/it]Task 0, Epoch 13/20 => Loss 0.391, Train_accy 88.56:  65%|██████▌   | 13/20 [15:02<08:25, 72.19s/it]Task 0, Epoch 14/20 => Loss 0.388, Train_accy 88.90:  65%|██████▌   | 13/20 [16:16<08:25, 72.19s/it]Task 0, Epoch 14/20 => Loss 0.388, Train_accy 88.90:  70%|███████   | 14/20 [16:16<07:17, 72.97s/it]Task 0, Epoch 15/20 => Loss 0.392, Train_accy 88.67:  70%|███████   | 14/20 [17:31<07:17, 72.97s/it]Task 0, Epoch 15/20 => Loss 0.392, Train_accy 88.67:  75%|███████▌  | 15/20 [17:31<06:08, 73.61s/it]Task 0, Epoch 16/20 => Loss 0.396, Train_accy 88.32:  75%|███████▌  | 15/20 [18:30<06:08, 73.61s/it]Task 0, Epoch 16/20 => Loss 0.396, Train_accy 88.32:  80%|████████  | 16/20 [18:30<04:36, 69.10s/it]Task 0, Epoch 17/20 => Loss 0.380, Train_accy 89.12:  80%|████████  | 16/20 [19:25<04:36, 69.10s/it]Task 0, Epoch 17/20 => Loss 0.380, Train_accy 89.12:  85%|████████▌ | 17/20 [19:25<03:14, 64.81s/it]Task 0, Epoch 18/20 => Loss 0.373, Train_accy 89.40:  85%|████████▌ | 17/20 [20:20<03:14, 64.81s/it]Task 0, Epoch 18/20 => Loss 0.373, Train_accy 89.40:  90%|█████████ | 18/20 [20:20<02:03, 61.87s/it]Task 0, Epoch 19/20 => Loss 0.366, Train_accy 89.26:  90%|█████████ | 18/20 [21:21<02:03, 61.87s/it]Task 0, Epoch 19/20 => Loss 0.366, Train_accy 89.26:  95%|█████████▌| 19/20 [21:21<01:01, 61.57s/it]Task 0, Epoch 20/20 => Loss 0.364, Train_accy 89.41:  95%|█████████▌| 19/20 [22:36<01:01, 61.57s/it]Task 0, Epoch 20/20 => Loss 0.364, Train_accy 89.41: 100%|██████████| 20/20 [22:36<00:00, 65.74s/it]Task 0, Epoch 20/20 => Loss 0.364, Train_accy 89.41: 100%|██████████| 20/20 [22:36<00:00, 67.84s/it]
2024-04-19 18:56:34,247 [loramoeinc.py] => Task 0, Epoch 20/20 => Loss 0.364, Train_accy 89.41
2024-04-19 18:58:28,648 [trainer.py] => No NME accuracy.
2024-04-19 18:58:28,648 [trainer.py] => CNN: {'total': 97.3, '00-19': 97.3, 'old': 0, 'new': 97.3}
2024-04-19 18:58:28,649 [trainer.py] => Route: {'total': 92.2, '00-19': 92.2, 'old': 0, 'new': 92.2}
2024-04-19 18:58:28,649 [trainer.py] => CNN top1 curve: [97.3]
2024-04-19 18:58:28,649 [trainer.py] => CNN top5 curve: [99.6]
2024-04-19 18:58:28,649 [trainer.py] => Route top1 curve: [92.2]
2024-04-19 18:58:28,649 [trainer.py] => Route top5 curve: [98.7]

Average Accuracy (CNN): 97.3
Average Accuracy (Route): 92.2
2024-04-19 18:58:28,649 [trainer.py] => Average Accuracy (CNN): 97.3
2024-04-19 18:58:28,649 [trainer.py] => Average Accuracy (Route): 92.2

2024-04-19 18:58:28,649 [trainer.py] => Train Time: 1356.8
2024-04-19 18:58:28,649 [trainer.py] => Test Time: 15.68 

2024-04-19 18:58:28,650 [trainer.py] => All params: 85898538
2024-04-19 18:58:28,650 [trainer.py] => Trainable params: 70689
2024-04-19 18:58:28,659 [loramoeinc.py] => Learning on 20-40
  0%|          | 0/20 [00:00<?, ?it/s]Task 1, Epoch 1/20 => Loss 1.463, Train_accy 67.28:   0%|          | 0/20 [01:14<?, ?it/s]Task 1, Epoch 1/20 => Loss 1.463, Train_accy 67.28:   5%|▌         | 1/20 [01:14<23:43, 74.94s/it]Task 1, Epoch 2/20 => Loss 0.812, Train_accy 80.06:   5%|▌         | 1/20 [02:29<23:43, 74.94s/it]Task 1, Epoch 2/20 => Loss 0.812, Train_accy 80.06:  10%|█         | 2/20 [02:29<22:23, 74.62s/it]Task 1, Epoch 3/20 => Loss 0.713, Train_accy 81.48:  10%|█         | 2/20 [03:43<22:23, 74.62s/it]Task 1, Epoch 3/20 => Loss 0.713, Train_accy 81.48:  15%|█▌        | 3/20 [03:43<21:06, 74.51s/it]Task 1, Epoch 4/20 => Loss 0.687, Train_accy 81.67:  15%|█▌        | 3/20 [04:58<21:06, 74.51s/it]Task 1, Epoch 4/20 => Loss 0.687, Train_accy 81.67:  20%|██        | 4/20 [04:58<19:55, 74.73s/it]Task 1, Epoch 5/20 => Loss 0.639, Train_accy 82.62:  20%|██        | 4/20 [05:56<19:55, 74.73s/it]Task 1, Epoch 5/20 => Loss 0.639, Train_accy 82.62:  25%|██▌       | 5/20 [05:56<17:09, 68.65s/it]Task 1, Epoch 6/20 => Loss 0.618, Train_accy 82.51:  25%|██▌       | 5/20 [06:51<17:09, 68.65s/it]Task 1, Epoch 6/20 => Loss 0.618, Train_accy 82.51:  30%|███       | 6/20 [06:51<14:55, 64.00s/it]Task 1, Epoch 7/20 => Loss 0.602, Train_accy 82.91:  30%|███       | 6/20 [07:46<14:55, 64.00s/it]Task 1, Epoch 7/20 => Loss 0.602, Train_accy 82.91:  35%|███▌      | 7/20 [07:46<13:14, 61.14s/it]Task 1, Epoch 8/20 => Loss 0.580, Train_accy 83.12:  35%|███▌      | 7/20 [08:49<13:14, 61.14s/it]Task 1, Epoch 8/20 => Loss 0.580, Train_accy 83.12:  40%|████      | 8/20 [08:49<12:18, 61.55s/it]Task 1, Epoch 9/20 => Loss 0.578, Train_accy 83.28:  40%|████      | 8/20 [10:03<12:18, 61.55s/it]Task 1, Epoch 9/20 => Loss 0.578, Train_accy 83.28:  45%|████▌     | 9/20 [10:03<12:02, 65.64s/it]Task 1, Epoch 10/20 => Loss 0.563, Train_accy 83.46:  45%|████▌     | 9/20 [11:18<12:02, 65.64s/it]Task 1, Epoch 10/20 => Loss 0.563, Train_accy 83.46:  50%|█████     | 10/20 [11:18<11:23, 68.37s/it]Task 1, Epoch 11/20 => Loss 0.563, Train_accy 83.52:  50%|█████     | 10/20 [12:32<11:23, 68.37s/it]Task 1, Epoch 11/20 => Loss 0.563, Train_accy 83.52:  55%|█████▌    | 11/20 [12:32<10:32, 70.25s/it]Task 1, Epoch 12/20 => Loss 0.551, Train_accy 83.34:  55%|█████▌    | 11/20 [13:48<10:32, 70.25s/it]Task 1, Epoch 12/20 => Loss 0.551, Train_accy 83.34:  60%|██████    | 12/20 [13:48<09:33, 71.72s/it]Task 1, Epoch 13/20 => Loss 0.525, Train_accy 84.58:  60%|██████    | 12/20 [15:02<09:33, 71.72s/it]Task 1, Epoch 13/20 => Loss 0.525, Train_accy 84.58:  65%|██████▌   | 13/20 [15:02<08:28, 72.70s/it]Task 1, Epoch 14/20 => Loss 0.509, Train_accy 85.13:  65%|██████▌   | 13/20 [16:18<08:28, 72.70s/it]Task 1, Epoch 14/20 => Loss 0.509, Train_accy 85.13:  70%|███████   | 14/20 [16:18<07:20, 73.43s/it]Task 1, Epoch 15/20 => Loss 0.502, Train_accy 85.04:  70%|███████   | 14/20 [17:33<07:20, 73.43s/it]Task 1, Epoch 15/20 => Loss 0.502, Train_accy 85.04:  75%|███████▌  | 15/20 [17:33<06:10, 74.03s/it]Task 1, Epoch 16/20 => Loss 0.506, Train_accy 84.94:  75%|███████▌  | 15/20 [18:28<06:10, 74.03s/it]Task 1, Epoch 16/20 => Loss 0.506, Train_accy 84.94:  80%|████████  | 16/20 [18:28<04:33, 68.41s/it]Task 1, Epoch 17/20 => Loss 0.500, Train_accy 84.97:  80%|████████  | 16/20 [19:23<04:33, 68.41s/it]Task 1, Epoch 17/20 => Loss 0.500, Train_accy 84.97:  85%|████████▌ | 17/20 [19:23<03:13, 64.40s/it]Task 1, Epoch 18/20 => Loss 0.491, Train_accy 85.26:  85%|████████▌ | 17/20 [20:19<03:13, 64.40s/it]Task 1, Epoch 18/20 => Loss 0.491, Train_accy 85.26:  90%|█████████ | 18/20 [20:19<02:03, 61.64s/it]Task 1, Epoch 19/20 => Loss 0.479, Train_accy 85.03:  90%|█████████ | 18/20 [21:24<02:03, 61.64s/it]Task 1, Epoch 19/20 => Loss 0.479, Train_accy 85.03:  95%|█████████▌| 19/20 [21:24<01:02, 62.74s/it]Task 1, Epoch 20/20 => Loss 0.492, Train_accy 84.72:  95%|█████████▌| 19/20 [22:39<01:02, 62.74s/it]Task 1, Epoch 20/20 => Loss 0.492, Train_accy 84.72: 100%|██████████| 20/20 [22:39<00:00, 66.45s/it]Task 1, Epoch 20/20 => Loss 0.492, Train_accy 84.72: 100%|██████████| 20/20 [22:39<00:00, 67.98s/it]
2024-04-19 19:21:08,289 [loramoeinc.py] => Task 1, Epoch 20/20 => Loss 0.492, Train_accy 84.72
2024-04-19 19:23:20,276 [trainer.py] => No NME accuracy.
2024-04-19 19:23:20,277 [trainer.py] => CNN: {'total': 96.55, '00-19': 97.25, '20-39': 95.85, 'old': 97.25, 'new': 95.85}
2024-04-19 19:23:20,277 [trainer.py] => Route: {'total': 89.1, '00-19': 88.6, '20-39': 89.6, 'old': 88.6, 'new': 89.6}
2024-04-19 19:23:20,277 [trainer.py] => CNN top1 curve: [97.3, 96.55]
2024-04-19 19:23:20,277 [trainer.py] => CNN top5 curve: [99.6, 99.48]
2024-04-19 19:23:20,277 [trainer.py] => Route top1 curve: [92.2, 89.1]
2024-04-19 19:23:20,277 [trainer.py] => Route top5 curve: [98.7, 97.92]

Average Accuracy (CNN): 96.925
Average Accuracy (Route): 90.65
2024-04-19 19:23:20,277 [trainer.py] => Average Accuracy (CNN): 96.925
2024-04-19 19:23:20,277 [trainer.py] => Average Accuracy (Route): 90.65

2024-04-19 19:23:20,277 [trainer.py] => Train Time: 2716.34
2024-04-19 19:23:20,277 [trainer.py] => Test Time: 46.3 

2024-04-19 19:23:20,278 [trainer.py] => All params: 85929258
2024-04-19 19:23:20,279 [trainer.py] => Trainable params: 72217
2024-04-19 19:23:20,286 [loramoeinc.py] => Learning on 40-60
  0%|          | 0/20 [00:00<?, ?it/s]Task 2, Epoch 1/20 => Loss 1.298, Train_accy 69.39:   0%|          | 0/20 [01:15<?, ?it/s]Task 2, Epoch 1/20 => Loss 1.298, Train_accy 69.39:   5%|▌         | 1/20 [01:15<23:47, 75.13s/it]Task 2, Epoch 2/20 => Loss 0.805, Train_accy 80.92:   5%|▌         | 1/20 [02:30<23:47, 75.13s/it]Task 2, Epoch 2/20 => Loss 0.805, Train_accy 80.92:  10%|█         | 2/20 [02:30<22:36, 75.34s/it]Task 2, Epoch 3/20 => Loss 0.698, Train_accy 83.08:  10%|█         | 2/20 [03:46<22:36, 75.34s/it]Task 2, Epoch 3/20 => Loss 0.698, Train_accy 83.08:  15%|█▌        | 3/20 [03:46<21:25, 75.61s/it]Task 2, Epoch 4/20 => Loss 0.674, Train_accy 83.79:  15%|█▌        | 3/20 [04:50<21:25, 75.61s/it]Task 2, Epoch 4/20 => Loss 0.674, Train_accy 83.79:  20%|██        | 4/20 [04:50<18:55, 70.96s/it]Task 2, Epoch 5/20 => Loss 0.611, Train_accy 85.30:  20%|██        | 4/20 [05:45<18:55, 70.96s/it]Task 2, Epoch 5/20 => Loss 0.611, Train_accy 85.30:  25%|██▌       | 5/20 [05:45<16:19, 65.28s/it]Task 2, Epoch 6/20 => Loss 0.616, Train_accy 85.29:  25%|██▌       | 5/20 [06:40<16:19, 65.28s/it]Task 2, Epoch 6/20 => Loss 0.616, Train_accy 85.29:  30%|███       | 6/20 [06:40<14:26, 61.87s/it]Task 2, Epoch 7/20 => Loss 0.590, Train_accy 86.00:  30%|███       | 6/20 [07:37<14:26, 61.87s/it]Task 2, Epoch 7/20 => Loss 0.590, Train_accy 86.00:  35%|███▌      | 7/20 [07:37<13:03, 60.31s/it]Task 2, Epoch 8/20 => Loss 0.576, Train_accy 85.98:  35%|███▌      | 7/20 [08:53<13:03, 60.31s/it]Task 2, Epoch 8/20 => Loss 0.576, Train_accy 85.98:  40%|████      | 8/20 [08:53<13:01, 65.08s/it]Task 2, Epoch 9/20 => Loss 0.547, Train_accy 86.45:  40%|████      | 8/20 [10:08<13:01, 65.08s/it]Task 2, Epoch 9/20 => Loss 0.547, Train_accy 86.45:  45%|████▌     | 9/20 [10:08<12:29, 68.13s/it]Task 2, Epoch 10/20 => Loss 0.531, Train_accy 87.05:  45%|████▌     | 9/20 [11:22<12:29, 68.13s/it]Task 2, Epoch 10/20 => Loss 0.531, Train_accy 87.05:  50%|█████     | 10/20 [11:22<11:42, 70.22s/it]Task 2, Epoch 11/20 => Loss 0.541, Train_accy 86.79:  50%|█████     | 10/20 [12:38<11:42, 70.22s/it]Task 2, Epoch 11/20 => Loss 0.541, Train_accy 86.79:  55%|█████▌    | 11/20 [12:38<10:46, 71.88s/it]Task 2, Epoch 12/20 => Loss 0.527, Train_accy 87.07:  55%|█████▌    | 11/20 [13:53<10:46, 71.88s/it]Task 2, Epoch 12/20 => Loss 0.527, Train_accy 87.07:  60%|██████    | 12/20 [13:53<09:41, 72.67s/it]Task 2, Epoch 13/20 => Loss 0.520, Train_accy 87.04:  60%|██████    | 12/20 [15:07<09:41, 72.67s/it]Task 2, Epoch 13/20 => Loss 0.520, Train_accy 87.04:  65%|██████▌   | 13/20 [15:07<08:32, 73.19s/it]Task 2, Epoch 14/20 => Loss 0.510, Train_accy 87.14:  65%|██████▌   | 13/20 [16:22<08:32, 73.19s/it]Task 2, Epoch 14/20 => Loss 0.510, Train_accy 87.14:  70%|███████   | 14/20 [16:22<07:23, 73.85s/it]Task 2, Epoch 15/20 => Loss 0.502, Train_accy 87.68:  70%|███████   | 14/20 [17:22<07:23, 73.85s/it]Task 2, Epoch 15/20 => Loss 0.502, Train_accy 87.68:  75%|███████▌  | 15/20 [17:22<05:47, 69.59s/it]Task 2, Epoch 16/20 => Loss 0.501, Train_accy 87.24:  75%|███████▌  | 15/20 [18:17<05:47, 69.59s/it]Task 2, Epoch 16/20 => Loss 0.501, Train_accy 87.24:  80%|████████  | 16/20 [18:17<04:20, 65.20s/it]Task 2, Epoch 17/20 => Loss 0.496, Train_accy 87.49:  80%|████████  | 16/20 [19:12<04:20, 65.20s/it]Task 2, Epoch 17/20 => Loss 0.496, Train_accy 87.49:  85%|████████▌ | 17/20 [19:12<03:06, 62.14s/it]Task 2, Epoch 18/20 => Loss 0.472, Train_accy 88.31:  85%|████████▌ | 17/20 [20:13<03:06, 62.14s/it]Task 2, Epoch 18/20 => Loss 0.472, Train_accy 88.31:  90%|█████████ | 18/20 [20:13<02:03, 61.86s/it]Task 2, Epoch 19/20 => Loss 0.463, Train_accy 88.44:  90%|█████████ | 18/20 [21:28<02:03, 61.86s/it]Task 2, Epoch 19/20 => Loss 0.463, Train_accy 88.44:  95%|█████████▌| 19/20 [21:28<01:05, 65.82s/it]Task 2, Epoch 20/20 => Loss 0.465, Train_accy 88.30:  95%|█████████▌| 19/20 [22:43<01:05, 65.82s/it]Task 2, Epoch 20/20 => Loss 0.465, Train_accy 88.30: 100%|██████████| 20/20 [22:43<00:00, 68.35s/it]Task 2, Epoch 20/20 => Loss 0.465, Train_accy 88.30: 100%|██████████| 20/20 [22:43<00:00, 68.16s/it]
2024-04-19 19:46:03,514 [loramoeinc.py] => Task 2, Epoch 20/20 => Loss 0.465, Train_accy 88.30
2024-04-19 19:48:31,546 [trainer.py] => No NME accuracy.
2024-04-19 19:48:31,546 [trainer.py] => CNN: {'total': 96.08, '00-19': 97.25, '20-39': 95.35, '40-59': 95.65, 'old': 96.3, 'new': 95.65}
2024-04-19 19:48:31,546 [trainer.py] => Route: {'total': 85.43, '00-19': 85.95, '20-39': 86.45, '40-59': 83.9, 'old': 86.2, 'new': 83.9}
2024-04-19 19:48:31,546 [trainer.py] => CNN top1 curve: [97.3, 96.55, 96.08]
2024-04-19 19:48:31,546 [trainer.py] => CNN top5 curve: [99.6, 99.48, 99.48]
2024-04-19 19:48:31,547 [trainer.py] => Route top1 curve: [92.2, 89.1, 85.43]
2024-04-19 19:48:31,547 [trainer.py] => Route top5 curve: [98.7, 97.92, 96.65]

Average Accuracy (CNN): 96.64333333333333
Average Accuracy (Route): 88.91000000000001
2024-04-19 19:48:31,547 [trainer.py] => Average Accuracy (CNN): 96.64333333333333
2024-04-19 19:48:31,547 [trainer.py] => Average Accuracy (Route): 88.91000000000001

2024-04-19 19:48:31,547 [trainer.py] => Train Time: 4079.45
2024-04-19 19:48:31,547 [trainer.py] => Test Time: 91.25999999999999 

2024-04-19 19:48:31,548 [trainer.py] => All params: 85959978
2024-04-19 19:48:31,549 [trainer.py] => Trainable params: 73745
2024-04-19 19:48:31,553 [loramoeinc.py] => Learning on 60-80
  0%|          | 0/20 [00:00<?, ?it/s]Task 3, Epoch 1/20 => Loss 1.552, Train_accy 65.94:   0%|          | 0/20 [01:15<?, ?it/s]Task 3, Epoch 1/20 => Loss 1.552, Train_accy 65.94:   5%|▌         | 1/20 [01:15<23:56, 75.59s/it]Task 3, Epoch 2/20 => Loss 0.887, Train_accy 77.53:   5%|▌         | 1/20 [02:30<23:56, 75.59s/it]Task 3, Epoch 2/20 => Loss 0.887, Train_accy 77.53:  10%|█         | 2/20 [02:30<22:36, 75.39s/it]Task 3, Epoch 3/20 => Loss 0.810, Train_accy 79.23:  10%|█         | 2/20 [03:35<22:36, 75.39s/it]Task 3, Epoch 3/20 => Loss 0.810, Train_accy 79.23:  15%|█▌        | 3/20 [03:35<20:00, 70.63s/it]Task 3, Epoch 4/20 => Loss 0.778, Train_accy 79.60:  15%|█▌        | 3/20 [04:30<20:00, 70.63s/it]Task 3, Epoch 4/20 => Loss 0.778, Train_accy 79.60:  20%|██        | 4/20 [04:30<17:12, 64.54s/it]Task 3, Epoch 5/20 => Loss 0.759, Train_accy 80.15:  20%|██        | 4/20 [05:26<17:12, 64.54s/it]Task 3, Epoch 5/20 => Loss 0.759, Train_accy 80.15:  25%|██▌       | 5/20 [05:26<15:17, 61.17s/it]Task 3, Epoch 6/20 => Loss 0.758, Train_accy 80.31:  25%|██▌       | 5/20 [06:21<15:17, 61.17s/it]Task 3, Epoch 6/20 => Loss 0.758, Train_accy 80.31:  30%|███       | 6/20 [06:21<13:47, 59.14s/it]Task 3, Epoch 7/20 => Loss 0.714, Train_accy 81.08:  30%|███       | 6/20 [07:36<13:47, 59.14s/it]Task 3, Epoch 7/20 => Loss 0.714, Train_accy 81.08:  35%|███▌      | 7/20 [07:36<13:58, 64.46s/it]Task 3, Epoch 8/20 => Loss 0.691, Train_accy 81.61:  35%|███▌      | 7/20 [08:51<13:58, 64.46s/it]Task 3, Epoch 8/20 => Loss 0.691, Train_accy 81.61:  40%|████      | 8/20 [08:51<13:32, 67.70s/it]Task 3, Epoch 9/20 => Loss 0.670, Train_accy 82.19:  40%|████      | 8/20 [10:06<13:32, 67.70s/it]Task 3, Epoch 9/20 => Loss 0.670, Train_accy 82.19:  45%|████▌     | 9/20 [10:06<12:48, 69.87s/it]Task 3, Epoch 10/20 => Loss 0.658, Train_accy 82.41:  45%|████▌     | 9/20 [11:21<12:48, 69.87s/it]Task 3, Epoch 10/20 => Loss 0.658, Train_accy 82.41:  50%|█████     | 10/20 [11:21<11:55, 71.60s/it]Task 3, Epoch 11/20 => Loss 0.677, Train_accy 82.18:  50%|█████     | 10/20 [12:36<11:55, 71.60s/it]Task 3, Epoch 11/20 => Loss 0.677, Train_accy 82.18:  55%|█████▌    | 11/20 [12:36<10:53, 72.59s/it]Task 3, Epoch 12/20 => Loss 0.637, Train_accy 83.10:  55%|█████▌    | 11/20 [13:51<10:53, 72.59s/it]Task 3, Epoch 12/20 => Loss 0.637, Train_accy 83.10:  60%|██████    | 12/20 [13:51<09:46, 73.31s/it]Task 3, Epoch 13/20 => Loss 0.629, Train_accy 83.09:  60%|██████    | 12/20 [15:06<09:46, 73.31s/it]Task 3, Epoch 13/20 => Loss 0.629, Train_accy 83.09:  65%|██████▌   | 13/20 [15:06<08:38, 74.01s/it]Task 3, Epoch 14/20 => Loss 0.627, Train_accy 83.15:  65%|██████▌   | 13/20 [16:08<08:38, 74.01s/it]Task 3, Epoch 14/20 => Loss 0.627, Train_accy 83.15:  70%|███████   | 14/20 [16:08<07:01, 70.22s/it]Task 3, Epoch 15/20 => Loss 0.638, Train_accy 82.70:  70%|███████   | 14/20 [17:03<07:01, 70.22s/it]Task 3, Epoch 15/20 => Loss 0.638, Train_accy 82.70:  75%|███████▌  | 15/20 [17:03<05:28, 65.61s/it]Task 3, Epoch 16/20 => Loss 0.618, Train_accy 83.64:  75%|███████▌  | 15/20 [17:58<05:28, 65.61s/it]Task 3, Epoch 16/20 => Loss 0.618, Train_accy 83.64:  80%|████████  | 16/20 [17:58<04:09, 62.33s/it]Task 3, Epoch 17/20 => Loss 0.609, Train_accy 83.55:  80%|████████  | 16/20 [18:56<04:09, 62.33s/it]Task 3, Epoch 17/20 => Loss 0.609, Train_accy 83.55:  85%|████████▌ | 17/20 [18:56<03:03, 61.12s/it]Task 3, Epoch 18/20 => Loss 0.599, Train_accy 83.96:  85%|████████▌ | 17/20 [20:11<03:03, 61.12s/it]Task 3, Epoch 18/20 => Loss 0.599, Train_accy 83.96:  90%|█████████ | 18/20 [20:11<02:10, 65.44s/it]Task 3, Epoch 19/20 => Loss 0.584, Train_accy 84.56:  90%|█████████ | 18/20 [21:25<02:10, 65.44s/it]Task 3, Epoch 19/20 => Loss 0.584, Train_accy 84.56:  95%|█████████▌| 19/20 [21:25<01:08, 68.03s/it]Task 3, Epoch 20/20 => Loss 0.582, Train_accy 84.09:  95%|█████████▌| 19/20 [22:40<01:08, 68.03s/it]Task 3, Epoch 20/20 => Loss 0.582, Train_accy 84.09: 100%|██████████| 20/20 [22:40<00:00, 70.02s/it]Task 3, Epoch 20/20 => Loss 0.582, Train_accy 84.09: 100%|██████████| 20/20 [22:40<00:00, 68.03s/it]
2024-04-19 20:11:12,331 [loramoeinc.py] => Task 3, Epoch 20/20 => Loss 0.582, Train_accy 84.09
2024-04-19 20:13:49,028 [trainer.py] => No NME accuracy.
2024-04-19 20:13:49,028 [trainer.py] => CNN: {'total': 95.7, '00-19': 97.2, '20-39': 95.35, '40-59': 95.6, '60-79': 94.65, 'old': 96.05, 'new': 94.65}
2024-04-19 20:13:49,028 [trainer.py] => Route: {'total': 82.54, '00-19': 83.75, '20-39': 85.9, '40-59': 80.0, '60-79': 80.5, 'old': 83.22, 'new': 80.5}
2024-04-19 20:13:49,029 [trainer.py] => CNN top1 curve: [97.3, 96.55, 96.08, 95.7]
2024-04-19 20:13:49,029 [trainer.py] => CNN top5 curve: [99.6, 99.48, 99.48, 99.52]
2024-04-19 20:13:49,029 [trainer.py] => Route top1 curve: [92.2, 89.1, 85.43, 82.54]
2024-04-19 20:13:49,029 [trainer.py] => Route top5 curve: [98.7, 97.92, 96.65, 95.8]

Average Accuracy (CNN): 96.4075
Average Accuracy (Route): 87.31750000000001
2024-04-19 20:13:49,029 [trainer.py] => Average Accuracy (CNN): 96.4075
2024-04-19 20:13:49,029 [trainer.py] => Average Accuracy (Route): 87.31750000000001

2024-04-19 20:13:49,029 [trainer.py] => Train Time: 5440.0599999999995
2024-04-19 20:13:49,029 [trainer.py] => Test Time: 152.03 

2024-04-19 20:13:49,030 [trainer.py] => All params: 85990698
2024-04-19 20:13:49,030 [trainer.py] => Trainable params: 75273
2024-04-19 20:13:49,038 [loramoeinc.py] => Learning on 80-100
  0%|          | 0/20 [00:00<?, ?it/s]Task 4, Epoch 1/20 => Loss 1.720, Train_accy 62.32:   0%|          | 0/20 [01:14<?, ?it/s]Task 4, Epoch 1/20 => Loss 1.720, Train_accy 62.32:   5%|▌         | 1/20 [01:14<23:34, 74.44s/it]Task 4, Epoch 2/20 => Loss 0.948, Train_accy 75.50:   5%|▌         | 1/20 [02:22<23:34, 74.44s/it]Task 4, Epoch 2/20 => Loss 0.948, Train_accy 75.50:  10%|█         | 2/20 [02:22<21:15, 70.84s/it]Task 4, Epoch 3/20 => Loss 0.863, Train_accy 77.57:  10%|█         | 2/20 [03:17<21:15, 70.84s/it]Task 4, Epoch 3/20 => Loss 0.863, Train_accy 77.57:  15%|█▌        | 3/20 [03:17<18:03, 63.71s/it]Task 4, Epoch 4/20 => Loss 0.772, Train_accy 80.15:  15%|█▌        | 3/20 [04:12<18:03, 63.71s/it]Task 4, Epoch 4/20 => Loss 0.772, Train_accy 80.15:  20%|██        | 4/20 [04:12<16:04, 60.27s/it]Task 4, Epoch 5/20 => Loss 0.753, Train_accy 80.29:  20%|██        | 4/20 [05:08<16:04, 60.27s/it]Task 4, Epoch 5/20 => Loss 0.753, Train_accy 80.29:  25%|██▌       | 5/20 [05:08<14:37, 58.48s/it]Task 4, Epoch 6/20 => Loss 0.747, Train_accy 80.10:  25%|██▌       | 5/20 [06:21<14:37, 58.48s/it]Task 4, Epoch 6/20 => Loss 0.747, Train_accy 80.10:  30%|███       | 6/20 [06:21<14:48, 63.50s/it]Task 4, Epoch 7/20 => Loss 0.694, Train_accy 81.07:  30%|███       | 6/20 [07:35<14:48, 63.50s/it]Task 4, Epoch 7/20 => Loss 0.694, Train_accy 81.07:  35%|███▌      | 7/20 [07:35<14:31, 67.06s/it]Task 4, Epoch 8/20 => Loss 0.699, Train_accy 80.98:  35%|███▌      | 7/20 [08:50<14:31, 67.06s/it]Task 4, Epoch 8/20 => Loss 0.699, Train_accy 80.98:  40%|████      | 8/20 [08:50<13:55, 69.60s/it]Task 4, Epoch 9/20 => Loss 0.685, Train_accy 81.26:  40%|████      | 8/20 [10:05<13:55, 69.60s/it]Task 4, Epoch 9/20 => Loss 0.685, Train_accy 81.26:  45%|████▌     | 9/20 [10:05<13:03, 71.23s/it]Task 4, Epoch 10/20 => Loss 0.649, Train_accy 81.83:  45%|████▌     | 9/20 [11:20<13:03, 71.23s/it]Task 4, Epoch 10/20 => Loss 0.649, Train_accy 81.83:  50%|█████     | 10/20 [11:20<12:03, 72.39s/it]Task 4, Epoch 11/20 => Loss 0.659, Train_accy 81.30:  50%|█████     | 10/20 [12:35<12:03, 72.39s/it]Task 4, Epoch 11/20 => Loss 0.659, Train_accy 81.30:  55%|█████▌    | 11/20 [12:35<10:58, 73.12s/it]Task 4, Epoch 12/20 => Loss 0.640, Train_accy 82.35:  55%|█████▌    | 11/20 [13:50<10:58, 73.12s/it]Task 4, Epoch 12/20 => Loss 0.640, Train_accy 82.35:  60%|██████    | 12/20 [13:50<09:49, 73.72s/it]Task 4, Epoch 13/20 => Loss 0.633, Train_accy 82.17:  60%|██████    | 12/20 [14:54<09:49, 73.72s/it]Task 4, Epoch 13/20 => Loss 0.633, Train_accy 82.17:  65%|██████▌   | 13/20 [14:54<08:14, 70.71s/it]Task 4, Epoch 14/20 => Loss 0.627, Train_accy 82.53:  65%|██████▌   | 13/20 [15:49<08:14, 70.71s/it]Task 4, Epoch 14/20 => Loss 0.627, Train_accy 82.53:  70%|███████   | 14/20 [15:49<06:36, 66.07s/it]Task 4, Epoch 15/20 => Loss 0.616, Train_accy 82.36:  70%|███████   | 14/20 [16:44<06:36, 66.07s/it]Task 4, Epoch 15/20 => Loss 0.616, Train_accy 82.36:  75%|███████▌  | 15/20 [16:44<05:13, 62.78s/it]Task 4, Epoch 16/20 => Loss 0.610, Train_accy 82.94:  75%|███████▌  | 15/20 [17:41<05:13, 62.78s/it]Task 4, Epoch 16/20 => Loss 0.610, Train_accy 82.94:  80%|████████  | 16/20 [17:41<04:03, 60.94s/it]Task 4, Epoch 17/20 => Loss 0.603, Train_accy 82.87:  80%|████████  | 16/20 [18:56<04:03, 60.94s/it]Task 4, Epoch 17/20 => Loss 0.603, Train_accy 82.87:  85%|████████▌ | 17/20 [18:56<03:15, 65.28s/it]Task 4, Epoch 18/20 => Loss 0.601, Train_accy 83.03:  85%|████████▌ | 17/20 [20:11<03:15, 65.28s/it]Task 4, Epoch 18/20 => Loss 0.601, Train_accy 83.03:  90%|█████████ | 18/20 [20:11<02:16, 68.14s/it]Task 4, Epoch 19/20 => Loss 0.597, Train_accy 83.38:  90%|█████████ | 18/20 [21:26<02:16, 68.14s/it]Task 4, Epoch 19/20 => Loss 0.597, Train_accy 83.38:  95%|█████████▌| 19/20 [21:26<01:10, 70.06s/it]Task 4, Epoch 20/20 => Loss 0.599, Train_accy 83.13:  95%|█████████▌| 19/20 [22:41<01:10, 70.06s/it]Task 4, Epoch 20/20 => Loss 0.599, Train_accy 83.13: 100%|██████████| 20/20 [22:41<00:00, 71.53s/it]Task 4, Epoch 20/20 => Loss 0.599, Train_accy 83.13: 100%|██████████| 20/20 [22:41<00:00, 68.06s/it]
2024-04-19 20:36:30,402 [loramoeinc.py] => Task 4, Epoch 20/20 => Loss 0.599, Train_accy 83.13
2024-04-19 20:39:27,105 [trainer.py] => No NME accuracy.
2024-04-19 20:39:27,105 [trainer.py] => CNN: {'total': 95.54, '00-19': 97.2, '20-39': 95.35, '40-59': 95.55, '60-79': 94.65, '80-99': 94.95, 'old': 95.69, 'new': 94.95}
2024-04-19 20:39:27,105 [trainer.py] => Route: {'total': 81.26, '00-19': 81.7, '20-39': 84.65, '40-59': 78.35, '60-79': 79.2, '80-99': 82.4, 'old': 80.97, 'new': 82.4}
2024-04-19 20:39:27,105 [trainer.py] => CNN top1 curve: [97.3, 96.55, 96.08, 95.7, 95.54]
2024-04-19 20:39:27,105 [trainer.py] => CNN top5 curve: [99.6, 99.48, 99.48, 99.52, 99.32]
2024-04-19 20:39:27,105 [trainer.py] => Route top1 curve: [92.2, 89.1, 85.43, 82.54, 81.26]
2024-04-19 20:39:27,105 [trainer.py] => Route top5 curve: [98.7, 97.92, 96.65, 95.8, 94.98]

Average Accuracy (CNN): 96.23400000000001
Average Accuracy (Route): 86.10600000000001
2024-04-19 20:39:27,105 [trainer.py] => Average Accuracy (CNN): 96.23400000000001
2024-04-19 20:39:27,105 [trainer.py] => Average Accuracy (Route): 86.10600000000001

2024-04-19 20:39:27,105 [trainer.py] => Train Time: 6801.3099999999995
2024-04-19 20:39:27,105 [trainer.py] => Test Time: 227.28 

