nohup: 忽略输入
2024-04-23 07:38:43,807 [trainer.py] => config: ./exps/loramoe_inc_cub_B0_Inc5.json
2024-04-23 07:38:43,808 [trainer.py] => prefix: reproduce
2024-04-23 07:38:43,808 [trainer.py] => dataset: cub
2024-04-23 07:38:43,808 [trainer.py] => memory_size: 0
2024-04-23 07:38:43,808 [trainer.py] => memory_per_class: 0
2024-04-23 07:38:43,808 [trainer.py] => fixed_memory: False
2024-04-23 07:38:43,808 [trainer.py] => shuffle: True
2024-04-23 07:38:43,808 [trainer.py] => init_cls: 40
2024-04-23 07:38:43,808 [trainer.py] => increment: 40
2024-04-23 07:38:43,808 [trainer.py] => model_name: loramoeinc
2024-04-23 07:38:43,808 [trainer.py] => backbone_type: pretrained_vit_b16_224_inc
2024-04-23 07:38:43,808 [trainer.py] => device: [device(type='cuda', index=2)]
2024-04-23 07:38:43,808 [trainer.py] => seed: 1993
2024-04-23 07:38:43,808 [trainer.py] => tuned_epoch: 20
2024-04-23 07:38:43,808 [trainer.py] => init_lr: 0.01
2024-04-23 07:38:43,808 [trainer.py] => batch_size: 48
2024-04-23 07:38:43,808 [trainer.py] => weight_decay: 0.0005
2024-04-23 07:38:43,808 [trainer.py] => min_lr: 0
2024-04-23 07:38:43,808 [trainer.py] => ffn_num: 4
2024-04-23 07:38:43,808 [trainer.py] => optimizer: sgd
2024-04-23 07:38:43,808 [trainer.py] => vpt_type: shallow
2024-04-23 07:38:43,808 [trainer.py] => prompt_token_num: 5
2024-04-23 07:38:43,808 [trainer.py] => expert_num: 5
2024-04-23 07:38:43,869 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
/home/team/zhaohongwei/anaconda3/envs/peft/lib/python3.10/site-packages/bitsandbytes/cuda_setup/main.py:136: UserWarning: /home/team/zhaohongwei/anaconda3/envs/peft did not contain libcudart.so as expected! Searching further paths...
  warn(msg)

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please submit your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
CUDA SETUP: CUDA runtime path found: /usr/local/cuda-11.8/lib64/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 8.6
CUDA SETUP: Detected CUDA version 118
CUDA SETUP: Loading binary /home/team/zhaohongwei/anaconda3/envs/peft/lib/python3.10/site-packages/bitsandbytes/libbitsandbytes_cuda118.so...
I'm using ViT with adapters.
2024-04-23 07:38:47,782 [trainer.py] => All params: 85867816
2024-04-23 07:38:47,783 [trainer.py] => Trainable params: 69160
2024-04-23 07:38:47,922 [loramoeinc.py] => Learning on 0-40
  0%|          | 0/20 [00:00<?, ?it/s]Task 0, Epoch 1/20 => Loss 3.660, Train_accy 12.37:   0%|          | 0/20 [00:11<?, ?it/s]Task 0, Epoch 1/20 => Loss 3.660, Train_accy 12.37:   5%|▌         | 1/20 [00:11<03:29, 11.04s/it]Task 0, Epoch 2/20 => Loss 3.530, Train_accy 60.13:   5%|▌         | 1/20 [00:21<03:29, 11.04s/it]Task 0, Epoch 2/20 => Loss 3.530, Train_accy 60.13:  10%|█         | 2/20 [00:21<03:16, 10.92s/it]Task 0, Epoch 3/20 => Loss 3.223, Train_accy 74.09:  10%|█         | 2/20 [00:32<03:16, 10.92s/it]Task 0, Epoch 3/20 => Loss 3.223, Train_accy 74.09:  15%|█▌        | 3/20 [00:32<03:05, 10.92s/it]Task 0, Epoch 4/20 => Loss 2.537, Train_accy 79.22:  15%|█▌        | 3/20 [00:43<03:05, 10.92s/it]Task 0, Epoch 4/20 => Loss 2.537, Train_accy 79.22:  20%|██        | 4/20 [00:43<02:53, 10.87s/it]Task 0, Epoch 5/20 => Loss 1.544, Train_accy 88.21:  20%|██        | 4/20 [00:54<02:53, 10.87s/it]Task 0, Epoch 5/20 => Loss 1.544, Train_accy 88.21:  25%|██▌       | 5/20 [00:54<02:42, 10.85s/it]Task 0, Epoch 6/20 => Loss 1.002, Train_accy 89.00:  25%|██▌       | 5/20 [01:05<02:42, 10.85s/it]Task 0, Epoch 6/20 => Loss 1.002, Train_accy 89.00:  30%|███       | 6/20 [01:05<02:31, 10.81s/it]Task 0, Epoch 7/20 => Loss 0.770, Train_accy 90.43:  30%|███       | 6/20 [01:15<02:31, 10.81s/it]Task 0, Epoch 7/20 => Loss 0.770, Train_accy 90.43:  35%|███▌      | 7/20 [01:15<02:20, 10.83s/it]Task 0, Epoch 8/20 => Loss 0.641, Train_accy 91.17:  35%|███▌      | 7/20 [01:26<02:20, 10.83s/it]Task 0, Epoch 8/20 => Loss 0.641, Train_accy 91.17:  40%|████      | 8/20 [01:26<02:09, 10.83s/it]Task 0, Epoch 9/20 => Loss 0.603, Train_accy 90.38:  40%|████      | 8/20 [01:37<02:09, 10.83s/it]Task 0, Epoch 9/20 => Loss 0.603, Train_accy 90.38:  45%|████▌     | 9/20 [01:37<01:59, 10.86s/it]Task 0, Epoch 10/20 => Loss 0.560, Train_accy 90.53:  45%|████▌     | 9/20 [01:48<01:59, 10.86s/it]Task 0, Epoch 10/20 => Loss 0.560, Train_accy 90.53:  50%|█████     | 10/20 [01:48<01:48, 10.89s/it]Task 0, Epoch 11/20 => Loss 0.526, Train_accy 90.85:  50%|█████     | 10/20 [01:59<01:48, 10.89s/it]Task 0, Epoch 11/20 => Loss 0.526, Train_accy 90.85:  55%|█████▌    | 11/20 [01:59<01:38, 10.91s/it]Task 0, Epoch 12/20 => Loss 0.488, Train_accy 92.28:  55%|█████▌    | 11/20 [02:10<01:38, 10.91s/it]Task 0, Epoch 12/20 => Loss 0.488, Train_accy 92.28:  60%|██████    | 12/20 [02:10<01:27, 10.89s/it]Task 0, Epoch 13/20 => Loss 0.487, Train_accy 91.54:  60%|██████    | 12/20 [02:21<01:27, 10.89s/it]Task 0, Epoch 13/20 => Loss 0.487, Train_accy 91.54:  65%|██████▌   | 13/20 [02:21<01:16, 10.90s/it]Task 0, Epoch 14/20 => Loss 0.465, Train_accy 91.80:  65%|██████▌   | 13/20 [02:32<01:16, 10.90s/it]Task 0, Epoch 14/20 => Loss 0.465, Train_accy 91.80:  70%|███████   | 14/20 [02:32<01:05, 10.91s/it]Task 0, Epoch 15/20 => Loss 0.445, Train_accy 91.96:  70%|███████   | 14/20 [02:43<01:05, 10.91s/it]Task 0, Epoch 15/20 => Loss 0.445, Train_accy 91.96:  75%|███████▌  | 15/20 [02:43<00:54, 10.90s/it]Task 0, Epoch 16/20 => Loss 0.447, Train_accy 92.65:  75%|███████▌  | 15/20 [02:54<00:54, 10.90s/it]Task 0, Epoch 16/20 => Loss 0.447, Train_accy 92.65:  80%|████████  | 16/20 [02:54<00:43, 10.91s/it]Task 0, Epoch 17/20 => Loss 0.481, Train_accy 91.59:  80%|████████  | 16/20 [03:05<00:43, 10.91s/it]Task 0, Epoch 17/20 => Loss 0.481, Train_accy 91.59:  85%|████████▌ | 17/20 [03:05<00:32, 10.90s/it]Task 0, Epoch 18/20 => Loss 0.439, Train_accy 92.54:  85%|████████▌ | 17/20 [03:15<00:32, 10.90s/it]Task 0, Epoch 18/20 => Loss 0.439, Train_accy 92.54:  90%|█████████ | 18/20 [03:15<00:21, 10.90s/it]Task 0, Epoch 19/20 => Loss 0.450, Train_accy 92.38:  90%|█████████ | 18/20 [03:26<00:21, 10.90s/it]Task 0, Epoch 19/20 => Loss 0.450, Train_accy 92.38:  95%|█████████▌| 19/20 [03:26<00:10, 10.92s/it]Task 0, Epoch 20/20 => Loss 0.441, Train_accy 91.70:  95%|█████████▌| 19/20 [03:37<00:10, 10.92s/it]Task 0, Epoch 20/20 => Loss 0.441, Train_accy 91.70: 100%|██████████| 20/20 [03:37<00:00, 10.91s/it]Task 0, Epoch 20/20 => Loss 0.441, Train_accy 91.70: 100%|██████████| 20/20 [03:37<00:00, 10.89s/it]
2024-04-23 07:42:25,797 [loramoeinc.py] => Task 0, Epoch 20/20 => Loss 0.441, Train_accy 91.70
2024-04-23 07:42:44,832 [trainer.py] => No NME accuracy.
2024-04-23 07:42:44,832 [trainer.py] => CNN: {'total': 96.26, '00-39': 96.26, 'old': 0, 'new': 96.26}
2024-04-23 07:42:44,832 [trainer.py] => Route: {'total': 97.8, '00-39': 97.8, 'old': 0, 'new': 97.8}
2024-04-23 07:42:44,832 [trainer.py] => CNN top1 curve: [96.26]
2024-04-23 07:42:44,832 [trainer.py] => CNN top5 curve: [99.56]
2024-04-23 07:42:44,832 [trainer.py] => Route top1 curve: [97.8]
2024-04-23 07:42:44,832 [trainer.py] => Route top5 curve: [99.78]

Average Accuracy (CNN): 96.26
Average Accuracy (Route): 97.8
2024-04-23 07:42:44,832 [trainer.py] => Average Accuracy (CNN): 96.26
2024-04-23 07:42:44,832 [trainer.py] => Average Accuracy (Route): 97.8

2024-04-23 07:42:44,832 [trainer.py] => Train Time: 217.81
2024-04-23 07:42:44,832 [trainer.py] => Test Time: 0 

2024-04-23 07:42:44,833 [trainer.py] => All params: 85929258
2024-04-23 07:42:44,834 [trainer.py] => Trainable params: 86049
2024-04-23 07:42:44,836 [loramoeinc.py] => Learning on 40-80
  0%|          | 0/20 [00:00<?, ?it/s]Task 1, Epoch 1/20 => Loss 3.267, Train_accy 37.53:   0%|          | 0/20 [00:11<?, ?it/s]Task 1, Epoch 1/20 => Loss 3.267, Train_accy 37.53:   5%|▌         | 1/20 [00:11<03:29, 11.01s/it]Task 1, Epoch 2/20 => Loss 2.164, Train_accy 47.59:   5%|▌         | 1/20 [00:22<03:29, 11.01s/it]Task 1, Epoch 2/20 => Loss 2.164, Train_accy 47.59:  10%|█         | 2/20 [00:22<03:18, 11.02s/it]Task 1, Epoch 3/20 => Loss 1.925, Train_accy 52.04:  10%|█         | 2/20 [00:33<03:18, 11.02s/it]Task 1, Epoch 3/20 => Loss 1.925, Train_accy 52.04:  15%|█▌        | 3/20 [00:33<03:07, 11.01s/it]Task 1, Epoch 4/20 => Loss 1.806, Train_accy 54.26:  15%|█▌        | 3/20 [00:44<03:07, 11.01s/it]Task 1, Epoch 4/20 => Loss 1.806, Train_accy 54.26:  20%|██        | 4/20 [00:44<02:56, 11.02s/it]Task 1, Epoch 5/20 => Loss 1.677, Train_accy 56.22:  20%|██        | 4/20 [00:55<02:56, 11.02s/it]Task 1, Epoch 5/20 => Loss 1.677, Train_accy 56.22:  25%|██▌       | 5/20 [00:55<02:45, 11.05s/it]Task 1, Epoch 6/20 => Loss 1.581, Train_accy 58.97:  25%|██▌       | 5/20 [01:06<02:45, 11.05s/it]Task 1, Epoch 6/20 => Loss 1.581, Train_accy 58.97:  30%|███       | 6/20 [01:06<02:34, 11.06s/it]Task 1, Epoch 7/20 => Loss 1.553, Train_accy 59.71:  30%|███       | 6/20 [01:17<02:34, 11.06s/it]Task 1, Epoch 7/20 => Loss 1.553, Train_accy 59.71:  35%|███▌      | 7/20 [01:17<02:24, 11.08s/it]Task 1, Epoch 8/20 => Loss 1.514, Train_accy 60.03:  35%|███▌      | 7/20 [01:28<02:24, 11.08s/it]Task 1, Epoch 8/20 => Loss 1.514, Train_accy 60.03:  40%|████      | 8/20 [01:28<02:13, 11.09s/it]Task 1, Epoch 9/20 => Loss 1.472, Train_accy 61.78:  40%|████      | 8/20 [01:39<02:13, 11.09s/it]Task 1, Epoch 9/20 => Loss 1.472, Train_accy 61.78:  45%|████▌     | 9/20 [01:39<02:01, 11.08s/it]Task 1, Epoch 10/20 => Loss 1.435, Train_accy 61.78:  45%|████▌     | 9/20 [01:50<02:01, 11.08s/it]Task 1, Epoch 10/20 => Loss 1.435, Train_accy 61.78:  50%|█████     | 10/20 [01:50<01:50, 11.05s/it]Task 1, Epoch 11/20 => Loss 1.469, Train_accy 60.61:  50%|█████     | 10/20 [02:01<01:50, 11.05s/it]Task 1, Epoch 11/20 => Loss 1.469, Train_accy 60.61:  55%|█████▌    | 11/20 [02:01<01:39, 11.05s/it]Task 1, Epoch 12/20 => Loss 1.401, Train_accy 62.26:  55%|█████▌    | 11/20 [02:12<01:39, 11.05s/it]Task 1, Epoch 12/20 => Loss 1.401, Train_accy 62.26:  60%|██████    | 12/20 [02:12<01:28, 11.03s/it]Task 1, Epoch 13/20 => Loss 1.417, Train_accy 62.20:  60%|██████    | 12/20 [02:23<01:28, 11.03s/it]Task 1, Epoch 13/20 => Loss 1.417, Train_accy 62.20:  65%|██████▌   | 13/20 [02:23<01:17, 11.03s/it]Task 1, Epoch 14/20 => Loss 1.403, Train_accy 62.41:  65%|██████▌   | 13/20 [02:34<01:17, 11.03s/it]Task 1, Epoch 14/20 => Loss 1.403, Train_accy 62.41:  70%|███████   | 14/20 [02:34<01:06, 11.01s/it]Task 1, Epoch 15/20 => Loss 1.380, Train_accy 62.68:  70%|███████   | 14/20 [02:45<01:06, 11.01s/it]Task 1, Epoch 15/20 => Loss 1.380, Train_accy 62.68:  75%|███████▌  | 15/20 [02:45<00:54, 10.98s/it]Task 1, Epoch 16/20 => Loss 1.395, Train_accy 61.62:  75%|███████▌  | 15/20 [02:56<00:54, 10.98s/it]Task 1, Epoch 16/20 => Loss 1.395, Train_accy 61.62:  80%|████████  | 16/20 [02:56<00:43, 10.97s/it]Task 1, Epoch 17/20 => Loss 1.442, Train_accy 61.67:  80%|████████  | 16/20 [03:07<00:43, 10.97s/it]Task 1, Epoch 17/20 => Loss 1.442, Train_accy 61.67:  85%|████████▌ | 17/20 [03:07<00:32, 10.97s/it]Task 1, Epoch 18/20 => Loss 1.375, Train_accy 62.52:  85%|████████▌ | 17/20 [03:18<00:32, 10.97s/it]Task 1, Epoch 18/20 => Loss 1.375, Train_accy 62.52:  90%|█████████ | 18/20 [03:18<00:21, 10.95s/it]Task 1, Epoch 19/20 => Loss 1.406, Train_accy 62.10:  90%|█████████ | 18/20 [03:29<00:21, 10.95s/it]Task 1, Epoch 19/20 => Loss 1.406, Train_accy 62.10:  95%|█████████▌| 19/20 [03:29<00:10, 10.95s/it]Task 1, Epoch 20/20 => Loss 1.391, Train_accy 62.89:  95%|█████████▌| 19/20 [03:40<00:10, 10.95s/it]Task 1, Epoch 20/20 => Loss 1.391, Train_accy 62.89: 100%|██████████| 20/20 [03:40<00:00, 10.95s/it]Task 1, Epoch 20/20 => Loss 1.391, Train_accy 62.89: 100%|██████████| 20/20 [03:40<00:00, 11.01s/it]
2024-04-23 07:46:25,057 [loramoeinc.py] => Task 1, Epoch 20/20 => Loss 1.391, Train_accy 62.89
2024-04-23 07:46:47,670 [trainer.py] => No NME accuracy.
2024-04-23 07:46:47,671 [trainer.py] => CNN: {'total': 94.56, '00-39': 96.26, '40-79': 92.9, 'old': 96.26, 'new': 92.9}
2024-04-23 07:46:47,671 [trainer.py] => Route: {'total': 93.25, '00-39': 93.83, '40-79': 92.69, 'old': 93.83, 'new': 92.69}
2024-04-23 07:46:47,671 [trainer.py] => CNN top1 curve: [96.26, 94.56]
2024-04-23 07:46:47,671 [trainer.py] => CNN top5 curve: [99.56, 99.46]
2024-04-23 07:46:47,671 [trainer.py] => Route top1 curve: [97.8, 93.25]
2024-04-23 07:46:47,671 [trainer.py] => Route top5 curve: [99.78, 99.02]

Average Accuracy (CNN): 95.41
Average Accuracy (Route): 95.525
2024-04-23 07:46:47,672 [trainer.py] => Average Accuracy (CNN): 95.41
2024-04-23 07:46:47,672 [trainer.py] => Average Accuracy (Route): 95.525

2024-04-23 07:46:47,672 [trainer.py] => Train Time: 438.02
2024-04-23 07:46:47,672 [trainer.py] => Test Time: 0 

2024-04-23 07:46:47,674 [trainer.py] => All params: 85990698
2024-04-23 07:46:47,676 [trainer.py] => Trainable params: 102937
2024-04-23 07:46:47,681 [loramoeinc.py] => Learning on 80-120
  0%|          | 0/20 [00:00<?, ?it/s]Task 2, Epoch 1/20 => Loss 3.570, Train_accy 31.67:   0%|          | 0/20 [00:10<?, ?it/s]Task 2, Epoch 1/20 => Loss 3.570, Train_accy 31.67:   5%|▌         | 1/20 [00:10<03:24, 10.77s/it]Task 2, Epoch 2/20 => Loss 2.213, Train_accy 44.59:   5%|▌         | 1/20 [00:21<03:24, 10.77s/it]Task 2, Epoch 2/20 => Loss 2.213, Train_accy 44.59:  10%|█         | 2/20 [00:21<03:14, 10.80s/it]Task 2, Epoch 3/20 => Loss 1.911, Train_accy 51.29:  10%|█         | 2/20 [00:32<03:14, 10.80s/it]Task 2, Epoch 3/20 => Loss 1.911, Train_accy 51.29:  15%|█▌        | 3/20 [00:32<03:03, 10.81s/it]Task 2, Epoch 4/20 => Loss 1.773, Train_accy 55.63:  15%|█▌        | 3/20 [00:43<03:03, 10.81s/it]Task 2, Epoch 4/20 => Loss 1.773, Train_accy 55.63:  20%|██        | 4/20 [00:43<02:53, 10.82s/it]Task 2, Epoch 5/20 => Loss 1.652, Train_accy 58.41:  20%|██        | 4/20 [00:54<02:53, 10.82s/it]Task 2, Epoch 5/20 => Loss 1.652, Train_accy 58.41:  25%|██▌       | 5/20 [00:54<02:43, 10.88s/it]Task 2, Epoch 6/20 => Loss 1.649, Train_accy 58.41:  25%|██▌       | 5/20 [01:05<02:43, 10.88s/it]Task 2, Epoch 6/20 => Loss 1.649, Train_accy 58.41:  30%|███       | 6/20 [01:05<02:33, 10.95s/it]Task 2, Epoch 7/20 => Loss 1.567, Train_accy 60.13:  30%|███       | 6/20 [01:16<02:33, 10.95s/it]Task 2, Epoch 7/20 => Loss 1.567, Train_accy 60.13:  35%|███▌      | 7/20 [01:16<02:22, 10.96s/it]Task 2, Epoch 8/20 => Loss 1.575, Train_accy 60.18:  35%|███▌      | 7/20 [01:27<02:22, 10.96s/it]Task 2, Epoch 8/20 => Loss 1.575, Train_accy 60.18:  40%|████      | 8/20 [01:27<02:11, 10.97s/it]Task 2, Epoch 9/20 => Loss 1.470, Train_accy 62.00:  40%|████      | 8/20 [01:38<02:11, 10.97s/it]Task 2, Epoch 9/20 => Loss 1.470, Train_accy 62.00:  45%|████▌     | 9/20 [01:38<02:00, 10.97s/it]Task 2, Epoch 10/20 => Loss 1.428, Train_accy 61.52:  45%|████▌     | 9/20 [01:49<02:00, 10.97s/it]Task 2, Epoch 10/20 => Loss 1.428, Train_accy 61.52:  50%|█████     | 10/20 [01:49<01:50, 11.02s/it]Task 2, Epoch 11/20 => Loss 1.453, Train_accy 61.47:  50%|█████     | 10/20 [02:00<01:50, 11.02s/it]Task 2, Epoch 11/20 => Loss 1.453, Train_accy 61.47:  55%|█████▌    | 11/20 [02:00<01:38, 10.99s/it]Task 2, Epoch 12/20 => Loss 1.433, Train_accy 62.22:  55%|█████▌    | 11/20 [02:11<01:38, 10.99s/it]Task 2, Epoch 12/20 => Loss 1.433, Train_accy 62.22:  60%|██████    | 12/20 [02:11<01:28, 11.00s/it]Task 2, Epoch 13/20 => Loss 1.388, Train_accy 62.22:  60%|██████    | 12/20 [02:22<01:28, 11.00s/it]Task 2, Epoch 13/20 => Loss 1.388, Train_accy 62.22:  65%|██████▌   | 13/20 [02:22<01:16, 10.99s/it]Task 2, Epoch 14/20 => Loss 1.396, Train_accy 62.17:  65%|██████▌   | 13/20 [02:33<01:16, 10.99s/it]Task 2, Epoch 14/20 => Loss 1.396, Train_accy 62.17:  70%|███████   | 14/20 [02:33<01:05, 10.99s/it]Task 2, Epoch 15/20 => Loss 1.376, Train_accy 62.65:  70%|███████   | 14/20 [02:44<01:05, 10.99s/it]Task 2, Epoch 15/20 => Loss 1.376, Train_accy 62.65:  75%|███████▌  | 15/20 [02:44<00:54, 10.97s/it]Task 2, Epoch 16/20 => Loss 1.366, Train_accy 62.75:  75%|███████▌  | 15/20 [02:55<00:54, 10.97s/it]Task 2, Epoch 16/20 => Loss 1.366, Train_accy 62.75:  80%|████████  | 16/20 [02:55<00:43, 10.93s/it]Task 2, Epoch 17/20 => Loss 1.367, Train_accy 62.92:  80%|████████  | 16/20 [03:05<00:43, 10.93s/it]Task 2, Epoch 17/20 => Loss 1.367, Train_accy 62.92:  85%|████████▌ | 17/20 [03:05<00:32, 10.92s/it]Task 2, Epoch 18/20 => Loss 1.350, Train_accy 62.38:  85%|████████▌ | 17/20 [03:16<00:32, 10.92s/it]Task 2, Epoch 18/20 => Loss 1.350, Train_accy 62.38:  90%|█████████ | 18/20 [03:16<00:21, 10.94s/it]Task 2, Epoch 19/20 => Loss 1.338, Train_accy 63.08:  90%|█████████ | 18/20 [03:27<00:21, 10.94s/it]Task 2, Epoch 19/20 => Loss 1.338, Train_accy 63.08:  95%|█████████▌| 19/20 [03:27<00:10, 10.92s/it]Task 2, Epoch 20/20 => Loss 1.340, Train_accy 62.59:  95%|█████████▌| 19/20 [03:38<00:10, 10.92s/it]Task 2, Epoch 20/20 => Loss 1.340, Train_accy 62.59: 100%|██████████| 20/20 [03:38<00:00, 10.92s/it]Task 2, Epoch 20/20 => Loss 1.340, Train_accy 62.59: 100%|██████████| 20/20 [03:38<00:00, 10.94s/it]
2024-04-23 07:50:26,433 [loramoeinc.py] => Task 2, Epoch 20/20 => Loss 1.340, Train_accy 62.59
2024-04-23 07:50:51,639 [trainer.py] => No NME accuracy.
2024-04-23 07:50:51,639 [trainer.py] => CNN: {'total': 94.35, '00-39': 96.26, '40-79': 92.04, '80-119': 94.77, 'old': 94.12, 'new': 94.77}
2024-04-23 07:50:51,639 [trainer.py] => Route: {'total': 90.18, '00-39': 91.85, '40-79': 89.68, '80-119': 89.13, 'old': 90.75, 'new': 89.13}
2024-04-23 07:50:51,639 [trainer.py] => CNN top1 curve: [96.26, 94.56, 94.35]
2024-04-23 07:50:51,640 [trainer.py] => CNN top5 curve: [99.56, 99.46, 99.15]
2024-04-23 07:50:51,640 [trainer.py] => Route top1 curve: [97.8, 93.25, 90.18]
2024-04-23 07:50:51,640 [trainer.py] => Route top5 curve: [99.78, 99.02, 98.87]

Average Accuracy (CNN): 95.05666666666666
Average Accuracy (Route): 93.74333333333334
2024-04-23 07:50:51,640 [trainer.py] => Average Accuracy (CNN): 95.05666666666666
2024-04-23 07:50:51,640 [trainer.py] => Average Accuracy (Route): 93.74333333333334

2024-04-23 07:50:51,640 [trainer.py] => Train Time: 656.76
2024-04-23 07:50:51,640 [trainer.py] => Test Time: 0 

2024-04-23 07:50:51,641 [trainer.py] => All params: 86052138
2024-04-23 07:50:51,642 [trainer.py] => Trainable params: 119825
2024-04-23 07:50:51,647 [loramoeinc.py] => Learning on 120-160
  0%|          | 0/20 [00:00<?, ?it/s]Task 3, Epoch 1/20 => Loss 3.903, Train_accy 28.07:   0%|          | 0/20 [00:10<?, ?it/s]Task 3, Epoch 1/20 => Loss 3.903, Train_accy 28.07:   5%|▌         | 1/20 [00:10<03:27, 10.95s/it]Task 3, Epoch 2/20 => Loss 2.549, Train_accy 40.02:   5%|▌         | 1/20 [00:21<03:27, 10.95s/it]Task 3, Epoch 2/20 => Loss 2.549, Train_accy 40.02:  10%|█         | 2/20 [00:21<03:16, 10.92s/it]Task 3, Epoch 3/20 => Loss 2.261, Train_accy 47.33:  10%|█         | 2/20 [00:32<03:16, 10.92s/it]Task 3, Epoch 3/20 => Loss 2.261, Train_accy 47.33:  15%|█▌        | 3/20 [00:32<03:06, 10.98s/it]Task 3, Epoch 4/20 => Loss 2.453, Train_accy 45.62:  15%|█▌        | 3/20 [00:43<03:06, 10.98s/it]Task 3, Epoch 4/20 => Loss 2.453, Train_accy 45.62:  20%|██        | 4/20 [00:43<02:55, 11.00s/it]Task 3, Epoch 5/20 => Loss 1.920, Train_accy 54.43:  20%|██        | 4/20 [00:54<02:55, 11.00s/it]Task 3, Epoch 5/20 => Loss 1.920, Train_accy 54.43:  25%|██▌       | 5/20 [00:54<02:44, 10.98s/it]Task 3, Epoch 6/20 => Loss 1.767, Train_accy 57.20:  25%|██▌       | 5/20 [01:05<02:44, 10.98s/it]Task 3, Epoch 6/20 => Loss 1.767, Train_accy 57.20:  30%|███       | 6/20 [01:05<02:34, 11.01s/it]Task 3, Epoch 7/20 => Loss 1.650, Train_accy 60.41:  30%|███       | 6/20 [01:17<02:34, 11.01s/it]Task 3, Epoch 7/20 => Loss 1.650, Train_accy 60.41:  35%|███▌      | 7/20 [01:17<02:23, 11.03s/it]Task 3, Epoch 8/20 => Loss 1.623, Train_accy 61.10:  35%|███▌      | 7/20 [01:27<02:23, 11.03s/it]Task 3, Epoch 8/20 => Loss 1.623, Train_accy 61.10:  40%|████      | 8/20 [01:27<02:12, 11.00s/it]Task 3, Epoch 9/20 => Loss 1.564, Train_accy 60.99:  40%|████      | 8/20 [01:38<02:12, 11.00s/it]Task 3, Epoch 9/20 => Loss 1.564, Train_accy 60.99:  45%|████▌     | 9/20 [01:38<02:00, 10.98s/it]Task 3, Epoch 10/20 => Loss 1.550, Train_accy 62.11:  45%|████▌     | 9/20 [01:49<02:00, 10.98s/it]Task 3, Epoch 10/20 => Loss 1.550, Train_accy 62.11:  50%|█████     | 10/20 [01:49<01:49, 10.99s/it]Task 3, Epoch 11/20 => Loss 1.521, Train_accy 62.49:  50%|█████     | 10/20 [02:00<01:49, 10.99s/it]Task 3, Epoch 11/20 => Loss 1.521, Train_accy 62.49:  55%|█████▌    | 11/20 [02:00<01:39, 11.01s/it]Task 3, Epoch 12/20 => Loss 1.510, Train_accy 62.11:  55%|█████▌    | 11/20 [02:11<01:39, 11.01s/it]Task 3, Epoch 12/20 => Loss 1.510, Train_accy 62.11:  60%|██████    | 12/20 [02:11<01:27, 10.98s/it]Task 3, Epoch 13/20 => Loss 1.505, Train_accy 61.69:  60%|██████    | 12/20 [02:23<01:27, 10.98s/it]Task 3, Epoch 13/20 => Loss 1.505, Train_accy 61.69:  65%|██████▌   | 13/20 [02:23<01:17, 11.04s/it]Task 3, Epoch 14/20 => Loss 1.455, Train_accy 64.14:  65%|██████▌   | 13/20 [02:33<01:17, 11.04s/it]Task 3, Epoch 14/20 => Loss 1.455, Train_accy 64.14:  70%|███████   | 14/20 [02:33<01:05, 11.00s/it]Task 3, Epoch 15/20 => Loss 1.406, Train_accy 62.97:  70%|███████   | 14/20 [02:44<01:05, 11.00s/it]Task 3, Epoch 15/20 => Loss 1.406, Train_accy 62.97:  75%|███████▌  | 15/20 [02:44<00:54, 10.97s/it]Task 3, Epoch 16/20 => Loss 1.421, Train_accy 64.46:  75%|███████▌  | 15/20 [02:55<00:54, 10.97s/it]Task 3, Epoch 16/20 => Loss 1.421, Train_accy 64.46:  80%|████████  | 16/20 [02:55<00:43, 10.97s/it]Task 3, Epoch 17/20 => Loss 1.428, Train_accy 63.66:  80%|████████  | 16/20 [03:06<00:43, 10.97s/it]Task 3, Epoch 17/20 => Loss 1.428, Train_accy 63.66:  85%|████████▌ | 17/20 [03:06<00:32, 10.95s/it]Task 3, Epoch 18/20 => Loss 1.439, Train_accy 63.18:  85%|████████▌ | 17/20 [03:17<00:32, 10.95s/it]Task 3, Epoch 18/20 => Loss 1.439, Train_accy 63.18:  90%|█████████ | 18/20 [03:17<00:21, 10.95s/it]Task 3, Epoch 19/20 => Loss 1.403, Train_accy 64.41:  90%|█████████ | 18/20 [03:28<00:21, 10.95s/it]Task 3, Epoch 19/20 => Loss 1.403, Train_accy 64.41:  95%|█████████▌| 19/20 [03:28<00:10, 11.00s/it]Task 3, Epoch 20/20 => Loss 1.423, Train_accy 64.09:  95%|█████████▌| 19/20 [03:39<00:10, 11.00s/it]Task 3, Epoch 20/20 => Loss 1.423, Train_accy 64.09: 100%|██████████| 20/20 [03:39<00:00, 10.98s/it]Task 3, Epoch 20/20 => Loss 1.423, Train_accy 64.09: 100%|██████████| 20/20 [03:39<00:00, 10.99s/it]
2024-04-23 07:54:31,383 [loramoeinc.py] => Task 3, Epoch 20/20 => Loss 1.423, Train_accy 64.09
2024-04-23 07:55:00,206 [trainer.py] => No NME accuracy.
2024-04-23 07:55:00,207 [trainer.py] => CNN: {'total': 93.5, '00-39': 96.26, '40-79': 92.04, '80-119': 94.77, '120-159': 90.95, 'old': 94.35, 'new': 90.95}
2024-04-23 07:55:00,207 [trainer.py] => Route: {'total': 88.47, '00-39': 89.65, '40-79': 88.39, '80-119': 87.93, '120-159': 88.0, 'old': 88.63, 'new': 88.0}
2024-04-23 07:55:00,207 [trainer.py] => CNN top1 curve: [96.26, 94.56, 94.35, 93.5]
2024-04-23 07:55:00,207 [trainer.py] => CNN top5 curve: [99.56, 99.46, 99.15, 98.73]
2024-04-23 07:55:00,207 [trainer.py] => Route top1 curve: [97.8, 93.25, 90.18, 88.47]
2024-04-23 07:55:00,207 [trainer.py] => Route top5 curve: [99.78, 99.02, 98.87, 98.68]

Average Accuracy (CNN): 94.66749999999999
Average Accuracy (Route): 92.42500000000001
2024-04-23 07:55:00,208 [trainer.py] => Average Accuracy (CNN): 94.66749999999999
2024-04-23 07:55:00,208 [trainer.py] => Average Accuracy (Route): 92.42500000000001

2024-04-23 07:55:00,208 [trainer.py] => Train Time: 876.48
2024-04-23 07:55:00,208 [trainer.py] => Test Time: 0 

2024-04-23 07:55:00,209 [trainer.py] => All params: 86113578
2024-04-23 07:55:00,211 [trainer.py] => Trainable params: 136713
2024-04-23 07:55:00,218 [loramoeinc.py] => Learning on 160-200
  0%|          | 0/20 [00:00<?, ?it/s]Task 4, Epoch 1/20 => Loss 4.716, Train_accy 20.79:   0%|          | 0/20 [00:11<?, ?it/s]Task 4, Epoch 1/20 => Loss 4.716, Train_accy 20.79:   5%|▌         | 1/20 [00:11<03:30, 11.09s/it]Task 4, Epoch 2/20 => Loss 3.069, Train_accy 30.26:   5%|▌         | 1/20 [00:22<03:30, 11.09s/it]Task 4, Epoch 2/20 => Loss 3.069, Train_accy 30.26:  10%|█         | 2/20 [00:22<03:21, 11.19s/it]Task 4, Epoch 3/20 => Loss 2.426, Train_accy 43.82:  10%|█         | 2/20 [00:33<03:21, 11.19s/it]Task 4, Epoch 3/20 => Loss 2.426, Train_accy 43.82:  15%|█▌        | 3/20 [00:33<03:09, 11.17s/it]Task 4, Epoch 4/20 => Loss 2.090, Train_accy 50.10:  15%|█▌        | 3/20 [00:44<03:09, 11.17s/it]Task 4, Epoch 4/20 => Loss 2.090, Train_accy 50.10:  20%|██        | 4/20 [00:44<02:58, 11.16s/it]Task 4, Epoch 5/20 => Loss 2.141, Train_accy 51.36:  20%|██        | 4/20 [00:55<02:58, 11.16s/it]Task 4, Epoch 5/20 => Loss 2.141, Train_accy 51.36:  25%|██▌       | 5/20 [00:55<02:47, 11.17s/it]Task 4, Epoch 6/20 => Loss 1.907, Train_accy 54.29:  25%|██▌       | 5/20 [01:07<02:47, 11.17s/it]Task 4, Epoch 6/20 => Loss 1.907, Train_accy 54.29:  30%|███       | 6/20 [01:07<02:36, 11.18s/it]Task 4, Epoch 7/20 => Loss 1.825, Train_accy 55.92:  30%|███       | 6/20 [01:18<02:36, 11.18s/it]Task 4, Epoch 7/20 => Loss 1.825, Train_accy 55.92:  35%|███▌      | 7/20 [01:18<02:25, 11.19s/it]Task 4, Epoch 8/20 => Loss 1.768, Train_accy 56.91:  35%|███▌      | 7/20 [01:29<02:25, 11.19s/it]Task 4, Epoch 8/20 => Loss 1.768, Train_accy 56.91:  40%|████      | 8/20 [01:29<02:13, 11.16s/it]Task 4, Epoch 9/20 => Loss 1.830, Train_accy 56.44:  40%|████      | 8/20 [01:40<02:13, 11.16s/it]Task 4, Epoch 9/20 => Loss 1.830, Train_accy 56.44:  45%|████▌     | 9/20 [01:40<02:02, 11.15s/it]Task 4, Epoch 10/20 => Loss 1.732, Train_accy 57.12:  45%|████▌     | 9/20 [01:51<02:02, 11.15s/it]Task 4, Epoch 10/20 => Loss 1.732, Train_accy 57.12:  50%|█████     | 10/20 [01:51<01:51, 11.20s/it]Task 4, Epoch 11/20 => Loss 1.677, Train_accy 58.22:  50%|█████     | 10/20 [02:03<01:51, 11.20s/it]Task 4, Epoch 11/20 => Loss 1.677, Train_accy 58.22:  55%|█████▌    | 11/20 [02:03<01:40, 11.21s/it]Task 4, Epoch 12/20 => Loss 1.658, Train_accy 58.01:  55%|█████▌    | 11/20 [02:14<01:40, 11.21s/it]Task 4, Epoch 12/20 => Loss 1.658, Train_accy 58.01:  60%|██████    | 12/20 [02:14<01:29, 11.20s/it]Task 4, Epoch 13/20 => Loss 1.624, Train_accy 58.80:  60%|██████    | 12/20 [02:25<01:29, 11.20s/it]Task 4, Epoch 13/20 => Loss 1.624, Train_accy 58.80:  65%|██████▌   | 13/20 [02:25<01:18, 11.19s/it]Task 4, Epoch 14/20 => Loss 1.678, Train_accy 57.02:  65%|██████▌   | 13/20 [02:36<01:18, 11.19s/it]Task 4, Epoch 14/20 => Loss 1.678, Train_accy 57.02:  70%|███████   | 14/20 [02:36<01:07, 11.20s/it]Task 4, Epoch 15/20 => Loss 1.636, Train_accy 58.64:  70%|███████   | 14/20 [02:47<01:07, 11.20s/it]Task 4, Epoch 15/20 => Loss 1.636, Train_accy 58.64:  75%|███████▌  | 15/20 [02:47<00:56, 11.21s/it]Task 4, Epoch 16/20 => Loss 1.646, Train_accy 58.27:  75%|███████▌  | 15/20 [02:59<00:56, 11.21s/it]Task 4, Epoch 16/20 => Loss 1.646, Train_accy 58.27:  80%|████████  | 16/20 [02:59<00:44, 11.21s/it]Task 4, Epoch 17/20 => Loss 1.596, Train_accy 58.95:  80%|████████  | 16/20 [03:10<00:44, 11.21s/it]Task 4, Epoch 17/20 => Loss 1.596, Train_accy 58.95:  85%|████████▌ | 17/20 [03:10<00:33, 11.22s/it]Task 4, Epoch 18/20 => Loss 1.640, Train_accy 57.75:  85%|████████▌ | 17/20 [03:21<00:33, 11.22s/it]Task 4, Epoch 18/20 => Loss 1.640, Train_accy 57.75:  90%|█████████ | 18/20 [03:21<00:22, 11.19s/it]Task 4, Epoch 19/20 => Loss 1.620, Train_accy 57.75:  90%|█████████ | 18/20 [03:32<00:22, 11.19s/it]Task 4, Epoch 19/20 => Loss 1.620, Train_accy 57.75:  95%|█████████▌| 19/20 [03:32<00:11, 11.19s/it]Task 4, Epoch 20/20 => Loss 1.579, Train_accy 58.32:  95%|█████████▌| 19/20 [03:43<00:11, 11.19s/it]Task 4, Epoch 20/20 => Loss 1.579, Train_accy 58.32: 100%|██████████| 20/20 [03:43<00:00, 11.17s/it]Task 4, Epoch 20/20 => Loss 1.579, Train_accy 58.32: 100%|██████████| 20/20 [03:43<00:00, 11.19s/it]
2024-04-23 07:58:43,944 [loramoeinc.py] => Task 4, Epoch 20/20 => Loss 1.579, Train_accy 58.32
2024-04-23 07:59:16,215 [trainer.py] => No NME accuracy.
2024-04-23 07:59:16,215 [trainer.py] => CNN: {'total': 92.32, '00-39': 96.26, '40-79': 92.04, '80-119': 94.77, '120-159': 90.95, '160-199': 87.58, 'old': 93.5, 'new': 87.58}
2024-04-23 07:59:16,216 [trainer.py] => Route: {'total': 86.77, '00-39': 88.33, '40-79': 86.02, '80-119': 87.93, '120-159': 86.11, '160-199': 85.44, 'old': 87.1, 'new': 85.44}
2024-04-23 07:59:16,216 [trainer.py] => CNN top1 curve: [96.26, 94.56, 94.35, 93.5, 92.32]
2024-04-23 07:59:16,216 [trainer.py] => CNN top5 curve: [99.56, 99.46, 99.15, 98.73, 97.75]
2024-04-23 07:59:16,216 [trainer.py] => Route top1 curve: [97.8, 93.25, 90.18, 88.47, 86.77]
2024-04-23 07:59:16,216 [trainer.py] => Route top5 curve: [99.78, 99.02, 98.87, 98.68, 98.18]

Average Accuracy (CNN): 94.198
Average Accuracy (Route): 91.29400000000001
2024-04-23 07:59:16,216 [trainer.py] => Average Accuracy (CNN): 94.198
2024-04-23 07:59:16,217 [trainer.py] => Average Accuracy (Route): 91.29400000000001

2024-04-23 07:59:16,217 [trainer.py] => Train Time: 1100.19
2024-04-23 07:59:16,217 [trainer.py] => Test Time: 0 

2024-04-23 07:59:19,336 [trainer.py] => config: ./exps/loramoe_inc_ina_B0_Inc5.json
2024-04-23 07:59:19,336 [trainer.py] => prefix: reproduce
2024-04-23 07:59:19,336 [trainer.py] => dataset: imageneta
2024-04-23 07:59:19,336 [trainer.py] => memory_size: 0
2024-04-23 07:59:19,336 [trainer.py] => memory_per_class: 0
2024-04-23 07:59:19,336 [trainer.py] => fixed_memory: False
2024-04-23 07:59:19,337 [trainer.py] => shuffle: True
2024-04-23 07:59:19,337 [trainer.py] => init_cls: 40
2024-04-23 07:59:19,337 [trainer.py] => increment: 40
2024-04-23 07:59:19,337 [trainer.py] => model_name: loramoeinc
2024-04-23 07:59:19,337 [trainer.py] => backbone_type: pretrained_vit_b16_224_inc
2024-04-23 07:59:19,337 [trainer.py] => device: [device(type='cuda', index=2)]
2024-04-23 07:59:19,337 [trainer.py] => seed: 1993
2024-04-23 07:59:19,337 [trainer.py] => tuned_epoch: 20
2024-04-23 07:59:19,337 [trainer.py] => init_lr: 0.01
2024-04-23 07:59:19,337 [trainer.py] => batch_size: 48
2024-04-23 07:59:19,337 [trainer.py] => weight_decay: 0.0005
2024-04-23 07:59:19,337 [trainer.py] => min_lr: 0
2024-04-23 07:59:19,337 [trainer.py] => ffn_num: 4
2024-04-23 07:59:19,337 [trainer.py] => optimizer: sgd
2024-04-23 07:59:19,337 [trainer.py] => vpt_type: shallow
2024-04-23 07:59:19,337 [trainer.py] => prompt_token_num: 5
2024-04-23 07:59:19,337 [trainer.py] => expert_num: 5
2024-04-23 07:59:19,364 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
/home/team/zhaohongwei/anaconda3/envs/peft/lib/python3.10/site-packages/bitsandbytes/cuda_setup/main.py:136: UserWarning: /home/team/zhaohongwei/anaconda3/envs/peft did not contain libcudart.so as expected! Searching further paths...
  warn(msg)

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please submit your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
CUDA SETUP: CUDA runtime path found: /usr/local/cuda-11.8/lib64/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 8.6
CUDA SETUP: Detected CUDA version 118
CUDA SETUP: Loading binary /home/team/zhaohongwei/anaconda3/envs/peft/lib/python3.10/site-packages/bitsandbytes/libbitsandbytes_cuda118.so...
I'm using ViT with adapters.
2024-04-23 07:59:23,530 [trainer.py] => All params: 85833236
2024-04-23 07:59:23,531 [trainer.py] => Trainable params: 34580
2024-04-23 07:59:23,672 [loramoeinc.py] => Learning on 0-40
  0%|          | 0/20 [00:00<?, ?it/s]Task 0, Epoch 1/20 => Loss 3.670, Train_accy 7.95:   0%|          | 0/20 [00:04<?, ?it/s]Task 0, Epoch 1/20 => Loss 3.670, Train_accy 7.95:   5%|▌         | 1/20 [00:04<01:34,  4.95s/it]Task 0, Epoch 2/20 => Loss 3.599, Train_accy 29.98:   5%|▌         | 1/20 [00:09<01:34,  4.95s/it]Task 0, Epoch 2/20 => Loss 3.599, Train_accy 29.98:  10%|█         | 2/20 [00:09<01:27,  4.84s/it]Task 0, Epoch 3/20 => Loss 3.483, Train_accy 41.60:  10%|█         | 2/20 [00:14<01:27,  4.84s/it]Task 0, Epoch 3/20 => Loss 3.483, Train_accy 41.60:  15%|█▌        | 3/20 [00:14<01:20,  4.75s/it]Task 0, Epoch 4/20 => Loss 3.288, Train_accy 47.59:  15%|█▌        | 3/20 [00:18<01:20,  4.75s/it]Task 0, Epoch 4/20 => Loss 3.288, Train_accy 47.59:  20%|██        | 4/20 [00:18<01:15,  4.70s/it]Task 0, Epoch 5/20 => Loss 3.013, Train_accy 51.46:  20%|██        | 4/20 [00:23<01:15,  4.70s/it]Task 0, Epoch 5/20 => Loss 3.013, Train_accy 51.46:  25%|██▌       | 5/20 [00:23<01:10,  4.73s/it]Task 0, Epoch 6/20 => Loss 2.704, Train_accy 55.13:  25%|██▌       | 5/20 [00:28<01:10,  4.73s/it]Task 0, Epoch 6/20 => Loss 2.704, Train_accy 55.13:  30%|███       | 6/20 [00:28<01:06,  4.75s/it]Task 0, Epoch 7/20 => Loss 2.418, Train_accy 58.40:  30%|███       | 6/20 [00:33<01:06,  4.75s/it]Task 0, Epoch 7/20 => Loss 2.418, Train_accy 58.40:  35%|███▌      | 7/20 [00:33<01:01,  4.71s/it]Task 0, Epoch 8/20 => Loss 2.166, Train_accy 62.00:  35%|███▌      | 7/20 [00:37<01:01,  4.71s/it]Task 0, Epoch 8/20 => Loss 2.166, Train_accy 62.00:  40%|████      | 8/20 [00:37<00:56,  4.71s/it]Task 0, Epoch 9/20 => Loss 2.001, Train_accy 61.73:  40%|████      | 8/20 [00:42<00:56,  4.71s/it]Task 0, Epoch 9/20 => Loss 2.001, Train_accy 61.73:  45%|████▌     | 9/20 [00:42<00:52,  4.74s/it]Task 0, Epoch 10/20 => Loss 1.868, Train_accy 63.63:  45%|████▌     | 9/20 [00:47<00:52,  4.74s/it]Task 0, Epoch 10/20 => Loss 1.868, Train_accy 63.63:  50%|█████     | 10/20 [00:47<00:47,  4.76s/it]Task 0, Epoch 11/20 => Loss 1.727, Train_accy 67.78:  50%|█████     | 10/20 [00:52<00:47,  4.76s/it]Task 0, Epoch 11/20 => Loss 1.727, Train_accy 67.78:  55%|█████▌    | 11/20 [00:52<00:42,  4.74s/it]Task 0, Epoch 12/20 => Loss 1.656, Train_accy 68.59:  55%|█████▌    | 11/20 [00:56<00:42,  4.74s/it]Task 0, Epoch 12/20 => Loss 1.656, Train_accy 68.59:  60%|██████    | 12/20 [00:56<00:37,  4.75s/it]Task 0, Epoch 13/20 => Loss 1.575, Train_accy 69.34:  60%|██████    | 12/20 [01:01<00:37,  4.75s/it]Task 0, Epoch 13/20 => Loss 1.575, Train_accy 69.34:  65%|██████▌   | 13/20 [01:01<00:33,  4.73s/it]Task 0, Epoch 14/20 => Loss 1.561, Train_accy 69.88:  65%|██████▌   | 13/20 [01:06<00:33,  4.73s/it]Task 0, Epoch 14/20 => Loss 1.561, Train_accy 69.88:  70%|███████   | 14/20 [01:06<00:28,  4.73s/it]Task 0, Epoch 15/20 => Loss 1.526, Train_accy 71.65:  70%|███████   | 14/20 [01:11<00:28,  4.73s/it]Task 0, Epoch 15/20 => Loss 1.526, Train_accy 71.65:  75%|███████▌  | 15/20 [01:11<00:23,  4.70s/it]Task 0, Epoch 16/20 => Loss 1.524, Train_accy 70.70:  75%|███████▌  | 15/20 [01:15<00:23,  4.70s/it]Task 0, Epoch 16/20 => Loss 1.524, Train_accy 70.70:  80%|████████  | 16/20 [01:15<00:18,  4.70s/it]Task 0, Epoch 17/20 => Loss 1.466, Train_accy 72.74:  80%|████████  | 16/20 [01:20<00:18,  4.70s/it]Task 0, Epoch 17/20 => Loss 1.466, Train_accy 72.74:  85%|████████▌ | 17/20 [01:20<00:14,  4.70s/it]Task 0, Epoch 18/20 => Loss 1.490, Train_accy 71.38:  85%|████████▌ | 17/20 [01:25<00:14,  4.70s/it]Task 0, Epoch 18/20 => Loss 1.490, Train_accy 71.38:  90%|█████████ | 18/20 [01:25<00:09,  4.72s/it]Task 0, Epoch 19/20 => Loss 1.461, Train_accy 73.35:  90%|█████████ | 18/20 [01:29<00:09,  4.72s/it]Task 0, Epoch 19/20 => Loss 1.461, Train_accy 73.35:  95%|█████████▌| 19/20 [01:29<00:04,  4.72s/it]Task 0, Epoch 20/20 => Loss 1.479, Train_accy 71.72:  95%|█████████▌| 19/20 [01:34<00:04,  4.72s/it]Task 0, Epoch 20/20 => Loss 1.479, Train_accy 71.72: 100%|██████████| 20/20 [01:34<00:00,  4.74s/it]Task 0, Epoch 20/20 => Loss 1.479, Train_accy 71.72: 100%|██████████| 20/20 [01:34<00:00,  4.73s/it]
2024-04-23 08:00:58,437 [loramoeinc.py] => Task 0, Epoch 20/20 => Loss 1.479, Train_accy 71.72
2024-04-23 08:01:14,966 [trainer.py] => No NME accuracy.
2024-04-23 08:01:14,966 [trainer.py] => CNN: {'total': 70.0, '00-39': 70.0, 'old': 0, 'new': 70.0}
2024-04-23 08:01:14,966 [trainer.py] => Route: {'total': 71.39, '00-39': 71.39, 'old': 0, 'new': 71.39}
2024-04-23 08:01:14,966 [trainer.py] => CNN top1 curve: [70.0]
2024-04-23 08:01:14,967 [trainer.py] => CNN top5 curve: [93.89]
2024-04-23 08:01:14,967 [trainer.py] => Route top1 curve: [71.39]
2024-04-23 08:01:14,967 [trainer.py] => Route top5 curve: [92.22]

Average Accuracy (CNN): 70.0
Average Accuracy (Route): 71.39
2024-04-23 08:01:14,967 [trainer.py] => Average Accuracy (CNN): 70.0
2024-04-23 08:01:14,967 [trainer.py] => Average Accuracy (Route): 71.39

2024-04-23 08:01:14,967 [trainer.py] => Train Time: 94.69
2024-04-23 08:01:14,967 [trainer.py] => Test Time: 0 

2024-04-23 08:01:14,968 [trainer.py] => All params: 85894678
2024-04-23 08:01:14,969 [trainer.py] => Trainable params: 58385
2024-04-23 08:01:14,973 [loramoeinc.py] => Learning on 40-80
  0%|          | 0/20 [00:00<?, ?it/s]Task 1, Epoch 1/20 => Loss 3.745, Train_accy 11.43:   0%|          | 0/20 [00:04<?, ?it/s]Task 1, Epoch 1/20 => Loss 3.745, Train_accy 11.43:   5%|▌         | 1/20 [00:04<01:20,  4.25s/it]Task 1, Epoch 2/20 => Loss 3.380, Train_accy 20.31:   5%|▌         | 1/20 [00:08<01:20,  4.25s/it]Task 1, Epoch 2/20 => Loss 3.380, Train_accy 20.31:  10%|█         | 2/20 [00:08<01:16,  4.23s/it]Task 1, Epoch 3/20 => Loss 3.129, Train_accy 28.88:  10%|█         | 2/20 [00:12<01:16,  4.23s/it]Task 1, Epoch 3/20 => Loss 3.129, Train_accy 28.88:  15%|█▌        | 3/20 [00:12<01:11,  4.23s/it]Task 1, Epoch 4/20 => Loss 2.988, Train_accy 34.75:  15%|█▌        | 3/20 [00:16<01:11,  4.23s/it]Task 1, Epoch 4/20 => Loss 2.988, Train_accy 34.75:  20%|██        | 4/20 [00:16<01:08,  4.25s/it]Task 1, Epoch 5/20 => Loss 2.834, Train_accy 36.76:  20%|██        | 4/20 [00:21<01:08,  4.25s/it]Task 1, Epoch 5/20 => Loss 2.834, Train_accy 36.76:  25%|██▌       | 5/20 [00:21<01:04,  4.27s/it]Task 1, Epoch 6/20 => Loss 2.686, Train_accy 40.85:  25%|██▌       | 5/20 [00:25<01:04,  4.27s/it]Task 1, Epoch 6/20 => Loss 2.686, Train_accy 40.85:  30%|███       | 6/20 [00:25<00:59,  4.24s/it]Task 1, Epoch 7/20 => Loss 2.593, Train_accy 38.61:  30%|███       | 6/20 [00:29<00:59,  4.24s/it]Task 1, Epoch 7/20 => Loss 2.593, Train_accy 38.61:  35%|███▌      | 7/20 [00:29<00:55,  4.26s/it]Task 1, Epoch 8/20 => Loss 2.468, Train_accy 42.93:  35%|███▌      | 7/20 [00:34<00:55,  4.26s/it]Task 1, Epoch 8/20 => Loss 2.468, Train_accy 42.93:  40%|████      | 8/20 [00:34<00:51,  4.26s/it]Task 1, Epoch 9/20 => Loss 2.414, Train_accy 44.17:  40%|████      | 8/20 [00:38<00:51,  4.26s/it]Task 1, Epoch 9/20 => Loss 2.414, Train_accy 44.17:  45%|████▌     | 9/20 [00:38<00:47,  4.28s/it]Task 1, Epoch 10/20 => Loss 2.348, Train_accy 45.87:  45%|████▌     | 9/20 [00:42<00:47,  4.28s/it]Task 1, Epoch 10/20 => Loss 2.348, Train_accy 45.87:  50%|█████     | 10/20 [00:42<00:42,  4.27s/it]Task 1, Epoch 11/20 => Loss 2.327, Train_accy 47.41:  50%|█████     | 10/20 [00:46<00:42,  4.27s/it]Task 1, Epoch 11/20 => Loss 2.327, Train_accy 47.41:  55%|█████▌    | 11/20 [00:46<00:38,  4.27s/it]Task 1, Epoch 12/20 => Loss 2.272, Train_accy 48.11:  55%|█████▌    | 11/20 [00:51<00:38,  4.27s/it]Task 1, Epoch 12/20 => Loss 2.272, Train_accy 48.11:  60%|██████    | 12/20 [00:51<00:34,  4.27s/it]Task 1, Epoch 13/20 => Loss 2.221, Train_accy 48.80:  60%|██████    | 12/20 [00:55<00:34,  4.27s/it]Task 1, Epoch 13/20 => Loss 2.221, Train_accy 48.80:  65%|██████▌   | 13/20 [00:55<00:29,  4.26s/it]Task 1, Epoch 14/20 => Loss 2.225, Train_accy 48.42:  65%|██████▌   | 13/20 [00:59<00:29,  4.26s/it]Task 1, Epoch 14/20 => Loss 2.225, Train_accy 48.42:  70%|███████   | 14/20 [00:59<00:25,  4.27s/it]Task 1, Epoch 15/20 => Loss 2.211, Train_accy 48.80:  70%|███████   | 14/20 [01:04<00:25,  4.27s/it]Task 1, Epoch 15/20 => Loss 2.211, Train_accy 48.80:  75%|███████▌  | 15/20 [01:04<00:21,  4.33s/it]Task 1, Epoch 16/20 => Loss 2.194, Train_accy 49.34:  75%|███████▌  | 15/20 [01:08<00:21,  4.33s/it]Task 1, Epoch 16/20 => Loss 2.194, Train_accy 49.34:  80%|████████  | 16/20 [01:08<00:17,  4.32s/it]Task 1, Epoch 17/20 => Loss 2.171, Train_accy 49.96:  80%|████████  | 16/20 [01:12<00:17,  4.32s/it]Task 1, Epoch 17/20 => Loss 2.171, Train_accy 49.96:  85%|████████▌ | 17/20 [01:12<00:12,  4.30s/it]Task 1, Epoch 18/20 => Loss 2.170, Train_accy 49.03:  85%|████████▌ | 17/20 [01:16<00:12,  4.30s/it]Task 1, Epoch 18/20 => Loss 2.170, Train_accy 49.03:  90%|█████████ | 18/20 [01:16<00:08,  4.29s/it]Task 1, Epoch 19/20 => Loss 2.173, Train_accy 49.27:  90%|█████████ | 18/20 [01:21<00:08,  4.29s/it]Task 1, Epoch 19/20 => Loss 2.173, Train_accy 49.27:  95%|█████████▌| 19/20 [01:21<00:04,  4.28s/it]Task 1, Epoch 20/20 => Loss 2.154, Train_accy 51.12:  95%|█████████▌| 19/20 [01:25<00:04,  4.28s/it]Task 1, Epoch 20/20 => Loss 2.154, Train_accy 51.12: 100%|██████████| 20/20 [01:25<00:00,  4.26s/it]Task 1, Epoch 20/20 => Loss 2.154, Train_accy 51.12: 100%|██████████| 20/20 [01:25<00:00,  4.27s/it]
2024-04-23 08:02:40,434 [loramoeinc.py] => Task 1, Epoch 20/20 => Loss 2.154, Train_accy 51.12
2024-04-23 08:02:59,332 [trainer.py] => No NME accuracy.
2024-04-23 08:02:59,333 [trainer.py] => CNN: {'total': 65.62, '00-39': 69.72, '40-79': 61.24, 'old': 69.72, 'new': 61.24}
2024-04-23 08:02:59,333 [trainer.py] => Route: {'total': 62.75, '00-39': 60.83, '40-79': 64.79, 'old': 60.83, 'new': 64.79}
2024-04-23 08:02:59,333 [trainer.py] => CNN top1 curve: [70.0, 65.62]
2024-04-23 08:02:59,333 [trainer.py] => CNN top5 curve: [93.89, 88.97]
2024-04-23 08:02:59,334 [trainer.py] => Route top1 curve: [71.39, 62.75]
2024-04-23 08:02:59,334 [trainer.py] => Route top5 curve: [92.22, 88.4]

Average Accuracy (CNN): 67.81
Average Accuracy (Route): 67.07
2024-04-23 08:02:59,334 [trainer.py] => Average Accuracy (CNN): 67.81
2024-04-23 08:02:59,334 [trainer.py] => Average Accuracy (Route): 67.07

2024-04-23 08:02:59,334 [trainer.py] => Train Time: 180.14
2024-04-23 08:02:59,334 [trainer.py] => Test Time: 0 

2024-04-23 08:02:59,335 [trainer.py] => All params: 85956118
2024-04-23 08:02:59,337 [trainer.py] => Trainable params: 82189
2024-04-23 08:02:59,342 [loramoeinc.py] => Learning on 80-120
  0%|          | 0/20 [00:00<?, ?it/s]Task 2, Epoch 1/20 => Loss 4.034, Train_accy 18.62:   0%|          | 0/20 [00:03<?, ?it/s]Task 2, Epoch 1/20 => Loss 4.034, Train_accy 18.62:   5%|▌         | 1/20 [00:03<01:07,  3.55s/it]Task 2, Epoch 2/20 => Loss 3.595, Train_accy 23.88:   5%|▌         | 1/20 [00:07<01:07,  3.55s/it]Task 2, Epoch 2/20 => Loss 3.595, Train_accy 23.88:  10%|█         | 2/20 [00:07<01:03,  3.56s/it]Task 2, Epoch 3/20 => Loss 3.192, Train_accy 30.47:  10%|█         | 2/20 [00:10<01:03,  3.56s/it]Task 2, Epoch 3/20 => Loss 3.192, Train_accy 30.47:  15%|█▌        | 3/20 [00:10<01:00,  3.57s/it]Task 2, Epoch 4/20 => Loss 2.915, Train_accy 40.11:  15%|█▌        | 3/20 [00:14<01:00,  3.57s/it]Task 2, Epoch 4/20 => Loss 2.915, Train_accy 40.11:  20%|██        | 4/20 [00:14<00:57,  3.57s/it]Task 2, Epoch 5/20 => Loss 2.764, Train_accy 42.50:  20%|██        | 4/20 [00:17<00:57,  3.57s/it]Task 2, Epoch 5/20 => Loss 2.764, Train_accy 42.50:  25%|██▌       | 5/20 [00:17<00:53,  3.58s/it]Task 2, Epoch 6/20 => Loss 2.612, Train_accy 43.84:  25%|██▌       | 5/20 [00:21<00:53,  3.58s/it]Task 2, Epoch 6/20 => Loss 2.612, Train_accy 43.84:  30%|███       | 6/20 [00:21<00:50,  3.60s/it]Task 2, Epoch 7/20 => Loss 2.474, Train_accy 46.32:  30%|███       | 6/20 [00:25<00:50,  3.60s/it]Task 2, Epoch 7/20 => Loss 2.474, Train_accy 46.32:  35%|███▌      | 7/20 [00:25<00:46,  3.58s/it]Task 2, Epoch 8/20 => Loss 2.363, Train_accy 47.66:  35%|███▌      | 7/20 [00:28<00:46,  3.58s/it]Task 2, Epoch 8/20 => Loss 2.363, Train_accy 47.66:  40%|████      | 8/20 [00:28<00:43,  3.63s/it]Task 2, Epoch 9/20 => Loss 2.295, Train_accy 47.95:  40%|████      | 8/20 [00:32<00:43,  3.63s/it]Task 2, Epoch 9/20 => Loss 2.295, Train_accy 47.95:  45%|████▌     | 9/20 [00:32<00:39,  3.61s/it]Task 2, Epoch 10/20 => Loss 2.272, Train_accy 46.42:  45%|████▌     | 9/20 [00:35<00:39,  3.61s/it]Task 2, Epoch 10/20 => Loss 2.272, Train_accy 46.42:  50%|█████     | 10/20 [00:35<00:35,  3.59s/it]Task 2, Epoch 11/20 => Loss 2.207, Train_accy 46.99:  50%|█████     | 10/20 [00:39<00:35,  3.59s/it]Task 2, Epoch 11/20 => Loss 2.207, Train_accy 46.99:  55%|█████▌    | 11/20 [00:39<00:32,  3.59s/it]Task 2, Epoch 12/20 => Loss 2.154, Train_accy 49.86:  55%|█████▌    | 11/20 [00:43<00:32,  3.59s/it]Task 2, Epoch 12/20 => Loss 2.154, Train_accy 49.86:  60%|██████    | 12/20 [00:43<00:28,  3.58s/it]Task 2, Epoch 13/20 => Loss 2.113, Train_accy 50.91:  60%|██████    | 12/20 [00:46<00:28,  3.58s/it]Task 2, Epoch 13/20 => Loss 2.113, Train_accy 50.91:  65%|██████▌   | 13/20 [00:46<00:25,  3.59s/it]Task 2, Epoch 14/20 => Loss 2.113, Train_accy 49.28:  65%|██████▌   | 13/20 [00:50<00:25,  3.59s/it]Task 2, Epoch 14/20 => Loss 2.113, Train_accy 49.28:  70%|███████   | 14/20 [00:50<00:21,  3.57s/it]Task 2, Epoch 15/20 => Loss 2.112, Train_accy 51.10:  70%|███████   | 14/20 [00:53<00:21,  3.57s/it]Task 2, Epoch 15/20 => Loss 2.112, Train_accy 51.10:  75%|███████▌  | 15/20 [00:53<00:17,  3.59s/it]Task 2, Epoch 16/20 => Loss 2.100, Train_accy 51.29:  75%|███████▌  | 15/20 [00:57<00:17,  3.59s/it]Task 2, Epoch 16/20 => Loss 2.100, Train_accy 51.29:  80%|████████  | 16/20 [00:57<00:14,  3.59s/it]Task 2, Epoch 17/20 => Loss 2.099, Train_accy 50.81:  80%|████████  | 16/20 [01:01<00:14,  3.59s/it]Task 2, Epoch 17/20 => Loss 2.099, Train_accy 50.81:  85%|████████▌ | 17/20 [01:01<00:10,  3.62s/it]Task 2, Epoch 18/20 => Loss 2.089, Train_accy 49.67:  85%|████████▌ | 17/20 [01:04<00:10,  3.62s/it]Task 2, Epoch 18/20 => Loss 2.089, Train_accy 49.67:  90%|█████████ | 18/20 [01:04<00:07,  3.59s/it]Task 2, Epoch 19/20 => Loss 2.045, Train_accy 51.77:  90%|█████████ | 18/20 [01:08<00:07,  3.59s/it]Task 2, Epoch 19/20 => Loss 2.045, Train_accy 51.77:  95%|█████████▌| 19/20 [01:08<00:03,  3.61s/it]Task 2, Epoch 20/20 => Loss 2.051, Train_accy 52.34:  95%|█████████▌| 19/20 [01:11<00:03,  3.61s/it]Task 2, Epoch 20/20 => Loss 2.051, Train_accy 52.34: 100%|██████████| 20/20 [01:11<00:00,  3.61s/it]Task 2, Epoch 20/20 => Loss 2.051, Train_accy 52.34: 100%|██████████| 20/20 [01:11<00:00,  3.59s/it]
2024-04-23 08:04:11,243 [loramoeinc.py] => Task 2, Epoch 20/20 => Loss 2.051, Train_accy 52.34
2024-04-23 08:04:29,059 [trainer.py] => No NME accuracy.
2024-04-23 08:04:29,060 [trainer.py] => CNN: {'total': 63.08, '00-39': 68.89, '40-79': 61.24, '80-119': 57.76, 'old': 65.19, 'new': 57.76}
2024-04-23 08:04:29,060 [trainer.py] => Route: {'total': 56.92, '00-39': 53.06, '40-79': 58.88, '80-119': 59.57, 'old': 55.87, 'new': 59.57}
2024-04-23 08:04:29,061 [trainer.py] => CNN top1 curve: [70.0, 65.62, 63.08]
2024-04-23 08:04:29,061 [trainer.py] => CNN top5 curve: [93.89, 88.97, 84.92]
2024-04-23 08:04:29,061 [trainer.py] => Route top1 curve: [71.39, 62.75, 56.92]
2024-04-23 08:04:29,061 [trainer.py] => Route top5 curve: [92.22, 88.4, 84.41]

Average Accuracy (CNN): 66.23333333333333
Average Accuracy (Route): 63.68666666666667
2024-04-23 08:04:29,061 [trainer.py] => Average Accuracy (CNN): 66.23333333333333
2024-04-23 08:04:29,061 [trainer.py] => Average Accuracy (Route): 63.68666666666667

2024-04-23 08:04:29,061 [trainer.py] => Train Time: 252.02999999999997
2024-04-23 08:04:29,061 [trainer.py] => Test Time: 0 

2024-04-23 08:04:29,063 [trainer.py] => All params: 86017558
2024-04-23 08:04:29,064 [trainer.py] => Trainable params: 105993
2024-04-23 08:04:29,070 [loramoeinc.py] => Learning on 120-160
  0%|          | 0/20 [00:00<?, ?it/s]Task 3, Epoch 1/20 => Loss 4.689, Train_accy 16.73:   0%|          | 0/20 [00:03<?, ?it/s]Task 3, Epoch 1/20 => Loss 4.689, Train_accy 16.73:   5%|▌         | 1/20 [00:03<01:08,  3.62s/it]Task 3, Epoch 2/20 => Loss 3.784, Train_accy 16.54:   5%|▌         | 1/20 [00:07<01:08,  3.62s/it]Task 3, Epoch 2/20 => Loss 3.784, Train_accy 16.54:  10%|█         | 2/20 [00:07<01:06,  3.67s/it]Task 3, Epoch 3/20 => Loss 3.300, Train_accy 27.10:  10%|█         | 2/20 [00:10<01:06,  3.67s/it]Task 3, Epoch 3/20 => Loss 3.300, Train_accy 27.10:  15%|█▌        | 3/20 [00:10<01:02,  3.66s/it]Task 3, Epoch 4/20 => Loss 3.027, Train_accy 36.73:  15%|█▌        | 3/20 [00:14<01:02,  3.66s/it]Task 3, Epoch 4/20 => Loss 3.027, Train_accy 36.73:  20%|██        | 4/20 [00:14<00:58,  3.67s/it]Task 3, Epoch 5/20 => Loss 2.829, Train_accy 38.69:  20%|██        | 4/20 [00:18<00:58,  3.67s/it]Task 3, Epoch 5/20 => Loss 2.829, Train_accy 38.69:  25%|██▌       | 5/20 [00:18<00:55,  3.67s/it]Task 3, Epoch 6/20 => Loss 2.730, Train_accy 40.37:  25%|██▌       | 5/20 [00:22<00:55,  3.67s/it]Task 3, Epoch 6/20 => Loss 2.730, Train_accy 40.37:  30%|███       | 6/20 [00:22<00:51,  3.69s/it]Task 3, Epoch 7/20 => Loss 2.623, Train_accy 41.87:  30%|███       | 6/20 [00:25<00:51,  3.69s/it]Task 3, Epoch 7/20 => Loss 2.623, Train_accy 41.87:  35%|███▌      | 7/20 [00:25<00:48,  3.70s/it]Task 3, Epoch 8/20 => Loss 2.548, Train_accy 44.02:  35%|███▌      | 7/20 [00:29<00:48,  3.70s/it]Task 3, Epoch 8/20 => Loss 2.548, Train_accy 44.02:  40%|████      | 8/20 [00:29<00:44,  3.71s/it]Task 3, Epoch 9/20 => Loss 2.456, Train_accy 44.21:  40%|████      | 8/20 [00:36<00:44,  3.71s/it]Task 3, Epoch 9/20 => Loss 2.456, Train_accy 44.21:  45%|████▌     | 9/20 [00:36<00:51,  4.68s/it]Task 3, Epoch 10/20 => Loss 2.407, Train_accy 46.26:  45%|████▌     | 9/20 [00:43<00:51,  4.68s/it]Task 3, Epoch 10/20 => Loss 2.407, Train_accy 46.26:  50%|█████     | 10/20 [00:43<00:53,  5.33s/it]Task 3, Epoch 11/20 => Loss 2.354, Train_accy 45.14:  50%|█████     | 10/20 [00:50<00:53,  5.33s/it]Task 3, Epoch 11/20 => Loss 2.354, Train_accy 45.14:  55%|█████▌    | 11/20 [00:50<00:52,  5.83s/it]Task 3, Epoch 12/20 => Loss 2.304, Train_accy 46.54:  55%|█████▌    | 11/20 [00:56<00:52,  5.83s/it]Task 3, Epoch 12/20 => Loss 2.304, Train_accy 46.54:  60%|██████    | 12/20 [00:56<00:48,  6.12s/it]Task 3, Epoch 13/20 => Loss 2.342, Train_accy 45.98:  60%|██████    | 12/20 [01:03<00:48,  6.12s/it]Task 3, Epoch 13/20 => Loss 2.342, Train_accy 45.98:  65%|██████▌   | 13/20 [01:03<00:44,  6.37s/it]Task 3, Epoch 14/20 => Loss 2.339, Train_accy 46.36:  65%|██████▌   | 13/20 [01:10<00:44,  6.37s/it]Task 3, Epoch 14/20 => Loss 2.339, Train_accy 46.36:  70%|███████   | 14/20 [01:10<00:39,  6.53s/it]Task 3, Epoch 15/20 => Loss 2.285, Train_accy 46.17:  70%|███████   | 14/20 [01:17<00:39,  6.53s/it]Task 3, Epoch 15/20 => Loss 2.285, Train_accy 46.17:  75%|███████▌  | 15/20 [01:17<00:32,  6.51s/it]Task 3, Epoch 16/20 => Loss 2.280, Train_accy 45.98:  75%|███████▌  | 15/20 [01:24<00:32,  6.51s/it]Task 3, Epoch 16/20 => Loss 2.280, Train_accy 45.98:  80%|████████  | 16/20 [01:24<00:26,  6.64s/it]Task 3, Epoch 17/20 => Loss 2.259, Train_accy 47.10:  80%|████████  | 16/20 [01:31<00:26,  6.64s/it]Task 3, Epoch 17/20 => Loss 2.259, Train_accy 47.10:  85%|████████▌ | 17/20 [01:31<00:20,  6.75s/it]Task 3, Epoch 18/20 => Loss 2.271, Train_accy 47.76:  85%|████████▌ | 17/20 [01:37<00:20,  6.75s/it]Task 3, Epoch 18/20 => Loss 2.271, Train_accy 47.76:  90%|█████████ | 18/20 [01:37<00:13,  6.66s/it]Task 3, Epoch 19/20 => Loss 2.246, Train_accy 46.26:  90%|█████████ | 18/20 [01:44<00:13,  6.66s/it]Task 3, Epoch 19/20 => Loss 2.246, Train_accy 46.26:  95%|█████████▌| 19/20 [01:44<00:06,  6.79s/it]Task 3, Epoch 20/20 => Loss 2.255, Train_accy 47.20:  95%|█████████▌| 19/20 [01:51<00:06,  6.79s/it]Task 3, Epoch 20/20 => Loss 2.255, Train_accy 47.20: 100%|██████████| 20/20 [01:51<00:00,  6.88s/it]Task 3, Epoch 20/20 => Loss 2.255, Train_accy 47.20: 100%|██████████| 20/20 [01:51<00:00,  5.59s/it]
2024-04-23 08:06:20,839 [loramoeinc.py] => Task 3, Epoch 20/20 => Loss 2.255, Train_accy 47.20
2024-04-23 08:06:54,840 [trainer.py] => No NME accuracy.
2024-04-23 08:06:54,840 [trainer.py] => CNN: {'total': 60.26, '00-39': 68.61, '40-79': 61.24, '80-119': 57.76, '120-159': 50.55, 'old': 62.97, 'new': 50.55}
2024-04-23 08:06:54,840 [trainer.py] => Route: {'total': 52.0, '00-39': 50.28, '40-79': 53.55, '80-119': 57.76, '120-159': 46.52, 'old': 53.54, 'new': 46.52}
2024-04-23 08:06:54,841 [trainer.py] => CNN top1 curve: [70.0, 65.62, 63.08, 60.26]
2024-04-23 08:06:54,841 [trainer.py] => CNN top5 curve: [93.89, 88.97, 84.92, 82.37]
2024-04-23 08:06:54,841 [trainer.py] => Route top1 curve: [71.39, 62.75, 56.92, 52.0]
2024-04-23 08:06:54,841 [trainer.py] => Route top5 curve: [92.22, 88.4, 84.41, 80.13]

Average Accuracy (CNN): 64.74
Average Accuracy (Route): 60.765
2024-04-23 08:06:54,841 [trainer.py] => Average Accuracy (CNN): 64.74
2024-04-23 08:06:54,841 [trainer.py] => Average Accuracy (Route): 60.765

2024-04-23 08:06:54,841 [trainer.py] => Train Time: 363.78999999999996
2024-04-23 08:06:54,841 [trainer.py] => Test Time: 0 

2024-04-23 08:06:54,842 [trainer.py] => All params: 86078998
2024-04-23 08:06:54,842 [trainer.py] => Trainable params: 129797
2024-04-23 08:06:54,852 [loramoeinc.py] => Learning on 160-200
  0%|          | 0/20 [00:00<?, ?it/s]Task 4, Epoch 1/20 => Loss 5.048, Train_accy 11.29:   0%|          | 0/20 [00:06<?, ?it/s]Task 4, Epoch 1/20 => Loss 5.048, Train_accy 11.29:   5%|▌         | 1/20 [00:06<02:04,  6.56s/it]Task 4, Epoch 2/20 => Loss 3.986, Train_accy 17.30:   5%|▌         | 1/20 [00:13<02:04,  6.56s/it]Task 4, Epoch 2/20 => Loss 3.986, Train_accy 17.30:  10%|█         | 2/20 [00:13<02:04,  6.91s/it]Task 4, Epoch 3/20 => Loss 3.499, Train_accy 26.05:  10%|█         | 2/20 [00:20<02:04,  6.91s/it]Task 4, Epoch 3/20 => Loss 3.499, Train_accy 26.05:  15%|█▌        | 3/20 [00:20<01:59,  7.01s/it]Task 4, Epoch 4/20 => Loss 3.272, Train_accy 28.87:  15%|█▌        | 3/20 [00:27<01:59,  7.01s/it]Task 4, Epoch 4/20 => Loss 3.272, Train_accy 28.87:  20%|██        | 4/20 [00:27<01:49,  6.85s/it]Task 4, Epoch 5/20 => Loss 3.016, Train_accy 31.97:  20%|██        | 4/20 [00:34<01:49,  6.85s/it]Task 4, Epoch 5/20 => Loss 3.016, Train_accy 31.97:  25%|██▌       | 5/20 [00:34<01:43,  6.93s/it]Task 4, Epoch 6/20 => Loss 2.924, Train_accy 32.70:  25%|██▌       | 5/20 [00:41<01:43,  6.93s/it]Task 4, Epoch 6/20 => Loss 2.924, Train_accy 32.70:  30%|███       | 6/20 [00:41<01:37,  6.96s/it]Task 4, Epoch 7/20 => Loss 2.845, Train_accy 34.70:  30%|███       | 6/20 [00:48<01:37,  6.96s/it]Task 4, Epoch 7/20 => Loss 2.845, Train_accy 34.70:  35%|███▌      | 7/20 [00:48<01:30,  6.93s/it]Task 4, Epoch 8/20 => Loss 2.735, Train_accy 36.16:  35%|███▌      | 7/20 [00:52<01:30,  6.93s/it]Task 4, Epoch 8/20 => Loss 2.735, Train_accy 36.16:  40%|████      | 8/20 [00:52<01:11,  5.92s/it]Task 4, Epoch 9/20 => Loss 2.665, Train_accy 36.79:  40%|████      | 8/20 [00:55<01:11,  5.92s/it]Task 4, Epoch 9/20 => Loss 2.665, Train_accy 36.79:  45%|████▌     | 9/20 [00:55<00:57,  5.26s/it]Task 4, Epoch 10/20 => Loss 2.620, Train_accy 39.34:  45%|████▌     | 9/20 [01:02<00:57,  5.26s/it]Task 4, Epoch 10/20 => Loss 2.620, Train_accy 39.34:  50%|█████     | 10/20 [01:02<00:57,  5.79s/it]Task 4, Epoch 11/20 => Loss 2.506, Train_accy 40.80:  50%|█████     | 10/20 [01:09<00:57,  5.79s/it]Task 4, Epoch 11/20 => Loss 2.506, Train_accy 40.80:  55%|█████▌    | 11/20 [01:09<00:53,  5.95s/it]Task 4, Epoch 12/20 => Loss 2.540, Train_accy 39.80:  55%|█████▌    | 11/20 [01:12<00:53,  5.95s/it]Task 4, Epoch 12/20 => Loss 2.540, Train_accy 39.80:  60%|██████    | 12/20 [01:12<00:42,  5.28s/it]Task 4, Epoch 13/20 => Loss 2.477, Train_accy 39.89:  60%|██████    | 12/20 [01:17<00:42,  5.28s/it]Task 4, Epoch 13/20 => Loss 2.477, Train_accy 39.89:  65%|██████▌   | 13/20 [01:17<00:35,  5.10s/it]Task 4, Epoch 14/20 => Loss 2.440, Train_accy 40.53:  65%|██████▌   | 13/20 [01:24<00:35,  5.10s/it]Task 4, Epoch 14/20 => Loss 2.440, Train_accy 40.53:  70%|███████   | 14/20 [01:24<00:32,  5.50s/it]Task 4, Epoch 15/20 => Loss 2.469, Train_accy 40.98:  70%|███████   | 14/20 [01:28<00:32,  5.50s/it]Task 4, Epoch 15/20 => Loss 2.469, Train_accy 40.98:  75%|███████▌  | 15/20 [01:28<00:26,  5.24s/it]Task 4, Epoch 16/20 => Loss 2.416, Train_accy 41.62:  75%|███████▌  | 15/20 [01:32<00:26,  5.24s/it]Task 4, Epoch 16/20 => Loss 2.416, Train_accy 41.62:  80%|████████  | 16/20 [01:32<00:19,  4.79s/it]Task 4, Epoch 17/20 => Loss 2.418, Train_accy 41.62:  80%|████████  | 16/20 [01:36<00:19,  4.79s/it]Task 4, Epoch 17/20 => Loss 2.418, Train_accy 41.62:  85%|████████▌ | 17/20 [01:36<00:13,  4.46s/it]Task 4, Epoch 18/20 => Loss 2.381, Train_accy 40.98:  85%|████████▌ | 17/20 [01:39<00:13,  4.46s/it]Task 4, Epoch 18/20 => Loss 2.381, Train_accy 40.98:  90%|█████████ | 18/20 [01:39<00:08,  4.25s/it]Task 4, Epoch 19/20 => Loss 2.373, Train_accy 40.62:  90%|█████████ | 18/20 [01:43<00:08,  4.25s/it]Task 4, Epoch 19/20 => Loss 2.373, Train_accy 40.62:  95%|█████████▌| 19/20 [01:43<00:04,  4.10s/it]Task 4, Epoch 20/20 => Loss 2.363, Train_accy 41.89:  95%|█████████▌| 19/20 [01:47<00:04,  4.10s/it]Task 4, Epoch 20/20 => Loss 2.363, Train_accy 41.89: 100%|██████████| 20/20 [01:47<00:00,  3.99s/it]Task 4, Epoch 20/20 => Loss 2.363, Train_accy 41.89: 100%|██████████| 20/20 [01:47<00:00,  5.37s/it]
2024-04-23 08:08:42,297 [loramoeinc.py] => Task 4, Epoch 20/20 => Loss 2.363, Train_accy 41.89
2024-04-23 08:09:04,439 [trainer.py] => No NME accuracy.
2024-04-23 08:09:04,440 [trainer.py] => CNN: {'total': 58.53, '00-39': 68.61, '40-79': 61.24, '80-119': 57.76, '120-159': 50.55, '160-199': 50.55, 'old': 60.26, 'new': 50.55}
2024-04-23 08:09:04,440 [trainer.py] => Route: {'total': 48.45, '00-39': 47.78, '40-79': 51.78, '80-119': 55.23, '120-159': 43.96, '160-199': 42.8, 'old': 49.68, 'new': 42.8}
2024-04-23 08:09:04,440 [trainer.py] => CNN top1 curve: [70.0, 65.62, 63.08, 60.26, 58.53]
2024-04-23 08:09:04,440 [trainer.py] => CNN top5 curve: [93.89, 88.97, 84.92, 82.37, 81.7]
2024-04-23 08:09:04,440 [trainer.py] => Route top1 curve: [71.39, 62.75, 56.92, 52.0, 48.45]
2024-04-23 08:09:04,440 [trainer.py] => Route top5 curve: [92.22, 88.4, 84.41, 80.13, 75.64]

Average Accuracy (CNN): 63.498000000000005
Average Accuracy (Route): 58.302
2024-04-23 08:09:04,440 [trainer.py] => Average Accuracy (CNN): 63.498000000000005
2024-04-23 08:09:04,440 [trainer.py] => Average Accuracy (Route): 58.302

2024-04-23 08:09:04,441 [trainer.py] => Train Time: 471.21999999999997
2024-04-23 08:09:04,441 [trainer.py] => Test Time: 0 

2024-04-23 08:09:07,339 [trainer.py] => config: ./exps/loramoe_inc_vtab_B0_Inc5.json
2024-04-23 08:09:07,339 [trainer.py] => prefix: reproduce
2024-04-23 08:09:07,339 [trainer.py] => dataset: vtab
2024-04-23 08:09:07,339 [trainer.py] => memory_size: 0
2024-04-23 08:09:07,339 [trainer.py] => memory_per_class: 0
2024-04-23 08:09:07,339 [trainer.py] => fixed_memory: False
2024-04-23 08:09:07,339 [trainer.py] => shuffle: True
2024-04-23 08:09:07,339 [trainer.py] => init_cls: 10
2024-04-23 08:09:07,339 [trainer.py] => increment: 10
2024-04-23 08:09:07,339 [trainer.py] => model_name: loramoeinc
2024-04-23 08:09:07,339 [trainer.py] => backbone_type: pretrained_vit_b16_224_inc
2024-04-23 08:09:07,339 [trainer.py] => device: [device(type='cuda', index=2)]
2024-04-23 08:09:07,339 [trainer.py] => seed: 1993
2024-04-23 08:09:07,339 [trainer.py] => tuned_epoch: 20
2024-04-23 08:09:07,339 [trainer.py] => init_lr: 0.01
2024-04-23 08:09:07,339 [trainer.py] => batch_size: 48
2024-04-23 08:09:07,339 [trainer.py] => weight_decay: 0.0005
2024-04-23 08:09:07,339 [trainer.py] => min_lr: 0
2024-04-23 08:09:07,339 [trainer.py] => ffn_num: 4
2024-04-23 08:09:07,339 [trainer.py] => optimizer: sgd
2024-04-23 08:09:07,339 [trainer.py] => vpt_type: shallow
2024-04-23 08:09:07,339 [trainer.py] => prompt_token_num: 5
2024-04-23 08:09:07,340 [trainer.py] => expert_num: 5
{'10': 0, '11': 1, '12': 2, '13': 3, '14': 4, '15': 5, '16': 6, '17': 7, '18': 8, '19': 9, '20': 10, '21': 11, '22': 12, '23': 13, '24': 14, '25': 15, '26': 16, '27': 17, '28': 18, '29': 19, '30': 20, '31': 21, '32': 22, '33': 23, '34': 24, '35': 25, '36': 26, '37': 27, '38': 28, '39': 29, '40': 30, '41': 31, '42': 32, '43': 33, '44': 34, '45': 35, '46': 36, '47': 37, '48': 38, '49': 39, '50': 40, '51': 41, '52': 42, '53': 43, '54': 44, '55': 45, '56': 46, '57': 47, '58': 48, '59': 49}
{'10': 0, '11': 1, '12': 2, '13': 3, '14': 4, '15': 5, '16': 6, '17': 7, '18': 8, '19': 9, '20': 10, '21': 11, '22': 12, '23': 13, '24': 14, '25': 15, '26': 16, '27': 17, '28': 18, '29': 19, '30': 20, '31': 21, '32': 22, '33': 23, '34': 24, '35': 25, '36': 26, '37': 27, '38': 28, '39': 29, '40': 30, '41': 31, '42': 32, '43': 33, '44': 34, '45': 35, '46': 36, '47': 37, '48': 38, '49': 39, '50': 40, '51': 41, '52': 42, '53': 43, '54': 44, '55': 45, '56': 46, '57': 47, '58': 48, '59': 49}
2024-04-23 08:09:07,367 [data_manager.py] => [43, 41, 23, 14, 13, 40, 42, 22, 16, 45, 17, 10, 27, 46, 35, 8, 2, 34, 1, 37, 21, 0, 18, 36, 38, 24, 12, 6, 15, 20, 25, 48, 30, 19, 44, 26, 7, 28, 11, 5, 32, 4, 9, 47, 39, 31, 3, 29, 49, 33]
/home/team/zhaohongwei/anaconda3/envs/peft/lib/python3.10/site-packages/bitsandbytes/cuda_setup/main.py:136: UserWarning: /home/team/zhaohongwei/anaconda3/envs/peft did not contain libcudart.so as expected! Searching further paths...
  warn(msg)

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please submit your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
CUDA SETUP: CUDA runtime path found: /usr/local/cuda-11.8/lib64/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 8.6
CUDA SETUP: Detected CUDA version 118
CUDA SETUP: Loading binary /home/team/zhaohongwei/anaconda3/envs/peft/lib/python3.10/site-packages/bitsandbytes/libbitsandbytes_cuda118.so...
I'm using ViT with adapters.
2024-04-23 08:09:10,983 [trainer.py] => All params: 85833236
2024-04-23 08:09:10,984 [trainer.py] => Trainable params: 34580
2024-04-23 08:09:11,177 [loramoeinc.py] => Learning on 0-10
  0%|          | 0/20 [00:00<?, ?it/s]Task 0, Epoch 1/20 => Loss 2.311, Train_accy 7.45:   0%|          | 0/20 [00:01<?, ?it/s]Task 0, Epoch 1/20 => Loss 2.311, Train_accy 7.45:   5%|▌         | 1/20 [00:01<00:23,  1.22s/it]Task 0, Epoch 2/20 => Loss 2.296, Train_accy 13.66:   5%|▌         | 1/20 [00:02<00:23,  1.22s/it]Task 0, Epoch 2/20 => Loss 2.296, Train_accy 13.66:  10%|█         | 2/20 [00:02<00:18,  1.02s/it]Task 0, Epoch 3/20 => Loss 2.264, Train_accy 40.37:  10%|█         | 2/20 [00:03<00:18,  1.02s/it]Task 0, Epoch 3/20 => Loss 2.264, Train_accy 40.37:  15%|█▌        | 3/20 [00:03<00:16,  1.01it/s]Task 0, Epoch 4/20 => Loss 2.228, Train_accy 58.39:  15%|█▌        | 3/20 [00:03<00:16,  1.01it/s]Task 0, Epoch 4/20 => Loss 2.228, Train_accy 58.39:  20%|██        | 4/20 [00:03<00:14,  1.08it/s]Task 0, Epoch 5/20 => Loss 2.184, Train_accy 70.19:  20%|██        | 4/20 [00:04<00:14,  1.08it/s]Task 0, Epoch 5/20 => Loss 2.184, Train_accy 70.19:  25%|██▌       | 5/20 [00:04<00:13,  1.11it/s]Task 0, Epoch 6/20 => Loss 2.143, Train_accy 79.50:  25%|██▌       | 5/20 [00:05<00:13,  1.11it/s]Task 0, Epoch 6/20 => Loss 2.143, Train_accy 79.50:  30%|███       | 6/20 [00:05<00:12,  1.11it/s]Task 0, Epoch 7/20 => Loss 2.099, Train_accy 85.09:  30%|███       | 6/20 [00:06<00:12,  1.11it/s]Task 0, Epoch 7/20 => Loss 2.099, Train_accy 85.09:  35%|███▌      | 7/20 [00:06<00:11,  1.15it/s]Task 0, Epoch 8/20 => Loss 2.066, Train_accy 83.85:  35%|███▌      | 7/20 [00:07<00:11,  1.15it/s]Task 0, Epoch 8/20 => Loss 2.066, Train_accy 83.85:  40%|████      | 8/20 [00:07<00:10,  1.17it/s]Task 0, Epoch 9/20 => Loss 2.028, Train_accy 83.23:  40%|████      | 8/20 [00:08<00:10,  1.17it/s]Task 0, Epoch 9/20 => Loss 2.028, Train_accy 83.23:  45%|████▌     | 9/20 [00:08<00:09,  1.17it/s]Task 0, Epoch 10/20 => Loss 1.970, Train_accy 86.34:  45%|████▌     | 9/20 [00:08<00:09,  1.17it/s]Task 0, Epoch 10/20 => Loss 1.970, Train_accy 86.34:  50%|█████     | 10/20 [00:08<00:08,  1.18it/s]Task 0, Epoch 11/20 => Loss 1.946, Train_accy 88.20:  50%|█████     | 10/20 [00:09<00:08,  1.18it/s]Task 0, Epoch 11/20 => Loss 1.946, Train_accy 88.20:  55%|█████▌    | 11/20 [00:09<00:07,  1.19it/s]Task 0, Epoch 12/20 => Loss 1.916, Train_accy 89.44:  55%|█████▌    | 11/20 [00:10<00:07,  1.19it/s]Task 0, Epoch 12/20 => Loss 1.916, Train_accy 89.44:  60%|██████    | 12/20 [00:10<00:06,  1.17it/s]Task 0, Epoch 13/20 => Loss 1.884, Train_accy 89.44:  60%|██████    | 12/20 [00:11<00:06,  1.17it/s]Task 0, Epoch 13/20 => Loss 1.884, Train_accy 89.44:  65%|██████▌   | 13/20 [00:11<00:05,  1.18it/s]Task 0, Epoch 14/20 => Loss 1.849, Train_accy 89.44:  65%|██████▌   | 13/20 [00:12<00:05,  1.18it/s]Task 0, Epoch 14/20 => Loss 1.849, Train_accy 89.44:  70%|███████   | 14/20 [00:12<00:05,  1.11it/s]Task 0, Epoch 15/20 => Loss 1.851, Train_accy 91.93:  70%|███████   | 14/20 [00:13<00:05,  1.11it/s]Task 0, Epoch 15/20 => Loss 1.851, Train_accy 91.93:  75%|███████▌  | 15/20 [00:13<00:04,  1.12it/s]Task 0, Epoch 16/20 => Loss 1.843, Train_accy 88.82:  75%|███████▌  | 15/20 [00:14<00:04,  1.12it/s]Task 0, Epoch 16/20 => Loss 1.843, Train_accy 88.82:  80%|████████  | 16/20 [00:14<00:03,  1.13it/s]Task 0, Epoch 17/20 => Loss 1.809, Train_accy 88.82:  80%|████████  | 16/20 [00:15<00:03,  1.13it/s]Task 0, Epoch 17/20 => Loss 1.809, Train_accy 88.82:  85%|████████▌ | 17/20 [00:15<00:02,  1.10it/s]Task 0, Epoch 18/20 => Loss 1.808, Train_accy 91.30:  85%|████████▌ | 17/20 [00:16<00:02,  1.10it/s]Task 0, Epoch 18/20 => Loss 1.808, Train_accy 91.30:  90%|█████████ | 18/20 [00:16<00:01,  1.13it/s]Task 0, Epoch 19/20 => Loss 1.809, Train_accy 90.68:  90%|█████████ | 18/20 [00:16<00:01,  1.13it/s]Task 0, Epoch 19/20 => Loss 1.809, Train_accy 90.68:  95%|█████████▌| 19/20 [00:16<00:00,  1.14it/s]Task 0, Epoch 20/20 => Loss 1.805, Train_accy 90.68:  95%|█████████▌| 19/20 [00:17<00:00,  1.14it/s]Task 0, Epoch 20/20 => Loss 1.805, Train_accy 90.68: 100%|██████████| 20/20 [00:17<00:00,  1.18it/s]Task 0, Epoch 20/20 => Loss 1.805, Train_accy 90.68: 100%|██████████| 20/20 [00:17<00:00,  1.13it/s]
2024-04-23 08:09:28,966 [loramoeinc.py] => Task 0, Epoch 20/20 => Loss 1.805, Train_accy 90.68
2024-04-23 08:09:42,019 [trainer.py] => No NME accuracy.
2024-04-23 08:09:42,020 [trainer.py] => CNN: {'total': 99.27, '00-09': 99.27, 'old': 0, 'new': 99.27}
2024-04-23 08:09:42,020 [trainer.py] => Route: {'total': 98.79, '00-09': 98.79, 'old': 0, 'new': 98.79}
2024-04-23 08:09:42,020 [trainer.py] => CNN top1 curve: [99.27]
2024-04-23 08:09:42,020 [trainer.py] => CNN top5 curve: [99.88]
2024-04-23 08:09:42,020 [trainer.py] => Route top1 curve: [98.79]
2024-04-23 08:09:42,020 [trainer.py] => Route top5 curve: [99.64]

Average Accuracy (CNN): 99.27
Average Accuracy (Route): 98.79
2024-04-23 08:09:42,020 [trainer.py] => Average Accuracy (CNN): 99.27
2024-04-23 08:09:42,020 [trainer.py] => Average Accuracy (Route): 98.79

2024-04-23 08:09:42,020 [trainer.py] => Train Time: 17.71
2024-04-23 08:09:42,020 [trainer.py] => Test Time: 0 

2024-04-23 08:09:42,021 [trainer.py] => All params: 85848598
2024-04-23 08:09:42,021 [trainer.py] => Trainable params: 35345
2024-04-23 08:09:42,023 [loramoeinc.py] => Learning on 10-20
  0%|          | 0/20 [00:00<?, ?it/s]Task 1, Epoch 1/20 => Loss 2.413, Train_accy 57.49:   0%|          | 0/20 [00:01<?, ?it/s]Task 1, Epoch 1/20 => Loss 2.413, Train_accy 57.49:   5%|▌         | 1/20 [00:01<00:30,  1.63s/it]Task 1, Epoch 2/20 => Loss 2.219, Train_accy 69.57:   5%|▌         | 1/20 [00:03<00:30,  1.63s/it]Task 1, Epoch 2/20 => Loss 2.219, Train_accy 69.57:  10%|█         | 2/20 [00:03<00:29,  1.63s/it]Task 1, Epoch 3/20 => Loss 2.142, Train_accy 68.12:  10%|█         | 2/20 [00:04<00:29,  1.63s/it]Task 1, Epoch 3/20 => Loss 2.142, Train_accy 68.12:  15%|█▌        | 3/20 [00:04<00:28,  1.65s/it]Task 1, Epoch 4/20 => Loss 2.018, Train_accy 71.01:  15%|█▌        | 3/20 [00:06<00:28,  1.65s/it]Task 1, Epoch 4/20 => Loss 2.018, Train_accy 71.01:  20%|██        | 4/20 [00:06<00:26,  1.64s/it]Task 1, Epoch 5/20 => Loss 1.933, Train_accy 69.81:  20%|██        | 4/20 [00:08<00:26,  1.64s/it]Task 1, Epoch 5/20 => Loss 1.933, Train_accy 69.81:  25%|██▌       | 5/20 [00:08<00:24,  1.62s/it]Task 1, Epoch 6/20 => Loss 1.818, Train_accy 70.53:  25%|██▌       | 5/20 [00:09<00:24,  1.62s/it]Task 1, Epoch 6/20 => Loss 1.818, Train_accy 70.53:  30%|███       | 6/20 [00:09<00:22,  1.62s/it]Task 1, Epoch 7/20 => Loss 1.680, Train_accy 72.46:  30%|███       | 6/20 [00:11<00:22,  1.62s/it]Task 1, Epoch 7/20 => Loss 1.680, Train_accy 72.46:  35%|███▌      | 7/20 [00:11<00:21,  1.63s/it]Task 1, Epoch 8/20 => Loss 1.527, Train_accy 77.54:  35%|███▌      | 7/20 [00:12<00:21,  1.63s/it]Task 1, Epoch 8/20 => Loss 1.527, Train_accy 77.54:  40%|████      | 8/20 [00:12<00:19,  1.61s/it]Task 1, Epoch 9/20 => Loss 1.415, Train_accy 77.54:  40%|████      | 8/20 [00:14<00:19,  1.61s/it]Task 1, Epoch 9/20 => Loss 1.415, Train_accy 77.54:  45%|████▌     | 9/20 [00:14<00:17,  1.62s/it]Task 1, Epoch 10/20 => Loss 1.319, Train_accy 79.47:  45%|████▌     | 9/20 [00:16<00:17,  1.62s/it]Task 1, Epoch 10/20 => Loss 1.319, Train_accy 79.47:  50%|█████     | 10/20 [00:16<00:16,  1.63s/it]Task 1, Epoch 11/20 => Loss 1.249, Train_accy 77.78:  50%|█████     | 10/20 [00:17<00:16,  1.63s/it]Task 1, Epoch 11/20 => Loss 1.249, Train_accy 77.78:  55%|█████▌    | 11/20 [00:17<00:14,  1.61s/it]Task 1, Epoch 12/20 => Loss 1.194, Train_accy 81.88:  55%|█████▌    | 11/20 [00:19<00:14,  1.61s/it]Task 1, Epoch 12/20 => Loss 1.194, Train_accy 81.88:  60%|██████    | 12/20 [00:19<00:12,  1.61s/it]Task 1, Epoch 13/20 => Loss 1.157, Train_accy 83.82:  60%|██████    | 12/20 [00:20<00:12,  1.61s/it]Task 1, Epoch 13/20 => Loss 1.157, Train_accy 83.82:  65%|██████▌   | 13/20 [00:20<00:11,  1.59s/it]Task 1, Epoch 14/20 => Loss 1.126, Train_accy 84.30:  65%|██████▌   | 13/20 [00:22<00:11,  1.59s/it]Task 1, Epoch 14/20 => Loss 1.126, Train_accy 84.30:  70%|███████   | 14/20 [00:22<00:09,  1.64s/it]Task 1, Epoch 15/20 => Loss 1.108, Train_accy 80.92:  70%|███████   | 14/20 [00:24<00:09,  1.64s/it]Task 1, Epoch 15/20 => Loss 1.108, Train_accy 80.92:  75%|███████▌  | 15/20 [00:24<00:08,  1.66s/it]Task 1, Epoch 16/20 => Loss 1.087, Train_accy 82.37:  75%|███████▌  | 15/20 [00:26<00:08,  1.66s/it]Task 1, Epoch 16/20 => Loss 1.087, Train_accy 82.37:  80%|████████  | 16/20 [00:26<00:06,  1.65s/it]Task 1, Epoch 17/20 => Loss 1.129, Train_accy 80.92:  80%|████████  | 16/20 [00:27<00:06,  1.65s/it]Task 1, Epoch 17/20 => Loss 1.129, Train_accy 80.92:  85%|████████▌ | 17/20 [00:27<00:04,  1.64s/it]Task 1, Epoch 18/20 => Loss 1.085, Train_accy 82.37:  85%|████████▌ | 17/20 [00:29<00:04,  1.64s/it]Task 1, Epoch 18/20 => Loss 1.085, Train_accy 82.37:  90%|█████████ | 18/20 [00:29<00:03,  1.62s/it]Task 1, Epoch 19/20 => Loss 1.069, Train_accy 81.64:  90%|█████████ | 18/20 [00:30<00:03,  1.62s/it]Task 1, Epoch 19/20 => Loss 1.069, Train_accy 81.64:  95%|█████████▌| 19/20 [00:30<00:01,  1.60s/it]Task 1, Epoch 20/20 => Loss 1.083, Train_accy 82.85:  95%|█████████▌| 19/20 [00:32<00:01,  1.60s/it]Task 1, Epoch 20/20 => Loss 1.083, Train_accy 82.85: 100%|██████████| 20/20 [00:32<00:00,  1.62s/it]Task 1, Epoch 20/20 => Loss 1.083, Train_accy 82.85: 100%|██████████| 20/20 [00:32<00:00,  1.62s/it]
2024-04-23 08:10:14,511 [loramoeinc.py] => Task 1, Epoch 20/20 => Loss 1.083, Train_accy 82.85
2024-04-23 08:10:38,851 [trainer.py] => No NME accuracy.
2024-04-23 08:10:38,851 [trainer.py] => CNN: {'total': 94.84, '00-09': 98.18, '10-19': 93.47, 'old': 98.18, 'new': 93.47}
2024-04-23 08:10:38,851 [trainer.py] => Route: {'total': 94.49, '00-09': 98.18, '10-19': 92.97, 'old': 98.18, 'new': 92.97}
2024-04-23 08:10:38,851 [trainer.py] => CNN top1 curve: [99.27, 94.84]
2024-04-23 08:10:38,851 [trainer.py] => CNN top5 curve: [99.88, 99.96]
2024-04-23 08:10:38,851 [trainer.py] => Route top1 curve: [98.79, 94.49]
2024-04-23 08:10:38,851 [trainer.py] => Route top5 curve: [99.64, 99.61]

Average Accuracy (CNN): 97.055
Average Accuracy (Route): 96.64
2024-04-23 08:10:38,851 [trainer.py] => Average Accuracy (CNN): 97.055
2024-04-23 08:10:38,851 [trainer.py] => Average Accuracy (Route): 96.64

2024-04-23 08:10:38,851 [trainer.py] => Train Time: 50.19
2024-04-23 08:10:38,851 [trainer.py] => Test Time: 0 

2024-04-23 08:10:38,852 [trainer.py] => All params: 85863958
2024-04-23 08:10:38,853 [trainer.py] => Trainable params: 36109
2024-04-23 08:10:38,855 [loramoeinc.py] => Learning on 20-30
  0%|          | 0/20 [00:00<?, ?it/s]Task 2, Epoch 1/20 => Loss 1.924, Train_accy 67.40:   0%|          | 0/20 [00:01<?, ?it/s]Task 2, Epoch 1/20 => Loss 1.924, Train_accy 67.40:   5%|▌         | 1/20 [00:01<00:29,  1.56s/it]Task 2, Epoch 2/20 => Loss 1.581, Train_accy 79.73:   5%|▌         | 1/20 [00:03<00:29,  1.56s/it]Task 2, Epoch 2/20 => Loss 1.581, Train_accy 79.73:  10%|█         | 2/20 [00:03<00:27,  1.54s/it]Task 2, Epoch 3/20 => Loss 1.534, Train_accy 78.08:  10%|█         | 2/20 [00:04<00:27,  1.54s/it]Task 2, Epoch 3/20 => Loss 1.534, Train_accy 78.08:  15%|█▌        | 3/20 [00:04<00:26,  1.56s/it]Task 2, Epoch 4/20 => Loss 1.485, Train_accy 81.10:  15%|█▌        | 3/20 [00:06<00:26,  1.56s/it]Task 2, Epoch 4/20 => Loss 1.485, Train_accy 81.10:  20%|██        | 4/20 [00:06<00:24,  1.55s/it]Task 2, Epoch 5/20 => Loss 1.412, Train_accy 78.90:  20%|██        | 4/20 [00:07<00:24,  1.55s/it]Task 2, Epoch 5/20 => Loss 1.412, Train_accy 78.90:  25%|██▌       | 5/20 [00:07<00:23,  1.58s/it]Task 2, Epoch 6/20 => Loss 1.348, Train_accy 81.10:  25%|██▌       | 5/20 [00:09<00:23,  1.58s/it]Task 2, Epoch 6/20 => Loss 1.348, Train_accy 81.10:  30%|███       | 6/20 [00:09<00:21,  1.54s/it]Task 2, Epoch 7/20 => Loss 1.320, Train_accy 80.00:  30%|███       | 6/20 [00:10<00:21,  1.54s/it]Task 2, Epoch 7/20 => Loss 1.320, Train_accy 80.00:  35%|███▌      | 7/20 [00:10<00:19,  1.53s/it]Task 2, Epoch 8/20 => Loss 1.242, Train_accy 81.64:  35%|███▌      | 7/20 [00:12<00:19,  1.53s/it]Task 2, Epoch 8/20 => Loss 1.242, Train_accy 81.64:  40%|████      | 8/20 [00:12<00:18,  1.54s/it]Task 2, Epoch 9/20 => Loss 1.200, Train_accy 81.37:  40%|████      | 8/20 [00:13<00:18,  1.54s/it]Task 2, Epoch 9/20 => Loss 1.200, Train_accy 81.37:  45%|████▌     | 9/20 [00:13<00:17,  1.55s/it]Task 2, Epoch 10/20 => Loss 1.168, Train_accy 82.74:  45%|████▌     | 9/20 [00:15<00:17,  1.55s/it]Task 2, Epoch 10/20 => Loss 1.168, Train_accy 82.74:  50%|█████     | 10/20 [00:15<00:15,  1.54s/it]Task 2, Epoch 11/20 => Loss 1.121, Train_accy 81.64:  50%|█████     | 10/20 [00:17<00:15,  1.54s/it]Task 2, Epoch 11/20 => Loss 1.121, Train_accy 81.64:  55%|█████▌    | 11/20 [00:17<00:14,  1.56s/it]Task 2, Epoch 12/20 => Loss 1.155, Train_accy 81.92:  55%|█████▌    | 11/20 [00:18<00:14,  1.56s/it]Task 2, Epoch 12/20 => Loss 1.155, Train_accy 81.92:  60%|██████    | 12/20 [00:18<00:12,  1.58s/it]Task 2, Epoch 13/20 => Loss 1.077, Train_accy 84.93:  60%|██████    | 12/20 [00:20<00:12,  1.58s/it]Task 2, Epoch 13/20 => Loss 1.077, Train_accy 84.93:  65%|██████▌   | 13/20 [00:20<00:10,  1.56s/it]Task 2, Epoch 14/20 => Loss 1.066, Train_accy 84.38:  65%|██████▌   | 13/20 [00:21<00:10,  1.56s/it]Task 2, Epoch 14/20 => Loss 1.066, Train_accy 84.38:  70%|███████   | 14/20 [00:21<00:09,  1.58s/it]Task 2, Epoch 15/20 => Loss 1.065, Train_accy 85.48:  70%|███████   | 14/20 [00:23<00:09,  1.58s/it]Task 2, Epoch 15/20 => Loss 1.065, Train_accy 85.48:  75%|███████▌  | 15/20 [00:23<00:07,  1.57s/it]Task 2, Epoch 16/20 => Loss 1.059, Train_accy 84.66:  75%|███████▌  | 15/20 [00:24<00:07,  1.57s/it]Task 2, Epoch 16/20 => Loss 1.059, Train_accy 84.66:  80%|████████  | 16/20 [00:24<00:06,  1.57s/it]Task 2, Epoch 17/20 => Loss 1.024, Train_accy 85.75:  80%|████████  | 16/20 [00:26<00:06,  1.57s/it]Task 2, Epoch 17/20 => Loss 1.024, Train_accy 85.75:  85%|████████▌ | 17/20 [00:26<00:04,  1.57s/it]Task 2, Epoch 18/20 => Loss 1.043, Train_accy 85.48:  85%|████████▌ | 17/20 [00:27<00:04,  1.57s/it]Task 2, Epoch 18/20 => Loss 1.043, Train_accy 85.48:  90%|█████████ | 18/20 [00:27<00:03,  1.54s/it]Task 2, Epoch 19/20 => Loss 1.025, Train_accy 86.30:  90%|█████████ | 18/20 [00:29<00:03,  1.54s/it]Task 2, Epoch 19/20 => Loss 1.025, Train_accy 86.30:  95%|█████████▌| 19/20 [00:29<00:01,  1.54s/it]Task 2, Epoch 20/20 => Loss 1.024, Train_accy 83.29:  95%|█████████▌| 19/20 [00:31<00:01,  1.54s/it]Task 2, Epoch 20/20 => Loss 1.024, Train_accy 83.29: 100%|██████████| 20/20 [00:31<00:00,  1.54s/it]Task 2, Epoch 20/20 => Loss 1.024, Train_accy 83.29: 100%|██████████| 20/20 [00:31<00:00,  1.55s/it]
2024-04-23 08:11:09,937 [loramoeinc.py] => Task 2, Epoch 20/20 => Loss 1.024, Train_accy 83.29
2024-04-23 08:11:43,603 [trainer.py] => No NME accuracy.
2024-04-23 08:11:43,604 [trainer.py] => CNN: {'total': 94.51, '00-09': 96.61, '10-19': 92.92, '20-29': 95.41, 'old': 93.99, 'new': 95.41}
2024-04-23 08:11:43,604 [trainer.py] => Route: {'total': 88.37, '00-09': 95.64, '10-19': 90.6, '20-29': 81.94, 'old': 92.06, 'new': 81.94}
2024-04-23 08:11:43,604 [trainer.py] => CNN top1 curve: [99.27, 94.84, 94.51]
2024-04-23 08:11:43,604 [trainer.py] => CNN top5 curve: [99.88, 99.96, 99.93]
2024-04-23 08:11:43,604 [trainer.py] => Route top1 curve: [98.79, 94.49, 88.37]
2024-04-23 08:11:43,604 [trainer.py] => Route top5 curve: [99.64, 99.61, 99.33]

Average Accuracy (CNN): 96.20666666666666
Average Accuracy (Route): 93.88333333333333
2024-04-23 08:11:43,604 [trainer.py] => Average Accuracy (CNN): 96.20666666666666
2024-04-23 08:11:43,605 [trainer.py] => Average Accuracy (Route): 93.88333333333333

2024-04-23 08:11:43,605 [trainer.py] => Train Time: 81.27
2024-04-23 08:11:43,605 [trainer.py] => Test Time: 0 

2024-04-23 08:11:43,606 [trainer.py] => All params: 85879318
2024-04-23 08:11:43,607 [trainer.py] => Trainable params: 36873
2024-04-23 08:11:43,610 [loramoeinc.py] => Learning on 30-40
  0%|          | 0/20 [00:00<?, ?it/s]Task 3, Epoch 1/20 => Loss 1.940, Train_accy 65.35:   0%|          | 0/20 [00:01<?, ?it/s]Task 3, Epoch 1/20 => Loss 1.940, Train_accy 65.35:   5%|▌         | 1/20 [00:01<00:27,  1.42s/it]Task 3, Epoch 2/20 => Loss 1.357, Train_accy 84.16:   5%|▌         | 1/20 [00:02<00:27,  1.42s/it]Task 3, Epoch 2/20 => Loss 1.357, Train_accy 84.16:  10%|█         | 2/20 [00:02<00:25,  1.41s/it]Task 3, Epoch 3/20 => Loss 1.369, Train_accy 83.50:  10%|█         | 2/20 [00:04<00:25,  1.41s/it]Task 3, Epoch 3/20 => Loss 1.369, Train_accy 83.50:  15%|█▌        | 3/20 [00:04<00:23,  1.41s/it]Task 3, Epoch 4/20 => Loss 1.380, Train_accy 83.17:  15%|█▌        | 3/20 [00:05<00:23,  1.41s/it]Task 3, Epoch 4/20 => Loss 1.380, Train_accy 83.17:  20%|██        | 4/20 [00:05<00:22,  1.38s/it]Task 3, Epoch 5/20 => Loss 1.345, Train_accy 84.82:  20%|██        | 4/20 [00:06<00:22,  1.38s/it]Task 3, Epoch 5/20 => Loss 1.345, Train_accy 84.82:  25%|██▌       | 5/20 [00:06<00:20,  1.40s/it]Task 3, Epoch 6/20 => Loss 1.267, Train_accy 84.82:  25%|██▌       | 5/20 [00:08<00:20,  1.40s/it]Task 3, Epoch 6/20 => Loss 1.267, Train_accy 84.82:  30%|███       | 6/20 [00:08<00:19,  1.41s/it]Task 3, Epoch 7/20 => Loss 1.147, Train_accy 88.12:  30%|███       | 6/20 [00:09<00:19,  1.41s/it]Task 3, Epoch 7/20 => Loss 1.147, Train_accy 88.12:  35%|███▌      | 7/20 [00:09<00:18,  1.41s/it]Task 3, Epoch 8/20 => Loss 1.135, Train_accy 86.80:  35%|███▌      | 7/20 [00:11<00:18,  1.41s/it]Task 3, Epoch 8/20 => Loss 1.135, Train_accy 86.80:  40%|████      | 8/20 [00:11<00:16,  1.40s/it]Task 3, Epoch 9/20 => Loss 1.065, Train_accy 88.78:  40%|████      | 8/20 [00:12<00:16,  1.40s/it]Task 3, Epoch 9/20 => Loss 1.065, Train_accy 88.78:  45%|████▌     | 9/20 [00:12<00:15,  1.42s/it]Task 3, Epoch 10/20 => Loss 1.134, Train_accy 85.15:  45%|████▌     | 9/20 [00:13<00:15,  1.42s/it]Task 3, Epoch 10/20 => Loss 1.134, Train_accy 85.15:  50%|█████     | 10/20 [00:13<00:13,  1.38s/it]Task 3, Epoch 11/20 => Loss 1.043, Train_accy 87.13:  50%|█████     | 10/20 [00:15<00:13,  1.38s/it]Task 3, Epoch 11/20 => Loss 1.043, Train_accy 87.13:  55%|█████▌    | 11/20 [00:15<00:12,  1.39s/it]Task 3, Epoch 12/20 => Loss 1.011, Train_accy 87.13:  55%|█████▌    | 11/20 [00:16<00:12,  1.39s/it]Task 3, Epoch 12/20 => Loss 1.011, Train_accy 87.13:  60%|██████    | 12/20 [00:16<00:11,  1.40s/it]Task 3, Epoch 13/20 => Loss 1.005, Train_accy 88.45:  60%|██████    | 12/20 [00:18<00:11,  1.40s/it]Task 3, Epoch 13/20 => Loss 1.005, Train_accy 88.45:  65%|██████▌   | 13/20 [00:18<00:09,  1.40s/it]Task 3, Epoch 14/20 => Loss 0.967, Train_accy 89.44:  65%|██████▌   | 13/20 [00:19<00:09,  1.40s/it]Task 3, Epoch 14/20 => Loss 0.967, Train_accy 89.44:  70%|███████   | 14/20 [00:19<00:08,  1.42s/it]Task 3, Epoch 15/20 => Loss 0.928, Train_accy 87.79:  70%|███████   | 14/20 [00:21<00:08,  1.42s/it]Task 3, Epoch 15/20 => Loss 0.928, Train_accy 87.79:  75%|███████▌  | 15/20 [00:21<00:07,  1.41s/it]Task 3, Epoch 16/20 => Loss 0.940, Train_accy 87.13:  75%|███████▌  | 15/20 [00:22<00:07,  1.41s/it]Task 3, Epoch 16/20 => Loss 0.940, Train_accy 87.13:  80%|████████  | 16/20 [00:22<00:05,  1.40s/it]Task 3, Epoch 17/20 => Loss 0.940, Train_accy 89.77:  80%|████████  | 16/20 [00:23<00:05,  1.40s/it]Task 3, Epoch 17/20 => Loss 0.940, Train_accy 89.77:  85%|████████▌ | 17/20 [00:23<00:04,  1.39s/it]Task 3, Epoch 18/20 => Loss 0.894, Train_accy 90.76:  85%|████████▌ | 17/20 [00:25<00:04,  1.39s/it]Task 3, Epoch 18/20 => Loss 0.894, Train_accy 90.76:  90%|█████████ | 18/20 [00:25<00:02,  1.40s/it]Task 3, Epoch 19/20 => Loss 0.937, Train_accy 90.10:  90%|█████████ | 18/20 [00:26<00:02,  1.40s/it]Task 3, Epoch 19/20 => Loss 0.937, Train_accy 90.10:  95%|█████████▌| 19/20 [00:26<00:01,  1.39s/it]Task 3, Epoch 20/20 => Loss 0.945, Train_accy 88.12:  95%|█████████▌| 19/20 [00:27<00:01,  1.39s/it]Task 3, Epoch 20/20 => Loss 0.945, Train_accy 88.12: 100%|██████████| 20/20 [00:27<00:00,  1.38s/it]Task 3, Epoch 20/20 => Loss 0.945, Train_accy 88.12: 100%|██████████| 20/20 [00:27<00:00,  1.40s/it]
2024-04-23 08:12:11,577 [loramoeinc.py] => Task 3, Epoch 20/20 => Loss 0.945, Train_accy 88.12
2024-04-23 08:12:52,295 [trainer.py] => No NME accuracy.
2024-04-23 08:12:52,296 [trainer.py] => CNN: {'total': 95.2, '00-09': 96.37, '10-19': 92.92, '20-29': 94.98, '30-39': 98.4, 'old': 94.31, 'new': 98.4}
2024-04-23 08:12:52,296 [trainer.py] => Route: {'total': 87.87, '00-09': 94.43, '10-19': 90.25, '20-29': 78.69, '30-39': 91.68, 'old': 86.81, 'new': 91.68}
2024-04-23 08:12:52,296 [trainer.py] => CNN top1 curve: [99.27, 94.84, 94.51, 95.2]
2024-04-23 08:12:52,296 [trainer.py] => CNN top5 curve: [99.88, 99.96, 99.93, 99.88]
2024-04-23 08:12:52,296 [trainer.py] => Route top1 curve: [98.79, 94.49, 88.37, 87.87]
2024-04-23 08:12:52,296 [trainer.py] => Route top5 curve: [99.64, 99.61, 99.33, 98.97]

Average Accuracy (CNN): 95.955
Average Accuracy (Route): 92.38
2024-04-23 08:12:52,296 [trainer.py] => Average Accuracy (CNN): 95.955
2024-04-23 08:12:52,296 [trainer.py] => Average Accuracy (Route): 92.38

2024-04-23 08:12:52,296 [trainer.py] => Train Time: 109.22999999999999
2024-04-23 08:12:52,296 [trainer.py] => Test Time: 0 

2024-04-23 08:12:52,298 [trainer.py] => All params: 85894678
2024-04-23 08:12:52,299 [trainer.py] => Trainable params: 37637
2024-04-23 08:12:52,303 [loramoeinc.py] => Learning on 40-50
  0%|          | 0/20 [00:00<?, ?it/s]Task 4, Epoch 1/20 => Loss 1.964, Train_accy 61.48:   0%|          | 0/20 [00:02<?, ?it/s]Task 4, Epoch 1/20 => Loss 1.964, Train_accy 61.48:   5%|▌         | 1/20 [00:02<00:39,  2.07s/it]Task 4, Epoch 2/20 => Loss 1.555, Train_accy 71.97:   5%|▌         | 1/20 [00:04<00:39,  2.07s/it]Task 4, Epoch 2/20 => Loss 1.555, Train_accy 71.97:  10%|█         | 2/20 [00:04<00:37,  2.10s/it]Task 4, Epoch 3/20 => Loss 1.454, Train_accy 73.60:  10%|█         | 2/20 [00:06<00:37,  2.10s/it]Task 4, Epoch 3/20 => Loss 1.454, Train_accy 73.60:  15%|█▌        | 3/20 [00:06<00:36,  2.14s/it]Task 4, Epoch 4/20 => Loss 1.363, Train_accy 76.49:  15%|█▌        | 3/20 [00:08<00:36,  2.14s/it]Task 4, Epoch 4/20 => Loss 1.363, Train_accy 76.49:  20%|██        | 4/20 [00:08<00:34,  2.15s/it]Task 4, Epoch 5/20 => Loss 1.281, Train_accy 79.20:  20%|██        | 4/20 [00:10<00:34,  2.15s/it]Task 4, Epoch 5/20 => Loss 1.281, Train_accy 79.20:  25%|██▌       | 5/20 [00:10<00:31,  2.12s/it]Task 4, Epoch 6/20 => Loss 1.231, Train_accy 76.31:  25%|██▌       | 5/20 [00:12<00:31,  2.12s/it]Task 4, Epoch 6/20 => Loss 1.231, Train_accy 76.31:  30%|███       | 6/20 [00:12<00:29,  2.14s/it]Task 4, Epoch 7/20 => Loss 1.140, Train_accy 77.94:  30%|███       | 6/20 [00:14<00:29,  2.14s/it]Task 4, Epoch 7/20 => Loss 1.140, Train_accy 77.94:  35%|███▌      | 7/20 [00:14<00:27,  2.13s/it]Task 4, Epoch 8/20 => Loss 1.131, Train_accy 80.47:  35%|███▌      | 7/20 [00:17<00:27,  2.13s/it]Task 4, Epoch 8/20 => Loss 1.131, Train_accy 80.47:  40%|████      | 8/20 [00:17<00:25,  2.16s/it]Task 4, Epoch 9/20 => Loss 1.025, Train_accy 83.18:  40%|████      | 8/20 [00:19<00:25,  2.16s/it]Task 4, Epoch 9/20 => Loss 1.025, Train_accy 83.18:  45%|████▌     | 9/20 [00:19<00:23,  2.14s/it]Task 4, Epoch 10/20 => Loss 0.996, Train_accy 81.01:  45%|████▌     | 9/20 [00:21<00:23,  2.14s/it]Task 4, Epoch 10/20 => Loss 0.996, Train_accy 81.01:  50%|█████     | 10/20 [00:21<00:21,  2.15s/it]Task 4, Epoch 11/20 => Loss 0.998, Train_accy 81.56:  50%|█████     | 10/20 [00:23<00:21,  2.15s/it]Task 4, Epoch 11/20 => Loss 0.998, Train_accy 81.56:  55%|█████▌    | 11/20 [00:23<00:19,  2.13s/it]Task 4, Epoch 12/20 => Loss 0.932, Train_accy 84.27:  55%|█████▌    | 11/20 [00:25<00:19,  2.13s/it]Task 4, Epoch 12/20 => Loss 0.932, Train_accy 84.27:  60%|██████    | 12/20 [00:25<00:16,  2.11s/it]Task 4, Epoch 13/20 => Loss 0.932, Train_accy 84.81:  60%|██████    | 12/20 [00:27<00:16,  2.11s/it]Task 4, Epoch 13/20 => Loss 0.932, Train_accy 84.81:  65%|██████▌   | 13/20 [00:27<00:14,  2.09s/it]Task 4, Epoch 14/20 => Loss 0.924, Train_accy 84.09:  65%|██████▌   | 13/20 [00:29<00:14,  2.09s/it]Task 4, Epoch 14/20 => Loss 0.924, Train_accy 84.09:  70%|███████   | 14/20 [00:29<00:12,  2.13s/it]Task 4, Epoch 15/20 => Loss 0.925, Train_accy 83.36:  70%|███████   | 14/20 [00:31<00:12,  2.13s/it]Task 4, Epoch 15/20 => Loss 0.925, Train_accy 83.36:  75%|███████▌  | 15/20 [00:31<00:10,  2.11s/it]Task 4, Epoch 16/20 => Loss 0.847, Train_accy 86.44:  75%|███████▌  | 15/20 [00:34<00:10,  2.11s/it]Task 4, Epoch 16/20 => Loss 0.847, Train_accy 86.44:  80%|████████  | 16/20 [00:34<00:08,  2.13s/it]Task 4, Epoch 17/20 => Loss 0.863, Train_accy 84.09:  80%|████████  | 16/20 [00:36<00:08,  2.13s/it]Task 4, Epoch 17/20 => Loss 0.863, Train_accy 84.09:  85%|████████▌ | 17/20 [00:36<00:06,  2.11s/it]Task 4, Epoch 18/20 => Loss 0.895, Train_accy 83.91:  85%|████████▌ | 17/20 [00:38<00:06,  2.11s/it]Task 4, Epoch 18/20 => Loss 0.895, Train_accy 83.91:  90%|█████████ | 18/20 [00:38<00:04,  2.09s/it]Task 4, Epoch 19/20 => Loss 0.867, Train_accy 84.27:  90%|█████████ | 18/20 [00:40<00:04,  2.09s/it]Task 4, Epoch 19/20 => Loss 0.867, Train_accy 84.27:  95%|█████████▌| 19/20 [00:40<00:02,  2.08s/it]Task 4, Epoch 20/20 => Loss 0.858, Train_accy 85.90:  95%|█████████▌| 19/20 [00:42<00:02,  2.08s/it]Task 4, Epoch 20/20 => Loss 0.858, Train_accy 85.90: 100%|██████████| 20/20 [00:42<00:00,  2.06s/it]Task 4, Epoch 20/20 => Loss 0.858, Train_accy 85.90: 100%|██████████| 20/20 [00:42<00:00,  2.11s/it]
2024-04-23 08:13:34,551 [loramoeinc.py] => Task 4, Epoch 20/20 => Loss 0.858, Train_accy 85.90
2024-04-23 08:14:32,038 [trainer.py] => No NME accuracy.
2024-04-23 08:14:32,038 [trainer.py] => CNN: {'total': 93.96, '00-09': 96.25, '10-19': 92.92, '20-29': 94.79, '30-39': 96.88, '40-49': 92.28, 'old': 94.8, 'new': 92.28}
2024-04-23 08:14:32,038 [trainer.py] => Route: {'total': 84.46, '00-09': 94.43, '10-19': 86.79, '20-29': 74.46, '30-39': 90.8, '40-49': 82.9, 'old': 85.25, 'new': 82.9}
2024-04-23 08:14:32,038 [trainer.py] => CNN top1 curve: [99.27, 94.84, 94.51, 95.2, 93.96]
2024-04-23 08:14:32,038 [trainer.py] => CNN top5 curve: [99.88, 99.96, 99.93, 99.88, 99.61]
2024-04-23 08:14:32,038 [trainer.py] => Route top1 curve: [98.79, 94.49, 88.37, 87.87, 84.46]
2024-04-23 08:14:32,038 [trainer.py] => Route top5 curve: [99.64, 99.61, 99.33, 98.97, 98.29]

Average Accuracy (CNN): 95.556
Average Accuracy (Route): 90.79599999999999
2024-04-23 08:14:32,038 [trainer.py] => Average Accuracy (CNN): 95.556
2024-04-23 08:14:32,038 [trainer.py] => Average Accuracy (Route): 90.79599999999999

2024-04-23 08:14:32,038 [trainer.py] => Train Time: 151.47
2024-04-23 08:14:32,038 [trainer.py] => Test Time: 0 

2024-04-23 08:14:35,048 [trainer.py] => config: ./exps/loramoe_inc_omn_inc5.json
2024-04-23 08:14:35,049 [trainer.py] => prefix: reproduce
2024-04-23 08:14:35,049 [trainer.py] => dataset: omnibenchmark
2024-04-23 08:14:35,049 [trainer.py] => memory_size: 0
2024-04-23 08:14:35,049 [trainer.py] => memory_per_class: 0
2024-04-23 08:14:35,049 [trainer.py] => fixed_memory: False
2024-04-23 08:14:35,049 [trainer.py] => shuffle: True
2024-04-23 08:14:35,049 [trainer.py] => init_cls: 60
2024-04-23 08:14:35,049 [trainer.py] => increment: 60
2024-04-23 08:14:35,049 [trainer.py] => model_name: loramoeinc
2024-04-23 08:14:35,049 [trainer.py] => backbone_type: pretrained_vit_b16_224_inc
2024-04-23 08:14:35,049 [trainer.py] => device: [device(type='cuda', index=2)]
2024-04-23 08:14:35,049 [trainer.py] => seed: 1993
2024-04-23 08:14:35,049 [trainer.py] => tuned_epoch: 20
2024-04-23 08:14:35,049 [trainer.py] => init_lr: 0.01
2024-04-23 08:14:35,049 [trainer.py] => batch_size: 48
2024-04-23 08:14:35,049 [trainer.py] => weight_decay: 0.0005
2024-04-23 08:14:35,049 [trainer.py] => min_lr: 0
2024-04-23 08:14:35,049 [trainer.py] => ffn_num: 4
2024-04-23 08:14:35,049 [trainer.py] => optimizer: sgd
2024-04-23 08:14:35,049 [trainer.py] => vpt_type: shallow
2024-04-23 08:14:35,049 [trainer.py] => prompt_token_num: 5
2024-04-23 08:14:35,049 [trainer.py] => expert_num: 5
2024-04-23 08:14:35,323 [data_manager.py] => [169, 221, 146, 296, 92, 229, 49, 70, 126, 77, 243, 57, 120, 223, 27, 217, 154, 8, 101, 182, 54, 50, 97, 162, 28, 193, 79, 6, 151, 0, 173, 187, 44, 277, 157, 16, 257, 122, 35, 9, 171, 176, 134, 4, 87, 255, 112, 153, 246, 286, 147, 186, 107, 98, 10, 7, 266, 214, 36, 165, 139, 254, 103, 269, 59, 23, 298, 39, 73, 208, 135, 299, 102, 20, 12, 268, 11, 209, 161, 210, 74, 42, 56, 99, 235, 133, 159, 189, 145, 238, 215, 241, 138, 195, 233, 279, 88, 199, 64, 280, 26, 203, 17, 245, 174, 236, 137, 252, 80, 68, 181, 150, 118, 94, 75, 2, 109, 119, 232, 15, 69, 184, 201, 261, 55, 287, 273, 66, 175, 32, 142, 136, 116, 76, 179, 1, 91, 248, 275, 240, 290, 170, 132, 106, 265, 270, 85, 19, 284, 43, 259, 293, 228, 200, 104, 227, 51, 224, 163, 297, 216, 260, 93, 46, 100, 272, 105, 72, 131, 3, 156, 256, 249, 48, 113, 82, 172, 213, 62, 53, 271, 168, 253, 226, 183, 180, 276, 283, 78, 61, 143, 278, 30, 141, 196, 264, 231, 52, 222, 40, 125, 219, 65, 166, 192, 289, 45, 205, 89, 267, 90, 71, 167, 262, 281, 212, 96, 84, 127, 67, 294, 178, 288, 197, 21, 18, 111, 108, 58, 230, 188, 31, 110, 291, 129, 24, 204, 83, 81, 251, 60, 13, 128, 14, 86, 63, 117, 198, 274, 5, 22, 144, 258, 121, 38, 207, 148, 292, 41, 234, 237, 114, 202, 37, 149, 206, 155, 29, 130, 177, 194, 152, 34, 33, 239, 160, 140, 47, 244, 25, 282, 158, 211, 123, 190, 218, 164, 247, 263, 191, 220, 115, 242, 250, 124, 295, 95, 285, 225, 185]
/home/team/zhaohongwei/anaconda3/envs/peft/lib/python3.10/site-packages/bitsandbytes/cuda_setup/main.py:136: UserWarning: /home/team/zhaohongwei/anaconda3/envs/peft did not contain libcudart.so as expected! Searching further paths...
  warn(msg)

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please submit your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
CUDA SETUP: CUDA runtime path found: /usr/local/cuda-11.8/lib64/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 8.6
CUDA SETUP: Detected CUDA version 118
CUDA SETUP: Loading binary /home/team/zhaohongwei/anaconda3/envs/peft/lib/python3.10/site-packages/bitsandbytes/libbitsandbytes_cuda118.so...
I'm using ViT with adapters.
2024-04-23 08:14:39,696 [trainer.py] => All params: 85833236
2024-04-23 08:14:39,697 [trainer.py] => Trainable params: 34580
2024-04-23 08:14:39,834 [loramoeinc.py] => Learning on 0-60
  0%|          | 0/20 [00:00<?, ?it/s]Task 0, Epoch 1/20 => Loss 2.462, Train_accy 63.23:   0%|          | 0/20 [00:52<?, ?it/s]Task 0, Epoch 1/20 => Loss 2.462, Train_accy 63.23:   5%|▌         | 1/20 [00:52<16:44, 52.84s/it]Task 0, Epoch 2/20 => Loss 0.701, Train_accy 83.33:   5%|▌         | 1/20 [01:45<16:44, 52.84s/it]Task 0, Epoch 2/20 => Loss 0.701, Train_accy 83.33:  10%|█         | 2/20 [01:45<15:46, 52.57s/it]Task 0, Epoch 3/20 => Loss 0.577, Train_accy 84.99:  10%|█         | 2/20 [02:37<15:46, 52.57s/it]Task 0, Epoch 3/20 => Loss 0.577, Train_accy 84.99:  15%|█▌        | 3/20 [02:37<14:51, 52.45s/it]Task 0, Epoch 4/20 => Loss 0.524, Train_accy 85.88:  15%|█▌        | 3/20 [03:29<14:51, 52.45s/it]Task 0, Epoch 4/20 => Loss 0.524, Train_accy 85.88:  20%|██        | 4/20 [03:29<13:57, 52.32s/it]Task 0, Epoch 5/20 => Loss 0.488, Train_accy 86.20:  20%|██        | 4/20 [04:21<13:57, 52.32s/it]Task 0, Epoch 5/20 => Loss 0.488, Train_accy 86.20:  25%|██▌       | 5/20 [04:21<13:04, 52.30s/it]Task 0, Epoch 6/20 => Loss 0.465, Train_accy 86.74:  25%|██▌       | 5/20 [05:14<13:04, 52.30s/it]Task 0, Epoch 6/20 => Loss 0.465, Train_accy 86.74:  30%|███       | 6/20 [05:14<12:12, 52.29s/it]Task 0, Epoch 7/20 => Loss 0.434, Train_accy 87.62:  30%|███       | 6/20 [06:06<12:12, 52.29s/it]Task 0, Epoch 7/20 => Loss 0.434, Train_accy 87.62:  35%|███▌      | 7/20 [06:06<11:20, 52.32s/it]Task 0, Epoch 8/20 => Loss 0.437, Train_accy 87.55:  35%|███▌      | 7/20 [06:59<11:20, 52.32s/it]Task 0, Epoch 8/20 => Loss 0.437, Train_accy 87.55:  40%|████      | 8/20 [06:59<10:29, 52.42s/it]Task 0, Epoch 9/20 => Loss 0.425, Train_accy 87.82:  40%|████      | 8/20 [07:51<10:29, 52.42s/it]Task 0, Epoch 9/20 => Loss 0.425, Train_accy 87.82:  45%|████▌     | 9/20 [07:51<09:35, 52.34s/it]Task 0, Epoch 10/20 => Loss 0.406, Train_accy 88.36:  45%|████▌     | 9/20 [08:43<09:35, 52.34s/it]Task 0, Epoch 10/20 => Loss 0.406, Train_accy 88.36:  50%|█████     | 10/20 [08:43<08:43, 52.34s/it]Task 0, Epoch 11/20 => Loss 0.402, Train_accy 88.53:  50%|█████     | 10/20 [09:36<08:43, 52.34s/it]Task 0, Epoch 11/20 => Loss 0.402, Train_accy 88.53:  55%|█████▌    | 11/20 [09:36<07:51, 52.33s/it]Task 0, Epoch 12/20 => Loss 0.396, Train_accy 88.67:  55%|█████▌    | 11/20 [10:28<07:51, 52.33s/it]Task 0, Epoch 12/20 => Loss 0.396, Train_accy 88.67:  60%|██████    | 12/20 [10:28<06:58, 52.25s/it]Task 0, Epoch 13/20 => Loss 0.392, Train_accy 88.72:  60%|██████    | 12/20 [11:20<06:58, 52.25s/it]Task 0, Epoch 13/20 => Loss 0.392, Train_accy 88.72:  65%|██████▌   | 13/20 [11:20<06:05, 52.21s/it]Task 0, Epoch 14/20 => Loss 0.380, Train_accy 89.09:  65%|██████▌   | 13/20 [12:12<06:05, 52.21s/it]Task 0, Epoch 14/20 => Loss 0.380, Train_accy 89.09:  70%|███████   | 14/20 [12:12<05:13, 52.21s/it]Task 0, Epoch 15/20 => Loss 0.380, Train_accy 89.30:  70%|███████   | 14/20 [13:04<05:13, 52.21s/it]Task 0, Epoch 15/20 => Loss 0.380, Train_accy 89.30:  75%|███████▌  | 15/20 [13:04<04:20, 52.18s/it]Task 0, Epoch 16/20 => Loss 0.377, Train_accy 89.25:  75%|███████▌  | 15/20 [13:56<04:20, 52.18s/it]Task 0, Epoch 16/20 => Loss 0.377, Train_accy 89.25:  80%|████████  | 16/20 [13:56<03:28, 52.15s/it]Task 0, Epoch 17/20 => Loss 0.361, Train_accy 89.71:  80%|████████  | 16/20 [14:48<03:28, 52.15s/it]Task 0, Epoch 17/20 => Loss 0.361, Train_accy 89.71:  85%|████████▌ | 17/20 [14:48<02:36, 52.14s/it]Task 0, Epoch 18/20 => Loss 0.366, Train_accy 89.77:  85%|████████▌ | 17/20 [15:41<02:36, 52.14s/it]Task 0, Epoch 18/20 => Loss 0.366, Train_accy 89.77:  90%|█████████ | 18/20 [15:41<01:44, 52.22s/it]Task 0, Epoch 19/20 => Loss 0.365, Train_accy 89.67:  90%|█████████ | 18/20 [16:33<01:44, 52.22s/it]Task 0, Epoch 19/20 => Loss 0.365, Train_accy 89.67:  95%|█████████▌| 19/20 [16:33<00:52, 52.37s/it]Task 0, Epoch 20/20 => Loss 0.353, Train_accy 90.29:  95%|█████████▌| 19/20 [17:26<00:52, 52.37s/it]Task 0, Epoch 20/20 => Loss 0.353, Train_accy 90.29: 100%|██████████| 20/20 [17:26<00:00, 52.52s/it]Task 0, Epoch 20/20 => Loss 0.353, Train_accy 90.29: 100%|██████████| 20/20 [17:26<00:00, 52.34s/it]
2024-04-23 08:32:06,683 [loramoeinc.py] => Task 0, Epoch 20/20 => Loss 0.353, Train_accy 90.29
2024-04-23 08:34:02,558 [trainer.py] => No NME accuracy.
2024-04-23 08:34:02,559 [trainer.py] => CNN: {'total': 87.99, '00-59': 87.99, 'old': 0, 'new': 87.99}
2024-04-23 08:34:02,559 [trainer.py] => Route: {'total': 87.57, '00-59': 87.57, 'old': 0, 'new': 87.57}
2024-04-23 08:34:02,559 [trainer.py] => CNN top1 curve: [87.99]
2024-04-23 08:34:02,559 [trainer.py] => CNN top5 curve: [99.08]
2024-04-23 08:34:02,559 [trainer.py] => Route top1 curve: [87.57]
2024-04-23 08:34:02,559 [trainer.py] => Route top5 curve: [98.0]

Average Accuracy (CNN): 87.99
Average Accuracy (Route): 87.57
2024-04-23 08:34:02,559 [trainer.py] => Average Accuracy (CNN): 87.99
2024-04-23 08:34:02,559 [trainer.py] => Average Accuracy (Route): 87.57

2024-04-23 08:34:02,559 [trainer.py] => Train Time: 1046.73
2024-04-23 08:34:02,559 [trainer.py] => Test Time: 0 

2024-04-23 08:34:02,560 [trainer.py] => All params: 85925398
2024-04-23 08:34:02,561 [trainer.py] => Trainable params: 73745
2024-04-23 08:34:02,586 [loramoeinc.py] => Learning on 60-120
  0%|          | 0/20 [00:00<?, ?it/s]Task 1, Epoch 1/20 => Loss 2.305, Train_accy 45.52:   0%|          | 0/20 [00:52<?, ?it/s]Task 1, Epoch 1/20 => Loss 2.305, Train_accy 45.52:   5%|▌         | 1/20 [00:52<16:28, 52.04s/it]Task 1, Epoch 2/20 => Loss 1.954, Train_accy 50.77:   5%|▌         | 1/20 [01:44<16:28, 52.04s/it]Task 1, Epoch 2/20 => Loss 1.954, Train_accy 50.77:  10%|█         | 2/20 [01:44<15:36, 52.00s/it]Task 1, Epoch 3/20 => Loss 1.894, Train_accy 51.40:  10%|█         | 2/20 [02:36<15:36, 52.00s/it]Task 1, Epoch 3/20 => Loss 1.894, Train_accy 51.40:  15%|█▌        | 3/20 [02:36<14:46, 52.15s/it]Task 1, Epoch 4/20 => Loss 1.875, Train_accy 51.87:  15%|█▌        | 3/20 [03:28<14:46, 52.15s/it]Task 1, Epoch 4/20 => Loss 1.875, Train_accy 51.87:  20%|██        | 4/20 [03:28<13:54, 52.15s/it]Task 1, Epoch 5/20 => Loss 1.861, Train_accy 52.23:  20%|██        | 4/20 [04:20<13:54, 52.15s/it]Task 1, Epoch 5/20 => Loss 1.861, Train_accy 52.23:  25%|██▌       | 5/20 [04:20<13:01, 52.09s/it]Task 1, Epoch 6/20 => Loss 1.832, Train_accy 52.41:  25%|██▌       | 5/20 [05:12<13:01, 52.09s/it]Task 1, Epoch 6/20 => Loss 1.832, Train_accy 52.41:  30%|███       | 6/20 [05:12<12:09, 52.07s/it]Task 1, Epoch 7/20 => Loss 1.841, Train_accy 52.36:  30%|███       | 6/20 [06:04<12:09, 52.07s/it]Task 1, Epoch 7/20 => Loss 1.841, Train_accy 52.36:  35%|███▌      | 7/20 [06:04<11:15, 51.99s/it]Task 1, Epoch 8/20 => Loss 1.825, Train_accy 52.77:  35%|███▌      | 7/20 [06:56<11:15, 51.99s/it]Task 1, Epoch 8/20 => Loss 1.825, Train_accy 52.77:  40%|████      | 8/20 [06:56<10:22, 51.90s/it]Task 1, Epoch 9/20 => Loss 1.816, Train_accy 52.68:  40%|████      | 8/20 [07:47<10:22, 51.90s/it]Task 1, Epoch 9/20 => Loss 1.816, Train_accy 52.68:  45%|████▌     | 9/20 [07:47<09:30, 51.88s/it]Task 1, Epoch 10/20 => Loss 1.809, Train_accy 53.12:  45%|████▌     | 9/20 [08:39<09:30, 51.88s/it]Task 1, Epoch 10/20 => Loss 1.809, Train_accy 53.12:  50%|█████     | 10/20 [08:39<08:38, 51.84s/it]Task 1, Epoch 11/20 => Loss 1.802, Train_accy 53.00:  50%|█████     | 10/20 [09:31<08:38, 51.84s/it]Task 1, Epoch 11/20 => Loss 1.802, Train_accy 53.00:  55%|█████▌    | 11/20 [09:31<07:46, 51.88s/it]Task 1, Epoch 12/20 => Loss 1.794, Train_accy 53.26:  55%|█████▌    | 11/20 [10:23<07:46, 51.88s/it]Task 1, Epoch 12/20 => Loss 1.794, Train_accy 53.26:  60%|██████    | 12/20 [10:23<06:55, 51.90s/it]Task 1, Epoch 13/20 => Loss 1.782, Train_accy 53.44:  60%|██████    | 12/20 [11:15<06:55, 51.90s/it]Task 1, Epoch 13/20 => Loss 1.782, Train_accy 53.44:  65%|██████▌   | 13/20 [11:15<06:04, 52.01s/it]Task 1, Epoch 14/20 => Loss 1.784, Train_accy 53.29:  65%|██████▌   | 13/20 [12:08<06:04, 52.01s/it]Task 1, Epoch 14/20 => Loss 1.784, Train_accy 53.29:  70%|███████   | 14/20 [12:08<05:13, 52.17s/it]Task 1, Epoch 15/20 => Loss 1.780, Train_accy 53.35:  70%|███████   | 14/20 [13:00<05:13, 52.17s/it]Task 1, Epoch 15/20 => Loss 1.780, Train_accy 53.35:  75%|███████▌  | 15/20 [13:00<04:20, 52.17s/it]Task 1, Epoch 16/20 => Loss 1.781, Train_accy 53.33:  75%|███████▌  | 15/20 [13:52<04:20, 52.17s/it]Task 1, Epoch 16/20 => Loss 1.781, Train_accy 53.33:  80%|████████  | 16/20 [13:52<03:28, 52.07s/it]Task 1, Epoch 17/20 => Loss 1.762, Train_accy 53.65:  80%|████████  | 16/20 [14:43<03:28, 52.07s/it]Task 1, Epoch 17/20 => Loss 1.762, Train_accy 53.65:  85%|████████▌ | 17/20 [14:43<02:35, 51.94s/it]Task 1, Epoch 18/20 => Loss 1.772, Train_accy 53.69:  85%|████████▌ | 17/20 [15:36<02:35, 51.94s/it]Task 1, Epoch 18/20 => Loss 1.772, Train_accy 53.69:  90%|█████████ | 18/20 [15:36<01:43, 52.00s/it]Task 1, Epoch 19/20 => Loss 1.771, Train_accy 53.63:  90%|█████████ | 18/20 [16:27<01:43, 52.00s/it]Task 1, Epoch 19/20 => Loss 1.771, Train_accy 53.63:  95%|█████████▌| 19/20 [16:27<00:51, 51.95s/it]Task 1, Epoch 20/20 => Loss 1.779, Train_accy 53.48:  95%|█████████▌| 19/20 [17:19<00:51, 51.95s/it]Task 1, Epoch 20/20 => Loss 1.779, Train_accy 53.48: 100%|██████████| 20/20 [17:19<00:00, 51.93s/it]Task 1, Epoch 20/20 => Loss 1.779, Train_accy 53.48: 100%|██████████| 20/20 [17:19<00:00, 51.99s/it]
2024-04-23 08:51:22,448 [loramoeinc.py] => Task 1, Epoch 20/20 => Loss 1.779, Train_accy 53.48
2024-04-23 08:53:22,883 [trainer.py] => No NME accuracy.
2024-04-23 08:53:22,883 [trainer.py] => CNN: {'total': 85.09, '00-59': 87.99, '60-119': 82.19, 'old': 87.99, 'new': 82.19}
2024-04-23 08:53:22,883 [trainer.py] => Route: {'total': 81.42, '00-59': 81.9, '60-119': 80.94, 'old': 81.9, 'new': 80.94}
2024-04-23 08:53:22,883 [trainer.py] => CNN top1 curve: [87.99, 85.09]
2024-04-23 08:53:22,883 [trainer.py] => CNN top5 curve: [99.08, 97.24]
2024-04-23 08:53:22,884 [trainer.py] => Route top1 curve: [87.57, 81.42]
2024-04-23 08:53:22,884 [trainer.py] => Route top5 curve: [98.0, 95.87]

Average Accuracy (CNN): 86.53999999999999
Average Accuracy (Route): 84.495
2024-04-23 08:53:22,884 [trainer.py] => Average Accuracy (CNN): 86.53999999999999
2024-04-23 08:53:22,884 [trainer.py] => Average Accuracy (Route): 84.495

2024-04-23 08:53:22,884 [trainer.py] => Train Time: 2086.55
2024-04-23 08:53:22,884 [trainer.py] => Test Time: 0 

2024-04-23 08:53:22,884 [trainer.py] => All params: 86017558
2024-04-23 08:53:22,885 [trainer.py] => Trainable params: 112909
2024-04-23 08:53:22,889 [loramoeinc.py] => Learning on 120-180
  0%|          | 0/20 [00:00<?, ?it/s]Task 2, Epoch 1/20 => Loss 2.321, Train_accy 44.29:   0%|          | 0/20 [00:52<?, ?it/s]Task 2, Epoch 1/20 => Loss 2.321, Train_accy 44.29:   5%|▌         | 1/20 [00:52<16:37, 52.48s/it]Task 2, Epoch 2/20 => Loss 1.939, Train_accy 50.32:   5%|▌         | 1/20 [01:45<16:37, 52.48s/it]Task 2, Epoch 2/20 => Loss 1.939, Train_accy 50.32:  10%|█         | 2/20 [01:45<15:47, 52.63s/it]Task 2, Epoch 3/20 => Loss 1.872, Train_accy 52.09:  10%|█         | 2/20 [02:37<15:47, 52.63s/it]Task 2, Epoch 3/20 => Loss 1.872, Train_accy 52.09:  15%|█▌        | 3/20 [02:37<14:54, 52.60s/it]Task 2, Epoch 4/20 => Loss 1.856, Train_accy 52.73:  15%|█▌        | 3/20 [03:30<14:54, 52.60s/it]Task 2, Epoch 4/20 => Loss 1.856, Train_accy 52.73:  20%|██        | 4/20 [03:30<13:59, 52.45s/it]Task 2, Epoch 5/20 => Loss 1.814, Train_accy 53.64:  20%|██        | 4/20 [04:22<13:59, 52.45s/it]Task 2, Epoch 5/20 => Loss 1.814, Train_accy 53.64:  25%|██▌       | 5/20 [04:22<13:06, 52.41s/it]Task 2, Epoch 6/20 => Loss 1.804, Train_accy 53.95:  25%|██▌       | 5/20 [05:14<13:06, 52.41s/it]Task 2, Epoch 6/20 => Loss 1.804, Train_accy 53.95:  30%|███       | 6/20 [05:14<12:13, 52.43s/it]Task 2, Epoch 7/20 => Loss 1.789, Train_accy 54.33:  30%|███       | 6/20 [06:07<12:13, 52.43s/it]Task 2, Epoch 7/20 => Loss 1.789, Train_accy 54.33:  35%|███▌      | 7/20 [06:07<11:21, 52.45s/it]Task 2, Epoch 8/20 => Loss 1.774, Train_accy 54.51:  35%|███▌      | 7/20 [06:59<11:21, 52.45s/it]Task 2, Epoch 8/20 => Loss 1.774, Train_accy 54.51:  40%|████      | 8/20 [06:59<10:28, 52.40s/it]Task 2, Epoch 9/20 => Loss 1.768, Train_accy 54.66:  40%|████      | 8/20 [07:52<10:28, 52.40s/it]Task 2, Epoch 9/20 => Loss 1.768, Train_accy 54.66:  45%|████▌     | 9/20 [07:52<09:36, 52.41s/it]Task 2, Epoch 10/20 => Loss 1.770, Train_accy 54.77:  45%|████▌     | 9/20 [08:44<09:36, 52.41s/it]Task 2, Epoch 10/20 => Loss 1.770, Train_accy 54.77:  50%|█████     | 10/20 [08:44<08:44, 52.46s/it]Task 2, Epoch 11/20 => Loss 1.762, Train_accy 54.89:  50%|█████     | 10/20 [09:37<08:44, 52.46s/it]Task 2, Epoch 11/20 => Loss 1.762, Train_accy 54.89:  55%|█████▌    | 11/20 [09:37<07:53, 52.58s/it]Task 2, Epoch 12/20 => Loss 1.738, Train_accy 55.26:  55%|█████▌    | 11/20 [10:30<07:53, 52.58s/it]Task 2, Epoch 12/20 => Loss 1.738, Train_accy 55.26:  60%|██████    | 12/20 [10:30<07:02, 52.78s/it]Task 2, Epoch 13/20 => Loss 1.732, Train_accy 55.07:  60%|██████    | 12/20 [11:23<07:02, 52.78s/it]Task 2, Epoch 13/20 => Loss 1.732, Train_accy 55.07:  65%|██████▌   | 13/20 [11:23<06:09, 52.85s/it]Task 2, Epoch 14/20 => Loss 1.736, Train_accy 55.25:  65%|██████▌   | 13/20 [12:17<06:09, 52.85s/it]Task 2, Epoch 14/20 => Loss 1.736, Train_accy 55.25:  70%|███████   | 14/20 [12:17<05:18, 53.05s/it]Task 2, Epoch 15/20 => Loss 1.735, Train_accy 55.33:  70%|███████   | 14/20 [13:10<05:18, 53.05s/it]Task 2, Epoch 15/20 => Loss 1.735, Train_accy 55.33:  75%|███████▌  | 15/20 [13:10<04:25, 53.10s/it]Task 2, Epoch 16/20 => Loss 1.719, Train_accy 55.52:  75%|███████▌  | 15/20 [14:02<04:25, 53.10s/it]Task 2, Epoch 16/20 => Loss 1.719, Train_accy 55.52:  80%|████████  | 16/20 [14:02<03:31, 52.93s/it]Task 2, Epoch 17/20 => Loss 1.705, Train_accy 55.91:  80%|████████  | 16/20 [14:55<03:31, 52.93s/it]Task 2, Epoch 17/20 => Loss 1.705, Train_accy 55.91:  85%|████████▌ | 17/20 [14:55<02:38, 52.79s/it]Task 2, Epoch 18/20 => Loss 1.708, Train_accy 55.48:  85%|████████▌ | 17/20 [15:47<02:38, 52.79s/it]Task 2, Epoch 18/20 => Loss 1.708, Train_accy 55.48:  90%|█████████ | 18/20 [15:47<01:45, 52.72s/it]Task 2, Epoch 19/20 => Loss 1.719, Train_accy 55.46:  90%|█████████ | 18/20 [16:40<01:45, 52.72s/it]Task 2, Epoch 19/20 => Loss 1.719, Train_accy 55.46:  95%|█████████▌| 19/20 [16:40<00:52, 52.68s/it]Task 2, Epoch 20/20 => Loss 1.710, Train_accy 55.73:  95%|█████████▌| 19/20 [17:33<00:52, 52.68s/it]Task 2, Epoch 20/20 => Loss 1.710, Train_accy 55.73: 100%|██████████| 20/20 [17:33<00:00, 52.73s/it]Task 2, Epoch 20/20 => Loss 1.710, Train_accy 55.73: 100%|██████████| 20/20 [17:33<00:00, 52.67s/it]
2024-04-23 09:10:56,343 [loramoeinc.py] => Task 2, Epoch 20/20 => Loss 1.710, Train_accy 55.73
2024-04-23 09:13:04,145 [trainer.py] => No NME accuracy.
2024-04-23 09:13:04,146 [trainer.py] => CNN: {'total': 83.88, '00-59': 88.07, '60-119': 82.19, '120-179': 81.37, 'old': 85.14, 'new': 81.37}
2024-04-23 09:13:04,146 [trainer.py] => Route: {'total': 76.73, '00-59': 76.81, '60-119': 76.59, '120-179': 76.78, 'old': 76.7, 'new': 76.78}
2024-04-23 09:13:04,146 [trainer.py] => CNN top1 curve: [87.99, 85.09, 83.88]
2024-04-23 09:13:04,146 [trainer.py] => CNN top5 curve: [99.08, 97.24, 96.02]
2024-04-23 09:13:04,146 [trainer.py] => Route top1 curve: [87.57, 81.42, 76.73]
2024-04-23 09:13:04,146 [trainer.py] => Route top5 curve: [98.0, 95.87, 93.26]

Average Accuracy (CNN): 85.65333333333332
Average Accuracy (Route): 81.90666666666668
2024-04-23 09:13:04,146 [trainer.py] => Average Accuracy (CNN): 85.65333333333332
2024-04-23 09:13:04,146 [trainer.py] => Average Accuracy (Route): 81.90666666666668

2024-04-23 09:13:04,146 [trainer.py] => Train Time: 3139.96
2024-04-23 09:13:04,146 [trainer.py] => Test Time: 0 

2024-04-23 09:13:04,148 [trainer.py] => All params: 86109718
2024-04-23 09:13:04,149 [trainer.py] => Trainable params: 152073
2024-04-23 09:13:04,189 [loramoeinc.py] => Learning on 180-240
  0%|          | 0/20 [00:00<?, ?it/s]Task 3, Epoch 1/20 => Loss 2.600, Train_accy 40.73:   0%|          | 0/20 [00:52<?, ?it/s]Task 3, Epoch 1/20 => Loss 2.600, Train_accy 40.73:   5%|▌         | 1/20 [00:52<16:44, 52.85s/it]Task 3, Epoch 2/20 => Loss 2.147, Train_accy 45.12:   5%|▌         | 1/20 [01:45<16:44, 52.85s/it]Task 3, Epoch 2/20 => Loss 2.147, Train_accy 45.12:  10%|█         | 2/20 [01:45<15:53, 52.95s/it]Task 3, Epoch 3/20 => Loss 2.113, Train_accy 45.47:  10%|█         | 2/20 [02:39<15:53, 52.95s/it]Task 3, Epoch 3/20 => Loss 2.113, Train_accy 45.47:  15%|█▌        | 3/20 [02:39<15:03, 53.15s/it]Task 3, Epoch 4/20 => Loss 2.094, Train_accy 45.67:  15%|█▌        | 3/20 [03:32<15:03, 53.15s/it]Task 3, Epoch 4/20 => Loss 2.094, Train_accy 45.67:  20%|██        | 4/20 [03:32<14:09, 53.09s/it]Task 3, Epoch 5/20 => Loss 2.061, Train_accy 45.84:  20%|██        | 4/20 [04:25<14:09, 53.09s/it]Task 3, Epoch 5/20 => Loss 2.061, Train_accy 45.84:  25%|██▌       | 5/20 [04:25<13:17, 53.16s/it]Task 3, Epoch 6/20 => Loss 2.064, Train_accy 46.24:  25%|██▌       | 5/20 [05:18<13:17, 53.16s/it]Task 3, Epoch 6/20 => Loss 2.064, Train_accy 46.24:  30%|███       | 6/20 [05:18<12:22, 53.07s/it]Task 3, Epoch 7/20 => Loss 2.052, Train_accy 46.19:  30%|███       | 6/20 [06:11<12:22, 53.07s/it]Task 3, Epoch 7/20 => Loss 2.052, Train_accy 46.19:  35%|███▌      | 7/20 [06:11<11:28, 52.94s/it]Task 3, Epoch 8/20 => Loss 2.040, Train_accy 46.32:  35%|███▌      | 7/20 [07:03<11:28, 52.94s/it]Task 3, Epoch 8/20 => Loss 2.040, Train_accy 46.32:  40%|████      | 8/20 [07:03<10:34, 52.89s/it]Task 3, Epoch 9/20 => Loss 2.028, Train_accy 46.75:  40%|████      | 8/20 [07:56<10:34, 52.89s/it]Task 3, Epoch 9/20 => Loss 2.028, Train_accy 46.75:  45%|████▌     | 9/20 [07:56<09:41, 52.85s/it]Task 3, Epoch 10/20 => Loss 2.019, Train_accy 46.74:  45%|████▌     | 9/20 [08:49<09:41, 52.85s/it]Task 3, Epoch 10/20 => Loss 2.019, Train_accy 46.74:  50%|█████     | 10/20 [08:49<08:48, 52.83s/it]Task 3, Epoch 11/20 => Loss 2.025, Train_accy 46.52:  50%|█████     | 10/20 [09:42<08:48, 52.83s/it]Task 3, Epoch 11/20 => Loss 2.025, Train_accy 46.52:  55%|█████▌    | 11/20 [09:42<07:55, 52.82s/it]Task 3, Epoch 12/20 => Loss 2.023, Train_accy 46.65:  55%|█████▌    | 11/20 [10:35<07:55, 52.82s/it]Task 3, Epoch 12/20 => Loss 2.023, Train_accy 46.65:  60%|██████    | 12/20 [10:35<07:02, 52.85s/it]Task 3, Epoch 13/20 => Loss 2.008, Train_accy 46.93:  60%|██████    | 12/20 [11:28<07:02, 52.85s/it]Task 3, Epoch 13/20 => Loss 2.008, Train_accy 46.93:  65%|██████▌   | 13/20 [11:28<06:10, 52.88s/it]Task 3, Epoch 14/20 => Loss 2.008, Train_accy 46.65:  65%|██████▌   | 13/20 [12:20<06:10, 52.88s/it]Task 3, Epoch 14/20 => Loss 2.008, Train_accy 46.65:  70%|███████   | 14/20 [12:20<05:17, 52.87s/it]Task 3, Epoch 15/20 => Loss 2.012, Train_accy 46.90:  70%|███████   | 14/20 [13:13<05:17, 52.87s/it]Task 3, Epoch 15/20 => Loss 2.012, Train_accy 46.90:  75%|███████▌  | 15/20 [13:13<04:24, 52.89s/it]Task 3, Epoch 16/20 => Loss 1.998, Train_accy 46.92:  75%|███████▌  | 15/20 [14:06<04:24, 52.89s/it]Task 3, Epoch 16/20 => Loss 1.998, Train_accy 46.92:  80%|████████  | 16/20 [14:06<03:31, 52.87s/it]Task 3, Epoch 17/20 => Loss 1.999, Train_accy 47.02:  80%|████████  | 16/20 [14:59<03:31, 52.87s/it]Task 3, Epoch 17/20 => Loss 1.999, Train_accy 47.02:  85%|████████▌ | 17/20 [14:59<02:38, 52.88s/it]Task 3, Epoch 18/20 => Loss 1.990, Train_accy 47.28:  85%|████████▌ | 17/20 [15:52<02:38, 52.88s/it]Task 3, Epoch 18/20 => Loss 1.990, Train_accy 47.28:  90%|█████████ | 18/20 [15:52<01:45, 52.86s/it]Task 3, Epoch 19/20 => Loss 1.998, Train_accy 46.81:  90%|█████████ | 18/20 [16:45<01:45, 52.86s/it]Task 3, Epoch 19/20 => Loss 1.998, Train_accy 46.81:  95%|█████████▌| 19/20 [16:45<00:52, 52.97s/it]Task 3, Epoch 20/20 => Loss 2.006, Train_accy 46.84:  95%|█████████▌| 19/20 [17:38<00:52, 52.97s/it]Task 3, Epoch 20/20 => Loss 2.006, Train_accy 46.84: 100%|██████████| 20/20 [17:38<00:00, 53.03s/it]Task 3, Epoch 20/20 => Loss 2.006, Train_accy 46.84: 100%|██████████| 20/20 [17:38<00:00, 52.94s/it]
2024-04-23 09:30:43,063 [loramoeinc.py] => Task 3, Epoch 20/20 => Loss 2.006, Train_accy 46.84
2024-04-23 09:32:58,439 [trainer.py] => No NME accuracy.
2024-04-23 09:32:58,439 [trainer.py] => CNN: {'total': 82.48, '00-59': 87.99, '60-119': 82.19, '120-179': 81.37, '180-239': 78.34, 'old': 83.85, 'new': 78.34}
2024-04-23 09:32:58,439 [trainer.py] => Route: {'total': 74.12, '00-59': 75.06, '60-119': 73.58, '120-179': 74.69, '180-239': 73.16, 'old': 74.44, 'new': 73.16}
2024-04-23 09:32:58,439 [trainer.py] => CNN top1 curve: [87.99, 85.09, 83.88, 82.48]
2024-04-23 09:32:58,439 [trainer.py] => CNN top5 curve: [99.08, 97.24, 96.02, 95.15]
2024-04-23 09:32:58,440 [trainer.py] => Route top1 curve: [87.57, 81.42, 76.73, 74.12]
2024-04-23 09:32:58,440 [trainer.py] => Route top5 curve: [98.0, 95.87, 93.26, 91.21]

Average Accuracy (CNN): 84.86
Average Accuracy (Route): 79.96000000000001
2024-04-23 09:32:58,440 [trainer.py] => Average Accuracy (CNN): 84.86
2024-04-23 09:32:58,440 [trainer.py] => Average Accuracy (Route): 79.96000000000001

2024-04-23 09:32:58,440 [trainer.py] => Train Time: 4198.79
2024-04-23 09:32:58,440 [trainer.py] => Test Time: 0 

2024-04-23 09:32:58,441 [trainer.py] => All params: 86201878
2024-04-23 09:32:58,442 [trainer.py] => Trainable params: 191237
2024-04-23 09:32:58,481 [loramoeinc.py] => Learning on 240-300
  0%|          | 0/20 [00:00<?, ?it/s]Task 4, Epoch 1/20 => Loss 2.626, Train_accy 40.69:   0%|          | 0/20 [00:51<?, ?it/s]Task 4, Epoch 1/20 => Loss 2.626, Train_accy 40.69:   5%|▌         | 1/20 [00:51<16:21, 51.65s/it]Task 4, Epoch 2/20 => Loss 2.214, Train_accy 44.43:   5%|▌         | 1/20 [01:43<16:21, 51.65s/it]Task 4, Epoch 2/20 => Loss 2.214, Train_accy 44.43:  10%|█         | 2/20 [01:43<15:30, 51.70s/it]Task 4, Epoch 3/20 => Loss 2.180, Train_accy 45.18:  10%|█         | 2/20 [02:35<15:30, 51.70s/it]Task 4, Epoch 3/20 => Loss 2.180, Train_accy 45.18:  15%|█▌        | 3/20 [02:35<14:38, 51.70s/it]Task 4, Epoch 4/20 => Loss 2.155, Train_accy 45.64:  15%|█▌        | 3/20 [03:26<14:38, 51.70s/it]Task 4, Epoch 4/20 => Loss 2.155, Train_accy 45.64:  20%|██        | 4/20 [03:26<13:46, 51.65s/it]Task 4, Epoch 5/20 => Loss 2.139, Train_accy 46.10:  20%|██        | 4/20 [04:18<13:46, 51.65s/it]Task 4, Epoch 5/20 => Loss 2.139, Train_accy 46.10:  25%|██▌       | 5/20 [04:18<12:55, 51.71s/it]Task 4, Epoch 6/20 => Loss 2.134, Train_accy 45.92:  25%|██▌       | 5/20 [05:10<12:55, 51.71s/it]Task 4, Epoch 6/20 => Loss 2.134, Train_accy 45.92:  30%|███       | 6/20 [05:10<12:04, 51.75s/it]Task 4, Epoch 7/20 => Loss 2.129, Train_accy 46.06:  30%|███       | 6/20 [06:02<12:04, 51.75s/it]Task 4, Epoch 7/20 => Loss 2.129, Train_accy 46.06:  35%|███▌      | 7/20 [06:02<11:13, 51.78s/it]Task 4, Epoch 8/20 => Loss 2.121, Train_accy 46.16:  35%|███▌      | 7/20 [06:53<11:13, 51.78s/it]Task 4, Epoch 8/20 => Loss 2.121, Train_accy 46.16:  40%|████      | 8/20 [06:53<10:21, 51.77s/it]Task 4, Epoch 9/20 => Loss 2.125, Train_accy 46.01:  40%|████      | 8/20 [07:45<10:21, 51.77s/it]Task 4, Epoch 9/20 => Loss 2.125, Train_accy 46.01:  45%|████▌     | 9/20 [07:45<09:29, 51.73s/it]Task 4, Epoch 10/20 => Loss 2.107, Train_accy 46.30:  45%|████▌     | 9/20 [08:37<09:29, 51.73s/it]Task 4, Epoch 10/20 => Loss 2.107, Train_accy 46.30:  50%|█████     | 10/20 [08:37<08:38, 51.83s/it]Task 4, Epoch 11/20 => Loss 2.093, Train_accy 46.63:  50%|█████     | 10/20 [09:29<08:38, 51.83s/it]Task 4, Epoch 11/20 => Loss 2.093, Train_accy 46.63:  55%|█████▌    | 11/20 [09:29<07:46, 51.80s/it]Task 4, Epoch 12/20 => Loss 2.104, Train_accy 46.50:  55%|█████▌    | 11/20 [10:21<07:46, 51.80s/it]Task 4, Epoch 12/20 => Loss 2.104, Train_accy 46.50:  60%|██████    | 12/20 [10:21<06:54, 51.78s/it]Task 4, Epoch 13/20 => Loss 2.093, Train_accy 46.61:  60%|██████    | 12/20 [11:12<06:54, 51.78s/it]Task 4, Epoch 13/20 => Loss 2.093, Train_accy 46.61:  65%|██████▌   | 13/20 [11:12<06:02, 51.82s/it]Task 4, Epoch 14/20 => Loss 2.092, Train_accy 46.71:  65%|██████▌   | 13/20 [12:04<06:02, 51.82s/it]Task 4, Epoch 14/20 => Loss 2.092, Train_accy 46.71:  70%|███████   | 14/20 [12:04<05:10, 51.75s/it]Task 4, Epoch 15/20 => Loss 2.100, Train_accy 46.43:  70%|███████   | 14/20 [12:56<05:10, 51.75s/it]Task 4, Epoch 15/20 => Loss 2.100, Train_accy 46.43:  75%|███████▌  | 15/20 [12:56<04:18, 51.70s/it]Task 4, Epoch 16/20 => Loss 2.096, Train_accy 46.61:  75%|███████▌  | 15/20 [13:47<04:18, 51.70s/it]Task 4, Epoch 16/20 => Loss 2.096, Train_accy 46.61:  80%|████████  | 16/20 [13:47<03:26, 51.74s/it]Task 4, Epoch 17/20 => Loss 2.083, Train_accy 46.61:  80%|████████  | 16/20 [14:40<03:26, 51.74s/it]Task 4, Epoch 17/20 => Loss 2.083, Train_accy 46.61:  85%|████████▌ | 17/20 [14:40<02:35, 51.98s/it]Task 4, Epoch 18/20 => Loss 2.082, Train_accy 46.65:  85%|████████▌ | 17/20 [15:32<02:35, 51.98s/it]Task 4, Epoch 18/20 => Loss 2.082, Train_accy 46.65:  90%|█████████ | 18/20 [15:32<01:44, 52.09s/it]Task 4, Epoch 19/20 => Loss 2.085, Train_accy 46.66:  90%|█████████ | 18/20 [16:25<01:44, 52.09s/it]Task 4, Epoch 19/20 => Loss 2.085, Train_accy 46.66:  95%|█████████▌| 19/20 [16:25<00:52, 52.14s/it]Task 4, Epoch 20/20 => Loss 2.094, Train_accy 46.46:  95%|█████████▌| 19/20 [17:17<00:52, 52.14s/it]Task 4, Epoch 20/20 => Loss 2.094, Train_accy 46.46: 100%|██████████| 20/20 [17:17<00:00, 52.20s/it]Task 4, Epoch 20/20 => Loss 2.094, Train_accy 46.46: 100%|██████████| 20/20 [17:17<00:00, 51.87s/it]
2024-04-23 09:50:15,971 [loramoeinc.py] => Task 4, Epoch 20/20 => Loss 2.094, Train_accy 46.46
2024-04-23 09:52:37,642 [trainer.py] => No NME accuracy.
2024-04-23 09:52:37,643 [trainer.py] => CNN: {'total': 83.17, '00-59': 87.99, '60-119': 82.19, '120-179': 81.37, '180-239': 78.34, '240-299': 85.96, 'old': 82.48, 'new': 85.96}
2024-04-23 09:52:37,643 [trainer.py] => Route: {'total': 73.3, '00-59': 74.23, '60-119': 71.15, '120-179': 71.85, '180-239': 72.07, '240-299': 77.19, 'old': 72.33, 'new': 77.19}
2024-04-23 09:52:37,643 [trainer.py] => CNN top1 curve: [87.99, 85.09, 83.88, 82.48, 83.17]
2024-04-23 09:52:37,643 [trainer.py] => CNN top5 curve: [99.08, 97.24, 96.02, 95.15, 95.46]
2024-04-23 09:52:37,643 [trainer.py] => Route top1 curve: [87.57, 81.42, 76.73, 74.12, 73.3]
2024-04-23 09:52:37,643 [trainer.py] => Route top5 curve: [98.0, 95.87, 93.26, 91.21, 91.45]

Average Accuracy (CNN): 84.522
Average Accuracy (Route): 78.62800000000001
2024-04-23 09:52:37,643 [trainer.py] => Average Accuracy (CNN): 84.522
2024-04-23 09:52:37,644 [trainer.py] => Average Accuracy (Route): 78.62800000000001

2024-04-23 09:52:37,644 [trainer.py] => Train Time: 5236.24
2024-04-23 09:52:37,644 [trainer.py] => Test Time: 0 

