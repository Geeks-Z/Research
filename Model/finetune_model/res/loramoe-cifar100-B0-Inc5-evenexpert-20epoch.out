nohup: 忽略输入
2024-04-19 10:55:13,715 [trainer.py] => config: ./exps/loramoe_inc.json
2024-04-19 10:55:13,715 [trainer.py] => prefix: reproduce
2024-04-19 10:55:13,715 [trainer.py] => dataset: cifar224
2024-04-19 10:55:13,715 [trainer.py] => memory_size: 0
2024-04-19 10:55:13,715 [trainer.py] => memory_per_class: 0
2024-04-19 10:55:13,715 [trainer.py] => fixed_memory: False
2024-04-19 10:55:13,715 [trainer.py] => shuffle: True
2024-04-19 10:55:13,715 [trainer.py] => init_cls: 20
2024-04-19 10:55:13,715 [trainer.py] => increment: 20
2024-04-19 10:55:13,715 [trainer.py] => model_name: loramoeinc
2024-04-19 10:55:13,715 [trainer.py] => backbone_type: pretrained_vit_b16_224_inc
2024-04-19 10:55:13,715 [trainer.py] => device: [device(type='cuda', index=5)]
2024-04-19 10:55:13,715 [trainer.py] => seed: 1993
2024-04-19 10:55:13,715 [trainer.py] => tuned_epoch: 20
2024-04-19 10:55:13,715 [trainer.py] => init_lr: 0.01
2024-04-19 10:55:13,715 [trainer.py] => batch_size: 48
2024-04-19 10:55:13,715 [trainer.py] => weight_decay: 0.0005
2024-04-19 10:55:13,716 [trainer.py] => min_lr: 0
2024-04-19 10:55:13,716 [trainer.py] => ffn_num: 4
2024-04-19 10:55:13,716 [trainer.py] => optimizer: sgd
2024-04-19 10:55:13,716 [trainer.py] => vpt_type: shallow
2024-04-19 10:55:13,716 [trainer.py] => prompt_token_num: 5
2024-04-19 10:55:13,716 [trainer.py] => expert_num: 5
2024-04-19 10:55:15,313 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
/home/team/zhaohongwei/anaconda3/envs/peft/lib/python3.10/site-packages/bitsandbytes/cuda_setup/main.py:136: UserWarning: /home/team/zhaohongwei/anaconda3/envs/peft did not contain libcudart.so as expected! Searching further paths...
  warn(msg)

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please submit your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
CUDA SETUP: CUDA runtime path found: /usr/local/cuda-11.8/lib64/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 8.6
CUDA SETUP: Detected CUDA version 118
CUDA SETUP: Loading binary /home/team/zhaohongwei/anaconda3/envs/peft/lib/python3.10/site-packages/bitsandbytes/libbitsandbytes_cuda118.so...
I'm using ViT with adapters.
2024-04-19 10:55:19,528 [trainer.py] => All params: 86006136
2024-04-19 10:55:19,529 [trainer.py] => Trainable params: 207480
2024-04-19 10:55:19,624 [loramoeinc.py] => Learning on 0-20
  0%|          | 0/20 [00:00<?, ?it/s]Task 0, Epoch 1/20 => Loss 2.074, Train_accy 61.76:   0%|          | 0/20 [00:50<?, ?it/s]Task 0, Epoch 1/20 => Loss 2.074, Train_accy 61.76:   5%|▌         | 1/20 [00:50<15:53, 50.17s/it]Task 0, Epoch 2/20 => Loss 0.589, Train_accy 85.66:   5%|▌         | 1/20 [01:40<15:53, 50.17s/it]Task 0, Epoch 2/20 => Loss 0.589, Train_accy 85.66:  10%|█         | 2/20 [01:40<15:04, 50.25s/it]Task 0, Epoch 3/20 => Loss 0.493, Train_accy 86.56:  10%|█         | 2/20 [02:31<15:04, 50.25s/it]Task 0, Epoch 3/20 => Loss 0.493, Train_accy 86.56:  15%|█▌        | 3/20 [02:31<14:16, 50.39s/it]Task 0, Epoch 4/20 => Loss 0.452, Train_accy 87.82:  15%|█▌        | 3/20 [03:21<14:16, 50.39s/it]Task 0, Epoch 4/20 => Loss 0.452, Train_accy 87.82:  20%|██        | 4/20 [03:21<13:27, 50.47s/it]Task 0, Epoch 5/20 => Loss 0.426, Train_accy 88.02:  20%|██        | 4/20 [04:12<13:27, 50.47s/it]Task 0, Epoch 5/20 => Loss 0.426, Train_accy 88.02:  25%|██▌       | 5/20 [04:12<12:38, 50.55s/it]Task 0, Epoch 6/20 => Loss 0.416, Train_accy 88.26:  25%|██▌       | 5/20 [05:03<12:38, 50.55s/it]Task 0, Epoch 6/20 => Loss 0.416, Train_accy 88.26:  30%|███       | 6/20 [05:03<11:48, 50.64s/it]Task 0, Epoch 7/20 => Loss 0.392, Train_accy 88.43:  30%|███       | 6/20 [05:54<11:48, 50.64s/it]Task 0, Epoch 7/20 => Loss 0.392, Train_accy 88.43:  35%|███▌      | 7/20 [05:54<10:59, 50.75s/it]Task 0, Epoch 8/20 => Loss 0.396, Train_accy 88.28:  35%|███▌      | 7/20 [06:44<10:59, 50.75s/it]Task 0, Epoch 8/20 => Loss 0.396, Train_accy 88.28:  40%|████      | 8/20 [06:44<10:08, 50.70s/it]Task 0, Epoch 9/20 => Loss 0.356, Train_accy 89.73:  40%|████      | 8/20 [07:35<10:08, 50.70s/it]Task 0, Epoch 9/20 => Loss 0.356, Train_accy 89.73:  45%|████▌     | 9/20 [07:35<09:17, 50.71s/it]Task 0, Epoch 10/20 => Loss 0.363, Train_accy 89.55:  45%|████▌     | 9/20 [08:25<09:17, 50.71s/it]Task 0, Epoch 10/20 => Loss 0.363, Train_accy 89.55:  50%|█████     | 10/20 [08:25<08:26, 50.67s/it]Task 0, Epoch 11/20 => Loss 0.349, Train_accy 89.80:  50%|█████     | 10/20 [09:16<08:26, 50.67s/it]Task 0, Epoch 11/20 => Loss 0.349, Train_accy 89.80:  55%|█████▌    | 11/20 [09:16<07:36, 50.69s/it]Task 0, Epoch 12/20 => Loss 0.330, Train_accy 90.33:  55%|█████▌    | 11/20 [10:08<07:36, 50.69s/it]Task 0, Epoch 12/20 => Loss 0.330, Train_accy 90.33:  60%|██████    | 12/20 [10:08<06:47, 50.88s/it]Task 0, Epoch 13/20 => Loss 0.327, Train_accy 90.56:  60%|██████    | 12/20 [11:04<06:47, 50.88s/it]Task 0, Epoch 13/20 => Loss 0.327, Train_accy 90.56:  65%|██████▌   | 13/20 [11:04<06:07, 52.46s/it]Task 0, Epoch 14/20 => Loss 0.319, Train_accy 90.31:  65%|██████▌   | 13/20 [12:00<06:07, 52.46s/it]Task 0, Epoch 14/20 => Loss 0.319, Train_accy 90.31:  70%|███████   | 14/20 [12:00<05:21, 53.59s/it]Task 0, Epoch 15/20 => Loss 0.297, Train_accy 91.28:  70%|███████   | 14/20 [12:56<05:21, 53.59s/it]Task 0, Epoch 15/20 => Loss 0.297, Train_accy 91.28:  75%|███████▌  | 15/20 [12:56<04:31, 54.39s/it]Task 0, Epoch 16/20 => Loss 0.305, Train_accy 91.09:  75%|███████▌  | 15/20 [13:52<04:31, 54.39s/it]Task 0, Epoch 16/20 => Loss 0.305, Train_accy 91.09:  80%|████████  | 16/20 [13:52<03:39, 54.90s/it]Task 0, Epoch 17/20 => Loss 0.291, Train_accy 91.47:  80%|████████  | 16/20 [14:49<03:39, 54.90s/it]Task 0, Epoch 17/20 => Loss 0.291, Train_accy 91.47:  85%|████████▌ | 17/20 [14:49<02:45, 55.33s/it]Task 0, Epoch 18/20 => Loss 0.299, Train_accy 91.37:  85%|████████▌ | 17/20 [15:40<02:45, 55.33s/it]Task 0, Epoch 18/20 => Loss 0.299, Train_accy 91.37:  90%|█████████ | 18/20 [15:40<01:48, 54.17s/it]Task 0, Epoch 19/20 => Loss 0.287, Train_accy 91.62:  90%|█████████ | 18/20 [16:31<01:48, 54.17s/it]Task 0, Epoch 19/20 => Loss 0.287, Train_accy 91.62:  95%|█████████▌| 19/20 [16:31<00:53, 53.12s/it]Task 0, Epoch 20/20 => Loss 0.291, Train_accy 91.33:  95%|█████████▌| 19/20 [17:22<00:53, 53.12s/it]Task 0, Epoch 20/20 => Loss 0.291, Train_accy 91.33: 100%|██████████| 20/20 [17:22<00:00, 52.54s/it]Task 0, Epoch 20/20 => Loss 0.291, Train_accy 91.33: 100%|██████████| 20/20 [17:22<00:00, 52.12s/it]
2024-04-19 11:12:42,071 [loramoeinc.py] => Task 0, Epoch 20/20 => Loss 0.291, Train_accy 91.33
2024-04-19 11:14:24,727 [trainer.py] => No NME accuracy.
2024-04-19 11:14:24,727 [trainer.py] => CNN: {'total': 97.8, '00-19': 97.8, 'old': 0, 'new': 97.8}
2024-04-19 11:14:24,727 [trainer.py] => Route: {'total': 92.2, '00-19': 92.2, 'old': 0, 'new': 92.2}
2024-04-19 11:14:24,727 [trainer.py] => CNN top1 curve: [97.8]
2024-04-19 11:14:24,727 [trainer.py] => CNN top5 curve: [99.75]
2024-04-19 11:14:24,727 [trainer.py] => Route top1 curve: [92.2]
2024-04-19 11:14:24,727 [trainer.py] => Route top5 curve: [98.7]

Average Accuracy (CNN): 97.8
Average Accuracy (Route): 92.2
2024-04-19 11:14:24,727 [trainer.py] => Average Accuracy (CNN): 97.8
2024-04-19 11:14:24,728 [trainer.py] => Average Accuracy (Route): 92.2

2024-04-19 11:14:24,728 [trainer.py] => Train Time: 1042.33
2024-04-19 11:14:24,728 [trainer.py] => Test Time: 10.81 

2024-04-19 11:14:24,729 [trainer.py] => All params: 86036858
2024-04-19 11:14:24,730 [trainer.py] => Trainable params: 181345
2024-04-19 11:14:24,732 [loramoeinc.py] => Learning on 20-40
  0%|          | 0/20 [00:00<?, ?it/s]Task 1, Epoch 1/20 => Loss 1.321, Train_accy 68.96:   0%|          | 0/20 [00:50<?, ?it/s]Task 1, Epoch 1/20 => Loss 1.321, Train_accy 68.96:   5%|▌         | 1/20 [00:50<16:02, 50.66s/it]Task 1, Epoch 2/20 => Loss 0.775, Train_accy 79.66:   5%|▌         | 1/20 [01:41<16:02, 50.66s/it]Task 1, Epoch 2/20 => Loss 0.775, Train_accy 79.66:  10%|█         | 2/20 [01:41<15:13, 50.72s/it]Task 1, Epoch 3/20 => Loss 0.666, Train_accy 81.50:  10%|█         | 2/20 [02:32<15:13, 50.72s/it]Task 1, Epoch 3/20 => Loss 0.666, Train_accy 81.50:  15%|█▌        | 3/20 [02:32<14:25, 50.89s/it]Task 1, Epoch 4/20 => Loss 0.639, Train_accy 81.42:  15%|█▌        | 3/20 [03:23<14:25, 50.89s/it]Task 1, Epoch 4/20 => Loss 0.639, Train_accy 81.42:  20%|██        | 4/20 [03:23<13:34, 50.90s/it]Task 1, Epoch 5/20 => Loss 0.595, Train_accy 82.39:  20%|██        | 4/20 [04:14<13:34, 50.90s/it]Task 1, Epoch 5/20 => Loss 0.595, Train_accy 82.39:  25%|██▌       | 5/20 [04:14<12:44, 51.00s/it]Task 1, Epoch 6/20 => Loss 0.557, Train_accy 83.41:  25%|██▌       | 5/20 [05:05<12:44, 51.00s/it]Task 1, Epoch 6/20 => Loss 0.557, Train_accy 83.41:  30%|███       | 6/20 [05:05<11:54, 51.05s/it]Task 1, Epoch 7/20 => Loss 0.543, Train_accy 83.23:  30%|███       | 6/20 [05:56<11:54, 51.05s/it]Task 1, Epoch 7/20 => Loss 0.543, Train_accy 83.23:  35%|███▌      | 7/20 [05:56<11:04, 51.08s/it]Task 1, Epoch 8/20 => Loss 0.502, Train_accy 84.33:  35%|███▌      | 7/20 [06:47<11:04, 51.08s/it]Task 1, Epoch 8/20 => Loss 0.502, Train_accy 84.33:  40%|████      | 8/20 [06:47<10:12, 51.07s/it]Task 1, Epoch 9/20 => Loss 0.486, Train_accy 84.68:  40%|████      | 8/20 [07:38<10:12, 51.07s/it]Task 1, Epoch 9/20 => Loss 0.486, Train_accy 84.68:  45%|████▌     | 9/20 [07:38<09:20, 50.99s/it]Task 1, Epoch 10/20 => Loss 0.460, Train_accy 85.04:  45%|████▌     | 9/20 [08:29<09:20, 50.99s/it]Task 1, Epoch 10/20 => Loss 0.460, Train_accy 85.04:  50%|█████     | 10/20 [08:29<08:30, 51.03s/it]Task 1, Epoch 11/20 => Loss 0.457, Train_accy 85.21:  50%|█████     | 10/20 [09:20<08:30, 51.03s/it]Task 1, Epoch 11/20 => Loss 0.457, Train_accy 85.21:  55%|█████▌    | 11/20 [09:20<07:38, 50.99s/it]Task 1, Epoch 12/20 => Loss 0.425, Train_accy 85.86:  55%|█████▌    | 11/20 [10:11<07:38, 50.99s/it]Task 1, Epoch 12/20 => Loss 0.425, Train_accy 85.86:  60%|██████    | 12/20 [10:11<06:48, 51.05s/it]Task 1, Epoch 13/20 => Loss 0.405, Train_accy 86.16:  60%|██████    | 12/20 [11:03<06:48, 51.05s/it]Task 1, Epoch 13/20 => Loss 0.405, Train_accy 86.16:  65%|██████▌   | 13/20 [11:03<05:57, 51.10s/it]Task 1, Epoch 14/20 => Loss 0.416, Train_accy 85.85:  65%|██████▌   | 13/20 [11:54<05:57, 51.10s/it]Task 1, Epoch 14/20 => Loss 0.416, Train_accy 85.85:  70%|███████   | 14/20 [11:54<05:06, 51.07s/it]Task 1, Epoch 15/20 => Loss 0.397, Train_accy 86.31:  70%|███████   | 14/20 [12:45<05:06, 51.07s/it]Task 1, Epoch 15/20 => Loss 0.397, Train_accy 86.31:  75%|███████▌  | 15/20 [12:45<04:15, 51.12s/it]Task 1, Epoch 16/20 => Loss 0.384, Train_accy 86.58:  75%|███████▌  | 15/20 [13:36<04:15, 51.12s/it]Task 1, Epoch 16/20 => Loss 0.384, Train_accy 86.58:  80%|████████  | 16/20 [13:36<03:24, 51.17s/it]Task 1, Epoch 17/20 => Loss 0.365, Train_accy 87.48:  80%|████████  | 16/20 [14:27<03:24, 51.17s/it]Task 1, Epoch 17/20 => Loss 0.365, Train_accy 87.48:  85%|████████▌ | 17/20 [14:27<02:33, 51.18s/it]Task 1, Epoch 18/20 => Loss 0.359, Train_accy 87.42:  85%|████████▌ | 17/20 [15:18<02:33, 51.18s/it]Task 1, Epoch 18/20 => Loss 0.359, Train_accy 87.42:  90%|█████████ | 18/20 [15:18<01:42, 51.14s/it]Task 1, Epoch 19/20 => Loss 0.366, Train_accy 87.26:  90%|█████████ | 18/20 [16:09<01:42, 51.14s/it]Task 1, Epoch 19/20 => Loss 0.366, Train_accy 87.26:  95%|█████████▌| 19/20 [16:09<00:50, 50.97s/it]Task 1, Epoch 20/20 => Loss 0.353, Train_accy 87.48:  95%|█████████▌| 19/20 [17:00<00:50, 50.97s/it]Task 1, Epoch 20/20 => Loss 0.353, Train_accy 87.48: 100%|██████████| 20/20 [17:00<00:00, 50.87s/it]Task 1, Epoch 20/20 => Loss 0.353, Train_accy 87.48: 100%|██████████| 20/20 [17:00<00:00, 51.01s/it]
2024-04-19 11:31:24,956 [loramoeinc.py] => Task 1, Epoch 20/20 => Loss 0.353, Train_accy 87.48
2024-04-19 11:32:45,411 [trainer.py] => No NME accuracy.
2024-04-19 11:32:45,411 [trainer.py] => CNN: {'total': 97.45, '00-19': 97.8, '20-39': 97.1, 'old': 97.8, 'new': 97.1}
2024-04-19 11:32:45,411 [trainer.py] => Route: {'total': 89.1, '00-19': 88.6, '20-39': 89.6, 'old': 88.6, 'new': 89.6}
2024-04-19 11:32:45,411 [trainer.py] => CNN top1 curve: [97.8, 97.45]
2024-04-19 11:32:45,411 [trainer.py] => CNN top5 curve: [99.75, 99.8]
2024-04-19 11:32:45,411 [trainer.py] => Route top1 curve: [92.2, 89.1]
2024-04-19 11:32:45,412 [trainer.py] => Route top5 curve: [98.7, 97.92]

Average Accuracy (CNN): 97.625
Average Accuracy (Route): 90.65
2024-04-19 11:32:45,412 [trainer.py] => Average Accuracy (CNN): 97.625
2024-04-19 11:32:45,412 [trainer.py] => Average Accuracy (Route): 90.65

2024-04-19 11:32:45,412 [trainer.py] => Train Time: 2062.48
2024-04-19 11:32:45,412 [trainer.py] => Test Time: 31.200000000000003 

2024-04-19 11:32:45,413 [trainer.py] => All params: 86067578
2024-04-19 11:32:45,414 [trainer.py] => Trainable params: 155209
2024-04-19 11:32:45,416 [loramoeinc.py] => Learning on 40-60
  0%|          | 0/20 [00:00<?, ?it/s]Task 2, Epoch 1/20 => Loss 0.825, Train_accy 78.91:   0%|          | 0/20 [00:50<?, ?it/s]Task 2, Epoch 1/20 => Loss 0.825, Train_accy 78.91:   5%|▌         | 1/20 [00:50<15:55, 50.27s/it]Task 2, Epoch 2/20 => Loss 0.539, Train_accy 85.90:   5%|▌         | 1/20 [01:40<15:55, 50.27s/it]Task 2, Epoch 2/20 => Loss 0.539, Train_accy 85.90:  10%|█         | 2/20 [01:40<15:05, 50.30s/it]Task 2, Epoch 3/20 => Loss 0.507, Train_accy 86.54:  10%|█         | 2/20 [02:31<15:05, 50.30s/it]Task 2, Epoch 3/20 => Loss 0.507, Train_accy 86.54:  15%|█▌        | 3/20 [02:31<14:16, 50.41s/it]Task 2, Epoch 4/20 => Loss 0.468, Train_accy 87.49:  15%|█▌        | 3/20 [03:21<14:16, 50.41s/it]Task 2, Epoch 4/20 => Loss 0.468, Train_accy 87.49:  20%|██        | 4/20 [03:21<13:27, 50.48s/it]Task 2, Epoch 5/20 => Loss 0.447, Train_accy 87.72:  20%|██        | 4/20 [04:12<13:27, 50.48s/it]Task 2, Epoch 5/20 => Loss 0.447, Train_accy 87.72:  25%|██▌       | 5/20 [04:12<12:38, 50.56s/it]Task 2, Epoch 6/20 => Loss 0.423, Train_accy 88.52:  25%|██▌       | 5/20 [05:02<12:38, 50.56s/it]Task 2, Epoch 6/20 => Loss 0.423, Train_accy 88.52:  30%|███       | 6/20 [05:02<11:46, 50.47s/it]Task 2, Epoch 7/20 => Loss 0.416, Train_accy 88.80:  30%|███       | 6/20 [05:53<11:46, 50.47s/it]Task 2, Epoch 7/20 => Loss 0.416, Train_accy 88.80:  35%|███▌      | 7/20 [05:53<10:55, 50.44s/it]Task 2, Epoch 8/20 => Loss 0.400, Train_accy 89.18:  35%|███▌      | 7/20 [06:43<10:55, 50.44s/it]Task 2, Epoch 8/20 => Loss 0.400, Train_accy 89.18:  40%|████      | 8/20 [06:43<10:05, 50.46s/it]Task 2, Epoch 9/20 => Loss 0.396, Train_accy 88.55:  40%|████      | 8/20 [07:34<10:05, 50.46s/it]Task 2, Epoch 9/20 => Loss 0.396, Train_accy 88.55:  45%|████▌     | 9/20 [07:34<09:15, 50.53s/it]Task 2, Epoch 10/20 => Loss 0.376, Train_accy 89.41:  45%|████▌     | 9/20 [08:24<09:15, 50.53s/it]Task 2, Epoch 10/20 => Loss 0.376, Train_accy 89.41:  50%|█████     | 10/20 [08:24<08:25, 50.50s/it]Task 2, Epoch 11/20 => Loss 0.365, Train_accy 90.10:  50%|█████     | 10/20 [09:15<08:25, 50.50s/it]Task 2, Epoch 11/20 => Loss 0.365, Train_accy 90.10:  55%|█████▌    | 11/20 [09:15<07:34, 50.45s/it]Task 2, Epoch 12/20 => Loss 0.356, Train_accy 90.25:  55%|█████▌    | 11/20 [10:05<07:34, 50.45s/it]Task 2, Epoch 12/20 => Loss 0.356, Train_accy 90.25:  60%|██████    | 12/20 [10:05<06:43, 50.43s/it]Task 2, Epoch 13/20 => Loss 0.336, Train_accy 90.33:  60%|██████    | 12/20 [10:55<06:43, 50.43s/it]Task 2, Epoch 13/20 => Loss 0.336, Train_accy 90.33:  65%|██████▌   | 13/20 [10:55<05:52, 50.37s/it]Task 2, Epoch 14/20 => Loss 0.323, Train_accy 90.63:  65%|██████▌   | 13/20 [11:46<05:52, 50.37s/it]Task 2, Epoch 14/20 => Loss 0.323, Train_accy 90.63:  70%|███████   | 14/20 [11:46<05:02, 50.43s/it]Task 2, Epoch 15/20 => Loss 0.316, Train_accy 91.15:  70%|███████   | 14/20 [12:36<05:02, 50.43s/it]Task 2, Epoch 15/20 => Loss 0.316, Train_accy 91.15:  75%|███████▌  | 15/20 [12:36<04:12, 50.41s/it]Task 2, Epoch 16/20 => Loss 0.317, Train_accy 91.32:  75%|███████▌  | 15/20 [13:27<04:12, 50.41s/it]Task 2, Epoch 16/20 => Loss 0.317, Train_accy 91.32:  80%|████████  | 16/20 [13:27<03:21, 50.44s/it]Task 2, Epoch 17/20 => Loss 0.311, Train_accy 91.38:  80%|████████  | 16/20 [14:17<03:21, 50.44s/it]Task 2, Epoch 17/20 => Loss 0.311, Train_accy 91.38:  85%|████████▌ | 17/20 [14:17<02:31, 50.45s/it]Task 2, Epoch 18/20 => Loss 0.294, Train_accy 92.06:  85%|████████▌ | 17/20 [15:07<02:31, 50.45s/it]Task 2, Epoch 18/20 => Loss 0.294, Train_accy 92.06:  90%|█████████ | 18/20 [15:07<01:40, 50.39s/it]Task 2, Epoch 19/20 => Loss 0.286, Train_accy 92.05:  90%|█████████ | 18/20 [15:58<01:40, 50.39s/it]Task 2, Epoch 19/20 => Loss 0.286, Train_accy 92.05:  95%|█████████▌| 19/20 [15:58<00:50, 50.42s/it]Task 2, Epoch 20/20 => Loss 0.286, Train_accy 91.99:  95%|█████████▌| 19/20 [16:48<00:50, 50.42s/it]Task 2, Epoch 20/20 => Loss 0.286, Train_accy 91.99: 100%|██████████| 20/20 [16:48<00:00, 50.41s/it]Task 2, Epoch 20/20 => Loss 0.286, Train_accy 91.99: 100%|██████████| 20/20 [16:48<00:00, 50.44s/it]
2024-04-19 11:49:34,241 [loramoeinc.py] => Task 2, Epoch 20/20 => Loss 0.286, Train_accy 91.99
2024-04-19 11:51:01,728 [trainer.py] => No NME accuracy.
2024-04-19 11:51:01,728 [trainer.py] => CNN: {'total': 97.0, '00-19': 97.8, '20-39': 96.3, '40-59': 96.9, 'old': 97.05, 'new': 96.9}
2024-04-19 11:51:01,729 [trainer.py] => Route: {'total': 85.43, '00-19': 85.95, '20-39': 86.45, '40-59': 83.9, 'old': 86.2, 'new': 83.9}
2024-04-19 11:51:01,729 [trainer.py] => CNN top1 curve: [97.8, 97.45, 97.0]
2024-04-19 11:51:01,729 [trainer.py] => CNN top5 curve: [99.75, 99.8, 99.72]
2024-04-19 11:51:01,729 [trainer.py] => Route top1 curve: [92.2, 89.1, 85.43]
2024-04-19 11:51:01,729 [trainer.py] => Route top5 curve: [98.7, 97.92, 96.65]

Average Accuracy (CNN): 97.41666666666667
Average Accuracy (Route): 88.91000000000001
2024-04-19 11:51:01,729 [trainer.py] => Average Accuracy (CNN): 97.41666666666667
2024-04-19 11:51:01,729 [trainer.py] => Average Accuracy (Route): 88.91000000000001

2024-04-19 11:51:01,729 [trainer.py] => Train Time: 3071.19
2024-04-19 11:51:01,729 [trainer.py] => Test Time: 61.58 

2024-04-19 11:51:01,731 [trainer.py] => All params: 86098298
2024-04-19 11:51:01,732 [trainer.py] => Trainable params: 129073
2024-04-19 11:51:01,735 [loramoeinc.py] => Learning on 60-80
  0%|          | 0/20 [00:00<?, ?it/s]Task 3, Epoch 1/20 => Loss 1.015, Train_accy 76.76:   0%|          | 0/20 [00:50<?, ?it/s]Task 3, Epoch 1/20 => Loss 1.015, Train_accy 76.76:   5%|▌         | 1/20 [00:50<15:54, 50.25s/it]Task 3, Epoch 2/20 => Loss 0.635, Train_accy 84.12:   5%|▌         | 1/20 [01:40<15:54, 50.25s/it]Task 3, Epoch 2/20 => Loss 0.635, Train_accy 84.12:  10%|█         | 2/20 [01:40<15:04, 50.25s/it]Task 3, Epoch 3/20 => Loss 0.590, Train_accy 85.19:  10%|█         | 2/20 [02:30<15:04, 50.25s/it]Task 3, Epoch 3/20 => Loss 0.590, Train_accy 85.19:  15%|█▌        | 3/20 [02:30<14:14, 50.28s/it]Task 3, Epoch 4/20 => Loss 0.560, Train_accy 85.26:  15%|█▌        | 3/20 [03:21<14:14, 50.28s/it]Task 3, Epoch 4/20 => Loss 0.560, Train_accy 85.26:  20%|██        | 4/20 [03:21<13:24, 50.30s/it]Task 3, Epoch 5/20 => Loss 0.515, Train_accy 86.65:  20%|██        | 4/20 [04:11<13:24, 50.30s/it]Task 3, Epoch 5/20 => Loss 0.515, Train_accy 86.65:  25%|██▌       | 5/20 [04:11<12:35, 50.38s/it]Task 3, Epoch 6/20 => Loss 0.529, Train_accy 86.45:  25%|██▌       | 5/20 [05:02<12:35, 50.38s/it]Task 3, Epoch 6/20 => Loss 0.529, Train_accy 86.45:  30%|███       | 6/20 [05:02<11:45, 50.40s/it]Task 3, Epoch 7/20 => Loss 0.469, Train_accy 87.67:  30%|███       | 6/20 [05:52<11:45, 50.40s/it]Task 3, Epoch 7/20 => Loss 0.469, Train_accy 87.67:  35%|███▌      | 7/20 [05:52<10:55, 50.39s/it]Task 3, Epoch 8/20 => Loss 0.461, Train_accy 88.13:  35%|███▌      | 7/20 [06:42<10:55, 50.39s/it]Task 3, Epoch 8/20 => Loss 0.461, Train_accy 88.13:  40%|████      | 8/20 [06:42<10:04, 50.38s/it]Task 3, Epoch 9/20 => Loss 0.422, Train_accy 89.03:  40%|████      | 8/20 [07:33<10:04, 50.38s/it]Task 3, Epoch 9/20 => Loss 0.422, Train_accy 89.03:  45%|████▌     | 9/20 [07:33<09:14, 50.45s/it]Task 3, Epoch 10/20 => Loss 0.420, Train_accy 89.04:  45%|████▌     | 9/20 [08:23<09:14, 50.45s/it]Task 3, Epoch 10/20 => Loss 0.420, Train_accy 89.04:  50%|█████     | 10/20 [08:23<08:24, 50.43s/it]Task 3, Epoch 11/20 => Loss 0.405, Train_accy 89.41:  50%|█████     | 10/20 [09:14<08:24, 50.43s/it]Task 3, Epoch 11/20 => Loss 0.405, Train_accy 89.41:  55%|█████▌    | 11/20 [09:14<07:33, 50.39s/it]Task 3, Epoch 12/20 => Loss 0.412, Train_accy 88.85:  55%|█████▌    | 11/20 [10:04<07:33, 50.39s/it]Task 3, Epoch 12/20 => Loss 0.412, Train_accy 88.85:  60%|██████    | 12/20 [10:04<06:42, 50.36s/it]Task 3, Epoch 13/20 => Loss 0.384, Train_accy 90.14:  60%|██████    | 12/20 [10:55<06:42, 50.36s/it]Task 3, Epoch 13/20 => Loss 0.384, Train_accy 90.14:  65%|██████▌   | 13/20 [10:55<05:53, 50.44s/it]Task 3, Epoch 14/20 => Loss 0.353, Train_accy 90.47:  65%|██████▌   | 13/20 [11:45<05:53, 50.44s/it]Task 3, Epoch 14/20 => Loss 0.353, Train_accy 90.47:  70%|███████   | 14/20 [11:45<05:02, 50.43s/it]Task 3, Epoch 15/20 => Loss 0.353, Train_accy 90.49:  70%|███████   | 14/20 [12:35<05:02, 50.43s/it]Task 3, Epoch 15/20 => Loss 0.353, Train_accy 90.49:  75%|███████▌  | 15/20 [12:35<04:12, 50.42s/it]Task 3, Epoch 16/20 => Loss 0.337, Train_accy 91.08:  75%|███████▌  | 15/20 [13:26<04:12, 50.42s/it]Task 3, Epoch 16/20 => Loss 0.337, Train_accy 91.08:  80%|████████  | 16/20 [13:26<03:21, 50.45s/it]Task 3, Epoch 17/20 => Loss 0.321, Train_accy 91.63:  80%|████████  | 16/20 [14:16<03:21, 50.45s/it]Task 3, Epoch 17/20 => Loss 0.321, Train_accy 91.63:  85%|████████▌ | 17/20 [14:16<02:31, 50.44s/it]Task 3, Epoch 18/20 => Loss 0.327, Train_accy 91.18:  85%|████████▌ | 17/20 [15:07<02:31, 50.44s/it]Task 3, Epoch 18/20 => Loss 0.327, Train_accy 91.18:  90%|█████████ | 18/20 [15:07<01:40, 50.43s/it]Task 3, Epoch 19/20 => Loss 0.328, Train_accy 91.15:  90%|█████████ | 18/20 [15:57<01:40, 50.43s/it]Task 3, Epoch 19/20 => Loss 0.328, Train_accy 91.15:  95%|█████████▌| 19/20 [15:57<00:50, 50.45s/it]Task 3, Epoch 20/20 => Loss 0.328, Train_accy 91.80:  95%|█████████▌| 19/20 [16:48<00:50, 50.45s/it]Task 3, Epoch 20/20 => Loss 0.328, Train_accy 91.80: 100%|██████████| 20/20 [16:48<00:00, 50.51s/it]Task 3, Epoch 20/20 => Loss 0.328, Train_accy 91.80: 100%|██████████| 20/20 [16:48<00:00, 50.42s/it]
2024-04-19 12:07:50,147 [loramoeinc.py] => Task 3, Epoch 20/20 => Loss 0.328, Train_accy 91.80
2024-04-19 12:09:30,359 [trainer.py] => No NME accuracy.
2024-04-19 12:09:30,359 [trainer.py] => CNN: {'total': 96.86, '00-19': 97.8, '20-39': 96.3, '40-59': 96.9, '60-79': 96.45, 'old': 97.0, 'new': 96.45}
2024-04-19 12:09:30,359 [trainer.py] => Route: {'total': 82.54, '00-19': 83.75, '20-39': 85.9, '40-59': 80.0, '60-79': 80.5, 'old': 83.22, 'new': 80.5}
2024-04-19 12:09:30,359 [trainer.py] => CNN top1 curve: [97.8, 97.45, 97.0, 96.86]
2024-04-19 12:09:30,359 [trainer.py] => CNN top5 curve: [99.75, 99.8, 99.72, 99.76]
2024-04-19 12:09:30,360 [trainer.py] => Route top1 curve: [92.2, 89.1, 85.43, 82.54]
2024-04-19 12:09:30,360 [trainer.py] => Route top5 curve: [98.7, 97.92, 96.65, 95.8]

Average Accuracy (CNN): 97.2775
Average Accuracy (Route): 87.31750000000001
2024-04-19 12:09:30,360 [trainer.py] => Average Accuracy (CNN): 97.2775
2024-04-19 12:09:30,360 [trainer.py] => Average Accuracy (Route): 87.31750000000001

2024-04-19 12:09:30,360 [trainer.py] => Train Time: 4079.53
2024-04-19 12:09:30,360 [trainer.py] => Test Time: 102.00999999999999 

2024-04-19 12:09:30,361 [trainer.py] => All params: 86129018
2024-04-19 12:09:30,363 [trainer.py] => Trainable params: 102937
2024-04-19 12:09:30,366 [loramoeinc.py] => Learning on 80-100
  0%|          | 0/20 [00:00<?, ?it/s]Task 4, Epoch 1/20 => Loss 1.152, Train_accy 74.59:   0%|          | 0/20 [00:50<?, ?it/s]Task 4, Epoch 1/20 => Loss 1.152, Train_accy 74.59:   5%|▌         | 1/20 [00:50<15:57, 50.39s/it]Task 4, Epoch 2/20 => Loss 0.703, Train_accy 83.82:   5%|▌         | 1/20 [01:40<15:57, 50.39s/it]Task 4, Epoch 2/20 => Loss 0.703, Train_accy 83.82:  10%|█         | 2/20 [01:40<15:07, 50.40s/it]Task 4, Epoch 3/20 => Loss 0.658, Train_accy 84.68:  10%|█         | 2/20 [02:31<15:07, 50.40s/it]Task 4, Epoch 3/20 => Loss 0.658, Train_accy 84.68:  15%|█▌        | 3/20 [02:31<14:17, 50.42s/it]Task 4, Epoch 4/20 => Loss 0.642, Train_accy 84.85:  15%|█▌        | 3/20 [03:21<14:17, 50.42s/it]Task 4, Epoch 4/20 => Loss 0.642, Train_accy 84.85:  20%|██        | 4/20 [03:21<13:26, 50.41s/it]Task 4, Epoch 5/20 => Loss 0.599, Train_accy 86.14:  20%|██        | 4/20 [04:12<13:26, 50.41s/it]Task 4, Epoch 5/20 => Loss 0.599, Train_accy 86.14:  25%|██▌       | 5/20 [04:12<12:36, 50.45s/it]Task 4, Epoch 6/20 => Loss 0.570, Train_accy 86.15:  25%|██▌       | 5/20 [05:02<12:36, 50.45s/it]Task 4, Epoch 6/20 => Loss 0.570, Train_accy 86.15:  30%|███       | 6/20 [05:02<11:47, 50.56s/it]Task 4, Epoch 7/20 => Loss 0.522, Train_accy 87.18:  30%|███       | 6/20 [05:53<11:47, 50.56s/it]Task 4, Epoch 7/20 => Loss 0.522, Train_accy 87.18:  35%|███▌      | 7/20 [05:53<10:57, 50.56s/it]Task 4, Epoch 8/20 => Loss 0.503, Train_accy 87.80:  35%|███▌      | 7/20 [06:44<10:57, 50.56s/it]Task 4, Epoch 8/20 => Loss 0.503, Train_accy 87.80:  40%|████      | 8/20 [06:44<10:06, 50.58s/it]Task 4, Epoch 9/20 => Loss 0.489, Train_accy 88.06:  40%|████      | 8/20 [07:34<10:06, 50.58s/it]Task 4, Epoch 9/20 => Loss 0.489, Train_accy 88.06:  45%|████▌     | 9/20 [07:34<09:16, 50.63s/it]Task 4, Epoch 10/20 => Loss 0.453, Train_accy 88.66:  45%|████▌     | 9/20 [08:25<09:16, 50.63s/it]Task 4, Epoch 10/20 => Loss 0.453, Train_accy 88.66:  50%|█████     | 10/20 [08:25<08:26, 50.62s/it]Task 4, Epoch 11/20 => Loss 0.439, Train_accy 89.01:  50%|█████     | 10/20 [09:16<08:26, 50.62s/it]Task 4, Epoch 11/20 => Loss 0.439, Train_accy 89.01:  55%|█████▌    | 11/20 [09:16<07:35, 50.64s/it]Task 4, Epoch 12/20 => Loss 0.407, Train_accy 89.96:  55%|█████▌    | 11/20 [10:06<07:35, 50.64s/it]Task 4, Epoch 12/20 => Loss 0.407, Train_accy 89.96:  60%|██████    | 12/20 [10:06<06:44, 50.55s/it]Task 4, Epoch 13/20 => Loss 0.405, Train_accy 90.14:  60%|██████    | 12/20 [10:57<06:44, 50.55s/it]Task 4, Epoch 13/20 => Loss 0.405, Train_accy 90.14:  65%|██████▌   | 13/20 [10:57<05:54, 50.58s/it]Task 4, Epoch 14/20 => Loss 0.388, Train_accy 90.36:  65%|██████▌   | 13/20 [11:47<05:54, 50.58s/it]Task 4, Epoch 14/20 => Loss 0.388, Train_accy 90.36:  70%|███████   | 14/20 [11:47<05:03, 50.65s/it]Task 4, Epoch 15/20 => Loss 0.368, Train_accy 90.72:  70%|███████   | 14/20 [12:38<05:03, 50.65s/it]Task 4, Epoch 15/20 => Loss 0.368, Train_accy 90.72:  75%|███████▌  | 15/20 [12:38<04:12, 50.57s/it]Task 4, Epoch 16/20 => Loss 0.353, Train_accy 91.40:  75%|███████▌  | 15/20 [13:28<04:12, 50.57s/it]Task 4, Epoch 16/20 => Loss 0.353, Train_accy 91.40:  80%|████████  | 16/20 [13:28<03:22, 50.56s/it]Task 4, Epoch 17/20 => Loss 0.349, Train_accy 91.42:  80%|████████  | 16/20 [14:19<03:22, 50.56s/it]Task 4, Epoch 17/20 => Loss 0.349, Train_accy 91.42:  85%|████████▌ | 17/20 [14:19<02:31, 50.61s/it]Task 4, Epoch 18/20 => Loss 0.334, Train_accy 91.60:  85%|████████▌ | 17/20 [15:09<02:31, 50.61s/it]Task 4, Epoch 18/20 => Loss 0.334, Train_accy 91.60:  90%|█████████ | 18/20 [15:09<01:41, 50.52s/it]Task 4, Epoch 19/20 => Loss 0.335, Train_accy 91.64:  90%|█████████ | 18/20 [16:00<01:41, 50.52s/it]Task 4, Epoch 19/20 => Loss 0.335, Train_accy 91.64:  95%|█████████▌| 19/20 [16:00<00:50, 50.46s/it]Task 4, Epoch 20/20 => Loss 0.341, Train_accy 91.30:  95%|█████████▌| 19/20 [16:50<00:50, 50.46s/it]Task 4, Epoch 20/20 => Loss 0.341, Train_accy 91.30: 100%|██████████| 20/20 [16:50<00:00, 50.47s/it]Task 4, Epoch 20/20 => Loss 0.341, Train_accy 91.30: 100%|██████████| 20/20 [16:50<00:00, 50.54s/it]
2024-04-19 12:26:21,185 [loramoeinc.py] => Task 4, Epoch 20/20 => Loss 0.341, Train_accy 91.30
2024-04-19 12:28:09,661 [trainer.py] => No NME accuracy.
2024-04-19 12:28:09,661 [trainer.py] => CNN: {'total': 96.65, '00-19': 97.8, '20-39': 96.3, '40-59': 96.9, '60-79': 96.45, '80-99': 95.8, 'old': 96.86, 'new': 95.8}
2024-04-19 12:28:09,662 [trainer.py] => Route: {'total': 81.26, '00-19': 81.7, '20-39': 84.65, '40-59': 78.35, '60-79': 79.2, '80-99': 82.4, 'old': 80.97, 'new': 82.4}
2024-04-19 12:28:09,662 [trainer.py] => CNN top1 curve: [97.8, 97.45, 97.0, 96.86, 96.65]
2024-04-19 12:28:09,662 [trainer.py] => CNN top5 curve: [99.75, 99.8, 99.72, 99.76, 99.56]
2024-04-19 12:28:09,662 [trainer.py] => Route top1 curve: [92.2, 89.1, 85.43, 82.54, 81.26]
2024-04-19 12:28:09,662 [trainer.py] => Route top5 curve: [98.7, 97.92, 96.65, 95.8, 94.98]

Average Accuracy (CNN): 97.152
Average Accuracy (Route): 86.10600000000001
2024-04-19 12:28:09,662 [trainer.py] => Average Accuracy (CNN): 97.152
2024-04-19 12:28:09,662 [trainer.py] => Average Accuracy (Route): 86.10600000000001

2024-04-19 12:28:09,662 [trainer.py] => Train Time: 5090.26
2024-04-19 12:28:09,662 [trainer.py] => Test Time: 152.60999999999999 

