nohup: 忽略输入
2024-04-22 22:56:22,502 [trainer.py] => config: ./exps/loramoe_inc_cub_B0_Inc5.json
2024-04-22 22:56:22,502 [trainer.py] => prefix: reproduce
2024-04-22 22:56:22,502 [trainer.py] => dataset: cub
2024-04-22 22:56:22,502 [trainer.py] => memory_size: 0
2024-04-22 22:56:22,502 [trainer.py] => memory_per_class: 0
2024-04-22 22:56:22,502 [trainer.py] => fixed_memory: False
2024-04-22 22:56:22,502 [trainer.py] => shuffle: True
2024-04-22 22:56:22,502 [trainer.py] => init_cls: 40
2024-04-22 22:56:22,502 [trainer.py] => increment: 40
2024-04-22 22:56:22,502 [trainer.py] => model_name: loramoeinc
2024-04-22 22:56:22,502 [trainer.py] => backbone_type: pretrained_vit_b16_224_inc
2024-04-22 22:56:22,502 [trainer.py] => device: [device(type='cuda', index=2)]
2024-04-22 22:56:22,502 [trainer.py] => seed: 1993
2024-04-22 22:56:22,502 [trainer.py] => tuned_epoch: 20
2024-04-22 22:56:22,502 [trainer.py] => init_lr: 0.01
2024-04-22 22:56:22,502 [trainer.py] => batch_size: 48
2024-04-22 22:56:22,502 [trainer.py] => weight_decay: 0.0005
2024-04-22 22:56:22,502 [trainer.py] => min_lr: 0
2024-04-22 22:56:22,503 [trainer.py] => ffn_num: 4
2024-04-22 22:56:22,503 [trainer.py] => optimizer: sgd
2024-04-22 22:56:22,503 [trainer.py] => vpt_type: shallow
2024-04-22 22:56:22,503 [trainer.py] => prompt_token_num: 5
2024-04-22 22:56:22,503 [trainer.py] => expert_num: 5
2024-04-22 22:56:22,563 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
/home/team/zhaohongwei/anaconda3/envs/peft/lib/python3.10/site-packages/bitsandbytes/cuda_setup/main.py:136: UserWarning: /home/team/zhaohongwei/anaconda3/envs/peft did not contain libcudart.so as expected! Searching further paths...
  warn(msg)

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please submit your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
CUDA SETUP: CUDA runtime path found: /usr/local/cuda-11.8/lib64/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 8.6
CUDA SETUP: Detected CUDA version 118
CUDA SETUP: Loading binary /home/team/zhaohongwei/anaconda3/envs/peft/lib/python3.10/site-packages/bitsandbytes/libbitsandbytes_cuda118.so...
I'm using ViT with adapters.
2024-04-22 22:56:40,880 [trainer.py] => All params: 86006136
2024-04-22 22:56:40,883 [trainer.py] => Trainable params: 207480
2024-04-22 22:56:41,209 [loramoeinc.py] => Learning on 0-40
  0%|          | 0/20 [00:00<?, ?it/s]Task 0, Epoch 1/20 => Loss 3.656, Train_accy 13.27:   0%|          | 0/20 [00:16<?, ?it/s]Task 0, Epoch 1/20 => Loss 3.656, Train_accy 13.27:   5%|▌         | 1/20 [00:16<05:08, 16.23s/it]Task 0, Epoch 2/20 => Loss 3.481, Train_accy 60.44:   5%|▌         | 1/20 [00:31<05:08, 16.23s/it]Task 0, Epoch 2/20 => Loss 3.481, Train_accy 60.44:  10%|█         | 2/20 [00:31<04:38, 15.48s/it]Task 0, Epoch 3/20 => Loss 2.941, Train_accy 76.73:  10%|█         | 2/20 [00:47<04:38, 15.48s/it]Task 0, Epoch 3/20 => Loss 2.941, Train_accy 76.73:  15%|█▌        | 3/20 [00:47<04:27, 15.74s/it]Task 0, Epoch 4/20 => Loss 1.908, Train_accy 82.28:  15%|█▌        | 3/20 [01:03<04:27, 15.74s/it]Task 0, Epoch 4/20 => Loss 1.908, Train_accy 82.28:  20%|██        | 4/20 [01:03<04:15, 15.96s/it]Task 0, Epoch 5/20 => Loss 1.114, Train_accy 87.04:  20%|██        | 4/20 [01:19<04:15, 15.96s/it]Task 0, Epoch 5/20 => Loss 1.114, Train_accy 87.04:  25%|██▌       | 5/20 [01:19<04:01, 16.07s/it]Task 0, Epoch 6/20 => Loss 0.775, Train_accy 89.32:  25%|██▌       | 5/20 [01:35<04:01, 16.07s/it]Task 0, Epoch 6/20 => Loss 0.775, Train_accy 89.32:  30%|███       | 6/20 [01:35<03:41, 15.83s/it]Task 0, Epoch 7/20 => Loss 0.610, Train_accy 90.16:  30%|███       | 6/20 [01:50<03:41, 15.83s/it]Task 0, Epoch 7/20 => Loss 0.610, Train_accy 90.16:  35%|███▌      | 7/20 [01:50<03:24, 15.72s/it]Task 0, Epoch 8/20 => Loss 0.504, Train_accy 91.80:  35%|███▌      | 7/20 [02:06<03:24, 15.72s/it]Task 0, Epoch 8/20 => Loss 0.504, Train_accy 91.80:  40%|████      | 8/20 [02:06<03:07, 15.60s/it]Task 0, Epoch 9/20 => Loss 0.452, Train_accy 91.96:  40%|████      | 8/20 [02:21<03:07, 15.60s/it]Task 0, Epoch 9/20 => Loss 0.452, Train_accy 91.96:  45%|████▌     | 9/20 [02:21<02:52, 15.65s/it]Task 0, Epoch 10/20 => Loss 0.443, Train_accy 91.49:  45%|████▌     | 9/20 [02:38<02:52, 15.65s/it]Task 0, Epoch 10/20 => Loss 0.443, Train_accy 91.49:  50%|█████     | 10/20 [02:38<02:39, 15.93s/it]Task 0, Epoch 11/20 => Loss 0.389, Train_accy 92.38:  50%|█████     | 10/20 [02:54<02:39, 15.93s/it]Task 0, Epoch 11/20 => Loss 0.389, Train_accy 92.38:  55%|█████▌    | 11/20 [02:54<02:23, 15.94s/it]Task 0, Epoch 12/20 => Loss 0.370, Train_accy 92.60:  55%|█████▌    | 11/20 [03:10<02:23, 15.94s/it]Task 0, Epoch 12/20 => Loss 0.370, Train_accy 92.60:  60%|██████    | 12/20 [03:10<02:09, 16.17s/it]Task 0, Epoch 13/20 => Loss 0.349, Train_accy 93.23:  60%|██████    | 12/20 [03:26<02:09, 16.17s/it]Task 0, Epoch 13/20 => Loss 0.349, Train_accy 93.23:  65%|██████▌   | 13/20 [03:26<01:52, 16.12s/it]Task 0, Epoch 14/20 => Loss 0.334, Train_accy 93.18:  65%|██████▌   | 13/20 [03:43<01:52, 16.12s/it]Task 0, Epoch 14/20 => Loss 0.334, Train_accy 93.18:  70%|███████   | 14/20 [03:43<01:38, 16.33s/it]Task 0, Epoch 15/20 => Loss 0.331, Train_accy 92.76:  70%|███████   | 14/20 [03:59<01:38, 16.33s/it]Task 0, Epoch 15/20 => Loss 0.331, Train_accy 92.76:  75%|███████▌  | 15/20 [03:59<01:20, 16.12s/it]Task 0, Epoch 16/20 => Loss 0.308, Train_accy 94.02:  75%|███████▌  | 15/20 [04:15<01:20, 16.12s/it]Task 0, Epoch 16/20 => Loss 0.308, Train_accy 94.02:  80%|████████  | 16/20 [04:15<01:04, 16.05s/it]Task 0, Epoch 17/20 => Loss 0.345, Train_accy 92.76:  80%|████████  | 16/20 [04:31<01:04, 16.05s/it]Task 0, Epoch 17/20 => Loss 0.345, Train_accy 92.76:  85%|████████▌ | 17/20 [04:31<00:48, 16.02s/it]Task 0, Epoch 18/20 => Loss 0.331, Train_accy 93.02:  85%|████████▌ | 17/20 [04:47<00:48, 16.02s/it]Task 0, Epoch 18/20 => Loss 0.331, Train_accy 93.02:  90%|█████████ | 18/20 [04:47<00:32, 16.17s/it]Task 0, Epoch 19/20 => Loss 0.308, Train_accy 93.87:  90%|█████████ | 18/20 [05:04<00:32, 16.17s/it]Task 0, Epoch 19/20 => Loss 0.308, Train_accy 93.87:  95%|█████████▌| 19/20 [05:04<00:16, 16.26s/it]Task 0, Epoch 20/20 => Loss 0.322, Train_accy 93.34:  95%|█████████▌| 19/20 [05:20<00:16, 16.26s/it]Task 0, Epoch 20/20 => Loss 0.322, Train_accy 93.34: 100%|██████████| 20/20 [05:20<00:00, 16.29s/it]Task 0, Epoch 20/20 => Loss 0.322, Train_accy 93.34: 100%|██████████| 20/20 [05:20<00:00, 16.03s/it]
2024-04-22 23:02:01,957 [loramoeinc.py] => Task 0, Epoch 20/20 => Loss 0.322, Train_accy 93.34
2024-04-22 23:02:59,682 [trainer.py] => No NME accuracy.
2024-04-22 23:02:59,682 [trainer.py] => CNN: {'total': 97.14, '00-39': 97.14, 'old': 0, 'new': 97.14}
2024-04-22 23:02:59,682 [trainer.py] => Route: {'total': 97.8, '00-39': 97.8, 'old': 0, 'new': 97.8}
2024-04-22 23:02:59,682 [trainer.py] => CNN top1 curve: [97.14]
2024-04-22 23:02:59,683 [trainer.py] => CNN top5 curve: [99.78]
2024-04-22 23:02:59,683 [trainer.py] => Route top1 curve: [97.8]
2024-04-22 23:02:59,683 [trainer.py] => Route top5 curve: [99.78]

Average Accuracy (CNN): 97.14
Average Accuracy (Route): 97.8
2024-04-22 23:02:59,683 [trainer.py] => Average Accuracy (CNN): 97.14
2024-04-22 23:02:59,683 [trainer.py] => Average Accuracy (Route): 97.8

2024-04-22 23:02:59,683 [trainer.py] => Train Time: 320.61
2024-04-22 23:02:59,683 [trainer.py] => Test Time: 0 

2024-04-22 23:02:59,684 [trainer.py] => All params: 86067578
2024-04-22 23:02:59,686 [trainer.py] => Trainable params: 196705
2024-04-22 23:02:59,689 [loramoeinc.py] => Learning on 40-80
  0%|          | 0/20 [00:00<?, ?it/s]Task 1, Epoch 1/20 => Loss 2.840, Train_accy 41.13:   0%|          | 0/20 [00:15<?, ?it/s]Task 1, Epoch 1/20 => Loss 2.840, Train_accy 41.13:   5%|▌         | 1/20 [00:15<05:02, 15.90s/it]Task 1, Epoch 2/20 => Loss 2.118, Train_accy 50.56:   5%|▌         | 1/20 [00:32<05:02, 15.90s/it]Task 1, Epoch 2/20 => Loss 2.118, Train_accy 50.56:  10%|█         | 2/20 [00:32<04:52, 16.23s/it]Task 1, Epoch 3/20 => Loss 2.006, Train_accy 51.09:  10%|█         | 2/20 [00:47<04:52, 16.23s/it]Task 1, Epoch 3/20 => Loss 2.006, Train_accy 51.09:  15%|█▌        | 3/20 [00:47<04:30, 15.93s/it]Task 1, Epoch 4/20 => Loss 1.809, Train_accy 53.84:  15%|█▌        | 3/20 [01:04<04:30, 15.93s/it]Task 1, Epoch 4/20 => Loss 1.809, Train_accy 53.84:  20%|██        | 4/20 [01:04<04:17, 16.12s/it]Task 1, Epoch 5/20 => Loss 1.726, Train_accy 54.47:  20%|██        | 4/20 [01:19<04:17, 16.12s/it]Task 1, Epoch 5/20 => Loss 1.726, Train_accy 54.47:  25%|██▌       | 5/20 [01:19<03:58, 15.91s/it]Task 1, Epoch 6/20 => Loss 1.693, Train_accy 55.37:  25%|██▌       | 5/20 [01:35<03:58, 15.91s/it]Task 1, Epoch 6/20 => Loss 1.693, Train_accy 55.37:  30%|███       | 6/20 [01:35<03:40, 15.73s/it]Task 1, Epoch 7/20 => Loss 1.692, Train_accy 55.06:  30%|███       | 6/20 [01:50<03:40, 15.73s/it]Task 1, Epoch 7/20 => Loss 1.692, Train_accy 55.06:  35%|███▌      | 7/20 [01:50<03:24, 15.70s/it]Task 1, Epoch 8/20 => Loss 1.652, Train_accy 56.27:  35%|███▌      | 7/20 [02:07<03:24, 15.70s/it]Task 1, Epoch 8/20 => Loss 1.652, Train_accy 56.27:  40%|████      | 8/20 [02:07<03:10, 15.84s/it]Task 1, Epoch 9/20 => Loss 1.595, Train_accy 55.85:  40%|████      | 8/20 [02:24<03:10, 15.84s/it]Task 1, Epoch 9/20 => Loss 1.595, Train_accy 55.85:  45%|████▌     | 9/20 [02:24<02:59, 16.35s/it]Task 1, Epoch 10/20 => Loss 1.564, Train_accy 56.91:  45%|████▌     | 9/20 [02:40<02:59, 16.35s/it]Task 1, Epoch 10/20 => Loss 1.564, Train_accy 56.91:  50%|█████     | 10/20 [02:40<02:41, 16.16s/it]Task 1, Epoch 11/20 => Loss 1.553, Train_accy 56.54:  50%|█████     | 10/20 [02:56<02:41, 16.16s/it]Task 1, Epoch 11/20 => Loss 1.553, Train_accy 56.54:  55%|█████▌    | 11/20 [02:56<02:24, 16.04s/it]Task 1, Epoch 12/20 => Loss 1.576, Train_accy 57.70:  55%|█████▌    | 11/20 [03:12<02:24, 16.04s/it]Task 1, Epoch 12/20 => Loss 1.576, Train_accy 57.70:  60%|██████    | 12/20 [03:12<02:09, 16.13s/it]Task 1, Epoch 13/20 => Loss 1.477, Train_accy 58.28:  60%|██████    | 12/20 [03:27<02:09, 16.13s/it]Task 1, Epoch 13/20 => Loss 1.477, Train_accy 58.28:  65%|██████▌   | 13/20 [03:27<01:51, 15.98s/it]Task 1, Epoch 14/20 => Loss 1.489, Train_accy 57.97:  65%|██████▌   | 13/20 [03:43<01:51, 15.98s/it]Task 1, Epoch 14/20 => Loss 1.489, Train_accy 57.97:  70%|███████   | 14/20 [03:43<01:35, 15.93s/it]Task 1, Epoch 15/20 => Loss 1.472, Train_accy 57.38:  70%|███████   | 14/20 [04:01<01:35, 15.93s/it]Task 1, Epoch 15/20 => Loss 1.472, Train_accy 57.38:  75%|███████▌  | 15/20 [04:01<01:21, 16.35s/it]Task 1, Epoch 16/20 => Loss 1.457, Train_accy 58.50:  75%|███████▌  | 15/20 [04:18<01:21, 16.35s/it]Task 1, Epoch 16/20 => Loss 1.457, Train_accy 58.50:  80%|████████  | 16/20 [04:18<01:06, 16.54s/it]Task 1, Epoch 17/20 => Loss 1.453, Train_accy 57.97:  80%|████████  | 16/20 [04:33<01:06, 16.54s/it]Task 1, Epoch 17/20 => Loss 1.453, Train_accy 57.97:  85%|████████▌ | 17/20 [04:33<00:48, 16.31s/it]Task 1, Epoch 18/20 => Loss 1.430, Train_accy 58.34:  85%|████████▌ | 17/20 [04:50<00:48, 16.31s/it]Task 1, Epoch 18/20 => Loss 1.430, Train_accy 58.34:  90%|█████████ | 18/20 [04:50<00:32, 16.31s/it]Task 1, Epoch 19/20 => Loss 1.443, Train_accy 58.18:  90%|█████████ | 18/20 [05:06<00:32, 16.31s/it]Task 1, Epoch 19/20 => Loss 1.443, Train_accy 58.18:  95%|█████████▌| 19/20 [05:06<00:16, 16.33s/it]Task 1, Epoch 20/20 => Loss 1.428, Train_accy 58.81:  95%|█████████▌| 19/20 [05:22<00:16, 16.33s/it]Task 1, Epoch 20/20 => Loss 1.428, Train_accy 58.81: 100%|██████████| 20/20 [05:22<00:00, 16.22s/it]Task 1, Epoch 20/20 => Loss 1.428, Train_accy 58.81: 100%|██████████| 20/20 [05:22<00:00, 16.13s/it]
2024-04-22 23:08:22,252 [loramoeinc.py] => Task 1, Epoch 20/20 => Loss 1.428, Train_accy 58.81
2024-04-22 23:09:20,833 [trainer.py] => No NME accuracy.
2024-04-22 23:09:20,833 [trainer.py] => CNN: {'total': 93.47, '00-39': 97.14, '40-79': 89.89, 'old': 97.14, 'new': 89.89}
2024-04-22 23:09:20,833 [trainer.py] => Route: {'total': 93.25, '00-39': 93.83, '40-79': 92.69, 'old': 93.83, 'new': 92.69}
2024-04-22 23:09:20,833 [trainer.py] => CNN top1 curve: [97.14, 93.47]
2024-04-22 23:09:20,833 [trainer.py] => CNN top5 curve: [99.78, 98.37]
2024-04-22 23:09:20,833 [trainer.py] => Route top1 curve: [97.8, 93.25]
2024-04-22 23:09:20,833 [trainer.py] => Route top5 curve: [99.78, 99.02]

Average Accuracy (CNN): 95.305
Average Accuracy (Route): 95.525
2024-04-22 23:09:20,833 [trainer.py] => Average Accuracy (CNN): 95.305
2024-04-22 23:09:20,833 [trainer.py] => Average Accuracy (Route): 95.525

2024-04-22 23:09:20,833 [trainer.py] => Train Time: 643.1600000000001
2024-04-22 23:09:20,833 [trainer.py] => Test Time: 0 

2024-04-22 23:09:20,835 [trainer.py] => All params: 86129018
2024-04-22 23:09:20,836 [trainer.py] => Trainable params: 185929
2024-04-22 23:09:20,840 [loramoeinc.py] => Learning on 80-120
  0%|          | 0/20 [00:00<?, ?it/s]Task 2, Epoch 1/20 => Loss 2.477, Train_accy 45.61:   0%|          | 0/20 [00:15<?, ?it/s]Task 2, Epoch 1/20 => Loss 2.477, Train_accy 45.61:   5%|▌         | 1/20 [00:15<04:46, 15.10s/it]Task 2, Epoch 2/20 => Loss 1.693, Train_accy 59.43:   5%|▌         | 1/20 [00:30<04:46, 15.10s/it]Task 2, Epoch 2/20 => Loss 1.693, Train_accy 59.43:  10%|█         | 2/20 [00:30<04:35, 15.29s/it]Task 2, Epoch 3/20 => Loss 1.565, Train_accy 62.22:  10%|█         | 2/20 [00:45<04:35, 15.29s/it]Task 2, Epoch 3/20 => Loss 1.565, Train_accy 62.22:  15%|█▌        | 3/20 [00:45<04:19, 15.29s/it]Task 2, Epoch 4/20 => Loss 1.581, Train_accy 60.99:  15%|█▌        | 3/20 [01:01<04:19, 15.29s/it]Task 2, Epoch 4/20 => Loss 1.581, Train_accy 60.99:  20%|██        | 4/20 [01:01<04:06, 15.40s/it]Task 2, Epoch 5/20 => Loss 1.425, Train_accy 63.67:  20%|██        | 4/20 [01:16<04:06, 15.40s/it]Task 2, Epoch 5/20 => Loss 1.425, Train_accy 63.67:  25%|██▌       | 5/20 [01:16<03:46, 15.13s/it]Task 2, Epoch 6/20 => Loss 1.353, Train_accy 65.33:  25%|██▌       | 5/20 [01:30<03:46, 15.13s/it]Task 2, Epoch 6/20 => Loss 1.353, Train_accy 65.33:  30%|███       | 6/20 [01:30<03:30, 15.07s/it]Task 2, Epoch 7/20 => Loss 1.322, Train_accy 65.43:  30%|███       | 6/20 [01:46<03:30, 15.07s/it]Task 2, Epoch 7/20 => Loss 1.322, Train_accy 65.43:  35%|███▌      | 7/20 [01:46<03:19, 15.36s/it]Task 2, Epoch 8/20 => Loss 1.353, Train_accy 65.38:  35%|███▌      | 7/20 [02:02<03:19, 15.36s/it]Task 2, Epoch 8/20 => Loss 1.353, Train_accy 65.38:  40%|████      | 8/20 [02:02<03:05, 15.43s/it]Task 2, Epoch 9/20 => Loss 1.305, Train_accy 66.45:  40%|████      | 8/20 [02:17<03:05, 15.43s/it]Task 2, Epoch 9/20 => Loss 1.305, Train_accy 66.45:  45%|████▌     | 9/20 [02:17<02:49, 15.43s/it]Task 2, Epoch 10/20 => Loss 1.269, Train_accy 65.59:  45%|████▌     | 9/20 [02:33<02:49, 15.43s/it]Task 2, Epoch 10/20 => Loss 1.269, Train_accy 65.59:  50%|█████     | 10/20 [02:33<02:34, 15.50s/it]Task 2, Epoch 11/20 => Loss 1.223, Train_accy 66.45:  50%|█████     | 10/20 [02:49<02:34, 15.50s/it]Task 2, Epoch 11/20 => Loss 1.223, Train_accy 66.45:  55%|█████▌    | 11/20 [02:49<02:20, 15.57s/it]Task 2, Epoch 12/20 => Loss 1.227, Train_accy 66.18:  55%|█████▌    | 11/20 [03:05<02:20, 15.57s/it]Task 2, Epoch 12/20 => Loss 1.227, Train_accy 66.18:  60%|██████    | 12/20 [03:05<02:06, 15.79s/it]Task 2, Epoch 13/20 => Loss 1.210, Train_accy 67.20:  60%|██████    | 12/20 [03:21<02:06, 15.79s/it]Task 2, Epoch 13/20 => Loss 1.210, Train_accy 67.20:  65%|██████▌   | 13/20 [03:21<01:51, 15.96s/it]Task 2, Epoch 14/20 => Loss 1.136, Train_accy 67.15:  65%|██████▌   | 13/20 [03:38<01:51, 15.96s/it]Task 2, Epoch 14/20 => Loss 1.136, Train_accy 67.15:  70%|███████   | 14/20 [03:38<01:36, 16.10s/it]Task 2, Epoch 15/20 => Loss 1.137, Train_accy 68.11:  70%|███████   | 14/20 [03:53<01:36, 16.10s/it]Task 2, Epoch 15/20 => Loss 1.137, Train_accy 68.11:  75%|███████▌  | 15/20 [03:53<01:19, 15.93s/it]Task 2, Epoch 16/20 => Loss 1.145, Train_accy 67.20:  75%|███████▌  | 15/20 [04:09<01:19, 15.93s/it]Task 2, Epoch 16/20 => Loss 1.145, Train_accy 67.20:  80%|████████  | 16/20 [04:09<01:03, 15.84s/it]Task 2, Epoch 17/20 => Loss 1.097, Train_accy 68.38:  80%|████████  | 16/20 [04:24<01:03, 15.84s/it]Task 2, Epoch 17/20 => Loss 1.097, Train_accy 68.38:  85%|████████▌ | 17/20 [04:24<00:47, 15.70s/it]Task 2, Epoch 18/20 => Loss 1.114, Train_accy 67.95:  85%|████████▌ | 17/20 [04:40<00:47, 15.70s/it]Task 2, Epoch 18/20 => Loss 1.114, Train_accy 67.95:  90%|█████████ | 18/20 [04:40<00:31, 15.60s/it]Task 2, Epoch 19/20 => Loss 1.119, Train_accy 67.79:  90%|█████████ | 18/20 [04:56<00:31, 15.60s/it]Task 2, Epoch 19/20 => Loss 1.119, Train_accy 67.79:  95%|█████████▌| 19/20 [04:56<00:15, 15.71s/it]Task 2, Epoch 20/20 => Loss 1.126, Train_accy 68.33:  95%|█████████▌| 19/20 [05:11<00:15, 15.71s/it]Task 2, Epoch 20/20 => Loss 1.126, Train_accy 68.33: 100%|██████████| 20/20 [05:11<00:00, 15.53s/it]Task 2, Epoch 20/20 => Loss 1.126, Train_accy 68.33: 100%|██████████| 20/20 [05:11<00:00, 15.57s/it]
2024-04-22 23:14:32,231 [loramoeinc.py] => Task 2, Epoch 20/20 => Loss 1.126, Train_accy 68.33
2024-04-22 23:15:33,988 [trainer.py] => No NME accuracy.
2024-04-22 23:15:33,988 [trainer.py] => CNN: {'total': 93.5, '00-39': 97.14, '40-79': 89.25, '80-119': 94.16, 'old': 93.14, 'new': 94.16}
2024-04-22 23:15:33,988 [trainer.py] => Route: {'total': 90.18, '00-39': 91.85, '40-79': 89.68, '80-119': 89.13, 'old': 90.75, 'new': 89.13}
2024-04-22 23:15:33,989 [trainer.py] => CNN top1 curve: [97.14, 93.47, 93.5]
2024-04-22 23:15:33,989 [trainer.py] => CNN top5 curve: [99.78, 98.37, 98.31]
2024-04-22 23:15:33,989 [trainer.py] => Route top1 curve: [97.8, 93.25, 90.18]
2024-04-22 23:15:33,989 [trainer.py] => Route top5 curve: [99.78, 99.02, 98.87]

Average Accuracy (CNN): 94.70333333333333
Average Accuracy (Route): 93.74333333333334
2024-04-22 23:15:33,989 [trainer.py] => Average Accuracy (CNN): 94.70333333333333
2024-04-22 23:15:33,989 [trainer.py] => Average Accuracy (Route): 93.74333333333334

2024-04-22 23:15:33,989 [trainer.py] => Train Time: 954.5300000000001
2024-04-22 23:15:33,989 [trainer.py] => Test Time: 0 

2024-04-22 23:15:33,990 [trainer.py] => All params: 86190458
2024-04-22 23:15:33,991 [trainer.py] => Trainable params: 175153
2024-04-22 23:15:33,995 [loramoeinc.py] => Learning on 120-160
  0%|          | 0/20 [00:00<?, ?it/s]Task 3, Epoch 1/20 => Loss 3.289, Train_accy 32.18:   0%|          | 0/20 [00:16<?, ?it/s]Task 3, Epoch 1/20 => Loss 3.289, Train_accy 32.18:   5%|▌         | 1/20 [00:16<05:09, 16.31s/it]Task 3, Epoch 2/20 => Loss 3.279, Train_accy 35.75:   5%|▌         | 1/20 [00:32<05:09, 16.31s/it]Task 3, Epoch 2/20 => Loss 3.279, Train_accy 35.75:  10%|█         | 2/20 [00:32<04:54, 16.34s/it]Task 3, Epoch 3/20 => Loss 2.589, Train_accy 46.85:  10%|█         | 2/20 [00:48<04:54, 16.34s/it]Task 3, Epoch 3/20 => Loss 2.589, Train_accy 46.85:  15%|█▌        | 3/20 [00:48<04:36, 16.24s/it]Task 3, Epoch 4/20 => Loss 2.115, Train_accy 52.99:  15%|█▌        | 3/20 [01:05<04:36, 16.24s/it]Task 3, Epoch 4/20 => Loss 2.115, Train_accy 52.99:  20%|██        | 4/20 [01:05<04:21, 16.34s/it]Task 3, Epoch 5/20 => Loss 1.936, Train_accy 55.02:  20%|██        | 4/20 [01:21<04:21, 16.34s/it]Task 3, Epoch 5/20 => Loss 1.936, Train_accy 55.02:  25%|██▌       | 5/20 [01:21<04:05, 16.39s/it]Task 3, Epoch 6/20 => Loss 1.968, Train_accy 56.03:  25%|██▌       | 5/20 [01:38<04:05, 16.39s/it]Task 3, Epoch 6/20 => Loss 1.968, Train_accy 56.03:  30%|███       | 6/20 [01:38<03:51, 16.50s/it]Task 3, Epoch 7/20 => Loss 2.000, Train_accy 55.60:  30%|███       | 6/20 [01:54<03:51, 16.50s/it]Task 3, Epoch 7/20 => Loss 2.000, Train_accy 55.60:  35%|███▌      | 7/20 [01:54<03:33, 16.43s/it]Task 3, Epoch 8/20 => Loss 1.856, Train_accy 57.74:  35%|███▌      | 7/20 [02:11<03:33, 16.43s/it]Task 3, Epoch 8/20 => Loss 1.856, Train_accy 57.74:  40%|████      | 8/20 [02:11<03:17, 16.45s/it]Task 3, Epoch 9/20 => Loss 1.729, Train_accy 59.07:  40%|████      | 8/20 [02:27<03:17, 16.45s/it]Task 3, Epoch 9/20 => Loss 1.729, Train_accy 59.07:  45%|████▌     | 9/20 [02:27<03:00, 16.40s/it]Task 3, Epoch 10/20 => Loss 1.561, Train_accy 60.67:  45%|████▌     | 9/20 [02:44<03:00, 16.40s/it]Task 3, Epoch 10/20 => Loss 1.561, Train_accy 60.67:  50%|█████     | 10/20 [02:44<02:44, 16.46s/it]Task 3, Epoch 11/20 => Loss 1.535, Train_accy 62.33:  50%|█████     | 10/20 [03:00<02:44, 16.46s/it]Task 3, Epoch 11/20 => Loss 1.535, Train_accy 62.33:  55%|█████▌    | 11/20 [03:00<02:27, 16.38s/it]Task 3, Epoch 12/20 => Loss 1.462, Train_accy 63.77:  55%|█████▌    | 11/20 [03:15<02:27, 16.38s/it]Task 3, Epoch 12/20 => Loss 1.462, Train_accy 63.77:  60%|██████    | 12/20 [03:15<02:09, 16.13s/it]Task 3, Epoch 13/20 => Loss 1.423, Train_accy 62.97:  60%|██████    | 12/20 [03:31<02:09, 16.13s/it]Task 3, Epoch 13/20 => Loss 1.423, Train_accy 62.97:  65%|██████▌   | 13/20 [03:31<01:51, 15.97s/it]Task 3, Epoch 14/20 => Loss 1.496, Train_accy 62.59:  65%|██████▌   | 13/20 [03:46<01:51, 15.97s/it]Task 3, Epoch 14/20 => Loss 1.496, Train_accy 62.59:  70%|███████   | 14/20 [03:46<01:33, 15.60s/it]Task 3, Epoch 15/20 => Loss 1.449, Train_accy 64.30:  70%|███████   | 14/20 [04:00<01:33, 15.60s/it]Task 3, Epoch 15/20 => Loss 1.449, Train_accy 64.30:  75%|███████▌  | 15/20 [04:00<01:16, 15.31s/it]Task 3, Epoch 16/20 => Loss 1.376, Train_accy 64.35:  75%|███████▌  | 15/20 [04:16<01:16, 15.31s/it]Task 3, Epoch 16/20 => Loss 1.376, Train_accy 64.35:  80%|████████  | 16/20 [04:16<01:01, 15.38s/it]Task 3, Epoch 17/20 => Loss 1.323, Train_accy 65.10:  80%|████████  | 16/20 [04:31<01:01, 15.38s/it]Task 3, Epoch 17/20 => Loss 1.323, Train_accy 65.10:  85%|████████▌ | 17/20 [04:31<00:46, 15.42s/it]Task 3, Epoch 18/20 => Loss 1.383, Train_accy 64.35:  85%|████████▌ | 17/20 [04:46<00:46, 15.42s/it]Task 3, Epoch 18/20 => Loss 1.383, Train_accy 64.35:  90%|█████████ | 18/20 [04:46<00:30, 15.31s/it]Task 3, Epoch 19/20 => Loss 1.354, Train_accy 64.83:  90%|█████████ | 18/20 [05:03<00:30, 15.31s/it]Task 3, Epoch 19/20 => Loss 1.354, Train_accy 64.83:  95%|█████████▌| 19/20 [05:03<00:15, 15.76s/it]Task 3, Epoch 20/20 => Loss 1.343, Train_accy 65.47:  95%|█████████▌| 19/20 [05:19<00:15, 15.76s/it]Task 3, Epoch 20/20 => Loss 1.343, Train_accy 65.47: 100%|██████████| 20/20 [05:19<00:00, 15.81s/it]Task 3, Epoch 20/20 => Loss 1.343, Train_accy 65.47: 100%|██████████| 20/20 [05:19<00:00, 15.99s/it]
2024-04-22 23:20:53,736 [loramoeinc.py] => Task 3, Epoch 20/20 => Loss 1.343, Train_accy 65.47
2024-04-22 23:22:00,484 [trainer.py] => No NME accuracy.
2024-04-22 23:22:00,484 [trainer.py] => CNN: {'total': 92.23, '00-39': 96.92, '40-79': 89.25, '80-119': 94.16, '120-159': 88.63, 'old': 93.43, 'new': 88.63}
2024-04-22 23:22:00,484 [trainer.py] => Route: {'total': 88.47, '00-39': 89.65, '40-79': 88.39, '80-119': 87.93, '120-159': 88.0, 'old': 88.63, 'new': 88.0}
2024-04-22 23:22:00,484 [trainer.py] => CNN top1 curve: [97.14, 93.47, 93.5, 92.23]
2024-04-22 23:22:00,484 [trainer.py] => CNN top5 curve: [99.78, 98.37, 98.31, 97.94]
2024-04-22 23:22:00,484 [trainer.py] => Route top1 curve: [97.8, 93.25, 90.18, 88.47]
2024-04-22 23:22:00,484 [trainer.py] => Route top5 curve: [99.78, 99.02, 98.87, 98.68]

Average Accuracy (CNN): 94.08500000000001
Average Accuracy (Route): 92.42500000000001
2024-04-22 23:22:00,484 [trainer.py] => Average Accuracy (CNN): 94.08500000000001
2024-04-22 23:22:00,485 [trainer.py] => Average Accuracy (Route): 92.42500000000001

2024-04-22 23:22:00,485 [trainer.py] => Train Time: 1274.2600000000002
2024-04-22 23:22:00,485 [trainer.py] => Test Time: 0 

2024-04-22 23:22:00,486 [trainer.py] => All params: 86251898
2024-04-22 23:22:00,487 [trainer.py] => Trainable params: 164377
2024-04-22 23:22:00,494 [loramoeinc.py] => Learning on 160-200
  0%|          | 0/20 [00:00<?, ?it/s]Task 4, Epoch 1/20 => Loss 3.073, Train_accy 43.77:   0%|          | 0/20 [00:15<?, ?it/s]Task 4, Epoch 1/20 => Loss 3.073, Train_accy 43.77:   5%|▌         | 1/20 [00:15<05:03, 15.96s/it]Task 4, Epoch 2/20 => Loss 1.836, Train_accy 62.15:   5%|▌         | 1/20 [00:32<05:03, 15.96s/it]Task 4, Epoch 2/20 => Loss 1.836, Train_accy 62.15:  10%|█         | 2/20 [00:32<04:51, 16.21s/it]Task 4, Epoch 3/20 => Loss 1.686, Train_accy 63.77:  10%|█         | 2/20 [00:48<04:51, 16.21s/it]Task 4, Epoch 3/20 => Loss 1.686, Train_accy 63.77:  15%|█▌        | 3/20 [00:48<04:31, 15.99s/it]Task 4, Epoch 4/20 => Loss 1.478, Train_accy 67.28:  15%|█▌        | 3/20 [01:03<04:31, 15.99s/it]Task 4, Epoch 4/20 => Loss 1.478, Train_accy 67.28:  20%|██        | 4/20 [01:03<04:13, 15.85s/it]Task 4, Epoch 5/20 => Loss 1.661, Train_accy 63.82:  20%|██        | 4/20 [01:19<04:13, 15.85s/it]Task 4, Epoch 5/20 => Loss 1.661, Train_accy 63.82:  25%|██▌       | 5/20 [01:19<03:56, 15.77s/it]Task 4, Epoch 6/20 => Loss 1.505, Train_accy 68.06:  25%|██▌       | 5/20 [01:34<03:56, 15.77s/it]Task 4, Epoch 6/20 => Loss 1.505, Train_accy 68.06:  30%|███       | 6/20 [01:34<03:37, 15.55s/it]Task 4, Epoch 7/20 => Loss 1.300, Train_accy 70.58:  30%|███       | 6/20 [01:50<03:37, 15.55s/it]Task 4, Epoch 7/20 => Loss 1.300, Train_accy 70.58:  35%|███▌      | 7/20 [01:50<03:23, 15.67s/it]Task 4, Epoch 8/20 => Loss 1.325, Train_accy 70.42:  35%|███▌      | 7/20 [02:06<03:23, 15.67s/it]Task 4, Epoch 8/20 => Loss 1.325, Train_accy 70.42:  40%|████      | 8/20 [02:06<03:09, 15.77s/it]Task 4, Epoch 9/20 => Loss 1.183, Train_accy 70.99:  40%|████      | 8/20 [02:21<03:09, 15.77s/it]Task 4, Epoch 9/20 => Loss 1.183, Train_accy 70.99:  45%|████▌     | 9/20 [02:21<02:51, 15.64s/it]Task 4, Epoch 10/20 => Loss 1.120, Train_accy 73.40:  45%|████▌     | 9/20 [02:36<02:51, 15.64s/it]Task 4, Epoch 10/20 => Loss 1.120, Train_accy 73.40:  50%|█████     | 10/20 [02:36<02:33, 15.37s/it]Task 4, Epoch 11/20 => Loss 1.066, Train_accy 73.56:  50%|█████     | 10/20 [02:51<02:33, 15.37s/it]Task 4, Epoch 11/20 => Loss 1.066, Train_accy 73.56:  55%|█████▌    | 11/20 [02:51<02:16, 15.13s/it]Task 4, Epoch 12/20 => Loss 1.074, Train_accy 73.09:  55%|█████▌    | 11/20 [03:06<02:16, 15.13s/it]Task 4, Epoch 12/20 => Loss 1.074, Train_accy 73.09:  60%|██████    | 12/20 [03:06<02:00, 15.08s/it]Task 4, Epoch 13/20 => Loss 1.040, Train_accy 73.14:  60%|██████    | 12/20 [03:21<02:00, 15.08s/it]Task 4, Epoch 13/20 => Loss 1.040, Train_accy 73.14:  65%|██████▌   | 13/20 [03:21<01:45, 15.07s/it]Task 4, Epoch 14/20 => Loss 1.007, Train_accy 74.19:  65%|██████▌   | 13/20 [03:36<01:45, 15.07s/it]Task 4, Epoch 14/20 => Loss 1.007, Train_accy 74.19:  70%|███████   | 14/20 [03:36<01:31, 15.19s/it]Task 4, Epoch 15/20 => Loss 0.963, Train_accy 75.03:  70%|███████   | 14/20 [03:52<01:31, 15.19s/it]Task 4, Epoch 15/20 => Loss 0.963, Train_accy 75.03:  75%|███████▌  | 15/20 [03:52<01:16, 15.35s/it]Task 4, Epoch 16/20 => Loss 0.966, Train_accy 74.66:  75%|███████▌  | 15/20 [04:07<01:16, 15.35s/it]Task 4, Epoch 16/20 => Loss 0.966, Train_accy 74.66:  80%|████████  | 16/20 [04:07<01:01, 15.30s/it]Task 4, Epoch 17/20 => Loss 0.929, Train_accy 74.87:  80%|████████  | 16/20 [04:23<01:01, 15.30s/it]Task 4, Epoch 17/20 => Loss 0.929, Train_accy 74.87:  85%|████████▌ | 17/20 [04:23<00:46, 15.60s/it]Task 4, Epoch 18/20 => Loss 0.928, Train_accy 75.39:  85%|████████▌ | 17/20 [04:39<00:46, 15.60s/it]Task 4, Epoch 18/20 => Loss 0.928, Train_accy 75.39:  90%|█████████ | 18/20 [04:39<00:31, 15.57s/it]Task 4, Epoch 19/20 => Loss 0.983, Train_accy 73.77:  90%|█████████ | 18/20 [04:54<00:31, 15.57s/it]Task 4, Epoch 19/20 => Loss 0.983, Train_accy 73.77:  95%|█████████▌| 19/20 [04:54<00:15, 15.58s/it]Task 4, Epoch 20/20 => Loss 0.947, Train_accy 74.92:  95%|█████████▌| 19/20 [05:10<00:15, 15.58s/it]Task 4, Epoch 20/20 => Loss 0.947, Train_accy 74.92: 100%|██████████| 20/20 [05:10<00:00, 15.73s/it]Task 4, Epoch 20/20 => Loss 0.947, Train_accy 74.92: 100%|██████████| 20/20 [05:10<00:00, 15.55s/it]
2024-04-22 23:27:11,448 [loramoeinc.py] => Task 4, Epoch 20/20 => Loss 0.947, Train_accy 74.92
2024-04-22 23:28:20,387 [trainer.py] => No NME accuracy.
2024-04-22 23:28:20,387 [trainer.py] => CNN: {'total': 91.35, '00-39': 96.92, '40-79': 89.25, '80-119': 94.16, '120-159': 88.63, '160-199': 87.79, 'old': 92.23, 'new': 87.79}
2024-04-22 23:28:20,387 [trainer.py] => Route: {'total': 86.77, '00-39': 88.33, '40-79': 86.02, '80-119': 87.93, '120-159': 86.11, '160-199': 85.44, 'old': 87.1, 'new': 85.44}
2024-04-22 23:28:20,387 [trainer.py] => CNN top1 curve: [97.14, 93.47, 93.5, 92.23, 91.35]
2024-04-22 23:28:20,387 [trainer.py] => CNN top5 curve: [99.78, 98.37, 98.31, 97.94, 97.37]
2024-04-22 23:28:20,387 [trainer.py] => Route top1 curve: [97.8, 93.25, 90.18, 88.47, 86.77]
2024-04-22 23:28:20,387 [trainer.py] => Route top5 curve: [99.78, 99.02, 98.87, 98.68, 98.18]

Average Accuracy (CNN): 93.53800000000001
Average Accuracy (Route): 91.29400000000001
2024-04-22 23:28:20,387 [trainer.py] => Average Accuracy (CNN): 93.53800000000001
2024-04-22 23:28:20,387 [trainer.py] => Average Accuracy (Route): 91.29400000000001

2024-04-22 23:28:20,387 [trainer.py] => Train Time: 1585.2000000000003
2024-04-22 23:28:20,387 [trainer.py] => Test Time: 0 

2024-04-22 23:28:24,241 [trainer.py] => config: ./exps/loramoe_inc_ina_B0_Inc5.json
2024-04-22 23:28:24,242 [trainer.py] => prefix: reproduce
2024-04-22 23:28:24,242 [trainer.py] => dataset: imageneta
2024-04-22 23:28:24,242 [trainer.py] => memory_size: 0
2024-04-22 23:28:24,242 [trainer.py] => memory_per_class: 0
2024-04-22 23:28:24,242 [trainer.py] => fixed_memory: False
2024-04-22 23:28:24,242 [trainer.py] => shuffle: True
2024-04-22 23:28:24,242 [trainer.py] => init_cls: 40
2024-04-22 23:28:24,242 [trainer.py] => increment: 40
2024-04-22 23:28:24,242 [trainer.py] => model_name: loramoeinc
2024-04-22 23:28:24,242 [trainer.py] => backbone_type: pretrained_vit_b16_224_inc
2024-04-22 23:28:24,242 [trainer.py] => device: [device(type='cuda', index=2)]
2024-04-22 23:28:24,242 [trainer.py] => seed: 1993
2024-04-22 23:28:24,242 [trainer.py] => tuned_epoch: 20
2024-04-22 23:28:24,242 [trainer.py] => init_lr: 0.01
2024-04-22 23:28:24,242 [trainer.py] => batch_size: 48
2024-04-22 23:28:24,242 [trainer.py] => weight_decay: 0.0005
2024-04-22 23:28:24,242 [trainer.py] => min_lr: 0
2024-04-22 23:28:24,242 [trainer.py] => ffn_num: 4
2024-04-22 23:28:24,242 [trainer.py] => optimizer: sgd
2024-04-22 23:28:24,242 [trainer.py] => vpt_type: shallow
2024-04-22 23:28:24,242 [trainer.py] => prompt_token_num: 5
2024-04-22 23:28:24,242 [trainer.py] => expert_num: 5
2024-04-22 23:28:24,276 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
/home/team/zhaohongwei/anaconda3/envs/peft/lib/python3.10/site-packages/bitsandbytes/cuda_setup/main.py:136: UserWarning: /home/team/zhaohongwei/anaconda3/envs/peft did not contain libcudart.so as expected! Searching further paths...
  warn(msg)

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please submit your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
CUDA SETUP: CUDA runtime path found: /usr/local/cuda-11.8/lib64/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 8.6
CUDA SETUP: Detected CUDA version 118
CUDA SETUP: Loading binary /home/team/zhaohongwei/anaconda3/envs/peft/lib/python3.10/site-packages/bitsandbytes/libbitsandbytes_cuda118.so...
I'm using ViT with adapters.
2024-04-22 23:28:40,007 [trainer.py] => All params: 86006136
2024-04-22 23:28:40,008 [trainer.py] => Trainable params: 207480
2024-04-22 23:28:40,297 [loramoeinc.py] => Learning on 0-40
  0%|          | 0/20 [00:00<?, ?it/s]Task 0, Epoch 1/20 => Loss 3.665, Train_accy 9.86:   0%|          | 0/20 [00:12<?, ?it/s]Task 0, Epoch 1/20 => Loss 3.665, Train_accy 9.86:   5%|▌         | 1/20 [00:12<03:54, 12.36s/it]Task 0, Epoch 2/20 => Loss 3.546, Train_accy 24.47:   5%|▌         | 1/20 [00:24<03:54, 12.36s/it]Task 0, Epoch 2/20 => Loss 3.546, Train_accy 24.47:  10%|█         | 2/20 [00:24<03:41, 12.30s/it]Task 0, Epoch 3/20 => Loss 3.352, Train_accy 28.55:  10%|█         | 2/20 [00:37<03:41, 12.30s/it]Task 0, Epoch 3/20 => Loss 3.352, Train_accy 28.55:  15%|█▌        | 3/20 [00:37<03:32, 12.48s/it]Task 0, Epoch 4/20 => Loss 2.986, Train_accy 37.93:  15%|█▌        | 3/20 [00:51<03:32, 12.48s/it]Task 0, Epoch 4/20 => Loss 2.986, Train_accy 37.93:  20%|██        | 4/20 [00:51<03:29, 13.06s/it]Task 0, Epoch 5/20 => Loss 2.469, Train_accy 49.69:  20%|██        | 4/20 [01:03<03:29, 13.06s/it]Task 0, Epoch 5/20 => Loss 2.469, Train_accy 49.69:  25%|██▌       | 5/20 [01:03<03:10, 12.70s/it]Task 0, Epoch 6/20 => Loss 2.074, Train_accy 57.85:  25%|██▌       | 5/20 [01:15<03:10, 12.70s/it]Task 0, Epoch 6/20 => Loss 2.074, Train_accy 57.85:  30%|███       | 6/20 [01:15<02:55, 12.53s/it]Task 0, Epoch 7/20 => Loss 1.785, Train_accy 63.70:  30%|███       | 6/20 [01:28<02:55, 12.53s/it]Task 0, Epoch 7/20 => Loss 1.785, Train_accy 63.70:  35%|███▌      | 7/20 [01:28<02:43, 12.55s/it]Task 0, Epoch 8/20 => Loss 1.487, Train_accy 67.98:  35%|███▌      | 7/20 [01:40<02:43, 12.55s/it]Task 0, Epoch 8/20 => Loss 1.487, Train_accy 67.98:  40%|████      | 8/20 [01:40<02:31, 12.60s/it]Task 0, Epoch 9/20 => Loss 1.315, Train_accy 70.43:  40%|████      | 8/20 [01:52<02:31, 12.60s/it]Task 0, Epoch 9/20 => Loss 1.315, Train_accy 70.43:  45%|████▌     | 9/20 [01:52<02:16, 12.40s/it]Task 0, Epoch 10/20 => Loss 1.184, Train_accy 72.81:  45%|████▌     | 9/20 [02:04<02:16, 12.40s/it]Task 0, Epoch 10/20 => Loss 1.184, Train_accy 72.81:  50%|█████     | 10/20 [02:04<02:02, 12.29s/it]Task 0, Epoch 11/20 => Loss 1.110, Train_accy 74.71:  50%|█████     | 10/20 [02:17<02:02, 12.29s/it]Task 0, Epoch 11/20 => Loss 1.110, Train_accy 74.71:  55%|█████▌    | 11/20 [02:17<01:50, 12.27s/it]Task 0, Epoch 12/20 => Loss 0.998, Train_accy 77.91:  55%|█████▌    | 11/20 [02:29<01:50, 12.27s/it]Task 0, Epoch 12/20 => Loss 0.998, Train_accy 77.91:  60%|██████    | 12/20 [02:29<01:38, 12.37s/it]Task 0, Epoch 13/20 => Loss 0.967, Train_accy 78.38:  60%|██████    | 12/20 [02:42<01:38, 12.37s/it]Task 0, Epoch 13/20 => Loss 0.967, Train_accy 78.38:  65%|██████▌   | 13/20 [02:42<01:26, 12.37s/it]Task 0, Epoch 14/20 => Loss 0.931, Train_accy 79.61:  65%|██████▌   | 13/20 [02:54<01:26, 12.37s/it]Task 0, Epoch 14/20 => Loss 0.931, Train_accy 79.61:  70%|███████   | 14/20 [02:54<01:14, 12.37s/it]Task 0, Epoch 15/20 => Loss 0.923, Train_accy 79.06:  70%|███████   | 14/20 [03:06<01:14, 12.37s/it]Task 0, Epoch 15/20 => Loss 0.923, Train_accy 79.06:  75%|███████▌  | 15/20 [03:06<01:00, 12.19s/it]Task 0, Epoch 16/20 => Loss 0.847, Train_accy 80.49:  75%|███████▌  | 15/20 [03:19<01:00, 12.19s/it]Task 0, Epoch 16/20 => Loss 0.847, Train_accy 80.49:  80%|████████  | 16/20 [03:19<00:49, 12.39s/it]Task 0, Epoch 17/20 => Loss 0.813, Train_accy 81.58:  80%|████████  | 16/20 [03:31<00:49, 12.39s/it]Task 0, Epoch 17/20 => Loss 0.813, Train_accy 81.58:  85%|████████▌ | 17/20 [03:31<00:37, 12.39s/it]Task 0, Epoch 18/20 => Loss 0.839, Train_accy 81.03:  85%|████████▌ | 17/20 [03:43<00:37, 12.39s/it]Task 0, Epoch 18/20 => Loss 0.839, Train_accy 81.03:  90%|█████████ | 18/20 [03:43<00:24, 12.36s/it]Task 0, Epoch 19/20 => Loss 0.841, Train_accy 81.31:  90%|█████████ | 18/20 [03:55<00:24, 12.36s/it]Task 0, Epoch 19/20 => Loss 0.841, Train_accy 81.31:  95%|█████████▌| 19/20 [03:55<00:12, 12.28s/it]Task 0, Epoch 20/20 => Loss 0.815, Train_accy 82.46:  95%|█████████▌| 19/20 [04:08<00:12, 12.28s/it]Task 0, Epoch 20/20 => Loss 0.815, Train_accy 82.46: 100%|██████████| 20/20 [04:08<00:00, 12.33s/it]Task 0, Epoch 20/20 => Loss 0.815, Train_accy 82.46: 100%|██████████| 20/20 [04:08<00:00, 12.41s/it]
2024-04-22 23:32:48,795 [loramoeinc.py] => Task 0, Epoch 20/20 => Loss 0.815, Train_accy 82.46
2024-04-22 23:33:33,721 [trainer.py] => No NME accuracy.
2024-04-22 23:33:33,721 [trainer.py] => CNN: {'total': 80.28, '00-39': 80.28, 'old': 0, 'new': 80.28}
2024-04-22 23:33:33,721 [trainer.py] => Route: {'total': 71.39, '00-39': 71.39, 'old': 0, 'new': 71.39}
2024-04-22 23:33:33,721 [trainer.py] => CNN top1 curve: [80.28]
2024-04-22 23:33:33,721 [trainer.py] => CNN top5 curve: [93.89]
2024-04-22 23:33:33,721 [trainer.py] => Route top1 curve: [71.39]
2024-04-22 23:33:33,721 [trainer.py] => Route top5 curve: [92.22]

Average Accuracy (CNN): 80.28
Average Accuracy (Route): 71.39
2024-04-22 23:33:33,721 [trainer.py] => Average Accuracy (CNN): 80.28
2024-04-22 23:33:33,721 [trainer.py] => Average Accuracy (Route): 71.39

2024-04-22 23:33:33,721 [trainer.py] => Train Time: 248.24
2024-04-22 23:33:33,721 [trainer.py] => Test Time: 0 

2024-04-22 23:33:33,723 [trainer.py] => All params: 86067578
2024-04-22 23:33:33,724 [trainer.py] => Trainable params: 196705
2024-04-22 23:33:33,727 [loramoeinc.py] => Learning on 40-80
  0%|          | 0/20 [00:00<?, ?it/s]Task 1, Epoch 1/20 => Loss 3.082, Train_accy 33.28:   0%|          | 0/20 [00:11<?, ?it/s]Task 1, Epoch 1/20 => Loss 3.082, Train_accy 33.28:   5%|▌         | 1/20 [00:11<03:30, 11.09s/it]Task 1, Epoch 2/20 => Loss 2.386, Train_accy 50.89:   5%|▌         | 1/20 [00:22<03:30, 11.09s/it]Task 1, Epoch 2/20 => Loss 2.386, Train_accy 50.89:  10%|█         | 2/20 [00:22<03:26, 11.45s/it]Task 1, Epoch 3/20 => Loss 2.094, Train_accy 56.37:  10%|█         | 2/20 [00:33<03:26, 11.45s/it]Task 1, Epoch 3/20 => Loss 2.094, Train_accy 56.37:  15%|█▌        | 3/20 [00:33<03:11, 11.26s/it]Task 1, Epoch 4/20 => Loss 1.982, Train_accy 57.07:  15%|█▌        | 3/20 [00:44<03:11, 11.26s/it]Task 1, Epoch 4/20 => Loss 1.982, Train_accy 57.07:  20%|██        | 4/20 [00:44<02:57, 11.11s/it]Task 1, Epoch 5/20 => Loss 1.812, Train_accy 61.85:  20%|██        | 4/20 [00:56<02:57, 11.11s/it]Task 1, Epoch 5/20 => Loss 1.812, Train_accy 61.85:  25%|██▌       | 5/20 [00:56<02:49, 11.32s/it]Task 1, Epoch 6/20 => Loss 1.686, Train_accy 64.56:  25%|██▌       | 5/20 [01:07<02:49, 11.32s/it]Task 1, Epoch 6/20 => Loss 1.686, Train_accy 64.56:  30%|███       | 6/20 [01:07<02:36, 11.18s/it]Task 1, Epoch 7/20 => Loss 1.636, Train_accy 65.17:  30%|███       | 6/20 [01:18<02:36, 11.18s/it]Task 1, Epoch 7/20 => Loss 1.636, Train_accy 65.17:  35%|███▌      | 7/20 [01:18<02:23, 11.04s/it]Task 1, Epoch 8/20 => Loss 1.558, Train_accy 65.17:  35%|███▌      | 7/20 [01:28<02:23, 11.04s/it]Task 1, Epoch 8/20 => Loss 1.558, Train_accy 65.17:  40%|████      | 8/20 [01:28<02:10, 10.90s/it]Task 1, Epoch 9/20 => Loss 1.443, Train_accy 68.34:  40%|████      | 8/20 [01:39<02:10, 10.90s/it]Task 1, Epoch 9/20 => Loss 1.443, Train_accy 68.34:  45%|████▌     | 9/20 [01:39<01:59, 10.83s/it]Task 1, Epoch 10/20 => Loss 1.427, Train_accy 67.26:  45%|████▌     | 9/20 [01:50<01:59, 10.83s/it]Task 1, Epoch 10/20 => Loss 1.427, Train_accy 67.26:  50%|█████     | 10/20 [01:50<01:49, 10.93s/it]Task 1, Epoch 11/20 => Loss 1.371, Train_accy 68.73:  50%|█████     | 10/20 [02:02<01:49, 10.93s/it]Task 1, Epoch 11/20 => Loss 1.371, Train_accy 68.73:  55%|█████▌    | 11/20 [02:02<01:40, 11.15s/it]Task 1, Epoch 12/20 => Loss 1.333, Train_accy 69.34:  55%|█████▌    | 11/20 [02:12<01:40, 11.15s/it]Task 1, Epoch 12/20 => Loss 1.333, Train_accy 69.34:  60%|██████    | 12/20 [02:12<01:28, 11.00s/it]Task 1, Epoch 13/20 => Loss 1.285, Train_accy 70.35:  60%|██████    | 12/20 [02:24<01:28, 11.00s/it]Task 1, Epoch 13/20 => Loss 1.285, Train_accy 70.35:  65%|██████▌   | 13/20 [02:24<01:18, 11.19s/it]Task 1, Epoch 14/20 => Loss 1.292, Train_accy 71.27:  65%|██████▌   | 13/20 [02:35<01:18, 11.19s/it]Task 1, Epoch 14/20 => Loss 1.292, Train_accy 71.27:  70%|███████   | 14/20 [02:35<01:07, 11.17s/it]Task 1, Epoch 15/20 => Loss 1.200, Train_accy 73.05:  70%|███████   | 14/20 [02:46<01:07, 11.17s/it]Task 1, Epoch 15/20 => Loss 1.200, Train_accy 73.05:  75%|███████▌  | 15/20 [02:46<00:55, 11.15s/it]Task 1, Epoch 16/20 => Loss 1.232, Train_accy 71.12:  75%|███████▌  | 15/20 [02:57<00:55, 11.15s/it]Task 1, Epoch 16/20 => Loss 1.232, Train_accy 71.12:  80%|████████  | 16/20 [02:57<00:44, 11.15s/it]Task 1, Epoch 17/20 => Loss 1.172, Train_accy 73.51:  80%|████████  | 16/20 [03:08<00:44, 11.15s/it]Task 1, Epoch 17/20 => Loss 1.172, Train_accy 73.51:  85%|████████▌ | 17/20 [03:08<00:33, 11.07s/it]Task 1, Epoch 18/20 => Loss 1.187, Train_accy 72.74:  85%|████████▌ | 17/20 [03:18<00:33, 11.07s/it]Task 1, Epoch 18/20 => Loss 1.187, Train_accy 72.74:  90%|█████████ | 18/20 [03:18<00:21, 10.79s/it]Task 1, Epoch 19/20 => Loss 1.158, Train_accy 73.20:  90%|█████████ | 18/20 [03:30<00:21, 10.79s/it]Task 1, Epoch 19/20 => Loss 1.158, Train_accy 73.20:  95%|█████████▌| 19/20 [03:30<00:10, 10.99s/it]Task 1, Epoch 20/20 => Loss 1.174, Train_accy 72.90:  95%|█████████▌| 19/20 [03:42<00:10, 10.99s/it]Task 1, Epoch 20/20 => Loss 1.174, Train_accy 72.90: 100%|██████████| 20/20 [03:42<00:00, 11.22s/it]Task 1, Epoch 20/20 => Loss 1.174, Train_accy 72.90: 100%|██████████| 20/20 [03:42<00:00, 11.10s/it]
2024-04-22 23:37:15,804 [loramoeinc.py] => Task 1, Epoch 20/20 => Loss 1.174, Train_accy 72.90
2024-04-22 23:38:04,179 [trainer.py] => No NME accuracy.
2024-04-22 23:38:04,179 [trainer.py] => CNN: {'total': 77.08, '00-39': 80.28, '40-79': 73.67, 'old': 80.28, 'new': 73.67}
2024-04-22 23:38:04,179 [trainer.py] => Route: {'total': 62.75, '00-39': 60.83, '40-79': 64.79, 'old': 60.83, 'new': 64.79}
2024-04-22 23:38:04,179 [trainer.py] => CNN top1 curve: [80.28, 77.08]
2024-04-22 23:38:04,179 [trainer.py] => CNN top5 curve: [93.89, 91.4]
2024-04-22 23:38:04,179 [trainer.py] => Route top1 curve: [71.39, 62.75]
2024-04-22 23:38:04,179 [trainer.py] => Route top5 curve: [92.22, 88.4]

Average Accuracy (CNN): 78.68
Average Accuracy (Route): 67.07
2024-04-22 23:38:04,179 [trainer.py] => Average Accuracy (CNN): 78.68
2024-04-22 23:38:04,179 [trainer.py] => Average Accuracy (Route): 67.07

2024-04-22 23:38:04,179 [trainer.py] => Train Time: 470.3
2024-04-22 23:38:04,179 [trainer.py] => Test Time: 0 

2024-04-22 23:38:04,180 [trainer.py] => All params: 86129018
2024-04-22 23:38:04,181 [trainer.py] => Trainable params: 185929
2024-04-22 23:38:04,195 [loramoeinc.py] => Learning on 80-120
  0%|          | 0/20 [00:00<?, ?it/s]Task 2, Epoch 1/20 => Loss 3.801, Train_accy 24.16:   0%|          | 0/20 [00:09<?, ?it/s]Task 2, Epoch 1/20 => Loss 3.801, Train_accy 24.16:   5%|▌         | 1/20 [00:09<02:57,  9.33s/it]Task 2, Epoch 2/20 => Loss 2.959, Train_accy 40.31:   5%|▌         | 1/20 [00:18<02:57,  9.33s/it]Task 2, Epoch 2/20 => Loss 2.959, Train_accy 40.31:  10%|█         | 2/20 [00:18<02:47,  9.31s/it]Task 2, Epoch 3/20 => Loss 2.309, Train_accy 52.24:  10%|█         | 2/20 [00:27<02:47,  9.31s/it]Task 2, Epoch 3/20 => Loss 2.309, Train_accy 52.24:  15%|█▌        | 3/20 [00:27<02:34,  9.09s/it]Task 2, Epoch 4/20 => Loss 2.066, Train_accy 54.15:  15%|█▌        | 3/20 [00:36<02:34,  9.09s/it]Task 2, Epoch 4/20 => Loss 2.066, Train_accy 54.15:  20%|██        | 4/20 [00:36<02:22,  8.94s/it]Task 2, Epoch 5/20 => Loss 1.941, Train_accy 57.78:  20%|██        | 4/20 [00:44<02:22,  8.94s/it]Task 2, Epoch 5/20 => Loss 1.941, Train_accy 57.78:  25%|██▌       | 5/20 [00:44<02:10,  8.73s/it]Task 2, Epoch 6/20 => Loss 1.816, Train_accy 59.31:  25%|██▌       | 5/20 [00:53<02:10,  8.73s/it]Task 2, Epoch 6/20 => Loss 1.816, Train_accy 59.31:  30%|███       | 6/20 [00:53<02:01,  8.69s/it]Task 2, Epoch 7/20 => Loss 1.857, Train_accy 58.45:  30%|███       | 6/20 [01:02<02:01,  8.69s/it]Task 2, Epoch 7/20 => Loss 1.857, Train_accy 58.45:  35%|███▌      | 7/20 [01:02<01:53,  8.76s/it]Task 2, Epoch 8/20 => Loss 1.713, Train_accy 60.46:  35%|███▌      | 7/20 [01:11<01:53,  8.76s/it]Task 2, Epoch 8/20 => Loss 1.713, Train_accy 60.46:  40%|████      | 8/20 [01:11<01:46,  8.91s/it]Task 2, Epoch 9/20 => Loss 1.592, Train_accy 61.80:  40%|████      | 8/20 [01:20<01:46,  8.91s/it]Task 2, Epoch 9/20 => Loss 1.592, Train_accy 61.80:  45%|████▌     | 9/20 [01:20<01:38,  8.99s/it]Task 2, Epoch 10/20 => Loss 1.560, Train_accy 63.51:  45%|████▌     | 9/20 [01:28<01:38,  8.99s/it]Task 2, Epoch 10/20 => Loss 1.560, Train_accy 63.51:  50%|█████     | 10/20 [01:28<01:28,  8.82s/it]Task 2, Epoch 11/20 => Loss 1.477, Train_accy 64.76:  50%|█████     | 10/20 [01:37<01:28,  8.82s/it]Task 2, Epoch 11/20 => Loss 1.477, Train_accy 64.76:  55%|█████▌    | 11/20 [01:37<01:19,  8.89s/it]Task 2, Epoch 12/20 => Loss 1.406, Train_accy 65.04:  55%|█████▌    | 11/20 [01:47<01:19,  8.89s/it]Task 2, Epoch 12/20 => Loss 1.406, Train_accy 65.04:  60%|██████    | 12/20 [01:47<01:13,  9.15s/it]Task 2, Epoch 13/20 => Loss 1.419, Train_accy 65.33:  60%|██████    | 12/20 [01:56<01:13,  9.15s/it]Task 2, Epoch 13/20 => Loss 1.419, Train_accy 65.33:  65%|██████▌   | 13/20 [01:56<01:04,  9.16s/it]Task 2, Epoch 14/20 => Loss 1.377, Train_accy 66.19:  65%|██████▌   | 13/20 [02:06<01:04,  9.16s/it]Task 2, Epoch 14/20 => Loss 1.377, Train_accy 66.19:  70%|███████   | 14/20 [02:06<00:55,  9.22s/it]Task 2, Epoch 15/20 => Loss 1.311, Train_accy 67.05:  70%|███████   | 14/20 [02:14<00:55,  9.22s/it]Task 2, Epoch 15/20 => Loss 1.311, Train_accy 67.05:  75%|███████▌  | 15/20 [02:14<00:45,  9.03s/it]Task 2, Epoch 16/20 => Loss 1.296, Train_accy 67.62:  75%|███████▌  | 15/20 [02:23<00:45,  9.03s/it]Task 2, Epoch 16/20 => Loss 1.296, Train_accy 67.62:  80%|████████  | 16/20 [02:23<00:36,  9.05s/it]Task 2, Epoch 17/20 => Loss 1.282, Train_accy 67.43:  80%|████████  | 16/20 [02:33<00:36,  9.05s/it]Task 2, Epoch 17/20 => Loss 1.282, Train_accy 67.43:  85%|████████▌ | 17/20 [02:33<00:27,  9.09s/it]Task 2, Epoch 18/20 => Loss 1.282, Train_accy 68.29:  85%|████████▌ | 17/20 [02:42<00:27,  9.09s/it]Task 2, Epoch 18/20 => Loss 1.282, Train_accy 68.29:  90%|█████████ | 18/20 [02:42<00:18,  9.08s/it]Task 2, Epoch 19/20 => Loss 1.282, Train_accy 68.10:  90%|█████████ | 18/20 [02:50<00:18,  9.08s/it]Task 2, Epoch 19/20 => Loss 1.282, Train_accy 68.10:  95%|█████████▌| 19/20 [02:50<00:08,  8.96s/it]Task 2, Epoch 20/20 => Loss 1.264, Train_accy 67.81:  95%|█████████▌| 19/20 [02:59<00:08,  8.96s/it]Task 2, Epoch 20/20 => Loss 1.264, Train_accy 67.81: 100%|██████████| 20/20 [02:59<00:00,  8.91s/it]Task 2, Epoch 20/20 => Loss 1.264, Train_accy 67.81: 100%|██████████| 20/20 [02:59<00:00,  8.98s/it]
2024-04-22 23:41:03,826 [loramoeinc.py] => Task 2, Epoch 20/20 => Loss 1.264, Train_accy 67.81
2024-04-22 23:41:52,122 [trainer.py] => No NME accuracy.
2024-04-22 23:41:52,122 [trainer.py] => CNN: {'total': 73.23, '00-39': 80.28, '40-79': 73.67, '80-119': 63.54, 'old': 77.08, 'new': 63.54}
2024-04-22 23:41:52,122 [trainer.py] => Route: {'total': 56.92, '00-39': 53.06, '40-79': 58.88, '80-119': 59.57, 'old': 55.87, 'new': 59.57}
2024-04-22 23:41:52,122 [trainer.py] => CNN top1 curve: [80.28, 77.08, 73.23]
2024-04-22 23:41:52,123 [trainer.py] => CNN top5 curve: [93.89, 91.4, 88.62]
2024-04-22 23:41:52,123 [trainer.py] => Route top1 curve: [71.39, 62.75, 56.92]
2024-04-22 23:41:52,123 [trainer.py] => Route top5 curve: [92.22, 88.4, 84.41]

Average Accuracy (CNN): 76.86333333333334
Average Accuracy (Route): 63.68666666666667
2024-04-22 23:41:52,123 [trainer.py] => Average Accuracy (CNN): 76.86333333333334
2024-04-22 23:41:52,123 [trainer.py] => Average Accuracy (Route): 63.68666666666667

2024-04-22 23:41:52,123 [trainer.py] => Train Time: 649.9200000000001
2024-04-22 23:41:52,123 [trainer.py] => Test Time: 0 

2024-04-22 23:41:52,124 [trainer.py] => All params: 86190458
2024-04-22 23:41:52,125 [trainer.py] => Trainable params: 175153
2024-04-22 23:41:52,136 [loramoeinc.py] => Learning on 120-160
  0%|          | 0/20 [00:00<?, ?it/s]Task 3, Epoch 1/20 => Loss 4.388, Train_accy 15.61:   0%|          | 0/20 [00:08<?, ?it/s]Task 3, Epoch 1/20 => Loss 4.388, Train_accy 15.61:   5%|▌         | 1/20 [00:08<02:47,  8.81s/it]Task 3, Epoch 2/20 => Loss 3.455, Train_accy 30.09:   5%|▌         | 1/20 [00:18<02:47,  8.81s/it]Task 3, Epoch 2/20 => Loss 3.455, Train_accy 30.09:  10%|█         | 2/20 [00:18<02:46,  9.27s/it]Task 3, Epoch 3/20 => Loss 2.857, Train_accy 39.72:  10%|█         | 2/20 [00:28<02:46,  9.27s/it]Task 3, Epoch 3/20 => Loss 2.857, Train_accy 39.72:  15%|█▌        | 3/20 [00:28<02:42,  9.57s/it]Task 3, Epoch 4/20 => Loss 2.536, Train_accy 45.89:  15%|█▌        | 3/20 [00:36<02:42,  9.57s/it]Task 3, Epoch 4/20 => Loss 2.536, Train_accy 45.89:  20%|██        | 4/20 [00:36<02:27,  9.20s/it]Task 3, Epoch 5/20 => Loss 2.450, Train_accy 45.61:  20%|██        | 4/20 [00:45<02:27,  9.20s/it]Task 3, Epoch 5/20 => Loss 2.450, Train_accy 45.61:  25%|██▌       | 5/20 [00:45<02:16,  9.09s/it]Task 3, Epoch 6/20 => Loss 2.315, Train_accy 49.63:  25%|██▌       | 5/20 [00:55<02:16,  9.09s/it]Task 3, Epoch 6/20 => Loss 2.315, Train_accy 49.63:  30%|███       | 6/20 [00:55<02:08,  9.17s/it]Task 3, Epoch 7/20 => Loss 2.159, Train_accy 51.21:  30%|███       | 6/20 [01:04<02:08,  9.17s/it]Task 3, Epoch 7/20 => Loss 2.159, Train_accy 51.21:  35%|███▌      | 7/20 [01:04<01:57,  9.07s/it]Task 3, Epoch 8/20 => Loss 2.115, Train_accy 52.43:  35%|███▌      | 7/20 [01:13<01:57,  9.07s/it]Task 3, Epoch 8/20 => Loss 2.115, Train_accy 52.43:  40%|████      | 8/20 [01:13<01:50,  9.17s/it]Task 3, Epoch 9/20 => Loss 2.008, Train_accy 52.99:  40%|████      | 8/20 [01:22<01:50,  9.17s/it]Task 3, Epoch 9/20 => Loss 2.008, Train_accy 52.99:  45%|████▌     | 9/20 [01:22<01:40,  9.12s/it]Task 3, Epoch 10/20 => Loss 1.936, Train_accy 54.95:  45%|████▌     | 9/20 [01:31<01:40,  9.12s/it]Task 3, Epoch 10/20 => Loss 1.936, Train_accy 54.95:  50%|█████     | 10/20 [01:31<01:31,  9.12s/it]Task 3, Epoch 11/20 => Loss 1.840, Train_accy 56.54:  50%|█████     | 10/20 [01:40<01:31,  9.12s/it]Task 3, Epoch 11/20 => Loss 1.840, Train_accy 56.54:  55%|█████▌    | 11/20 [01:40<01:22,  9.15s/it]Task 3, Epoch 12/20 => Loss 1.788, Train_accy 57.85:  55%|█████▌    | 11/20 [01:49<01:22,  9.15s/it]Task 3, Epoch 12/20 => Loss 1.788, Train_accy 57.85:  60%|██████    | 12/20 [01:49<01:12,  9.12s/it]Task 3, Epoch 13/20 => Loss 1.711, Train_accy 58.13:  60%|██████    | 12/20 [01:59<01:12,  9.12s/it]Task 3, Epoch 13/20 => Loss 1.711, Train_accy 58.13:  65%|██████▌   | 13/20 [01:59<01:04,  9.15s/it]Task 3, Epoch 14/20 => Loss 1.666, Train_accy 58.88:  65%|██████▌   | 13/20 [02:08<01:04,  9.15s/it]Task 3, Epoch 14/20 => Loss 1.666, Train_accy 58.88:  70%|███████   | 14/20 [02:08<00:55,  9.19s/it]Task 3, Epoch 15/20 => Loss 1.648, Train_accy 59.63:  70%|███████   | 14/20 [02:18<00:55,  9.19s/it]Task 3, Epoch 15/20 => Loss 1.648, Train_accy 59.63:  75%|███████▌  | 15/20 [02:18<00:46,  9.38s/it]Task 3, Epoch 16/20 => Loss 1.623, Train_accy 61.21:  75%|███████▌  | 15/20 [02:27<00:46,  9.38s/it]Task 3, Epoch 16/20 => Loss 1.623, Train_accy 61.21:  80%|████████  | 16/20 [02:27<00:37,  9.40s/it]Task 3, Epoch 17/20 => Loss 1.585, Train_accy 60.28:  80%|████████  | 16/20 [02:37<00:37,  9.40s/it]Task 3, Epoch 17/20 => Loss 1.585, Train_accy 60.28:  85%|████████▌ | 17/20 [02:37<00:28,  9.47s/it]Task 3, Epoch 18/20 => Loss 1.561, Train_accy 61.78:  85%|████████▌ | 17/20 [02:46<00:28,  9.47s/it]Task 3, Epoch 18/20 => Loss 1.561, Train_accy 61.78:  90%|█████████ | 18/20 [02:46<00:18,  9.36s/it]Task 3, Epoch 19/20 => Loss 1.525, Train_accy 62.24:  90%|█████████ | 18/20 [02:55<00:18,  9.36s/it]Task 3, Epoch 19/20 => Loss 1.525, Train_accy 62.24:  95%|█████████▌| 19/20 [02:55<00:09,  9.39s/it]Task 3, Epoch 20/20 => Loss 1.547, Train_accy 61.87:  95%|█████████▌| 19/20 [03:04<00:09,  9.39s/it]Task 3, Epoch 20/20 => Loss 1.547, Train_accy 61.87: 100%|██████████| 20/20 [03:04<00:00,  9.17s/it]Task 3, Epoch 20/20 => Loss 1.547, Train_accy 61.87: 100%|██████████| 20/20 [03:04<00:00,  9.22s/it]
2024-04-22 23:44:56,609 [loramoeinc.py] => Task 3, Epoch 20/20 => Loss 1.547, Train_accy 61.87
2024-04-22 23:45:47,476 [trainer.py] => No NME accuracy.
2024-04-22 23:45:47,476 [trainer.py] => CNN: {'total': 67.95, '00-39': 80.28, '40-79': 73.67, '80-119': 63.54, '120-159': 49.08, 'old': 73.23, 'new': 49.08}
2024-04-22 23:45:47,476 [trainer.py] => Route: {'total': 52.0, '00-39': 50.28, '40-79': 53.55, '80-119': 57.76, '120-159': 46.52, 'old': 53.54, 'new': 46.52}
2024-04-22 23:45:47,476 [trainer.py] => CNN top1 curve: [80.28, 77.08, 73.23, 67.95]
2024-04-22 23:45:47,476 [trainer.py] => CNN top5 curve: [93.89, 91.4, 88.62, 84.05]
2024-04-22 23:45:47,477 [trainer.py] => Route top1 curve: [71.39, 62.75, 56.92, 52.0]
2024-04-22 23:45:47,477 [trainer.py] => Route top5 curve: [92.22, 88.4, 84.41, 80.13]

Average Accuracy (CNN): 74.635
Average Accuracy (Route): 60.765
2024-04-22 23:45:47,477 [trainer.py] => Average Accuracy (CNN): 74.635
2024-04-22 23:45:47,477 [trainer.py] => Average Accuracy (Route): 60.765

2024-04-22 23:45:47,477 [trainer.py] => Train Time: 834.3800000000001
2024-04-22 23:45:47,477 [trainer.py] => Test Time: 0 

2024-04-22 23:45:47,478 [trainer.py] => All params: 86251898
2024-04-22 23:45:47,479 [trainer.py] => Trainable params: 164377
2024-04-22 23:45:47,484 [loramoeinc.py] => Learning on 160-200
  0%|          | 0/20 [00:00<?, ?it/s]Task 4, Epoch 1/20 => Loss 4.500, Train_accy 16.58:   0%|          | 0/20 [00:09<?, ?it/s]Task 4, Epoch 1/20 => Loss 4.500, Train_accy 16.58:   5%|▌         | 1/20 [00:09<02:53,  9.12s/it]Task 4, Epoch 2/20 => Loss 3.381, Train_accy 37.89:   5%|▌         | 1/20 [00:18<02:53,  9.12s/it]Task 4, Epoch 2/20 => Loss 3.381, Train_accy 37.89:  10%|█         | 2/20 [00:18<02:43,  9.09s/it]Task 4, Epoch 3/20 => Loss 2.825, Train_accy 44.99:  10%|█         | 2/20 [00:27<02:43,  9.09s/it]Task 4, Epoch 3/20 => Loss 2.825, Train_accy 44.99:  15%|█▌        | 3/20 [00:27<02:33,  9.02s/it]Task 4, Epoch 4/20 => Loss 2.514, Train_accy 49.45:  15%|█▌        | 3/20 [00:36<02:33,  9.02s/it]Task 4, Epoch 4/20 => Loss 2.514, Train_accy 49.45:  20%|██        | 4/20 [00:36<02:28,  9.27s/it]Task 4, Epoch 5/20 => Loss 2.501, Train_accy 50.55:  20%|██        | 4/20 [00:45<02:28,  9.27s/it]Task 4, Epoch 5/20 => Loss 2.501, Train_accy 50.55:  25%|██▌       | 5/20 [00:45<02:17,  9.18s/it]Task 4, Epoch 6/20 => Loss 2.421, Train_accy 51.73:  25%|██▌       | 5/20 [00:55<02:17,  9.18s/it]Task 4, Epoch 6/20 => Loss 2.421, Train_accy 51.73:  30%|███       | 6/20 [00:55<02:10,  9.29s/it]Task 4, Epoch 7/20 => Loss 2.338, Train_accy 52.00:  30%|███       | 6/20 [01:04<02:10,  9.29s/it]Task 4, Epoch 7/20 => Loss 2.338, Train_accy 52.00:  35%|███▌      | 7/20 [01:04<01:59,  9.22s/it]Task 4, Epoch 8/20 => Loss 2.213, Train_accy 53.28:  35%|███▌      | 7/20 [01:13<01:59,  9.22s/it]Task 4, Epoch 8/20 => Loss 2.213, Train_accy 53.28:  40%|████      | 8/20 [01:13<01:48,  9.04s/it]Task 4, Epoch 9/20 => Loss 2.009, Train_accy 57.29:  40%|████      | 8/20 [01:22<01:48,  9.04s/it]Task 4, Epoch 9/20 => Loss 2.009, Train_accy 57.29:  45%|████▌     | 9/20 [01:22<01:39,  9.05s/it]Task 4, Epoch 10/20 => Loss 2.026, Train_accy 58.11:  45%|████▌     | 9/20 [01:31<01:39,  9.05s/it]Task 4, Epoch 10/20 => Loss 2.026, Train_accy 58.11:  50%|█████     | 10/20 [01:31<01:30,  9.01s/it]Task 4, Epoch 11/20 => Loss 1.991, Train_accy 58.29:  50%|█████     | 10/20 [01:40<01:30,  9.01s/it]Task 4, Epoch 11/20 => Loss 1.991, Train_accy 58.29:  55%|█████▌    | 11/20 [01:40<01:22,  9.12s/it]Task 4, Epoch 12/20 => Loss 1.825, Train_accy 60.29:  55%|█████▌    | 11/20 [01:49<01:22,  9.12s/it]Task 4, Epoch 12/20 => Loss 1.825, Train_accy 60.29:  60%|██████    | 12/20 [01:49<01:13,  9.24s/it]Task 4, Epoch 13/20 => Loss 1.777, Train_accy 59.93:  60%|██████    | 12/20 [01:58<01:13,  9.24s/it]Task 4, Epoch 13/20 => Loss 1.777, Train_accy 59.93:  65%|██████▌   | 13/20 [01:58<01:03,  9.13s/it]Task 4, Epoch 14/20 => Loss 1.748, Train_accy 61.93:  65%|██████▌   | 13/20 [02:08<01:03,  9.13s/it]Task 4, Epoch 14/20 => Loss 1.748, Train_accy 61.93:  70%|███████   | 14/20 [02:08<00:55,  9.19s/it]Task 4, Epoch 15/20 => Loss 1.706, Train_accy 61.84:  70%|███████   | 14/20 [02:17<00:55,  9.19s/it]Task 4, Epoch 15/20 => Loss 1.706, Train_accy 61.84:  75%|███████▌  | 15/20 [02:17<00:46,  9.29s/it]Task 4, Epoch 16/20 => Loss 1.683, Train_accy 62.20:  75%|███████▌  | 15/20 [02:26<00:46,  9.29s/it]Task 4, Epoch 16/20 => Loss 1.683, Train_accy 62.20:  80%|████████  | 16/20 [02:26<00:36,  9.20s/it]Task 4, Epoch 17/20 => Loss 1.689, Train_accy 62.20:  80%|████████  | 16/20 [02:35<00:36,  9.20s/it]Task 4, Epoch 17/20 => Loss 1.689, Train_accy 62.20:  85%|████████▌ | 17/20 [02:35<00:27,  9.26s/it]Task 4, Epoch 18/20 => Loss 1.586, Train_accy 63.48:  85%|████████▌ | 17/20 [02:44<00:27,  9.26s/it]Task 4, Epoch 18/20 => Loss 1.586, Train_accy 63.48:  90%|█████████ | 18/20 [02:44<00:18,  9.05s/it]Task 4, Epoch 19/20 => Loss 1.628, Train_accy 63.48:  90%|█████████ | 18/20 [02:53<00:18,  9.05s/it]Task 4, Epoch 19/20 => Loss 1.628, Train_accy 63.48:  95%|█████████▌| 19/20 [02:53<00:09,  9.03s/it]Task 4, Epoch 20/20 => Loss 1.620, Train_accy 63.75:  95%|█████████▌| 19/20 [03:03<00:09,  9.03s/it]Task 4, Epoch 20/20 => Loss 1.620, Train_accy 63.75: 100%|██████████| 20/20 [03:03<00:00,  9.16s/it]Task 4, Epoch 20/20 => Loss 1.620, Train_accy 63.75: 100%|██████████| 20/20 [03:03<00:00,  9.15s/it]
2024-04-22 23:48:50,500 [loramoeinc.py] => Task 4, Epoch 20/20 => Loss 1.620, Train_accy 63.75
2024-04-22 23:49:44,575 [trainer.py] => No NME accuracy.
2024-04-22 23:49:44,575 [trainer.py] => CNN: {'total': 65.37, '00-39': 80.28, '40-79': 73.67, '80-119': 63.54, '120-159': 49.08, '160-199': 53.51, 'old': 67.95, 'new': 53.51}
2024-04-22 23:49:44,575 [trainer.py] => Route: {'total': 48.45, '00-39': 47.78, '40-79': 51.78, '80-119': 55.23, '120-159': 43.96, '160-199': 42.8, 'old': 49.68, 'new': 42.8}
2024-04-22 23:49:44,575 [trainer.py] => CNN top1 curve: [80.28, 77.08, 73.23, 67.95, 65.37]
2024-04-22 23:49:44,575 [trainer.py] => CNN top5 curve: [93.89, 91.4, 88.62, 84.05, 83.21]
2024-04-22 23:49:44,575 [trainer.py] => Route top1 curve: [71.39, 62.75, 56.92, 52.0, 48.45]
2024-04-22 23:49:44,575 [trainer.py] => Route top5 curve: [92.22, 88.4, 84.41, 80.13, 75.64]

Average Accuracy (CNN): 72.78200000000001
Average Accuracy (Route): 58.302
2024-04-22 23:49:44,575 [trainer.py] => Average Accuracy (CNN): 72.78200000000001
2024-04-22 23:49:44,575 [trainer.py] => Average Accuracy (Route): 58.302

2024-04-22 23:49:44,575 [trainer.py] => Train Time: 1017.3800000000001
2024-04-22 23:49:44,575 [trainer.py] => Test Time: 0 

2024-04-22 23:49:48,529 [trainer.py] => config: ./exps/loramoe_inc_vtab_B0_Inc5.json
2024-04-22 23:49:48,529 [trainer.py] => prefix: reproduce
2024-04-22 23:49:48,529 [trainer.py] => dataset: vtab
2024-04-22 23:49:48,529 [trainer.py] => memory_size: 0
2024-04-22 23:49:48,529 [trainer.py] => memory_per_class: 0
2024-04-22 23:49:48,529 [trainer.py] => fixed_memory: False
2024-04-22 23:49:48,529 [trainer.py] => shuffle: True
2024-04-22 23:49:48,529 [trainer.py] => init_cls: 10
2024-04-22 23:49:48,529 [trainer.py] => increment: 10
2024-04-22 23:49:48,529 [trainer.py] => model_name: loramoeinc
2024-04-22 23:49:48,529 [trainer.py] => backbone_type: pretrained_vit_b16_224_inc
2024-04-22 23:49:48,529 [trainer.py] => device: [device(type='cuda', index=2)]
2024-04-22 23:49:48,529 [trainer.py] => seed: 1993
2024-04-22 23:49:48,529 [trainer.py] => tuned_epoch: 20
2024-04-22 23:49:48,529 [trainer.py] => init_lr: 0.01
2024-04-22 23:49:48,529 [trainer.py] => batch_size: 48
2024-04-22 23:49:48,529 [trainer.py] => weight_decay: 0.0005
2024-04-22 23:49:48,530 [trainer.py] => min_lr: 0
2024-04-22 23:49:48,530 [trainer.py] => ffn_num: 4
2024-04-22 23:49:48,530 [trainer.py] => optimizer: sgd
2024-04-22 23:49:48,530 [trainer.py] => vpt_type: shallow
2024-04-22 23:49:48,530 [trainer.py] => prompt_token_num: 5
2024-04-22 23:49:48,530 [trainer.py] => expert_num: 5
{'10': 0, '11': 1, '12': 2, '13': 3, '14': 4, '15': 5, '16': 6, '17': 7, '18': 8, '19': 9, '20': 10, '21': 11, '22': 12, '23': 13, '24': 14, '25': 15, '26': 16, '27': 17, '28': 18, '29': 19, '30': 20, '31': 21, '32': 22, '33': 23, '34': 24, '35': 25, '36': 26, '37': 27, '38': 28, '39': 29, '40': 30, '41': 31, '42': 32, '43': 33, '44': 34, '45': 35, '46': 36, '47': 37, '48': 38, '49': 39, '50': 40, '51': 41, '52': 42, '53': 43, '54': 44, '55': 45, '56': 46, '57': 47, '58': 48, '59': 49}
{'10': 0, '11': 1, '12': 2, '13': 3, '14': 4, '15': 5, '16': 6, '17': 7, '18': 8, '19': 9, '20': 10, '21': 11, '22': 12, '23': 13, '24': 14, '25': 15, '26': 16, '27': 17, '28': 18, '29': 19, '30': 20, '31': 21, '32': 22, '33': 23, '34': 24, '35': 25, '36': 26, '37': 27, '38': 28, '39': 29, '40': 30, '41': 31, '42': 32, '43': 33, '44': 34, '45': 35, '46': 36, '47': 37, '48': 38, '49': 39, '50': 40, '51': 41, '52': 42, '53': 43, '54': 44, '55': 45, '56': 46, '57': 47, '58': 48, '59': 49}
2024-04-22 23:49:48,573 [data_manager.py] => [43, 41, 23, 14, 13, 40, 42, 22, 16, 45, 17, 10, 27, 46, 35, 8, 2, 34, 1, 37, 21, 0, 18, 36, 38, 24, 12, 6, 15, 20, 25, 48, 30, 19, 44, 26, 7, 28, 11, 5, 32, 4, 9, 47, 39, 31, 3, 29, 49, 33]
/home/team/zhaohongwei/anaconda3/envs/peft/lib/python3.10/site-packages/bitsandbytes/cuda_setup/main.py:136: UserWarning: /home/team/zhaohongwei/anaconda3/envs/peft did not contain libcudart.so as expected! Searching further paths...
  warn(msg)

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please submit your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
CUDA SETUP: CUDA runtime path found: /usr/local/cuda-11.8/lib64/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 8.6
CUDA SETUP: Detected CUDA version 118
CUDA SETUP: Loading binary /home/team/zhaohongwei/anaconda3/envs/peft/lib/python3.10/site-packages/bitsandbytes/libbitsandbytes_cuda118.so...
I'm using ViT with adapters.
2024-04-22 23:50:04,304 [trainer.py] => All params: 86006136
2024-04-22 23:50:04,306 [trainer.py] => Trainable params: 207480
2024-04-22 23:50:04,718 [loramoeinc.py] => Learning on 0-10
  0%|          | 0/20 [00:00<?, ?it/s]Task 0, Epoch 1/20 => Loss 2.300, Train_accy 6.83:   0%|          | 0/20 [00:02<?, ?it/s]Task 0, Epoch 1/20 => Loss 2.300, Train_accy 6.83:   5%|▌         | 1/20 [00:02<00:42,  2.24s/it]Task 0, Epoch 2/20 => Loss 2.278, Train_accy 19.88:   5%|▌         | 1/20 [00:03<00:42,  2.24s/it]Task 0, Epoch 2/20 => Loss 2.278, Train_accy 19.88:  10%|█         | 2/20 [00:03<00:35,  1.95s/it]Task 0, Epoch 3/20 => Loss 2.247, Train_accy 48.45:  10%|█         | 2/20 [00:05<00:35,  1.95s/it]Task 0, Epoch 3/20 => Loss 2.247, Train_accy 48.45:  15%|█▌        | 3/20 [00:05<00:31,  1.83s/it]Task 0, Epoch 4/20 => Loss 2.204, Train_accy 67.70:  15%|█▌        | 3/20 [00:07<00:31,  1.83s/it]Task 0, Epoch 4/20 => Loss 2.204, Train_accy 67.70:  20%|██        | 4/20 [00:07<00:28,  1.79s/it]Task 0, Epoch 5/20 => Loss 2.153, Train_accy 75.78:  20%|██        | 4/20 [00:09<00:28,  1.79s/it]Task 0, Epoch 5/20 => Loss 2.153, Train_accy 75.78:  25%|██▌       | 5/20 [00:09<00:26,  1.74s/it]Task 0, Epoch 6/20 => Loss 2.107, Train_accy 84.47:  25%|██▌       | 5/20 [00:10<00:26,  1.74s/it]Task 0, Epoch 6/20 => Loss 2.107, Train_accy 84.47:  30%|███       | 6/20 [00:10<00:25,  1.80s/it]Task 0, Epoch 7/20 => Loss 2.039, Train_accy 86.96:  30%|███       | 6/20 [00:12<00:25,  1.80s/it]Task 0, Epoch 7/20 => Loss 2.039, Train_accy 86.96:  35%|███▌      | 7/20 [00:12<00:24,  1.86s/it]Task 0, Epoch 8/20 => Loss 1.971, Train_accy 90.06:  35%|███▌      | 7/20 [00:14<00:24,  1.86s/it]Task 0, Epoch 8/20 => Loss 1.971, Train_accy 90.06:  40%|████      | 8/20 [00:14<00:22,  1.85s/it]Task 0, Epoch 9/20 => Loss 1.934, Train_accy 89.44:  40%|████      | 8/20 [00:16<00:22,  1.85s/it]Task 0, Epoch 9/20 => Loss 1.934, Train_accy 89.44:  45%|████▌     | 9/20 [00:16<00:20,  1.85s/it]Task 0, Epoch 10/20 => Loss 1.886, Train_accy 90.68:  45%|████▌     | 9/20 [00:18<00:20,  1.85s/it]Task 0, Epoch 10/20 => Loss 1.886, Train_accy 90.68:  50%|█████     | 10/20 [00:18<00:18,  1.84s/it]Task 0, Epoch 11/20 => Loss 1.823, Train_accy 91.93:  50%|█████     | 10/20 [00:20<00:18,  1.84s/it]Task 0, Epoch 11/20 => Loss 1.823, Train_accy 91.93:  55%|█████▌    | 11/20 [00:20<00:16,  1.85s/it]Task 0, Epoch 12/20 => Loss 1.776, Train_accy 91.30:  55%|█████▌    | 11/20 [00:22<00:16,  1.85s/it]Task 0, Epoch 12/20 => Loss 1.776, Train_accy 91.30:  60%|██████    | 12/20 [00:22<00:14,  1.87s/it]Task 0, Epoch 13/20 => Loss 1.711, Train_accy 95.03:  60%|██████    | 12/20 [00:24<00:14,  1.87s/it]Task 0, Epoch 13/20 => Loss 1.711, Train_accy 95.03:  65%|██████▌   | 13/20 [00:24<00:13,  1.90s/it]Task 0, Epoch 14/20 => Loss 1.699, Train_accy 93.79:  65%|██████▌   | 13/20 [00:26<00:13,  1.90s/it]Task 0, Epoch 14/20 => Loss 1.699, Train_accy 93.79:  70%|███████   | 14/20 [00:26<00:11,  1.88s/it]Task 0, Epoch 15/20 => Loss 1.655, Train_accy 95.65:  70%|███████   | 14/20 [00:27<00:11,  1.88s/it]Task 0, Epoch 15/20 => Loss 1.655, Train_accy 95.65:  75%|███████▌  | 15/20 [00:27<00:09,  1.82s/it]Task 0, Epoch 16/20 => Loss 1.665, Train_accy 93.17:  75%|███████▌  | 15/20 [00:29<00:09,  1.82s/it]Task 0, Epoch 16/20 => Loss 1.665, Train_accy 93.17:  80%|████████  | 16/20 [00:29<00:07,  1.82s/it]Task 0, Epoch 17/20 => Loss 1.628, Train_accy 93.17:  80%|████████  | 16/20 [00:31<00:07,  1.82s/it]Task 0, Epoch 17/20 => Loss 1.628, Train_accy 93.17:  85%|████████▌ | 17/20 [00:31<00:05,  1.84s/it]Task 0, Epoch 18/20 => Loss 1.618, Train_accy 93.79:  85%|████████▌ | 17/20 [00:33<00:05,  1.84s/it]Task 0, Epoch 18/20 => Loss 1.618, Train_accy 93.79:  90%|█████████ | 18/20 [00:33<00:03,  1.87s/it]Task 0, Epoch 19/20 => Loss 1.590, Train_accy 94.41:  90%|█████████ | 18/20 [00:35<00:03,  1.87s/it]Task 0, Epoch 19/20 => Loss 1.590, Train_accy 94.41:  95%|█████████▌| 19/20 [00:35<00:01,  1.87s/it]Task 0, Epoch 20/20 => Loss 1.604, Train_accy 95.03:  95%|█████████▌| 19/20 [00:37<00:01,  1.87s/it]Task 0, Epoch 20/20 => Loss 1.604, Train_accy 95.03: 100%|██████████| 20/20 [00:37<00:00,  1.89s/it]Task 0, Epoch 20/20 => Loss 1.604, Train_accy 95.03: 100%|██████████| 20/20 [00:37<00:00,  1.86s/it]
2024-04-22 23:50:42,098 [loramoeinc.py] => Task 0, Epoch 20/20 => Loss 1.604, Train_accy 95.03
2024-04-22 23:51:14,448 [trainer.py] => No NME accuracy.
2024-04-22 23:51:14,448 [trainer.py] => CNN: {'total': 99.76, '00-09': 99.76, 'old': 0, 'new': 99.76}
2024-04-22 23:51:14,448 [trainer.py] => Route: {'total': 98.79, '00-09': 98.79, 'old': 0, 'new': 98.79}
2024-04-22 23:51:14,449 [trainer.py] => CNN top1 curve: [99.76]
2024-04-22 23:51:14,449 [trainer.py] => CNN top5 curve: [100.0]
2024-04-22 23:51:14,449 [trainer.py] => Route top1 curve: [98.79]
2024-04-22 23:51:14,449 [trainer.py] => Route top5 curve: [99.64]

Average Accuracy (CNN): 99.76
Average Accuracy (Route): 98.79
2024-04-22 23:51:14,449 [trainer.py] => Average Accuracy (CNN): 99.76
2024-04-22 23:51:14,449 [trainer.py] => Average Accuracy (Route): 98.79

2024-04-22 23:51:14,449 [trainer.py] => Train Time: 37.16
2024-04-22 23:51:14,449 [trainer.py] => Test Time: 0 

2024-04-22 23:51:14,450 [trainer.py] => All params: 86021498
2024-04-22 23:51:14,451 [trainer.py] => Trainable params: 173665
2024-04-22 23:51:14,454 [loramoeinc.py] => Learning on 10-20
  0%|          | 0/20 [00:00<?, ?it/s]Task 1, Epoch 1/20 => Loss 2.279, Train_accy 66.43:   0%|          | 0/20 [00:03<?, ?it/s]Task 1, Epoch 1/20 => Loss 2.279, Train_accy 66.43:   5%|▌         | 1/20 [00:03<01:09,  3.63s/it]Task 1, Epoch 2/20 => Loss 2.059, Train_accy 75.85:   5%|▌         | 1/20 [00:07<01:09,  3.63s/it]Task 1, Epoch 2/20 => Loss 2.059, Train_accy 75.85:  10%|█         | 2/20 [00:07<01:04,  3.61s/it]Task 1, Epoch 3/20 => Loss 1.878, Train_accy 75.85:  10%|█         | 2/20 [00:10<01:04,  3.61s/it]Task 1, Epoch 3/20 => Loss 1.878, Train_accy 75.85:  15%|█▌        | 3/20 [00:10<01:01,  3.60s/it]Task 1, Epoch 4/20 => Loss 1.684, Train_accy 82.13:  15%|█▌        | 3/20 [00:14<01:01,  3.60s/it]Task 1, Epoch 4/20 => Loss 1.684, Train_accy 82.13:  20%|██        | 4/20 [00:14<00:57,  3.61s/it]Task 1, Epoch 5/20 => Loss 1.461, Train_accy 84.78:  20%|██        | 4/20 [00:18<00:57,  3.61s/it]Task 1, Epoch 5/20 => Loss 1.461, Train_accy 84.78:  25%|██▌       | 5/20 [00:18<00:56,  3.76s/it]Task 1, Epoch 6/20 => Loss 1.320, Train_accy 85.51:  25%|██▌       | 5/20 [00:22<00:56,  3.76s/it]Task 1, Epoch 6/20 => Loss 1.320, Train_accy 85.51:  30%|███       | 6/20 [00:22<00:53,  3.83s/it]Task 1, Epoch 7/20 => Loss 1.181, Train_accy 86.47:  30%|███       | 6/20 [00:26<00:53,  3.83s/it]Task 1, Epoch 7/20 => Loss 1.181, Train_accy 86.47:  35%|███▌      | 7/20 [00:26<00:49,  3.80s/it]Task 1, Epoch 8/20 => Loss 1.057, Train_accy 88.89:  35%|███▌      | 7/20 [00:29<00:49,  3.80s/it]Task 1, Epoch 8/20 => Loss 1.057, Train_accy 88.89:  40%|████      | 8/20 [00:29<00:45,  3.81s/it]Task 1, Epoch 9/20 => Loss 0.968, Train_accy 91.79:  40%|████      | 8/20 [00:33<00:45,  3.81s/it]Task 1, Epoch 9/20 => Loss 0.968, Train_accy 91.79:  45%|████▌     | 9/20 [00:33<00:41,  3.77s/it]Task 1, Epoch 10/20 => Loss 0.903, Train_accy 93.00:  45%|████▌     | 9/20 [00:37<00:41,  3.77s/it]Task 1, Epoch 10/20 => Loss 0.903, Train_accy 93.00:  50%|█████     | 10/20 [00:37<00:37,  3.79s/it]Task 1, Epoch 11/20 => Loss 0.826, Train_accy 94.69:  50%|█████     | 10/20 [00:41<00:37,  3.79s/it]Task 1, Epoch 11/20 => Loss 0.826, Train_accy 94.69:  55%|█████▌    | 11/20 [00:41<00:33,  3.74s/it]Task 1, Epoch 12/20 => Loss 0.789, Train_accy 93.48:  55%|█████▌    | 11/20 [00:44<00:33,  3.74s/it]Task 1, Epoch 12/20 => Loss 0.789, Train_accy 93.48:  60%|██████    | 12/20 [00:44<00:29,  3.74s/it]Task 1, Epoch 13/20 => Loss 0.735, Train_accy 95.17:  60%|██████    | 12/20 [00:48<00:29,  3.74s/it]Task 1, Epoch 13/20 => Loss 0.735, Train_accy 95.17:  65%|██████▌   | 13/20 [00:48<00:26,  3.75s/it]Task 1, Epoch 14/20 => Loss 0.705, Train_accy 96.14:  65%|██████▌   | 13/20 [00:52<00:26,  3.75s/it]Task 1, Epoch 14/20 => Loss 0.705, Train_accy 96.14:  70%|███████   | 14/20 [00:52<00:22,  3.70s/it]Task 1, Epoch 15/20 => Loss 0.673, Train_accy 97.83:  70%|███████   | 14/20 [00:55<00:22,  3.70s/it]Task 1, Epoch 15/20 => Loss 0.673, Train_accy 97.83:  75%|███████▌  | 15/20 [00:55<00:18,  3.67s/it]Task 1, Epoch 16/20 => Loss 0.676, Train_accy 95.89:  75%|███████▌  | 15/20 [00:59<00:18,  3.67s/it]Task 1, Epoch 16/20 => Loss 0.676, Train_accy 95.89:  80%|████████  | 16/20 [00:59<00:14,  3.66s/it]Task 1, Epoch 17/20 => Loss 0.669, Train_accy 96.38:  80%|████████  | 16/20 [01:03<00:14,  3.66s/it]Task 1, Epoch 17/20 => Loss 0.669, Train_accy 96.38:  85%|████████▌ | 17/20 [01:03<00:10,  3.66s/it]Task 1, Epoch 18/20 => Loss 0.664, Train_accy 95.41:  85%|████████▌ | 17/20 [01:06<00:10,  3.66s/it]Task 1, Epoch 18/20 => Loss 0.664, Train_accy 95.41:  90%|█████████ | 18/20 [01:06<00:07,  3.70s/it]Task 1, Epoch 19/20 => Loss 0.656, Train_accy 95.41:  90%|█████████ | 18/20 [01:10<00:07,  3.70s/it]Task 1, Epoch 19/20 => Loss 0.656, Train_accy 95.41:  95%|█████████▌| 19/20 [01:10<00:03,  3.68s/it]Task 1, Epoch 20/20 => Loss 0.660, Train_accy 96.38:  95%|█████████▌| 19/20 [01:14<00:03,  3.68s/it]Task 1, Epoch 20/20 => Loss 0.660, Train_accy 96.38: 100%|██████████| 20/20 [01:14<00:00,  3.66s/it]Task 1, Epoch 20/20 => Loss 0.660, Train_accy 96.38: 100%|██████████| 20/20 [01:14<00:00,  3.71s/it]
2024-04-22 23:52:28,634 [loramoeinc.py] => Task 1, Epoch 20/20 => Loss 0.660, Train_accy 96.38
2024-04-22 23:53:18,224 [trainer.py] => No NME accuracy.
2024-04-22 23:53:18,224 [trainer.py] => CNN: {'total': 97.82, '00-09': 98.55, '10-19': 97.53, 'old': 98.55, 'new': 97.53}
2024-04-22 23:53:18,224 [trainer.py] => Route: {'total': 94.49, '00-09': 98.18, '10-19': 92.97, 'old': 98.18, 'new': 92.97}
2024-04-22 23:53:18,224 [trainer.py] => CNN top1 curve: [99.76, 97.82]
2024-04-22 23:53:18,224 [trainer.py] => CNN top5 curve: [100.0, 100.0]
2024-04-22 23:53:18,224 [trainer.py] => Route top1 curve: [98.79, 94.49]
2024-04-22 23:53:18,224 [trainer.py] => Route top5 curve: [99.64, 99.61]

Average Accuracy (CNN): 98.78999999999999
Average Accuracy (Route): 96.64
2024-04-22 23:53:18,224 [trainer.py] => Average Accuracy (CNN): 98.78999999999999
2024-04-22 23:53:18,225 [trainer.py] => Average Accuracy (Route): 96.64

2024-04-22 23:53:18,225 [trainer.py] => Train Time: 111.33
2024-04-22 23:53:18,225 [trainer.py] => Test Time: 0 

2024-04-22 23:53:18,226 [trainer.py] => All params: 86036858
2024-04-22 23:53:18,227 [trainer.py] => Trainable params: 139849
2024-04-22 23:53:18,229 [loramoeinc.py] => Learning on 20-30
  0%|          | 0/20 [00:00<?, ?it/s]Task 2, Epoch 1/20 => Loss 1.860, Train_accy 66.03:   0%|          | 0/20 [00:03<?, ?it/s]Task 2, Epoch 1/20 => Loss 1.860, Train_accy 66.03:   5%|▌         | 1/20 [00:03<01:06,  3.51s/it]Task 2, Epoch 2/20 => Loss 1.439, Train_accy 82.19:   5%|▌         | 1/20 [00:06<01:06,  3.51s/it]Task 2, Epoch 2/20 => Loss 1.439, Train_accy 82.19:  10%|█         | 2/20 [00:06<00:59,  3.32s/it]Task 2, Epoch 3/20 => Loss 1.297, Train_accy 84.93:  10%|█         | 2/20 [00:10<00:59,  3.32s/it]Task 2, Epoch 3/20 => Loss 1.297, Train_accy 84.93:  15%|█▌        | 3/20 [00:10<00:58,  3.44s/it]Task 2, Epoch 4/20 => Loss 1.126, Train_accy 86.58:  15%|█▌        | 3/20 [00:13<00:58,  3.44s/it]Task 2, Epoch 4/20 => Loss 1.126, Train_accy 86.58:  20%|██        | 4/20 [00:13<00:54,  3.43s/it]Task 2, Epoch 5/20 => Loss 0.981, Train_accy 93.15:  20%|██        | 4/20 [00:17<00:54,  3.43s/it]Task 2, Epoch 5/20 => Loss 0.981, Train_accy 93.15:  25%|██▌       | 5/20 [00:17<00:53,  3.57s/it]Task 2, Epoch 6/20 => Loss 0.899, Train_accy 92.88:  25%|██▌       | 5/20 [00:21<00:53,  3.57s/it]Task 2, Epoch 6/20 => Loss 0.899, Train_accy 92.88:  30%|███       | 6/20 [00:21<00:51,  3.70s/it]Task 2, Epoch 7/20 => Loss 0.756, Train_accy 95.34:  30%|███       | 6/20 [00:24<00:51,  3.70s/it]Task 2, Epoch 7/20 => Loss 0.756, Train_accy 95.34:  35%|███▌      | 7/20 [00:24<00:46,  3.56s/it]Task 2, Epoch 8/20 => Loss 0.697, Train_accy 93.42:  35%|███▌      | 7/20 [00:28<00:46,  3.56s/it]Task 2, Epoch 8/20 => Loss 0.697, Train_accy 93.42:  40%|████      | 8/20 [00:28<00:42,  3.55s/it]Task 2, Epoch 9/20 => Loss 0.612, Train_accy 95.34:  40%|████      | 8/20 [00:31<00:42,  3.55s/it]Task 2, Epoch 9/20 => Loss 0.612, Train_accy 95.34:  45%|████▌     | 9/20 [00:31<00:38,  3.47s/it]Task 2, Epoch 10/20 => Loss 0.565, Train_accy 97.26:  45%|████▌     | 9/20 [00:34<00:38,  3.47s/it]Task 2, Epoch 10/20 => Loss 0.565, Train_accy 97.26:  50%|█████     | 10/20 [00:34<00:34,  3.40s/it]Task 2, Epoch 11/20 => Loss 0.547, Train_accy 97.53:  50%|█████     | 10/20 [00:38<00:34,  3.40s/it]Task 2, Epoch 11/20 => Loss 0.547, Train_accy 97.53:  55%|█████▌    | 11/20 [00:38<00:30,  3.43s/it]Task 2, Epoch 12/20 => Loss 0.493, Train_accy 96.71:  55%|█████▌    | 11/20 [00:41<00:30,  3.43s/it]Task 2, Epoch 12/20 => Loss 0.493, Train_accy 96.71:  60%|██████    | 12/20 [00:41<00:27,  3.40s/it]Task 2, Epoch 13/20 => Loss 0.478, Train_accy 98.08:  60%|██████    | 12/20 [00:44<00:27,  3.40s/it]Task 2, Epoch 13/20 => Loss 0.478, Train_accy 98.08:  65%|██████▌   | 13/20 [00:44<00:23,  3.38s/it]Task 2, Epoch 14/20 => Loss 0.466, Train_accy 98.08:  65%|██████▌   | 13/20 [00:48<00:23,  3.38s/it]Task 2, Epoch 14/20 => Loss 0.466, Train_accy 98.08:  70%|███████   | 14/20 [00:48<00:20,  3.41s/it]Task 2, Epoch 15/20 => Loss 0.450, Train_accy 98.08:  70%|███████   | 14/20 [00:51<00:20,  3.41s/it]Task 2, Epoch 15/20 => Loss 0.450, Train_accy 98.08:  75%|███████▌  | 15/20 [00:51<00:17,  3.41s/it]Task 2, Epoch 16/20 => Loss 0.436, Train_accy 97.53:  75%|███████▌  | 15/20 [00:55<00:17,  3.41s/it]Task 2, Epoch 16/20 => Loss 0.436, Train_accy 97.53:  80%|████████  | 16/20 [00:55<00:13,  3.44s/it]Task 2, Epoch 17/20 => Loss 0.409, Train_accy 99.73:  80%|████████  | 16/20 [00:59<00:13,  3.44s/it]Task 2, Epoch 17/20 => Loss 0.409, Train_accy 99.73:  85%|████████▌ | 17/20 [00:59<00:10,  3.49s/it]Task 2, Epoch 18/20 => Loss 0.454, Train_accy 97.81:  85%|████████▌ | 17/20 [01:02<00:10,  3.49s/it]Task 2, Epoch 18/20 => Loss 0.454, Train_accy 97.81:  90%|█████████ | 18/20 [01:02<00:07,  3.51s/it]Task 2, Epoch 19/20 => Loss 0.443, Train_accy 97.26:  90%|█████████ | 18/20 [01:05<00:07,  3.51s/it]Task 2, Epoch 19/20 => Loss 0.443, Train_accy 97.26:  95%|█████████▌| 19/20 [01:05<00:03,  3.48s/it]Task 2, Epoch 20/20 => Loss 0.423, Train_accy 98.90:  95%|█████████▌| 19/20 [01:09<00:03,  3.48s/it]Task 2, Epoch 20/20 => Loss 0.423, Train_accy 98.90: 100%|██████████| 20/20 [01:09<00:00,  3.47s/it]Task 2, Epoch 20/20 => Loss 0.423, Train_accy 98.90: 100%|██████████| 20/20 [01:09<00:00,  3.47s/it]
2024-04-22 23:54:27,654 [loramoeinc.py] => Task 2, Epoch 20/20 => Loss 0.423, Train_accy 98.90
2024-04-22 23:55:28,011 [trainer.py] => No NME accuracy.
2024-04-22 23:55:28,012 [trainer.py] => CNN: {'total': 97.88, '00-09': 98.55, '10-19': 96.78, '20-29': 98.9, 'old': 97.3, 'new': 98.9}
2024-04-22 23:55:28,012 [trainer.py] => Route: {'total': 88.37, '00-09': 95.64, '10-19': 90.6, '20-29': 81.94, 'old': 92.06, 'new': 81.94}
2024-04-22 23:55:28,012 [trainer.py] => CNN top1 curve: [99.76, 97.82, 97.88]
2024-04-22 23:55:28,012 [trainer.py] => CNN top5 curve: [100.0, 100.0, 100.0]
2024-04-22 23:55:28,012 [trainer.py] => Route top1 curve: [98.79, 94.49, 88.37]
2024-04-22 23:55:28,012 [trainer.py] => Route top5 curve: [99.64, 99.61, 99.33]

Average Accuracy (CNN): 98.48666666666666
Average Accuracy (Route): 93.88333333333333
2024-04-22 23:55:28,012 [trainer.py] => Average Accuracy (CNN): 98.48666666666666
2024-04-22 23:55:28,012 [trainer.py] => Average Accuracy (Route): 93.88333333333333

2024-04-22 23:55:28,012 [trainer.py] => Train Time: 180.75
2024-04-22 23:55:28,012 [trainer.py] => Test Time: 0 

2024-04-22 23:55:28,014 [trainer.py] => All params: 86052218
2024-04-22 23:55:28,015 [trainer.py] => Trainable params: 106033
2024-04-22 23:55:28,017 [loramoeinc.py] => Learning on 30-40
  0%|          | 0/20 [00:00<?, ?it/s]Task 3, Epoch 1/20 => Loss 2.048, Train_accy 66.01:   0%|          | 0/20 [00:02<?, ?it/s]Task 3, Epoch 1/20 => Loss 2.048, Train_accy 66.01:   5%|▌         | 1/20 [00:02<00:53,  2.83s/it]Task 3, Epoch 2/20 => Loss 1.403, Train_accy 84.16:   5%|▌         | 1/20 [00:05<00:53,  2.83s/it]Task 3, Epoch 2/20 => Loss 1.403, Train_accy 84.16:  10%|█         | 2/20 [00:05<00:51,  2.85s/it]Task 3, Epoch 3/20 => Loss 1.084, Train_accy 86.80:  10%|█         | 2/20 [00:08<00:51,  2.85s/it]Task 3, Epoch 3/20 => Loss 1.084, Train_accy 86.80:  15%|█▌        | 3/20 [00:08<00:48,  2.88s/it]Task 3, Epoch 4/20 => Loss 0.927, Train_accy 84.82:  15%|█▌        | 3/20 [00:11<00:48,  2.88s/it]Task 3, Epoch 4/20 => Loss 0.927, Train_accy 84.82:  20%|██        | 4/20 [00:11<00:45,  2.83s/it]Task 3, Epoch 5/20 => Loss 0.770, Train_accy 90.10:  20%|██        | 4/20 [00:14<00:45,  2.83s/it]Task 3, Epoch 5/20 => Loss 0.770, Train_accy 90.10:  25%|██▌       | 5/20 [00:14<00:43,  2.90s/it]Task 3, Epoch 6/20 => Loss 0.742, Train_accy 90.10:  25%|██▌       | 5/20 [00:17<00:43,  2.90s/it]Task 3, Epoch 6/20 => Loss 0.742, Train_accy 90.10:  30%|███       | 6/20 [00:17<00:40,  2.92s/it]Task 3, Epoch 7/20 => Loss 0.629, Train_accy 91.75:  30%|███       | 6/20 [00:20<00:40,  2.92s/it]Task 3, Epoch 7/20 => Loss 0.629, Train_accy 91.75:  35%|███▌      | 7/20 [00:20<00:37,  2.90s/it]Task 3, Epoch 8/20 => Loss 0.556, Train_accy 92.08:  35%|███▌      | 7/20 [00:23<00:37,  2.90s/it]Task 3, Epoch 8/20 => Loss 0.556, Train_accy 92.08:  40%|████      | 8/20 [00:23<00:35,  2.95s/it]Task 3, Epoch 9/20 => Loss 0.476, Train_accy 93.07:  40%|████      | 8/20 [00:26<00:35,  2.95s/it]Task 3, Epoch 9/20 => Loss 0.476, Train_accy 93.07:  45%|████▌     | 9/20 [00:26<00:32,  2.94s/it]Task 3, Epoch 10/20 => Loss 0.458, Train_accy 93.07:  45%|████▌     | 9/20 [00:28<00:32,  2.94s/it]Task 3, Epoch 10/20 => Loss 0.458, Train_accy 93.07:  50%|█████     | 10/20 [00:28<00:28,  2.89s/it]Task 3, Epoch 11/20 => Loss 0.452, Train_accy 92.74:  50%|█████     | 10/20 [00:31<00:28,  2.89s/it]Task 3, Epoch 11/20 => Loss 0.452, Train_accy 92.74:  55%|█████▌    | 11/20 [00:31<00:25,  2.84s/it]Task 3, Epoch 12/20 => Loss 0.454, Train_accy 92.41:  55%|█████▌    | 11/20 [00:34<00:25,  2.84s/it]Task 3, Epoch 12/20 => Loss 0.454, Train_accy 92.41:  60%|██████    | 12/20 [00:34<00:23,  2.95s/it]Task 3, Epoch 13/20 => Loss 0.441, Train_accy 92.74:  60%|██████    | 12/20 [00:37<00:23,  2.95s/it]Task 3, Epoch 13/20 => Loss 0.441, Train_accy 92.74:  65%|██████▌   | 13/20 [00:37<00:20,  2.97s/it]Task 3, Epoch 14/20 => Loss 0.401, Train_accy 93.40:  65%|██████▌   | 13/20 [00:41<00:20,  2.97s/it]Task 3, Epoch 14/20 => Loss 0.401, Train_accy 93.40:  70%|███████   | 14/20 [00:41<00:18,  3.04s/it]Task 3, Epoch 15/20 => Loss 0.381, Train_accy 93.73:  70%|███████   | 14/20 [00:44<00:18,  3.04s/it]Task 3, Epoch 15/20 => Loss 0.381, Train_accy 93.73:  75%|███████▌  | 15/20 [00:44<00:15,  3.14s/it]Task 3, Epoch 16/20 => Loss 0.391, Train_accy 93.73:  75%|███████▌  | 15/20 [00:47<00:15,  3.14s/it]Task 3, Epoch 16/20 => Loss 0.391, Train_accy 93.73:  80%|████████  | 16/20 [00:47<00:12,  3.12s/it]Task 3, Epoch 17/20 => Loss 0.357, Train_accy 94.06:  80%|████████  | 16/20 [00:50<00:12,  3.12s/it]Task 3, Epoch 17/20 => Loss 0.357, Train_accy 94.06:  85%|████████▌ | 17/20 [00:50<00:09,  3.09s/it]Task 3, Epoch 18/20 => Loss 0.381, Train_accy 93.40:  85%|████████▌ | 17/20 [00:53<00:09,  3.09s/it]Task 3, Epoch 18/20 => Loss 0.381, Train_accy 93.40:  90%|█████████ | 18/20 [00:53<00:06,  3.10s/it]Task 3, Epoch 19/20 => Loss 0.377, Train_accy 93.73:  90%|█████████ | 18/20 [00:56<00:06,  3.10s/it]Task 3, Epoch 19/20 => Loss 0.377, Train_accy 93.73:  95%|█████████▌| 19/20 [00:56<00:03,  3.03s/it]Task 3, Epoch 20/20 => Loss 0.401, Train_accy 92.41:  95%|█████████▌| 19/20 [00:59<00:03,  3.03s/it]Task 3, Epoch 20/20 => Loss 0.401, Train_accy 92.41: 100%|██████████| 20/20 [00:59<00:00,  2.99s/it]Task 3, Epoch 20/20 => Loss 0.401, Train_accy 92.41: 100%|██████████| 20/20 [00:59<00:00,  2.97s/it]
2024-04-22 23:56:27,482 [loramoeinc.py] => Task 3, Epoch 20/20 => Loss 0.401, Train_accy 92.41
2024-04-22 23:57:36,082 [trainer.py] => No NME accuracy.
2024-04-22 23:57:36,082 [trainer.py] => CNN: {'total': 97.94, '00-09': 98.55, '10-19': 96.78, '20-29': 97.98, '30-39': 99.36, 'old': 97.54, 'new': 99.36}
2024-04-22 23:57:36,082 [trainer.py] => Route: {'total': 87.87, '00-09': 94.43, '10-19': 90.25, '20-29': 78.69, '30-39': 91.68, 'old': 86.81, 'new': 91.68}
2024-04-22 23:57:36,082 [trainer.py] => CNN top1 curve: [99.76, 97.82, 97.88, 97.94]
2024-04-22 23:57:36,082 [trainer.py] => CNN top5 curve: [100.0, 100.0, 100.0, 100.0]
2024-04-22 23:57:36,082 [trainer.py] => Route top1 curve: [98.79, 94.49, 88.37, 87.87]
2024-04-22 23:57:36,082 [trainer.py] => Route top5 curve: [99.64, 99.61, 99.33, 98.97]

Average Accuracy (CNN): 98.35
Average Accuracy (Route): 92.38
2024-04-22 23:57:36,082 [trainer.py] => Average Accuracy (CNN): 98.35
2024-04-22 23:57:36,082 [trainer.py] => Average Accuracy (Route): 92.38

2024-04-22 23:57:36,082 [trainer.py] => Train Time: 240.2
2024-04-22 23:57:36,082 [trainer.py] => Test Time: 0 

2024-04-22 23:57:36,084 [trainer.py] => All params: 86067578
2024-04-22 23:57:36,085 [trainer.py] => Trainable params: 72217
2024-04-22 23:57:36,087 [loramoeinc.py] => Learning on 40-50
  0%|          | 0/20 [00:00<?, ?it/s]Task 4, Epoch 1/20 => Loss 1.523, Train_accy 68.90:   0%|          | 0/20 [00:04<?, ?it/s]Task 4, Epoch 1/20 => Loss 1.523, Train_accy 68.90:   5%|▌         | 1/20 [00:04<01:30,  4.79s/it]Task 4, Epoch 2/20 => Loss 0.979, Train_accy 83.91:   5%|▌         | 1/20 [00:09<01:30,  4.79s/it]Task 4, Epoch 2/20 => Loss 0.979, Train_accy 83.91:  10%|█         | 2/20 [00:09<01:26,  4.80s/it]Task 4, Epoch 3/20 => Loss 0.856, Train_accy 85.90:  10%|█         | 2/20 [00:14<01:26,  4.80s/it]Task 4, Epoch 3/20 => Loss 0.856, Train_accy 85.90:  15%|█▌        | 3/20 [00:14<01:21,  4.82s/it]Task 4, Epoch 4/20 => Loss 0.700, Train_accy 90.42:  15%|█▌        | 3/20 [00:19<01:21,  4.82s/it]Task 4, Epoch 4/20 => Loss 0.700, Train_accy 90.42:  20%|██        | 4/20 [00:19<01:17,  4.84s/it]Task 4, Epoch 5/20 => Loss 0.625, Train_accy 92.77:  20%|██        | 4/20 [00:24<01:17,  4.84s/it]Task 4, Epoch 5/20 => Loss 0.625, Train_accy 92.77:  25%|██▌       | 5/20 [00:24<01:14,  4.95s/it]Task 4, Epoch 6/20 => Loss 0.563, Train_accy 93.13:  25%|██▌       | 5/20 [00:29<01:14,  4.95s/it]Task 4, Epoch 6/20 => Loss 0.563, Train_accy 93.13:  30%|███       | 6/20 [00:29<01:10,  5.00s/it]Task 4, Epoch 7/20 => Loss 0.501, Train_accy 93.85:  30%|███       | 6/20 [00:34<01:10,  5.00s/it]Task 4, Epoch 7/20 => Loss 0.501, Train_accy 93.85:  35%|███▌      | 7/20 [00:34<01:04,  4.96s/it]Task 4, Epoch 8/20 => Loss 0.451, Train_accy 95.66:  35%|███▌      | 7/20 [00:39<01:04,  4.96s/it]Task 4, Epoch 8/20 => Loss 0.451, Train_accy 95.66:  40%|████      | 8/20 [00:39<01:00,  5.07s/it]Task 4, Epoch 9/20 => Loss 0.438, Train_accy 94.39:  40%|████      | 8/20 [00:44<01:00,  5.07s/it]Task 4, Epoch 9/20 => Loss 0.438, Train_accy 94.39:  45%|████▌     | 9/20 [00:44<00:55,  5.06s/it]Task 4, Epoch 10/20 => Loss 0.424, Train_accy 94.03:  45%|████▌     | 9/20 [00:49<00:55,  5.06s/it]Task 4, Epoch 10/20 => Loss 0.424, Train_accy 94.03:  50%|█████     | 10/20 [00:49<00:48,  4.89s/it]Task 4, Epoch 11/20 => Loss 0.402, Train_accy 94.94:  50%|█████     | 10/20 [00:54<00:48,  4.89s/it]Task 4, Epoch 11/20 => Loss 0.402, Train_accy 94.94:  55%|█████▌    | 11/20 [00:54<00:44,  4.90s/it]Task 4, Epoch 12/20 => Loss 0.394, Train_accy 94.94:  55%|█████▌    | 11/20 [00:59<00:44,  4.90s/it]Task 4, Epoch 12/20 => Loss 0.394, Train_accy 94.94:  60%|██████    | 12/20 [00:59<00:39,  4.88s/it]Task 4, Epoch 13/20 => Loss 0.357, Train_accy 96.75:  60%|██████    | 12/20 [01:04<00:39,  4.88s/it]Task 4, Epoch 13/20 => Loss 0.357, Train_accy 96.75:  65%|██████▌   | 13/20 [01:04<00:34,  4.90s/it]Task 4, Epoch 14/20 => Loss 0.341, Train_accy 96.93:  65%|██████▌   | 13/20 [01:08<00:34,  4.90s/it]Task 4, Epoch 14/20 => Loss 0.341, Train_accy 96.93:  70%|███████   | 14/20 [01:08<00:29,  4.85s/it]Task 4, Epoch 15/20 => Loss 0.339, Train_accy 96.93:  70%|███████   | 14/20 [01:13<00:29,  4.85s/it]Task 4, Epoch 15/20 => Loss 0.339, Train_accy 96.93:  75%|███████▌  | 15/20 [01:13<00:24,  4.83s/it]Task 4, Epoch 16/20 => Loss 0.331, Train_accy 96.75:  75%|███████▌  | 15/20 [01:18<00:24,  4.83s/it]Task 4, Epoch 16/20 => Loss 0.331, Train_accy 96.75:  80%|████████  | 16/20 [01:18<00:19,  4.94s/it]Task 4, Epoch 17/20 => Loss 0.324, Train_accy 96.02:  80%|████████  | 16/20 [01:23<00:19,  4.94s/it]Task 4, Epoch 17/20 => Loss 0.324, Train_accy 96.02:  85%|████████▌ | 17/20 [01:23<00:14,  4.94s/it]Task 4, Epoch 18/20 => Loss 0.355, Train_accy 94.39:  85%|████████▌ | 17/20 [01:28<00:14,  4.94s/it]Task 4, Epoch 18/20 => Loss 0.355, Train_accy 94.39:  90%|█████████ | 18/20 [01:28<00:09,  4.87s/it]Task 4, Epoch 19/20 => Loss 0.368, Train_accy 95.12:  90%|█████████ | 18/20 [01:33<00:09,  4.87s/it]Task 4, Epoch 19/20 => Loss 0.368, Train_accy 95.12:  95%|█████████▌| 19/20 [01:33<00:05,  5.02s/it]Task 4, Epoch 20/20 => Loss 0.342, Train_accy 95.48:  95%|█████████▌| 19/20 [01:38<00:05,  5.02s/it]Task 4, Epoch 20/20 => Loss 0.342, Train_accy 95.48: 100%|██████████| 20/20 [01:38<00:00,  5.08s/it]Task 4, Epoch 20/20 => Loss 0.342, Train_accy 95.48: 100%|██████████| 20/20 [01:38<00:00,  4.95s/it]
2024-04-22 23:59:15,074 [loramoeinc.py] => Task 4, Epoch 20/20 => Loss 0.342, Train_accy 95.48
2024-04-23 00:00:46,690 [trainer.py] => No NME accuracy.
2024-04-23 00:00:46,691 [trainer.py] => CNN: {'total': 97.67, '00-09': 98.43, '10-19': 96.78, '20-29': 97.98, '30-39': 97.92, '40-49': 97.78, 'old': 97.61, 'new': 97.78}
2024-04-23 00:00:46,691 [trainer.py] => Route: {'total': 84.46, '00-09': 94.43, '10-19': 86.79, '20-29': 74.46, '30-39': 90.8, '40-49': 82.9, 'old': 85.25, 'new': 82.9}
2024-04-23 00:00:46,691 [trainer.py] => CNN top1 curve: [99.76, 97.82, 97.88, 97.94, 97.67]
2024-04-23 00:00:46,691 [trainer.py] => CNN top5 curve: [100.0, 100.0, 100.0, 100.0, 99.9]
2024-04-23 00:00:46,691 [trainer.py] => Route top1 curve: [98.79, 94.49, 88.37, 87.87, 84.46]
2024-04-23 00:00:46,691 [trainer.py] => Route top5 curve: [99.64, 99.61, 99.33, 98.97, 98.29]

Average Accuracy (CNN): 98.214
Average Accuracy (Route): 90.79599999999999
2024-04-23 00:00:46,691 [trainer.py] => Average Accuracy (CNN): 98.214
2024-04-23 00:00:46,691 [trainer.py] => Average Accuracy (Route): 90.79599999999999

2024-04-23 00:00:46,691 [trainer.py] => Train Time: 339.16999999999996
2024-04-23 00:00:46,691 [trainer.py] => Test Time: 0 

2024-04-23 00:00:50,547 [trainer.py] => config: ./exps/loramoe_inc_omn_inc5.json
2024-04-23 00:00:50,547 [trainer.py] => prefix: reproduce
2024-04-23 00:00:50,547 [trainer.py] => dataset: omnibenchmark
2024-04-23 00:00:50,547 [trainer.py] => memory_size: 0
2024-04-23 00:00:50,547 [trainer.py] => memory_per_class: 0
2024-04-23 00:00:50,547 [trainer.py] => fixed_memory: False
2024-04-23 00:00:50,547 [trainer.py] => shuffle: True
2024-04-23 00:00:50,547 [trainer.py] => init_cls: 60
2024-04-23 00:00:50,547 [trainer.py] => increment: 60
2024-04-23 00:00:50,547 [trainer.py] => model_name: loramoeinc
2024-04-23 00:00:50,547 [trainer.py] => backbone_type: pretrained_vit_b16_224_inc
2024-04-23 00:00:50,547 [trainer.py] => device: [device(type='cuda', index=2)]
2024-04-23 00:00:50,547 [trainer.py] => seed: 1993
2024-04-23 00:00:50,547 [trainer.py] => tuned_epoch: 20
2024-04-23 00:00:50,547 [trainer.py] => init_lr: 0.01
2024-04-23 00:00:50,547 [trainer.py] => batch_size: 48
2024-04-23 00:00:50,547 [trainer.py] => weight_decay: 0.0005
2024-04-23 00:00:50,547 [trainer.py] => min_lr: 0
2024-04-23 00:00:50,547 [trainer.py] => ffn_num: 4
2024-04-23 00:00:50,547 [trainer.py] => optimizer: sgd
2024-04-23 00:00:50,548 [trainer.py] => vpt_type: shallow
2024-04-23 00:00:50,548 [trainer.py] => prompt_token_num: 5
2024-04-23 00:00:50,548 [trainer.py] => expert_num: 5
2024-04-23 00:00:50,921 [data_manager.py] => [169, 221, 146, 296, 92, 229, 49, 70, 126, 77, 243, 57, 120, 223, 27, 217, 154, 8, 101, 182, 54, 50, 97, 162, 28, 193, 79, 6, 151, 0, 173, 187, 44, 277, 157, 16, 257, 122, 35, 9, 171, 176, 134, 4, 87, 255, 112, 153, 246, 286, 147, 186, 107, 98, 10, 7, 266, 214, 36, 165, 139, 254, 103, 269, 59, 23, 298, 39, 73, 208, 135, 299, 102, 20, 12, 268, 11, 209, 161, 210, 74, 42, 56, 99, 235, 133, 159, 189, 145, 238, 215, 241, 138, 195, 233, 279, 88, 199, 64, 280, 26, 203, 17, 245, 174, 236, 137, 252, 80, 68, 181, 150, 118, 94, 75, 2, 109, 119, 232, 15, 69, 184, 201, 261, 55, 287, 273, 66, 175, 32, 142, 136, 116, 76, 179, 1, 91, 248, 275, 240, 290, 170, 132, 106, 265, 270, 85, 19, 284, 43, 259, 293, 228, 200, 104, 227, 51, 224, 163, 297, 216, 260, 93, 46, 100, 272, 105, 72, 131, 3, 156, 256, 249, 48, 113, 82, 172, 213, 62, 53, 271, 168, 253, 226, 183, 180, 276, 283, 78, 61, 143, 278, 30, 141, 196, 264, 231, 52, 222, 40, 125, 219, 65, 166, 192, 289, 45, 205, 89, 267, 90, 71, 167, 262, 281, 212, 96, 84, 127, 67, 294, 178, 288, 197, 21, 18, 111, 108, 58, 230, 188, 31, 110, 291, 129, 24, 204, 83, 81, 251, 60, 13, 128, 14, 86, 63, 117, 198, 274, 5, 22, 144, 258, 121, 38, 207, 148, 292, 41, 234, 237, 114, 202, 37, 149, 206, 155, 29, 130, 177, 194, 152, 34, 33, 239, 160, 140, 47, 244, 25, 282, 158, 211, 123, 190, 218, 164, 247, 263, 191, 220, 115, 242, 250, 124, 295, 95, 285, 225, 185]
/home/team/zhaohongwei/anaconda3/envs/peft/lib/python3.10/site-packages/bitsandbytes/cuda_setup/main.py:136: UserWarning: /home/team/zhaohongwei/anaconda3/envs/peft did not contain libcudart.so as expected! Searching further paths...
  warn(msg)

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please submit your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
CUDA SETUP: CUDA runtime path found: /usr/local/cuda-11.8/lib64/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 8.6
CUDA SETUP: Detected CUDA version 118
CUDA SETUP: Loading binary /home/team/zhaohongwei/anaconda3/envs/peft/lib/python3.10/site-packages/bitsandbytes/libbitsandbytes_cuda118.so...
I'm using ViT with adapters.
2024-04-23 00:01:09,615 [trainer.py] => All params: 86006136
2024-04-23 00:01:09,617 [trainer.py] => Trainable params: 207480
2024-04-23 00:01:09,874 [loramoeinc.py] => Learning on 0-60
  0%|          | 0/20 [00:00<?, ?it/s]Task 0, Epoch 1/20 => Loss 2.180, Train_accy 62.60:   0%|          | 0/20 [02:14<?, ?it/s]Task 0, Epoch 1/20 => Loss 2.180, Train_accy 62.60:   5%|▌         | 1/20 [02:14<42:40, 134.76s/it]Task 0, Epoch 2/20 => Loss 0.614, Train_accy 82.22:   5%|▌         | 1/20 [04:31<42:40, 134.76s/it]Task 0, Epoch 2/20 => Loss 0.614, Train_accy 82.22:  10%|█         | 2/20 [04:31<40:44, 135.80s/it]Task 0, Epoch 3/20 => Loss 0.506, Train_accy 84.70:  10%|█         | 2/20 [06:45<40:44, 135.80s/it]Task 0, Epoch 3/20 => Loss 0.506, Train_accy 84.70:  15%|█▌        | 3/20 [06:45<38:12, 134.87s/it]Task 0, Epoch 4/20 => Loss 0.463, Train_accy 85.92:  15%|█▌        | 3/20 [09:00<38:12, 134.87s/it]Task 0, Epoch 4/20 => Loss 0.463, Train_accy 85.92:  20%|██        | 4/20 [09:00<36:02, 135.18s/it]Task 0, Epoch 5/20 => Loss 0.429, Train_accy 86.71:  20%|██        | 4/20 [11:15<36:02, 135.18s/it]Task 0, Epoch 5/20 => Loss 0.429, Train_accy 86.71:  25%|██▌       | 5/20 [11:15<33:46, 135.11s/it]Task 0, Epoch 6/20 => Loss 0.412, Train_accy 87.52:  25%|██▌       | 5/20 [13:31<33:46, 135.11s/it]Task 0, Epoch 6/20 => Loss 0.412, Train_accy 87.52:  30%|███       | 6/20 [13:31<31:35, 135.42s/it]Task 0, Epoch 7/20 => Loss 0.394, Train_accy 87.99:  30%|███       | 6/20 [15:49<31:35, 135.42s/it]Task 0, Epoch 7/20 => Loss 0.394, Train_accy 87.99:  35%|███▌      | 7/20 [15:49<29:29, 136.13s/it]Task 0, Epoch 8/20 => Loss 0.381, Train_accy 88.43:  35%|███▌      | 7/20 [18:04<29:29, 136.13s/it]Task 0, Epoch 8/20 => Loss 0.381, Train_accy 88.43:  40%|████      | 8/20 [18:04<27:10, 135.88s/it]Task 0, Epoch 9/20 => Loss 0.359, Train_accy 89.11:  40%|████      | 8/20 [20:20<27:10, 135.88s/it]Task 0, Epoch 9/20 => Loss 0.359, Train_accy 89.11:  45%|████▌     | 9/20 [20:20<24:55, 135.96s/it]Task 0, Epoch 10/20 => Loss 0.351, Train_accy 89.08:  45%|████▌     | 9/20 [22:40<24:55, 135.96s/it]Task 0, Epoch 10/20 => Loss 0.351, Train_accy 89.08:  50%|█████     | 10/20 [22:40<22:52, 137.25s/it]Task 0, Epoch 11/20 => Loss 0.333, Train_accy 89.85:  50%|█████     | 10/20 [24:52<22:52, 137.25s/it]Task 0, Epoch 11/20 => Loss 0.333, Train_accy 89.85:  55%|█████▌    | 11/20 [24:52<20:20, 135.57s/it]Task 0, Epoch 12/20 => Loss 0.327, Train_accy 90.17:  55%|█████▌    | 11/20 [27:04<20:20, 135.57s/it]Task 0, Epoch 12/20 => Loss 0.327, Train_accy 90.17:  60%|██████    | 12/20 [27:04<17:56, 134.54s/it]Task 0, Epoch 13/20 => Loss 0.312, Train_accy 90.64:  60%|██████    | 12/20 [29:25<17:56, 134.54s/it]Task 0, Epoch 13/20 => Loss 0.312, Train_accy 90.64:  65%|██████▌   | 13/20 [29:25<15:54, 136.32s/it]Task 0, Epoch 14/20 => Loss 0.299, Train_accy 90.95:  65%|██████▌   | 13/20 [31:42<15:54, 136.32s/it]Task 0, Epoch 14/20 => Loss 0.299, Train_accy 90.95:  70%|███████   | 14/20 [31:42<13:39, 136.65s/it]Task 0, Epoch 15/20 => Loss 0.299, Train_accy 91.05:  70%|███████   | 14/20 [33:59<13:39, 136.65s/it]Task 0, Epoch 15/20 => Loss 0.299, Train_accy 91.05:  75%|███████▌  | 15/20 [33:59<11:22, 136.59s/it]Task 0, Epoch 16/20 => Loss 0.281, Train_accy 91.79:  75%|███████▌  | 15/20 [36:15<11:22, 136.59s/it]Task 0, Epoch 16/20 => Loss 0.281, Train_accy 91.79:  80%|████████  | 16/20 [36:15<09:06, 136.58s/it]Task 0, Epoch 17/20 => Loss 0.273, Train_accy 91.92:  80%|████████  | 16/20 [38:31<09:06, 136.58s/it]Task 0, Epoch 17/20 => Loss 0.273, Train_accy 91.92:  85%|████████▌ | 17/20 [38:31<06:49, 136.45s/it]Task 0, Epoch 18/20 => Loss 0.272, Train_accy 91.97:  85%|████████▌ | 17/20 [40:46<06:49, 136.45s/it]Task 0, Epoch 18/20 => Loss 0.272, Train_accy 91.97:  90%|█████████ | 18/20 [40:46<04:31, 135.82s/it]Task 0, Epoch 19/20 => Loss 0.278, Train_accy 91.73:  90%|█████████ | 18/20 [43:03<04:31, 135.82s/it]Task 0, Epoch 19/20 => Loss 0.278, Train_accy 91.73:  95%|█████████▌| 19/20 [43:03<02:16, 136.16s/it]Task 0, Epoch 20/20 => Loss 0.269, Train_accy 91.98:  95%|█████████▌| 19/20 [45:20<02:16, 136.16s/it]Task 0, Epoch 20/20 => Loss 0.269, Train_accy 91.98: 100%|██████████| 20/20 [45:20<00:00, 136.39s/it]Task 0, Epoch 20/20 => Loss 0.269, Train_accy 91.98: 100%|██████████| 20/20 [45:20<00:00, 136.00s/it]
2024-04-23 00:46:30,192 [loramoeinc.py] => Task 0, Epoch 20/20 => Loss 0.269, Train_accy 91.98
2024-04-23 00:49:56,319 [trainer.py] => No NME accuracy.
2024-04-23 00:49:56,320 [trainer.py] => CNN: {'total': 93.58, '00-59': 93.58, 'old': 0, 'new': 93.58}
2024-04-23 00:49:56,320 [trainer.py] => Route: {'total': 87.57, '00-59': 87.57, 'old': 0, 'new': 87.57}
2024-04-23 00:49:56,320 [trainer.py] => CNN top1 curve: [93.58]
2024-04-23 00:49:56,320 [trainer.py] => CNN top5 curve: [99.17]
2024-04-23 00:49:56,320 [trainer.py] => Route top1 curve: [87.57]
2024-04-23 00:49:56,320 [trainer.py] => Route top5 curve: [98.0]

Average Accuracy (CNN): 93.58
Average Accuracy (Route): 87.57
2024-04-23 00:49:56,320 [trainer.py] => Average Accuracy (CNN): 93.58
2024-04-23 00:49:56,320 [trainer.py] => Average Accuracy (Route): 87.57

2024-04-23 00:49:56,320 [trainer.py] => Train Time: 2720.06
2024-04-23 00:49:56,320 [trainer.py] => Test Time: 0 

2024-04-23 00:49:56,321 [trainer.py] => All params: 86098298
2024-04-23 00:49:56,322 [trainer.py] => Trainable params: 212065
2024-04-23 00:49:56,374 [loramoeinc.py] => Learning on 60-120
  0%|          | 0/20 [00:00<?, ?it/s]Task 1, Epoch 1/20 => Loss 2.376, Train_accy 42.55:   0%|          | 0/20 [02:18<?, ?it/s]Task 1, Epoch 1/20 => Loss 2.376, Train_accy 42.55:   5%|▌         | 1/20 [02:18<43:59, 138.95s/it]Task 1, Epoch 2/20 => Loss 2.127, Train_accy 45.38:   5%|▌         | 1/20 [04:30<43:59, 138.95s/it]Task 1, Epoch 2/20 => Loss 2.127, Train_accy 45.38:  10%|█         | 2/20 [04:30<40:21, 134.52s/it]Task 1, Epoch 3/20 => Loss 2.087, Train_accy 46.11:  10%|█         | 2/20 [06:46<40:21, 134.52s/it]Task 1, Epoch 3/20 => Loss 2.087, Train_accy 46.11:  15%|█▌        | 3/20 [06:46<38:17, 135.16s/it]Task 1, Epoch 4/20 => Loss 2.051, Train_accy 46.62:  15%|█▌        | 3/20 [09:01<38:17, 135.16s/it]Task 1, Epoch 4/20 => Loss 2.051, Train_accy 46.62:  20%|██        | 4/20 [09:01<36:01, 135.11s/it]Task 1, Epoch 5/20 => Loss 2.025, Train_accy 47.21:  20%|██        | 4/20 [11:17<36:01, 135.11s/it]Task 1, Epoch 5/20 => Loss 2.025, Train_accy 47.21:  25%|██▌       | 5/20 [11:17<33:50, 135.34s/it]Task 1, Epoch 6/20 => Loss 2.007, Train_accy 47.54:  25%|██▌       | 5/20 [13:35<33:50, 135.34s/it]Task 1, Epoch 6/20 => Loss 2.007, Train_accy 47.54:  30%|███       | 6/20 [13:35<31:49, 136.41s/it]Task 1, Epoch 7/20 => Loss 1.997, Train_accy 47.57:  30%|███       | 6/20 [15:51<31:49, 136.41s/it]Task 1, Epoch 7/20 => Loss 1.997, Train_accy 47.57:  35%|███▌      | 7/20 [15:51<29:29, 136.13s/it]Task 1, Epoch 8/20 => Loss 1.956, Train_accy 48.03:  35%|███▌      | 7/20 [18:03<29:29, 136.13s/it]Task 1, Epoch 8/20 => Loss 1.956, Train_accy 48.03:  40%|████      | 8/20 [18:03<26:58, 134.87s/it]Task 1, Epoch 9/20 => Loss 1.937, Train_accy 48.62:  40%|████      | 8/20 [20:19<26:58, 134.87s/it]Task 1, Epoch 9/20 => Loss 1.937, Train_accy 48.62:  45%|████▌     | 9/20 [20:19<24:46, 135.17s/it]Task 1, Epoch 10/20 => Loss 1.909, Train_accy 49.49:  45%|████▌     | 9/20 [22:30<24:46, 135.17s/it]Task 1, Epoch 10/20 => Loss 1.909, Train_accy 49.49:  50%|█████     | 10/20 [22:30<22:19, 133.90s/it]Task 1, Epoch 11/20 => Loss 1.904, Train_accy 49.21:  50%|█████     | 10/20 [24:46<22:19, 133.90s/it]Task 1, Epoch 11/20 => Loss 1.904, Train_accy 49.21:  55%|█████▌    | 11/20 [24:46<20:10, 134.53s/it]Task 1, Epoch 12/20 => Loss 1.892, Train_accy 49.64:  55%|█████▌    | 11/20 [27:08<20:10, 134.53s/it]Task 1, Epoch 12/20 => Loss 1.892, Train_accy 49.64:  60%|██████    | 12/20 [27:08<18:14, 136.77s/it]Task 1, Epoch 13/20 => Loss 1.854, Train_accy 50.40:  60%|██████    | 12/20 [29:24<18:14, 136.77s/it]Task 1, Epoch 13/20 => Loss 1.854, Train_accy 50.40:  65%|██████▌   | 13/20 [29:24<15:56, 136.59s/it]Task 1, Epoch 14/20 => Loss 1.844, Train_accy 50.46:  65%|██████▌   | 13/20 [31:46<15:56, 136.59s/it]Task 1, Epoch 14/20 => Loss 1.844, Train_accy 50.46:  70%|███████   | 14/20 [31:46<13:49, 138.26s/it]Task 1, Epoch 15/20 => Loss 1.824, Train_accy 51.07:  70%|███████   | 14/20 [34:04<13:49, 138.26s/it]Task 1, Epoch 15/20 => Loss 1.824, Train_accy 51.07:  75%|███████▌  | 15/20 [34:04<11:31, 138.29s/it]Task 1, Epoch 16/20 => Loss 1.807, Train_accy 51.15:  75%|███████▌  | 15/20 [36:23<11:31, 138.29s/it]Task 1, Epoch 16/20 => Loss 1.807, Train_accy 51.15:  80%|████████  | 16/20 [36:23<09:13, 138.39s/it]Task 1, Epoch 17/20 => Loss 1.797, Train_accy 51.58:  80%|████████  | 16/20 [38:43<09:13, 138.39s/it]Task 1, Epoch 17/20 => Loss 1.797, Train_accy 51.58:  85%|████████▌ | 17/20 [38:43<06:56, 138.98s/it]Task 1, Epoch 18/20 => Loss 1.785, Train_accy 51.85:  85%|████████▌ | 17/20 [40:58<06:56, 138.98s/it]Task 1, Epoch 18/20 => Loss 1.785, Train_accy 51.85:  90%|█████████ | 18/20 [40:58<04:35, 137.74s/it]Task 1, Epoch 19/20 => Loss 1.777, Train_accy 51.99:  90%|█████████ | 18/20 [43:16<04:35, 137.74s/it]Task 1, Epoch 19/20 => Loss 1.777, Train_accy 51.99:  95%|█████████▌| 19/20 [43:16<02:17, 137.79s/it]Task 1, Epoch 20/20 => Loss 1.774, Train_accy 51.79:  95%|█████████▌| 19/20 [45:35<02:17, 137.79s/it]Task 1, Epoch 20/20 => Loss 1.774, Train_accy 51.79: 100%|██████████| 20/20 [45:35<00:00, 138.20s/it]Task 1, Epoch 20/20 => Loss 1.774, Train_accy 51.79: 100%|██████████| 20/20 [45:35<00:00, 136.78s/it]
2024-04-23 01:35:32,006 [loramoeinc.py] => Task 1, Epoch 20/20 => Loss 1.774, Train_accy 51.79
2024-04-23 01:39:10,441 [trainer.py] => No NME accuracy.
2024-04-23 01:39:10,441 [trainer.py] => CNN: {'total': 89.81, '00-59': 93.58, '60-119': 86.04, 'old': 93.58, 'new': 86.04}
2024-04-23 01:39:10,441 [trainer.py] => Route: {'total': 81.42, '00-59': 81.9, '60-119': 80.94, 'old': 81.9, 'new': 80.94}
2024-04-23 01:39:10,441 [trainer.py] => CNN top1 curve: [93.58, 89.81]
2024-04-23 01:39:10,441 [trainer.py] => CNN top5 curve: [99.17, 98.83]
2024-04-23 01:39:10,441 [trainer.py] => Route top1 curve: [87.57, 81.42]
2024-04-23 01:39:10,441 [trainer.py] => Route top5 curve: [98.0, 95.87]

Average Accuracy (CNN): 91.695
Average Accuracy (Route): 84.495
2024-04-23 01:39:10,441 [trainer.py] => Average Accuracy (CNN): 91.695
2024-04-23 01:39:10,441 [trainer.py] => Average Accuracy (Route): 84.495

2024-04-23 01:39:10,441 [trainer.py] => Train Time: 5455.639999999999
2024-04-23 01:39:10,441 [trainer.py] => Test Time: 0 

2024-04-23 01:39:10,442 [trainer.py] => All params: 86190458
2024-04-23 01:39:10,443 [trainer.py] => Trainable params: 216649
2024-04-23 01:39:10,519 [loramoeinc.py] => Learning on 120-180
  0%|          | 0/20 [00:00<?, ?it/s]Task 2, Epoch 1/20 => Loss 2.656, Train_accy 38.80:   0%|          | 0/20 [02:19<?, ?it/s]Task 2, Epoch 1/20 => Loss 2.656, Train_accy 38.80:   5%|▌         | 1/20 [02:19<44:02, 139.10s/it]Task 2, Epoch 2/20 => Loss 2.306, Train_accy 43.48:   5%|▌         | 1/20 [04:40<44:02, 139.10s/it]Task 2, Epoch 2/20 => Loss 2.306, Train_accy 43.48:  10%|█         | 2/20 [04:40<42:11, 140.66s/it]Task 2, Epoch 3/20 => Loss 2.262, Train_accy 44.03:  10%|█         | 2/20 [06:58<42:11, 140.66s/it]Task 2, Epoch 3/20 => Loss 2.262, Train_accy 44.03:  15%|█▌        | 3/20 [06:58<39:27, 139.28s/it]Task 2, Epoch 4/20 => Loss 2.242, Train_accy 44.62:  15%|█▌        | 3/20 [09:19<39:27, 139.28s/it]Task 2, Epoch 4/20 => Loss 2.242, Train_accy 44.62:  20%|██        | 4/20 [09:19<37:18, 139.90s/it]Task 2, Epoch 5/20 => Loss 2.218, Train_accy 45.16:  20%|██        | 4/20 [11:40<37:18, 139.90s/it]Task 2, Epoch 5/20 => Loss 2.218, Train_accy 45.16:  25%|██▌       | 5/20 [11:40<35:04, 140.27s/it]Task 2, Epoch 6/20 => Loss 2.194, Train_accy 45.32:  25%|██▌       | 5/20 [13:59<35:04, 140.27s/it]Task 2, Epoch 6/20 => Loss 2.194, Train_accy 45.32:  30%|███       | 6/20 [13:59<32:37, 139.83s/it]Task 2, Epoch 7/20 => Loss 2.156, Train_accy 45.83:  30%|███       | 6/20 [16:14<32:37, 139.83s/it]Task 2, Epoch 7/20 => Loss 2.156, Train_accy 45.83:  35%|███▌      | 7/20 [16:14<29:57, 138.25s/it]Task 2, Epoch 8/20 => Loss 2.142, Train_accy 46.19:  35%|███▌      | 7/20 [18:32<29:57, 138.25s/it]Task 2, Epoch 8/20 => Loss 2.142, Train_accy 46.19:  40%|████      | 8/20 [18:32<27:37, 138.10s/it]Task 2, Epoch 9/20 => Loss 2.111, Train_accy 46.78:  40%|████      | 8/20 [20:47<27:37, 138.10s/it]Task 2, Epoch 9/20 => Loss 2.111, Train_accy 46.78:  45%|████▌     | 9/20 [20:47<25:10, 137.36s/it]Task 2, Epoch 10/20 => Loss 2.092, Train_accy 46.73:  45%|████▌     | 9/20 [23:12<25:10, 137.36s/it]Task 2, Epoch 10/20 => Loss 2.092, Train_accy 46.73:  50%|█████     | 10/20 [23:12<23:15, 139.56s/it]Task 2, Epoch 11/20 => Loss 2.077, Train_accy 47.06:  50%|█████     | 10/20 [25:31<23:15, 139.56s/it]Task 2, Epoch 11/20 => Loss 2.077, Train_accy 47.06:  55%|█████▌    | 11/20 [25:31<20:56, 139.57s/it]Task 2, Epoch 12/20 => Loss 2.049, Train_accy 47.47:  55%|█████▌    | 11/20 [27:51<20:56, 139.57s/it]Task 2, Epoch 12/20 => Loss 2.049, Train_accy 47.47:  60%|██████    | 12/20 [27:51<18:37, 139.68s/it]Task 2, Epoch 13/20 => Loss 2.035, Train_accy 48.01:  60%|██████    | 12/20 [30:13<18:37, 139.68s/it]Task 2, Epoch 13/20 => Loss 2.035, Train_accy 48.01:  65%|██████▌   | 13/20 [30:13<16:22, 140.33s/it]Task 2, Epoch 14/20 => Loss 2.026, Train_accy 47.86:  65%|██████▌   | 13/20 [32:33<16:22, 140.33s/it]Task 2, Epoch 14/20 => Loss 2.026, Train_accy 47.86:  70%|███████   | 14/20 [32:33<14:00, 140.15s/it]Task 2, Epoch 15/20 => Loss 2.005, Train_accy 48.19:  70%|███████   | 14/20 [34:56<14:00, 140.15s/it]Task 2, Epoch 15/20 => Loss 2.005, Train_accy 48.19:  75%|███████▌  | 15/20 [34:56<11:45, 141.12s/it]Task 2, Epoch 16/20 => Loss 1.997, Train_accy 48.42:  75%|███████▌  | 15/20 [37:18<11:45, 141.12s/it]Task 2, Epoch 16/20 => Loss 1.997, Train_accy 48.42:  80%|████████  | 16/20 [37:18<09:24, 141.19s/it]Task 2, Epoch 17/20 => Loss 1.981, Train_accy 48.53:  80%|████████  | 16/20 [39:45<09:24, 141.19s/it]Task 2, Epoch 17/20 => Loss 1.981, Train_accy 48.53:  85%|████████▌ | 17/20 [39:45<07:09, 143.16s/it]Task 2, Epoch 18/20 => Loss 1.969, Train_accy 48.73:  85%|████████▌ | 17/20 [42:09<07:09, 143.16s/it]Task 2, Epoch 18/20 => Loss 1.969, Train_accy 48.73:  90%|█████████ | 18/20 [42:09<04:46, 143.36s/it]Task 2, Epoch 19/20 => Loss 1.962, Train_accy 48.99:  90%|█████████ | 18/20 [44:32<04:46, 143.36s/it]Task 2, Epoch 19/20 => Loss 1.962, Train_accy 48.99:  95%|█████████▌| 19/20 [44:32<02:23, 143.15s/it]Task 2, Epoch 20/20 => Loss 1.958, Train_accy 48.95:  95%|█████████▌| 19/20 [46:54<02:23, 143.15s/it]Task 2, Epoch 20/20 => Loss 1.958, Train_accy 48.95: 100%|██████████| 20/20 [46:54<00:00, 143.00s/it]Task 2, Epoch 20/20 => Loss 1.958, Train_accy 48.95: 100%|██████████| 20/20 [46:54<00:00, 140.75s/it]
2024-04-23 02:26:05,533 [loramoeinc.py] => Task 2, Epoch 20/20 => Loss 1.958, Train_accy 48.95
2024-04-23 02:29:48,658 [trainer.py] => No NME accuracy.
2024-04-23 02:29:48,658 [trainer.py] => CNN: {'total': 87.89, '00-59': 93.58, '60-119': 86.04, '120-179': 84.04, 'old': 89.81, 'new': 84.04}
2024-04-23 02:29:48,658 [trainer.py] => Route: {'total': 76.73, '00-59': 76.81, '60-119': 76.59, '120-179': 76.78, 'old': 76.7, 'new': 76.78}
2024-04-23 02:29:48,658 [trainer.py] => CNN top1 curve: [93.58, 89.81, 87.89]
2024-04-23 02:29:48,659 [trainer.py] => CNN top5 curve: [99.17, 98.83, 97.97]
2024-04-23 02:29:48,659 [trainer.py] => Route top1 curve: [87.57, 81.42, 76.73]
2024-04-23 02:29:48,659 [trainer.py] => Route top5 curve: [98.0, 95.87, 93.26]

Average Accuracy (CNN): 90.42666666666666
Average Accuracy (Route): 81.90666666666668
2024-04-23 02:29:48,659 [trainer.py] => Average Accuracy (CNN): 90.42666666666666
2024-04-23 02:29:48,659 [trainer.py] => Average Accuracy (Route): 81.90666666666668

2024-04-23 02:29:48,659 [trainer.py] => Train Time: 8270.59
2024-04-23 02:29:48,659 [trainer.py] => Test Time: 0 

2024-04-23 02:29:48,660 [trainer.py] => All params: 86282618
2024-04-23 02:29:48,661 [trainer.py] => Trainable params: 221233
2024-04-23 02:29:48,713 [loramoeinc.py] => Learning on 180-240
  0%|          | 0/20 [00:00<?, ?it/s]Task 3, Epoch 1/20 => Loss 2.528, Train_accy 36.18:   0%|          | 0/20 [02:19<?, ?it/s]Task 3, Epoch 1/20 => Loss 2.528, Train_accy 36.18:   5%|▌         | 1/20 [02:19<44:07, 139.36s/it]Task 3, Epoch 2/20 => Loss 2.256, Train_accy 40.64:   5%|▌         | 1/20 [04:40<44:07, 139.36s/it]Task 3, Epoch 2/20 => Loss 2.256, Train_accy 40.64:  10%|█         | 2/20 [04:40<42:03, 140.19s/it]Task 3, Epoch 3/20 => Loss 2.224, Train_accy 40.94:  10%|█         | 2/20 [07:03<42:03, 140.19s/it]Task 3, Epoch 3/20 => Loss 2.224, Train_accy 40.94:  15%|█▌        | 3/20 [07:03<40:06, 141.57s/it]Task 3, Epoch 4/20 => Loss 2.189, Train_accy 42.05:  15%|█▌        | 3/20 [09:25<40:06, 141.57s/it]Task 3, Epoch 4/20 => Loss 2.189, Train_accy 42.05:  20%|██        | 4/20 [09:25<37:49, 141.85s/it]Task 3, Epoch 5/20 => Loss 2.162, Train_accy 42.39:  20%|██        | 4/20 [11:45<37:49, 141.85s/it]Task 3, Epoch 5/20 => Loss 2.162, Train_accy 42.39:  25%|██▌       | 5/20 [11:45<35:17, 141.14s/it]Task 3, Epoch 6/20 => Loss 2.146, Train_accy 42.73:  25%|██▌       | 5/20 [14:10<35:17, 141.14s/it]Task 3, Epoch 6/20 => Loss 2.146, Train_accy 42.73:  30%|███       | 6/20 [14:10<33:13, 142.36s/it]Task 3, Epoch 7/20 => Loss 2.127, Train_accy 42.85:  30%|███       | 6/20 [16:31<33:13, 142.36s/it]Task 3, Epoch 7/20 => Loss 2.127, Train_accy 42.85:  35%|███▌      | 7/20 [16:31<30:46, 142.04s/it]Task 3, Epoch 8/20 => Loss 2.120, Train_accy 43.22:  35%|███▌      | 7/20 [18:51<30:46, 142.04s/it]Task 3, Epoch 8/20 => Loss 2.120, Train_accy 43.22:  40%|████      | 8/20 [18:51<28:15, 141.29s/it]Task 3, Epoch 9/20 => Loss 2.097, Train_accy 43.79:  40%|████      | 8/20 [21:11<28:15, 141.29s/it]Task 3, Epoch 9/20 => Loss 2.097, Train_accy 43.79:  45%|████▌     | 9/20 [21:11<25:49, 140.85s/it]Task 3, Epoch 10/20 => Loss 2.064, Train_accy 44.23:  45%|████▌     | 9/20 [23:27<25:49, 140.85s/it]Task 3, Epoch 10/20 => Loss 2.064, Train_accy 44.23:  50%|█████     | 10/20 [23:27<23:15, 139.54s/it]Task 3, Epoch 11/20 => Loss 2.066, Train_accy 44.28:  50%|█████     | 10/20 [25:43<23:15, 139.54s/it]Task 3, Epoch 11/20 => Loss 2.066, Train_accy 44.28:  55%|█████▌    | 11/20 [25:43<20:45, 138.41s/it]Task 3, Epoch 12/20 => Loss 2.035, Train_accy 44.88:  55%|█████▌    | 11/20 [28:01<20:45, 138.41s/it]Task 3, Epoch 12/20 => Loss 2.035, Train_accy 44.88:  60%|██████    | 12/20 [28:01<18:26, 138.29s/it]Task 3, Epoch 13/20 => Loss 2.030, Train_accy 45.07:  60%|██████    | 12/20 [30:21<18:26, 138.29s/it]Task 3, Epoch 13/20 => Loss 2.030, Train_accy 45.07:  65%|██████▌   | 13/20 [30:21<16:10, 138.64s/it]Task 3, Epoch 14/20 => Loss 2.000, Train_accy 45.60:  65%|██████▌   | 13/20 [32:46<16:10, 138.64s/it]Task 3, Epoch 14/20 => Loss 2.000, Train_accy 45.60:  70%|███████   | 14/20 [32:46<14:04, 140.74s/it]Task 3, Epoch 15/20 => Loss 1.988, Train_accy 46.20:  70%|███████   | 14/20 [35:13<14:04, 140.74s/it]Task 3, Epoch 15/20 => Loss 1.988, Train_accy 46.20:  75%|███████▌  | 15/20 [35:13<11:52, 142.44s/it]Task 3, Epoch 16/20 => Loss 1.973, Train_accy 46.36:  75%|███████▌  | 15/20 [37:42<11:52, 142.44s/it]Task 3, Epoch 16/20 => Loss 1.973, Train_accy 46.36:  80%|████████  | 16/20 [37:42<09:37, 144.42s/it]Task 3, Epoch 17/20 => Loss 1.967, Train_accy 46.53:  80%|████████  | 16/20 [40:08<09:37, 144.42s/it]Task 3, Epoch 17/20 => Loss 1.967, Train_accy 46.53:  85%|████████▌ | 17/20 [40:08<07:15, 145.07s/it]Task 3, Epoch 18/20 => Loss 1.955, Train_accy 46.76:  85%|████████▌ | 17/20 [42:35<07:15, 145.07s/it]Task 3, Epoch 18/20 => Loss 1.955, Train_accy 46.76:  90%|█████████ | 18/20 [42:35<04:51, 145.56s/it]Task 3, Epoch 19/20 => Loss 1.947, Train_accy 46.99:  90%|█████████ | 18/20 [45:03<04:51, 145.56s/it]Task 3, Epoch 19/20 => Loss 1.947, Train_accy 46.99:  95%|█████████▌| 19/20 [45:03<02:26, 146.29s/it]Task 3, Epoch 20/20 => Loss 1.946, Train_accy 46.88:  95%|█████████▌| 19/20 [47:33<02:26, 146.29s/it]Task 3, Epoch 20/20 => Loss 1.946, Train_accy 46.88: 100%|██████████| 20/20 [47:33<00:00, 147.32s/it]Task 3, Epoch 20/20 => Loss 1.946, Train_accy 46.88: 100%|██████████| 20/20 [47:33<00:00, 142.65s/it]
2024-04-23 03:17:21,861 [loramoeinc.py] => Task 3, Epoch 20/20 => Loss 1.946, Train_accy 46.88
2024-04-23 03:21:07,428 [trainer.py] => No NME accuracy.
2024-04-23 03:21:07,428 [trainer.py] => CNN: {'total': 86.32, '00-59': 93.49, '60-119': 86.04, '120-179': 84.04, '180-239': 81.69, 'old': 87.86, 'new': 81.69}
2024-04-23 03:21:07,428 [trainer.py] => Route: {'total': 74.12, '00-59': 75.06, '60-119': 73.58, '120-179': 74.69, '180-239': 73.16, 'old': 74.44, 'new': 73.16}
2024-04-23 03:21:07,428 [trainer.py] => CNN top1 curve: [93.58, 89.81, 87.89, 86.32]
2024-04-23 03:21:07,429 [trainer.py] => CNN top5 curve: [99.17, 98.83, 97.97, 97.24]
2024-04-23 03:21:07,429 [trainer.py] => Route top1 curve: [87.57, 81.42, 76.73, 74.12]
2024-04-23 03:21:07,429 [trainer.py] => Route top5 curve: [98.0, 95.87, 93.26, 91.21]

Average Accuracy (CNN): 89.39999999999999
Average Accuracy (Route): 79.96000000000001
2024-04-23 03:21:07,429 [trainer.py] => Average Accuracy (CNN): 89.39999999999999
2024-04-23 03:21:07,429 [trainer.py] => Average Accuracy (Route): 79.96000000000001

2024-04-23 03:21:07,429 [trainer.py] => Train Time: 11123.67
2024-04-23 03:21:07,429 [trainer.py] => Test Time: 0 

2024-04-23 03:21:07,430 [trainer.py] => All params: 86374778
2024-04-23 03:21:07,430 [trainer.py] => Trainable params: 225817
2024-04-23 03:21:07,460 [loramoeinc.py] => Learning on 240-300
  0%|          | 0/20 [00:00<?, ?it/s]Task 4, Epoch 1/20 => Loss 2.202, Train_accy 47.73:   0%|          | 0/20 [02:29<?, ?it/s]Task 4, Epoch 1/20 => Loss 2.202, Train_accy 47.73:   5%|▌         | 1/20 [02:29<47:28, 149.90s/it]Task 4, Epoch 2/20 => Loss 1.935, Train_accy 51.70:   5%|▌         | 1/20 [05:00<47:28, 149.90s/it]Task 4, Epoch 2/20 => Loss 1.935, Train_accy 51.70:  10%|█         | 2/20 [05:00<45:04, 150.26s/it]Task 4, Epoch 3/20 => Loss 1.900, Train_accy 52.11:  10%|█         | 2/20 [07:31<45:04, 150.26s/it]Task 4, Epoch 3/20 => Loss 1.900, Train_accy 52.11:  15%|█▌        | 3/20 [07:31<42:42, 150.73s/it]Task 4, Epoch 4/20 => Loss 1.874, Train_accy 52.80:  15%|█▌        | 3/20 [10:02<42:42, 150.73s/it]Task 4, Epoch 4/20 => Loss 1.874, Train_accy 52.80:  20%|██        | 4/20 [10:02<40:12, 150.80s/it]Task 4, Epoch 5/20 => Loss 1.843, Train_accy 53.33:  20%|██        | 4/20 [12:32<40:12, 150.80s/it]Task 4, Epoch 5/20 => Loss 1.843, Train_accy 53.33:  25%|██▌       | 5/20 [12:32<37:39, 150.63s/it]Task 4, Epoch 6/20 => Loss 1.808, Train_accy 54.00:  25%|██▌       | 5/20 [15:02<37:39, 150.63s/it]Task 4, Epoch 6/20 => Loss 1.808, Train_accy 54.00:  30%|███       | 6/20 [15:02<35:05, 150.41s/it]Task 4, Epoch 7/20 => Loss 1.801, Train_accy 54.20:  30%|███       | 6/20 [17:32<35:05, 150.41s/it]Task 4, Epoch 7/20 => Loss 1.801, Train_accy 54.20:  35%|███▌      | 7/20 [17:32<32:33, 150.27s/it]Task 4, Epoch 8/20 => Loss 1.781, Train_accy 54.16:  35%|███▌      | 7/20 [20:01<32:33, 150.27s/it]Task 4, Epoch 8/20 => Loss 1.781, Train_accy 54.16:  40%|████      | 8/20 [20:01<29:57, 149.82s/it]Task 4, Epoch 9/20 => Loss 1.755, Train_accy 54.73:  40%|████      | 8/20 [22:31<29:57, 149.82s/it]Task 4, Epoch 9/20 => Loss 1.755, Train_accy 54.73:  45%|████▌     | 9/20 [22:31<27:27, 149.76s/it]Task 4, Epoch 10/20 => Loss 1.732, Train_accy 54.87:  45%|████▌     | 9/20 [25:00<27:27, 149.76s/it]Task 4, Epoch 10/20 => Loss 1.732, Train_accy 54.87:  50%|█████     | 10/20 [25:00<24:56, 149.69s/it]Task 4, Epoch 11/20 => Loss 1.728, Train_accy 55.11:  50%|█████     | 10/20 [27:31<24:56, 149.69s/it]Task 4, Epoch 11/20 => Loss 1.728, Train_accy 55.11:  55%|█████▌    | 11/20 [27:31<22:30, 150.03s/it]Task 4, Epoch 12/20 => Loss 1.694, Train_accy 55.59:  55%|█████▌    | 11/20 [30:01<22:30, 150.03s/it]Task 4, Epoch 12/20 => Loss 1.694, Train_accy 55.59:  60%|██████    | 12/20 [30:01<20:00, 150.04s/it]Task 4, Epoch 13/20 => Loss 1.675, Train_accy 55.83:  60%|██████    | 12/20 [32:32<20:00, 150.04s/it]Task 4, Epoch 13/20 => Loss 1.675, Train_accy 55.83:  65%|██████▌   | 13/20 [32:32<17:31, 150.21s/it]Task 4, Epoch 14/20 => Loss 1.662, Train_accy 56.04:  65%|██████▌   | 13/20 [35:02<17:31, 150.21s/it]Task 4, Epoch 14/20 => Loss 1.662, Train_accy 56.04:  70%|███████   | 14/20 [35:02<15:00, 150.10s/it]Task 4, Epoch 15/20 => Loss 1.655, Train_accy 56.17:  70%|███████   | 14/20 [37:32<15:00, 150.10s/it]Task 4, Epoch 15/20 => Loss 1.655, Train_accy 56.17:  75%|███████▌  | 15/20 [37:32<12:31, 150.23s/it]Task 4, Epoch 16/20 => Loss 1.643, Train_accy 56.23:  75%|███████▌  | 15/20 [40:02<12:31, 150.23s/it]Task 4, Epoch 16/20 => Loss 1.643, Train_accy 56.23:  80%|████████  | 16/20 [40:02<10:00, 150.09s/it]Task 4, Epoch 17/20 => Loss 1.624, Train_accy 56.50:  80%|████████  | 16/20 [42:31<10:00, 150.09s/it]Task 4, Epoch 17/20 => Loss 1.624, Train_accy 56.50:  85%|████████▌ | 17/20 [42:31<07:29, 149.68s/it]Task 4, Epoch 18/20 => Loss 1.622, Train_accy 56.59:  85%|████████▌ | 17/20 [44:53<07:29, 149.68s/it]Task 4, Epoch 18/20 => Loss 1.622, Train_accy 56.59:  90%|█████████ | 18/20 [44:53<04:54, 147.35s/it]Task 4, Epoch 19/20 => Loss 1.604, Train_accy 56.82:  90%|█████████ | 18/20 [46:59<04:54, 147.35s/it]Task 4, Epoch 19/20 => Loss 1.604, Train_accy 56.82:  95%|█████████▌| 19/20 [46:59<02:21, 141.11s/it]Task 4, Epoch 20/20 => Loss 1.608, Train_accy 56.77:  95%|█████████▌| 19/20 [49:05<02:21, 141.11s/it]Task 4, Epoch 20/20 => Loss 1.608, Train_accy 56.77: 100%|██████████| 20/20 [49:05<00:00, 136.62s/it]Task 4, Epoch 20/20 => Loss 1.608, Train_accy 56.77: 100%|██████████| 20/20 [49:05<00:00, 147.29s/it]
2024-04-23 04:10:13,411 [loramoeinc.py] => Task 4, Epoch 20/20 => Loss 1.608, Train_accy 56.77
2024-04-23 04:13:36,174 [trainer.py] => No NME accuracy.
2024-04-23 04:13:36,174 [trainer.py] => CNN: {'total': 86.25, '00-59': 93.49, '60-119': 86.04, '120-179': 84.04, '180-239': 81.69, '240-299': 85.96, 'old': 86.32, 'new': 85.96}
2024-04-23 04:13:36,174 [trainer.py] => Route: {'total': 73.3, '00-59': 74.23, '60-119': 71.15, '120-179': 71.85, '180-239': 72.07, '240-299': 77.19, 'old': 72.33, 'new': 77.19}
2024-04-23 04:13:36,174 [trainer.py] => CNN top1 curve: [93.58, 89.81, 87.89, 86.32, 86.25]
2024-04-23 04:13:36,174 [trainer.py] => CNN top5 curve: [99.17, 98.83, 97.97, 97.24, 97.19]
2024-04-23 04:13:36,174 [trainer.py] => Route top1 curve: [87.57, 81.42, 76.73, 74.12, 73.3]
2024-04-23 04:13:36,174 [trainer.py] => Route top5 curve: [98.0, 95.87, 93.26, 91.21, 91.45]

Average Accuracy (CNN): 88.77
Average Accuracy (Route): 78.62800000000001
2024-04-23 04:13:36,174 [trainer.py] => Average Accuracy (CNN): 88.77
2024-04-23 04:13:36,174 [trainer.py] => Average Accuracy (Route): 78.62800000000001

2024-04-23 04:13:36,174 [trainer.py] => Train Time: 14069.56
2024-04-23 04:13:36,175 [trainer.py] => Test Time: 0 

