nohup: 忽略输入
2024-04-22 21:27:39,808 [trainer.py] => config: ./exps/loramoe_inc_cub_B0_Inc5.json
2024-04-22 21:27:39,808 [trainer.py] => prefix: reproduce
2024-04-22 21:27:39,808 [trainer.py] => dataset: cub
2024-04-22 21:27:39,808 [trainer.py] => memory_size: 0
2024-04-22 21:27:39,808 [trainer.py] => memory_per_class: 0
2024-04-22 21:27:39,808 [trainer.py] => fixed_memory: False
2024-04-22 21:27:39,808 [trainer.py] => shuffle: True
2024-04-22 21:27:39,808 [trainer.py] => init_cls: 40
2024-04-22 21:27:39,808 [trainer.py] => increment: 40
2024-04-22 21:27:39,808 [trainer.py] => model_name: loramoeinc
2024-04-22 21:27:39,808 [trainer.py] => backbone_type: pretrained_vit_b16_224_inc
2024-04-22 21:27:39,808 [trainer.py] => device: [device(type='cuda', index=6)]
2024-04-22 21:27:39,808 [trainer.py] => seed: 1993
2024-04-22 21:27:39,809 [trainer.py] => tuned_epoch: 20
2024-04-22 21:27:39,809 [trainer.py] => init_lr: 0.01
2024-04-22 21:27:39,809 [trainer.py] => batch_size: 48
2024-04-22 21:27:39,809 [trainer.py] => weight_decay: 0.0005
2024-04-22 21:27:39,809 [trainer.py] => min_lr: 0
2024-04-22 21:27:39,809 [trainer.py] => ffn_num: 4
2024-04-22 21:27:39,809 [trainer.py] => optimizer: sgd
2024-04-22 21:27:39,809 [trainer.py] => vpt_type: shallow
2024-04-22 21:27:39,809 [trainer.py] => prompt_token_num: 5
2024-04-22 21:27:39,809 [trainer.py] => expert_num: 5
2024-04-22 21:27:39,865 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
/home/team/zhaohongwei/anaconda3/envs/peft/lib/python3.10/site-packages/bitsandbytes/cuda_setup/main.py:136: UserWarning: /home/team/zhaohongwei/anaconda3/envs/peft did not contain libcudart.so as expected! Searching further paths...
  warn(msg)

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please submit your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
CUDA SETUP: CUDA runtime path found: /usr/local/cuda-11.8/lib64/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 8.6
CUDA SETUP: Detected CUDA version 118
CUDA SETUP: Loading binary /home/team/zhaohongwei/anaconda3/envs/peft/lib/python3.10/site-packages/bitsandbytes/libbitsandbytes_cuda118.so...
I'm using ViT with adapters.
2024-04-22 21:27:54,421 [trainer.py] => All params: 86006136
2024-04-22 21:27:54,423 [trainer.py] => Trainable params: 207480
2024-04-22 21:27:54,575 [loramoeinc.py] => Learning on 0-40
  0%|          | 0/20 [00:00<?, ?it/s]Task 0, Epoch 1/20 => Loss 3.657, Train_accy 13.17:   0%|          | 0/20 [00:10<?, ?it/s]Task 0, Epoch 1/20 => Loss 3.657, Train_accy 13.17:   5%|▌         | 1/20 [00:10<03:10, 10.04s/it]Task 0, Epoch 2/20 => Loss 3.497, Train_accy 59.97:   5%|▌         | 1/20 [00:19<03:10, 10.04s/it]Task 0, Epoch 2/20 => Loss 3.497, Train_accy 59.97:  10%|█         | 2/20 [00:19<02:58,  9.89s/it]Task 0, Epoch 3/20 => Loss 3.016, Train_accy 75.46:  10%|█         | 2/20 [00:29<02:58,  9.89s/it]Task 0, Epoch 3/20 => Loss 3.016, Train_accy 75.46:  15%|█▌        | 3/20 [00:29<02:45,  9.74s/it]Task 0, Epoch 4/20 => Loss 2.028, Train_accy 80.59:  15%|█▌        | 3/20 [00:39<02:45,  9.74s/it]Task 0, Epoch 4/20 => Loss 2.028, Train_accy 80.59:  20%|██        | 4/20 [00:39<02:36,  9.76s/it]Task 0, Epoch 5/20 => Loss 1.180, Train_accy 85.30:  20%|██        | 4/20 [00:48<02:36,  9.76s/it]Task 0, Epoch 5/20 => Loss 1.180, Train_accy 85.30:  25%|██▌       | 5/20 [00:48<02:26,  9.77s/it]Task 0, Epoch 6/20 => Loss 0.806, Train_accy 88.84:  25%|██▌       | 5/20 [00:58<02:26,  9.77s/it]Task 0, Epoch 6/20 => Loss 0.806, Train_accy 88.84:  30%|███       | 6/20 [00:58<02:16,  9.73s/it]Task 0, Epoch 7/20 => Loss 0.648, Train_accy 90.01:  30%|███       | 6/20 [01:08<02:16,  9.73s/it]Task 0, Epoch 7/20 => Loss 0.648, Train_accy 90.01:  35%|███▌      | 7/20 [01:08<02:06,  9.72s/it]Task 0, Epoch 8/20 => Loss 0.540, Train_accy 90.69:  35%|███▌      | 7/20 [01:17<02:06,  9.72s/it]Task 0, Epoch 8/20 => Loss 0.540, Train_accy 90.69:  40%|████      | 8/20 [01:17<01:56,  9.69s/it]Task 0, Epoch 9/20 => Loss 0.492, Train_accy 90.85:  40%|████      | 8/20 [01:27<01:56,  9.69s/it]Task 0, Epoch 9/20 => Loss 0.492, Train_accy 90.85:  45%|████▌     | 9/20 [01:27<01:46,  9.72s/it]Task 0, Epoch 10/20 => Loss 0.473, Train_accy 90.80:  45%|████▌     | 9/20 [01:37<01:46,  9.72s/it]Task 0, Epoch 10/20 => Loss 0.473, Train_accy 90.80:  50%|█████     | 10/20 [01:37<01:37,  9.77s/it]Task 0, Epoch 11/20 => Loss 0.434, Train_accy 91.86:  50%|█████     | 10/20 [01:47<01:37,  9.77s/it]Task 0, Epoch 11/20 => Loss 0.434, Train_accy 91.86:  55%|█████▌    | 11/20 [01:47<01:27,  9.77s/it]Task 0, Epoch 12/20 => Loss 0.403, Train_accy 91.91:  55%|█████▌    | 11/20 [01:57<01:27,  9.77s/it]Task 0, Epoch 12/20 => Loss 0.403, Train_accy 91.91:  60%|██████    | 12/20 [01:57<01:17,  9.75s/it]Task 0, Epoch 13/20 => Loss 0.372, Train_accy 93.13:  60%|██████    | 12/20 [02:06<01:17,  9.75s/it]Task 0, Epoch 13/20 => Loss 0.372, Train_accy 93.13:  65%|██████▌   | 13/20 [02:06<01:08,  9.75s/it]Task 0, Epoch 14/20 => Loss 0.367, Train_accy 92.86:  65%|██████▌   | 13/20 [02:16<01:08,  9.75s/it]Task 0, Epoch 14/20 => Loss 0.367, Train_accy 92.86:  70%|███████   | 14/20 [02:16<00:58,  9.75s/it]Task 0, Epoch 15/20 => Loss 0.362, Train_accy 92.23:  70%|███████   | 14/20 [02:26<00:58,  9.75s/it]Task 0, Epoch 15/20 => Loss 0.362, Train_accy 92.23:  75%|███████▌  | 15/20 [02:26<00:49,  9.80s/it]Task 0, Epoch 16/20 => Loss 0.336, Train_accy 93.81:  75%|███████▌  | 15/20 [02:36<00:49,  9.80s/it]Task 0, Epoch 16/20 => Loss 0.336, Train_accy 93.81:  80%|████████  | 16/20 [02:36<00:39,  9.84s/it]Task 0, Epoch 17/20 => Loss 0.373, Train_accy 92.81:  80%|████████  | 16/20 [02:46<00:39,  9.84s/it]Task 0, Epoch 17/20 => Loss 0.373, Train_accy 92.81:  85%|████████▌ | 17/20 [02:46<00:29,  9.85s/it]Task 0, Epoch 18/20 => Loss 0.364, Train_accy 92.49:  85%|████████▌ | 17/20 [02:56<00:29,  9.85s/it]Task 0, Epoch 18/20 => Loss 0.364, Train_accy 92.49:  90%|█████████ | 18/20 [02:56<00:19,  9.83s/it]Task 0, Epoch 19/20 => Loss 0.335, Train_accy 93.81:  90%|█████████ | 18/20 [03:06<00:19,  9.83s/it]Task 0, Epoch 19/20 => Loss 0.335, Train_accy 93.81:  95%|█████████▌| 19/20 [03:06<00:09,  9.87s/it]Task 0, Epoch 20/20 => Loss 0.353, Train_accy 92.91:  95%|█████████▌| 19/20 [03:15<00:09,  9.87s/it]Task 0, Epoch 20/20 => Loss 0.353, Train_accy 92.91: 100%|██████████| 20/20 [03:15<00:00,  9.81s/it]Task 0, Epoch 20/20 => Loss 0.353, Train_accy 92.91: 100%|██████████| 20/20 [03:15<00:00,  9.79s/it]
2024-04-22 21:31:10,458 [loramoeinc.py] => Task 0, Epoch 20/20 => Loss 0.353, Train_accy 92.91
2024-04-22 21:31:55,340 [trainer.py] => No NME accuracy.
2024-04-22 21:31:55,340 [trainer.py] => CNN: {'total': 96.48, '00-39': 96.48, 'old': 0, 'new': 96.48}
2024-04-22 21:31:55,340 [trainer.py] => Route: {'total': 97.8, '00-39': 97.8, 'old': 0, 'new': 97.8}
2024-04-22 21:31:55,341 [trainer.py] => CNN top1 curve: [96.48]
2024-04-22 21:31:55,341 [trainer.py] => CNN top5 curve: [99.56]
2024-04-22 21:31:55,341 [trainer.py] => Route top1 curve: [97.8]
2024-04-22 21:31:55,341 [trainer.py] => Route top5 curve: [99.78]

Average Accuracy (CNN): 96.48
Average Accuracy (Route): 97.8
2024-04-22 21:31:55,341 [trainer.py] => Average Accuracy (CNN): 96.48
2024-04-22 21:31:55,341 [trainer.py] => Average Accuracy (Route): 97.8

2024-04-22 21:31:55,341 [trainer.py] => Train Time: 195.73
2024-04-22 21:31:55,341 [trainer.py] => Test Time: 0 

2024-04-22 21:31:55,342 [trainer.py] => All params: 86067578
2024-04-22 21:31:55,344 [trainer.py] => Trainable params: 196705
2024-04-22 21:31:55,347 [loramoeinc.py] => Learning on 40-80
  0%|          | 0/20 [00:00<?, ?it/s]Task 1, Epoch 1/20 => Loss 3.006, Train_accy 36.95:   0%|          | 0/20 [00:09<?, ?it/s]Task 1, Epoch 1/20 => Loss 3.006, Train_accy 36.95:   5%|▌         | 1/20 [00:09<03:04,  9.72s/it]Task 1, Epoch 2/20 => Loss 2.295, Train_accy 45.26:   5%|▌         | 1/20 [00:19<03:04,  9.72s/it]Task 1, Epoch 2/20 => Loss 2.295, Train_accy 45.26:  10%|█         | 2/20 [00:19<02:56,  9.78s/it]Task 1, Epoch 3/20 => Loss 1.977, Train_accy 49.44:  10%|█         | 2/20 [00:29<02:56,  9.78s/it]Task 1, Epoch 3/20 => Loss 1.977, Train_accy 49.44:  15%|█▌        | 3/20 [00:29<02:45,  9.76s/it]Task 1, Epoch 4/20 => Loss 1.824, Train_accy 52.20:  15%|█▌        | 3/20 [00:38<02:45,  9.76s/it]Task 1, Epoch 4/20 => Loss 1.824, Train_accy 52.20:  20%|██        | 4/20 [00:38<02:35,  9.74s/it]Task 1, Epoch 5/20 => Loss 1.689, Train_accy 53.94:  20%|██        | 4/20 [00:48<02:35,  9.74s/it]Task 1, Epoch 5/20 => Loss 1.689, Train_accy 53.94:  25%|██▌       | 5/20 [00:48<02:26,  9.77s/it]Task 1, Epoch 6/20 => Loss 1.706, Train_accy 54.00:  25%|██▌       | 5/20 [00:58<02:26,  9.77s/it]Task 1, Epoch 6/20 => Loss 1.706, Train_accy 54.00:  30%|███       | 6/20 [00:58<02:17,  9.79s/it]Task 1, Epoch 7/20 => Loss 1.649, Train_accy 54.95:  30%|███       | 6/20 [01:08<02:17,  9.79s/it]Task 1, Epoch 7/20 => Loss 1.649, Train_accy 54.95:  35%|███▌      | 7/20 [01:08<02:07,  9.83s/it]Task 1, Epoch 8/20 => Loss 1.607, Train_accy 56.70:  35%|███▌      | 7/20 [01:18<02:07,  9.83s/it]Task 1, Epoch 8/20 => Loss 1.607, Train_accy 56.70:  40%|████      | 8/20 [01:18<01:57,  9.82s/it]Task 1, Epoch 9/20 => Loss 1.585, Train_accy 55.32:  40%|████      | 8/20 [01:28<01:57,  9.82s/it]Task 1, Epoch 9/20 => Loss 1.585, Train_accy 55.32:  45%|████▌     | 9/20 [01:28<01:47,  9.79s/it]Task 1, Epoch 10/20 => Loss 1.578, Train_accy 56.06:  45%|████▌     | 9/20 [01:37<01:47,  9.79s/it]Task 1, Epoch 10/20 => Loss 1.578, Train_accy 56.06:  50%|█████     | 10/20 [01:37<01:38,  9.81s/it]Task 1, Epoch 11/20 => Loss 1.555, Train_accy 56.11:  50%|█████     | 10/20 [01:47<01:38,  9.81s/it]Task 1, Epoch 11/20 => Loss 1.555, Train_accy 56.11:  55%|█████▌    | 11/20 [01:47<01:28,  9.81s/it]Task 1, Epoch 12/20 => Loss 1.520, Train_accy 56.80:  55%|█████▌    | 11/20 [01:57<01:28,  9.81s/it]Task 1, Epoch 12/20 => Loss 1.520, Train_accy 56.80:  60%|██████    | 12/20 [01:57<01:18,  9.78s/it]Task 1, Epoch 13/20 => Loss 1.457, Train_accy 58.44:  60%|██████    | 12/20 [02:07<01:18,  9.78s/it]Task 1, Epoch 13/20 => Loss 1.457, Train_accy 58.44:  65%|██████▌   | 13/20 [02:07<01:08,  9.80s/it]Task 1, Epoch 14/20 => Loss 1.489, Train_accy 57.44:  65%|██████▌   | 13/20 [02:17<01:08,  9.80s/it]Task 1, Epoch 14/20 => Loss 1.489, Train_accy 57.44:  70%|███████   | 14/20 [02:17<00:59,  9.84s/it]Task 1, Epoch 15/20 => Loss 1.479, Train_accy 57.33:  70%|███████   | 14/20 [02:27<00:59,  9.84s/it]Task 1, Epoch 15/20 => Loss 1.479, Train_accy 57.33:  75%|███████▌  | 15/20 [02:27<00:49,  9.88s/it]Task 1, Epoch 16/20 => Loss 1.457, Train_accy 57.97:  75%|███████▌  | 15/20 [02:37<00:49,  9.88s/it]Task 1, Epoch 16/20 => Loss 1.457, Train_accy 57.97:  80%|████████  | 16/20 [02:37<00:39,  9.89s/it]Task 1, Epoch 17/20 => Loss 1.455, Train_accy 57.38:  80%|████████  | 16/20 [02:46<00:39,  9.89s/it]Task 1, Epoch 17/20 => Loss 1.455, Train_accy 57.38:  85%|████████▌ | 17/20 [02:46<00:29,  9.89s/it]Task 1, Epoch 18/20 => Loss 1.419, Train_accy 58.02:  85%|████████▌ | 17/20 [02:57<00:29,  9.89s/it]Task 1, Epoch 18/20 => Loss 1.419, Train_accy 58.02:  90%|█████████ | 18/20 [02:57<00:19,  9.93s/it]Task 1, Epoch 19/20 => Loss 1.437, Train_accy 57.91:  90%|█████████ | 18/20 [03:06<00:19,  9.93s/it]Task 1, Epoch 19/20 => Loss 1.437, Train_accy 57.91:  95%|█████████▌| 19/20 [03:06<00:09,  9.90s/it]Task 1, Epoch 20/20 => Loss 1.423, Train_accy 58.18:  95%|█████████▌| 19/20 [03:16<00:09,  9.90s/it]Task 1, Epoch 20/20 => Loss 1.423, Train_accy 58.18: 100%|██████████| 20/20 [03:16<00:00,  9.86s/it]Task 1, Epoch 20/20 => Loss 1.423, Train_accy 58.18: 100%|██████████| 20/20 [03:16<00:00,  9.83s/it]
2024-04-22 21:35:11,973 [loramoeinc.py] => Task 1, Epoch 20/20 => Loss 1.423, Train_accy 58.18
2024-04-22 21:35:59,443 [trainer.py] => No NME accuracy.
2024-04-22 21:35:59,443 [trainer.py] => CNN: {'total': 94.12, '00-39': 96.48, '40-79': 91.83, 'old': 96.48, 'new': 91.83}
2024-04-22 21:35:59,443 [trainer.py] => Route: {'total': 93.25, '00-39': 93.83, '40-79': 92.69, 'old': 93.83, 'new': 92.69}
2024-04-22 21:35:59,443 [trainer.py] => CNN top1 curve: [96.48, 94.12]
2024-04-22 21:35:59,443 [trainer.py] => CNN top5 curve: [99.56, 98.91]
2024-04-22 21:35:59,443 [trainer.py] => Route top1 curve: [97.8, 93.25]
2024-04-22 21:35:59,443 [trainer.py] => Route top5 curve: [99.78, 99.02]

Average Accuracy (CNN): 95.30000000000001
Average Accuracy (Route): 95.525
2024-04-22 21:35:59,443 [trainer.py] => Average Accuracy (CNN): 95.30000000000001
2024-04-22 21:35:59,443 [trainer.py] => Average Accuracy (Route): 95.525

2024-04-22 21:35:59,444 [trainer.py] => Train Time: 392.34000000000003
2024-04-22 21:35:59,444 [trainer.py] => Test Time: 0 

2024-04-22 21:35:59,445 [trainer.py] => All params: 86129018
2024-04-22 21:35:59,446 [trainer.py] => Trainable params: 185929
2024-04-22 21:35:59,449 [loramoeinc.py] => Learning on 80-120
  0%|          | 0/20 [00:00<?, ?it/s]Task 2, Epoch 1/20 => Loss 2.764, Train_accy 40.14:   0%|          | 0/20 [00:09<?, ?it/s]Task 2, Epoch 1/20 => Loss 2.764, Train_accy 40.14:   5%|▌         | 1/20 [00:09<03:03,  9.65s/it]Task 2, Epoch 2/20 => Loss 2.002, Train_accy 51.02:   5%|▌         | 1/20 [00:19<03:03,  9.65s/it]Task 2, Epoch 2/20 => Loss 2.002, Train_accy 51.02:  10%|█         | 2/20 [00:19<02:55,  9.72s/it]Task 2, Epoch 3/20 => Loss 1.716, Train_accy 58.57:  10%|█         | 2/20 [00:29<02:55,  9.72s/it]Task 2, Epoch 3/20 => Loss 1.716, Train_accy 58.57:  15%|█▌        | 3/20 [00:29<02:44,  9.70s/it]Task 2, Epoch 4/20 => Loss 1.553, Train_accy 60.72:  15%|█▌        | 3/20 [00:38<02:44,  9.70s/it]Task 2, Epoch 4/20 => Loss 1.553, Train_accy 60.72:  20%|██        | 4/20 [00:38<02:36,  9.75s/it]Task 2, Epoch 5/20 => Loss 1.523, Train_accy 61.74:  20%|██        | 4/20 [00:48<02:36,  9.75s/it]Task 2, Epoch 5/20 => Loss 1.523, Train_accy 61.74:  25%|██▌       | 5/20 [00:48<02:25,  9.73s/it]Task 2, Epoch 6/20 => Loss 1.383, Train_accy 63.61:  25%|██▌       | 5/20 [00:58<02:25,  9.73s/it]Task 2, Epoch 6/20 => Loss 1.383, Train_accy 63.61:  30%|███       | 6/20 [00:58<02:15,  9.70s/it]Task 2, Epoch 7/20 => Loss 1.329, Train_accy 64.31:  30%|███       | 6/20 [01:08<02:15,  9.70s/it]Task 2, Epoch 7/20 => Loss 1.329, Train_accy 64.31:  35%|███▌      | 7/20 [01:08<02:06,  9.73s/it]Task 2, Epoch 8/20 => Loss 1.285, Train_accy 65.43:  35%|███▌      | 7/20 [01:17<02:06,  9.73s/it]Task 2, Epoch 8/20 => Loss 1.285, Train_accy 65.43:  40%|████      | 8/20 [01:17<01:56,  9.74s/it]Task 2, Epoch 9/20 => Loss 1.225, Train_accy 66.67:  40%|████      | 8/20 [01:27<01:56,  9.74s/it]Task 2, Epoch 9/20 => Loss 1.225, Train_accy 66.67:  45%|████▌     | 9/20 [01:27<01:47,  9.74s/it]Task 2, Epoch 10/20 => Loss 1.195, Train_accy 66.08:  45%|████▌     | 9/20 [01:37<01:47,  9.74s/it]Task 2, Epoch 10/20 => Loss 1.195, Train_accy 66.08:  50%|█████     | 10/20 [01:37<01:37,  9.73s/it]Task 2, Epoch 11/20 => Loss 1.203, Train_accy 66.08:  50%|█████     | 10/20 [01:46<01:37,  9.73s/it]Task 2, Epoch 11/20 => Loss 1.203, Train_accy 66.08:  55%|█████▌    | 11/20 [01:46<01:27,  9.73s/it]Task 2, Epoch 12/20 => Loss 1.177, Train_accy 66.13:  55%|█████▌    | 11/20 [01:56<01:27,  9.73s/it]Task 2, Epoch 12/20 => Loss 1.177, Train_accy 66.13:  60%|██████    | 12/20 [01:56<01:18,  9.80s/it]Task 2, Epoch 13/20 => Loss 1.118, Train_accy 68.06:  60%|██████    | 12/20 [02:06<01:18,  9.80s/it]Task 2, Epoch 13/20 => Loss 1.118, Train_accy 68.06:  65%|██████▌   | 13/20 [02:06<01:08,  9.83s/it]Task 2, Epoch 14/20 => Loss 1.123, Train_accy 67.36:  65%|██████▌   | 13/20 [02:16<01:08,  9.83s/it]Task 2, Epoch 14/20 => Loss 1.123, Train_accy 67.36:  70%|███████   | 14/20 [02:16<00:58,  9.81s/it]Task 2, Epoch 15/20 => Loss 1.104, Train_accy 68.38:  70%|███████   | 14/20 [02:26<00:58,  9.81s/it]Task 2, Epoch 15/20 => Loss 1.104, Train_accy 68.38:  75%|███████▌  | 15/20 [02:26<00:48,  9.79s/it]Task 2, Epoch 16/20 => Loss 1.129, Train_accy 67.04:  75%|███████▌  | 15/20 [02:36<00:48,  9.79s/it]Task 2, Epoch 16/20 => Loss 1.129, Train_accy 67.04:  80%|████████  | 16/20 [02:36<00:39,  9.76s/it]Task 2, Epoch 17/20 => Loss 1.079, Train_accy 67.90:  80%|████████  | 16/20 [02:45<00:39,  9.76s/it]Task 2, Epoch 17/20 => Loss 1.079, Train_accy 67.90:  85%|████████▌ | 17/20 [02:45<00:29,  9.76s/it]Task 2, Epoch 18/20 => Loss 1.084, Train_accy 68.17:  85%|████████▌ | 17/20 [02:55<00:29,  9.76s/it]Task 2, Epoch 18/20 => Loss 1.084, Train_accy 68.17:  90%|█████████ | 18/20 [02:55<00:19,  9.75s/it]Task 2, Epoch 19/20 => Loss 1.085, Train_accy 67.36:  90%|█████████ | 18/20 [03:05<00:19,  9.75s/it]Task 2, Epoch 19/20 => Loss 1.085, Train_accy 67.36:  95%|█████████▌| 19/20 [03:05<00:09,  9.71s/it]Task 2, Epoch 20/20 => Loss 1.102, Train_accy 68.38:  95%|█████████▌| 19/20 [03:14<00:09,  9.71s/it]Task 2, Epoch 20/20 => Loss 1.102, Train_accy 68.38: 100%|██████████| 20/20 [03:14<00:00,  9.72s/it]Task 2, Epoch 20/20 => Loss 1.102, Train_accy 68.38: 100%|██████████| 20/20 [03:14<00:00,  9.74s/it]
2024-04-22 21:39:14,347 [loramoeinc.py] => Task 2, Epoch 20/20 => Loss 1.102, Train_accy 68.38
2024-04-22 21:40:03,798 [trainer.py] => No NME accuracy.
2024-04-22 21:40:03,798 [trainer.py] => CNN: {'total': 94.28, '00-39': 96.48, '40-79': 90.97, '80-119': 95.37, 'old': 93.69, 'new': 95.37}
2024-04-22 21:40:03,798 [trainer.py] => Route: {'total': 90.18, '00-39': 91.85, '40-79': 89.68, '80-119': 89.13, 'old': 90.75, 'new': 89.13}
2024-04-22 21:40:03,798 [trainer.py] => CNN top1 curve: [96.48, 94.12, 94.28]
2024-04-22 21:40:03,798 [trainer.py] => CNN top5 curve: [99.56, 98.91, 98.87]
2024-04-22 21:40:03,798 [trainer.py] => Route top1 curve: [97.8, 93.25, 90.18]
2024-04-22 21:40:03,798 [trainer.py] => Route top5 curve: [99.78, 99.02, 98.87]

Average Accuracy (CNN): 94.96
Average Accuracy (Route): 93.74333333333334
2024-04-22 21:40:03,798 [trainer.py] => Average Accuracy (CNN): 94.96
2024-04-22 21:40:03,798 [trainer.py] => Average Accuracy (Route): 93.74333333333334

2024-04-22 21:40:03,799 [trainer.py] => Train Time: 587.22
2024-04-22 21:40:03,799 [trainer.py] => Test Time: 0 

2024-04-22 21:40:03,800 [trainer.py] => All params: 86190458
2024-04-22 21:40:03,801 [trainer.py] => Trainable params: 175153
2024-04-22 21:40:03,805 [loramoeinc.py] => Learning on 120-160
  0%|          | 0/20 [00:00<?, ?it/s]Task 3, Epoch 1/20 => Loss 4.355, Train_accy 21.29:   0%|          | 0/20 [00:09<?, ?it/s]Task 3, Epoch 1/20 => Loss 4.355, Train_accy 21.29:   5%|▌         | 1/20 [00:09<03:04,  9.70s/it]Task 3, Epoch 2/20 => Loss 3.023, Train_accy 34.36:   5%|▌         | 1/20 [00:19<03:04,  9.70s/it]Task 3, Epoch 2/20 => Loss 3.023, Train_accy 34.36:  10%|█         | 2/20 [00:19<02:54,  9.68s/it]Task 3, Epoch 3/20 => Loss 2.404, Train_accy 45.46:  10%|█         | 2/20 [00:29<02:54,  9.68s/it]Task 3, Epoch 3/20 => Loss 2.404, Train_accy 45.46:  15%|█▌        | 3/20 [00:29<02:45,  9.72s/it]Task 3, Epoch 4/20 => Loss 2.084, Train_accy 51.12:  15%|█▌        | 3/20 [00:38<02:45,  9.72s/it]Task 3, Epoch 4/20 => Loss 2.084, Train_accy 51.12:  20%|██        | 4/20 [00:38<02:35,  9.75s/it]Task 3, Epoch 5/20 => Loss 1.978, Train_accy 54.32:  20%|██        | 4/20 [00:48<02:35,  9.75s/it]Task 3, Epoch 5/20 => Loss 1.978, Train_accy 54.32:  25%|██▌       | 5/20 [00:48<02:27,  9.80s/it]Task 3, Epoch 6/20 => Loss 1.980, Train_accy 53.47:  25%|██▌       | 5/20 [00:58<02:27,  9.80s/it]Task 3, Epoch 6/20 => Loss 1.980, Train_accy 53.47:  30%|███       | 6/20 [00:58<02:17,  9.80s/it]Task 3, Epoch 7/20 => Loss 1.766, Train_accy 57.36:  30%|███       | 6/20 [01:08<02:17,  9.80s/it]Task 3, Epoch 7/20 => Loss 1.766, Train_accy 57.36:  35%|███▌      | 7/20 [01:08<02:07,  9.83s/it]Task 3, Epoch 8/20 => Loss 1.619, Train_accy 60.03:  35%|███▌      | 7/20 [01:18<02:07,  9.83s/it]Task 3, Epoch 8/20 => Loss 1.619, Train_accy 60.03:  40%|████      | 8/20 [01:18<01:57,  9.82s/it]Task 3, Epoch 9/20 => Loss 1.522, Train_accy 60.99:  40%|████      | 8/20 [01:28<01:57,  9.82s/it]Task 3, Epoch 9/20 => Loss 1.522, Train_accy 60.99:  45%|████▌     | 9/20 [01:28<01:48,  9.87s/it]Task 3, Epoch 10/20 => Loss 1.438, Train_accy 62.54:  45%|████▌     | 9/20 [01:38<01:48,  9.87s/it]Task 3, Epoch 10/20 => Loss 1.438, Train_accy 62.54:  50%|█████     | 10/20 [01:38<01:39,  9.91s/it]Task 3, Epoch 11/20 => Loss 1.392, Train_accy 62.81:  50%|█████     | 10/20 [01:48<01:39,  9.91s/it]Task 3, Epoch 11/20 => Loss 1.392, Train_accy 62.81:  55%|█████▌    | 11/20 [01:48<01:28,  9.88s/it]Task 3, Epoch 12/20 => Loss 1.365, Train_accy 63.13:  55%|█████▌    | 11/20 [01:57<01:28,  9.88s/it]Task 3, Epoch 12/20 => Loss 1.365, Train_accy 63.13:  60%|██████    | 12/20 [01:57<01:18,  9.87s/it]Task 3, Epoch 13/20 => Loss 1.363, Train_accy 63.66:  60%|██████    | 12/20 [02:07<01:18,  9.87s/it]Task 3, Epoch 13/20 => Loss 1.363, Train_accy 63.66:  65%|██████▌   | 13/20 [02:07<01:09,  9.87s/it]Task 3, Epoch 14/20 => Loss 1.411, Train_accy 62.06:  65%|██████▌   | 13/20 [02:17<01:09,  9.87s/it]Task 3, Epoch 14/20 => Loss 1.411, Train_accy 62.06:  70%|███████   | 14/20 [02:17<00:59,  9.85s/it]Task 3, Epoch 15/20 => Loss 1.354, Train_accy 64.03:  70%|███████   | 14/20 [02:27<00:59,  9.85s/it]Task 3, Epoch 15/20 => Loss 1.354, Train_accy 64.03:  75%|███████▌  | 15/20 [02:27<00:49,  9.86s/it]Task 3, Epoch 16/20 => Loss 1.283, Train_accy 64.83:  75%|███████▌  | 15/20 [02:37<00:49,  9.86s/it]Task 3, Epoch 16/20 => Loss 1.283, Train_accy 64.83:  80%|████████  | 16/20 [02:37<00:39,  9.90s/it]Task 3, Epoch 17/20 => Loss 1.269, Train_accy 65.26:  80%|████████  | 16/20 [02:47<00:39,  9.90s/it]Task 3, Epoch 17/20 => Loss 1.269, Train_accy 65.26:  85%|████████▌ | 17/20 [02:47<00:29,  9.88s/it]Task 3, Epoch 18/20 => Loss 1.320, Train_accy 64.62:  85%|████████▌ | 17/20 [02:57<00:29,  9.88s/it]Task 3, Epoch 18/20 => Loss 1.320, Train_accy 64.62:  90%|█████████ | 18/20 [02:57<00:19,  9.84s/it]Task 3, Epoch 19/20 => Loss 1.281, Train_accy 65.10:  90%|█████████ | 18/20 [03:07<00:19,  9.84s/it]Task 3, Epoch 19/20 => Loss 1.281, Train_accy 65.10:  95%|█████████▌| 19/20 [03:07<00:09,  9.89s/it]Task 3, Epoch 20/20 => Loss 1.269, Train_accy 64.78:  95%|█████████▌| 19/20 [03:17<00:09,  9.89s/it]Task 3, Epoch 20/20 => Loss 1.269, Train_accy 64.78: 100%|██████████| 20/20 [03:17<00:00,  9.90s/it]Task 3, Epoch 20/20 => Loss 1.269, Train_accy 64.78: 100%|██████████| 20/20 [03:17<00:00,  9.85s/it]
2024-04-22 21:43:20,827 [loramoeinc.py] => Task 3, Epoch 20/20 => Loss 1.269, Train_accy 64.78
2024-04-22 21:44:14,998 [trainer.py] => No NME accuracy.
2024-04-22 21:44:14,998 [trainer.py] => CNN: {'total': 93.6, '00-39': 96.48, '40-79': 90.97, '80-119': 95.17, '120-159': 91.79, 'old': 94.21, 'new': 91.79}
2024-04-22 21:44:14,998 [trainer.py] => Route: {'total': 88.47, '00-39': 89.65, '40-79': 88.39, '80-119': 87.93, '120-159': 88.0, 'old': 88.63, 'new': 88.0}
2024-04-22 21:44:14,998 [trainer.py] => CNN top1 curve: [96.48, 94.12, 94.28, 93.6]
2024-04-22 21:44:14,998 [trainer.py] => CNN top5 curve: [99.56, 98.91, 98.87, 98.63]
2024-04-22 21:44:14,998 [trainer.py] => Route top1 curve: [97.8, 93.25, 90.18, 88.47]
2024-04-22 21:44:14,998 [trainer.py] => Route top5 curve: [99.78, 99.02, 98.87, 98.68]

Average Accuracy (CNN): 94.62
Average Accuracy (Route): 92.42500000000001
2024-04-22 21:44:14,998 [trainer.py] => Average Accuracy (CNN): 94.62
2024-04-22 21:44:14,998 [trainer.py] => Average Accuracy (Route): 92.42500000000001

2024-04-22 21:44:14,998 [trainer.py] => Train Time: 784.23
2024-04-22 21:44:14,998 [trainer.py] => Test Time: 0 

2024-04-22 21:44:14,999 [trainer.py] => All params: 86251898
2024-04-22 21:44:15,000 [trainer.py] => Trainable params: 164377
2024-04-22 21:44:15,006 [loramoeinc.py] => Learning on 160-200
  0%|          | 0/20 [00:00<?, ?it/s]Task 4, Epoch 1/20 => Loss 3.347, Train_accy 40.10:   0%|          | 0/20 [00:09<?, ?it/s]Task 4, Epoch 1/20 => Loss 3.347, Train_accy 40.10:   5%|▌         | 1/20 [00:09<03:09,  9.99s/it]Task 4, Epoch 2/20 => Loss 2.047, Train_accy 54.92:   5%|▌         | 1/20 [00:20<03:09,  9.99s/it]Task 4, Epoch 2/20 => Loss 2.047, Train_accy 54.92:  10%|█         | 2/20 [00:20<03:00, 10.01s/it]Task 4, Epoch 3/20 => Loss 1.704, Train_accy 62.98:  10%|█         | 2/20 [00:29<03:00, 10.01s/it]Task 4, Epoch 3/20 => Loss 1.704, Train_accy 62.98:  15%|█▌        | 3/20 [00:29<02:49,  9.99s/it]Task 4, Epoch 4/20 => Loss 1.485, Train_accy 65.86:  15%|█▌        | 3/20 [00:39<02:49,  9.99s/it]Task 4, Epoch 4/20 => Loss 1.485, Train_accy 65.86:  20%|██        | 4/20 [00:39<02:39, 10.00s/it]Task 4, Epoch 5/20 => Loss 1.372, Train_accy 68.43:  20%|██        | 4/20 [00:49<02:39, 10.00s/it]Task 4, Epoch 5/20 => Loss 1.372, Train_accy 68.43:  25%|██▌       | 5/20 [00:49<02:29,  9.98s/it]Task 4, Epoch 6/20 => Loss 1.440, Train_accy 67.02:  25%|██▌       | 5/20 [00:59<02:29,  9.98s/it]Task 4, Epoch 6/20 => Loss 1.440, Train_accy 67.02:  30%|███       | 6/20 [00:59<02:19,  9.99s/it]Task 4, Epoch 7/20 => Loss 1.183, Train_accy 70.84:  30%|███       | 6/20 [01:09<02:19,  9.99s/it]Task 4, Epoch 7/20 => Loss 1.183, Train_accy 70.84:  35%|███▌      | 7/20 [01:09<02:09,  9.99s/it]Task 4, Epoch 8/20 => Loss 1.150, Train_accy 72.04:  35%|███▌      | 7/20 [01:19<02:09,  9.99s/it]Task 4, Epoch 8/20 => Loss 1.150, Train_accy 72.04:  40%|████      | 8/20 [01:19<02:00, 10.00s/it]Task 4, Epoch 9/20 => Loss 1.109, Train_accy 72.77:  40%|████      | 8/20 [01:30<02:00, 10.00s/it]Task 4, Epoch 9/20 => Loss 1.109, Train_accy 72.77:  45%|████▌     | 9/20 [01:30<01:50, 10.03s/it]Task 4, Epoch 10/20 => Loss 1.051, Train_accy 73.72:  45%|████▌     | 9/20 [01:40<01:50, 10.03s/it]Task 4, Epoch 10/20 => Loss 1.051, Train_accy 73.72:  50%|█████     | 10/20 [01:40<01:40, 10.01s/it]Task 4, Epoch 11/20 => Loss 0.943, Train_accy 74.97:  50%|█████     | 10/20 [01:50<01:40, 10.01s/it]Task 4, Epoch 11/20 => Loss 0.943, Train_accy 74.97:  55%|█████▌    | 11/20 [01:50<01:30, 10.01s/it]Task 4, Epoch 12/20 => Loss 1.003, Train_accy 73.40:  55%|█████▌    | 11/20 [02:00<01:30, 10.01s/it]Task 4, Epoch 12/20 => Loss 1.003, Train_accy 73.40:  60%|██████    | 12/20 [02:00<01:20, 10.01s/it]Task 4, Epoch 13/20 => Loss 0.957, Train_accy 74.08:  60%|██████    | 12/20 [02:09<01:20, 10.01s/it]Task 4, Epoch 13/20 => Loss 0.957, Train_accy 74.08:  65%|██████▌   | 13/20 [02:09<01:09,  9.97s/it]Task 4, Epoch 14/20 => Loss 0.940, Train_accy 74.55:  65%|██████▌   | 13/20 [02:19<01:09,  9.97s/it]Task 4, Epoch 14/20 => Loss 0.940, Train_accy 74.55:  70%|███████   | 14/20 [02:19<00:59,  9.99s/it]Task 4, Epoch 15/20 => Loss 0.930, Train_accy 75.39:  70%|███████   | 14/20 [02:29<00:59,  9.99s/it]Task 4, Epoch 15/20 => Loss 0.930, Train_accy 75.39:  75%|███████▌  | 15/20 [02:29<00:49,  9.99s/it]Task 4, Epoch 16/20 => Loss 0.913, Train_accy 74.92:  75%|███████▌  | 15/20 [02:40<00:49,  9.99s/it]Task 4, Epoch 16/20 => Loss 0.913, Train_accy 74.92:  80%|████████  | 16/20 [02:40<00:40, 10.13s/it]Task 4, Epoch 17/20 => Loss 0.886, Train_accy 75.13:  80%|████████  | 16/20 [02:50<00:40, 10.13s/it]Task 4, Epoch 17/20 => Loss 0.886, Train_accy 75.13:  85%|████████▌ | 17/20 [02:50<00:30, 10.11s/it]Task 4, Epoch 18/20 => Loss 0.897, Train_accy 75.86:  85%|████████▌ | 17/20 [03:00<00:30, 10.11s/it]Task 4, Epoch 18/20 => Loss 0.897, Train_accy 75.86:  90%|█████████ | 18/20 [03:00<00:20, 10.12s/it]Task 4, Epoch 19/20 => Loss 0.950, Train_accy 73.61:  90%|█████████ | 18/20 [03:10<00:20, 10.12s/it]Task 4, Epoch 19/20 => Loss 0.950, Train_accy 73.61:  95%|█████████▌| 19/20 [03:10<00:10, 10.08s/it]Task 4, Epoch 20/20 => Loss 0.908, Train_accy 75.13:  95%|█████████▌| 19/20 [03:20<00:10, 10.08s/it]Task 4, Epoch 20/20 => Loss 0.908, Train_accy 75.13: 100%|██████████| 20/20 [03:20<00:00, 10.10s/it]Task 4, Epoch 20/20 => Loss 0.908, Train_accy 75.13: 100%|██████████| 20/20 [03:20<00:00, 10.04s/it]
2024-04-22 21:47:35,791 [loramoeinc.py] => Task 4, Epoch 20/20 => Loss 0.908, Train_accy 75.13
2024-04-22 21:48:33,886 [trainer.py] => No NME accuracy.
2024-04-22 21:48:33,887 [trainer.py] => CNN: {'total': 92.83, '00-39': 96.48, '40-79': 90.97, '80-119': 95.17, '120-159': 91.79, '160-199': 89.72, 'old': 93.6, 'new': 89.72}
2024-04-22 21:48:33,887 [trainer.py] => Route: {'total': 86.77, '00-39': 88.33, '40-79': 86.02, '80-119': 87.93, '120-159': 86.11, '160-199': 85.44, 'old': 87.1, 'new': 85.44}
2024-04-22 21:48:33,887 [trainer.py] => CNN top1 curve: [96.48, 94.12, 94.28, 93.6, 92.83]
2024-04-22 21:48:33,887 [trainer.py] => CNN top5 curve: [99.56, 98.91, 98.87, 98.63, 97.75]
2024-04-22 21:48:33,887 [trainer.py] => Route top1 curve: [97.8, 93.25, 90.18, 88.47, 86.77]
2024-04-22 21:48:33,887 [trainer.py] => Route top5 curve: [99.78, 99.02, 98.87, 98.68, 98.18]

Average Accuracy (CNN): 94.262
Average Accuracy (Route): 91.29400000000001
2024-04-22 21:48:33,887 [trainer.py] => Average Accuracy (CNN): 94.262
2024-04-22 21:48:33,887 [trainer.py] => Average Accuracy (Route): 91.29400000000001

2024-04-22 21:48:33,887 [trainer.py] => Train Time: 984.99
2024-04-22 21:48:33,887 [trainer.py] => Test Time: 0 

2024-04-22 21:48:37,633 [trainer.py] => config: ./exps/loramoe_inc_ina_B0_Inc5.json
2024-04-22 21:48:37,633 [trainer.py] => prefix: reproduce
2024-04-22 21:48:37,633 [trainer.py] => dataset: imageneta
2024-04-22 21:48:37,633 [trainer.py] => memory_size: 0
2024-04-22 21:48:37,633 [trainer.py] => memory_per_class: 0
2024-04-22 21:48:37,633 [trainer.py] => fixed_memory: False
2024-04-22 21:48:37,633 [trainer.py] => shuffle: True
2024-04-22 21:48:37,634 [trainer.py] => init_cls: 40
2024-04-22 21:48:37,634 [trainer.py] => increment: 40
2024-04-22 21:48:37,634 [trainer.py] => model_name: loramoeinc
2024-04-22 21:48:37,634 [trainer.py] => backbone_type: pretrained_vit_b16_224_inc
2024-04-22 21:48:37,634 [trainer.py] => device: [device(type='cuda', index=6)]
2024-04-22 21:48:37,634 [trainer.py] => seed: 1993
2024-04-22 21:48:37,634 [trainer.py] => tuned_epoch: 20
2024-04-22 21:48:37,634 [trainer.py] => init_lr: 0.01
2024-04-22 21:48:37,634 [trainer.py] => batch_size: 48
2024-04-22 21:48:37,634 [trainer.py] => weight_decay: 0.0005
2024-04-22 21:48:37,634 [trainer.py] => min_lr: 0
2024-04-22 21:48:37,634 [trainer.py] => ffn_num: 4
2024-04-22 21:48:37,634 [trainer.py] => optimizer: sgd
2024-04-22 21:48:37,634 [trainer.py] => vpt_type: shallow
2024-04-22 21:48:37,634 [trainer.py] => prompt_token_num: 5
2024-04-22 21:48:37,634 [trainer.py] => expert_num: 5
2024-04-22 21:48:37,675 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
/home/team/zhaohongwei/anaconda3/envs/peft/lib/python3.10/site-packages/bitsandbytes/cuda_setup/main.py:136: UserWarning: /home/team/zhaohongwei/anaconda3/envs/peft did not contain libcudart.so as expected! Searching further paths...
  warn(msg)

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please submit your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
CUDA SETUP: CUDA runtime path found: /usr/local/cuda-11.8/lib64/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 8.6
CUDA SETUP: Detected CUDA version 118
CUDA SETUP: Loading binary /home/team/zhaohongwei/anaconda3/envs/peft/lib/python3.10/site-packages/bitsandbytes/libbitsandbytes_cuda118.so...
I'm using ViT with adapters.
2024-04-22 21:48:53,216 [trainer.py] => All params: 86006136
2024-04-22 21:48:53,218 [trainer.py] => Trainable params: 207480
2024-04-22 21:48:53,364 [loramoeinc.py] => Learning on 0-40
  0%|          | 0/20 [00:00<?, ?it/s]Task 0, Epoch 1/20 => Loss 3.669, Train_accy 8.63:   0%|          | 0/20 [00:08<?, ?it/s]Task 0, Epoch 1/20 => Loss 3.669, Train_accy 8.63:   5%|▌         | 1/20 [00:08<02:36,  8.25s/it]Task 0, Epoch 2/20 => Loss 3.578, Train_accy 30.73:   5%|▌         | 1/20 [00:15<02:36,  8.25s/it]Task 0, Epoch 2/20 => Loss 3.578, Train_accy 30.73:  10%|█         | 2/20 [00:15<02:21,  7.89s/it]Task 0, Epoch 3/20 => Loss 3.381, Train_accy 33.45:  10%|█         | 2/20 [00:23<02:21,  7.89s/it]Task 0, Epoch 3/20 => Loss 3.381, Train_accy 33.45:  15%|█▌        | 3/20 [00:23<02:13,  7.84s/it]Task 0, Epoch 4/20 => Loss 3.007, Train_accy 40.38:  15%|█▌        | 3/20 [00:31<02:13,  7.84s/it]Task 0, Epoch 4/20 => Loss 3.007, Train_accy 40.38:  20%|██        | 4/20 [00:31<02:04,  7.80s/it]Task 0, Epoch 5/20 => Loss 2.489, Train_accy 52.01:  20%|██        | 4/20 [00:39<02:04,  7.80s/it]Task 0, Epoch 5/20 => Loss 2.489, Train_accy 52.01:  25%|██▌       | 5/20 [00:39<01:56,  7.79s/it]Task 0, Epoch 6/20 => Loss 2.072, Train_accy 58.19:  25%|██▌       | 5/20 [00:46<01:56,  7.79s/it]Task 0, Epoch 6/20 => Loss 2.072, Train_accy 58.19:  30%|███       | 6/20 [00:46<01:48,  7.75s/it]Task 0, Epoch 7/20 => Loss 1.759, Train_accy 62.41:  30%|███       | 6/20 [00:54<01:48,  7.75s/it]Task 0, Epoch 7/20 => Loss 1.759, Train_accy 62.41:  35%|███▌      | 7/20 [00:54<01:41,  7.79s/it]Task 0, Epoch 8/20 => Loss 1.433, Train_accy 69.34:  35%|███▌      | 7/20 [01:02<01:41,  7.79s/it]Task 0, Epoch 8/20 => Loss 1.433, Train_accy 69.34:  40%|████      | 8/20 [01:02<01:33,  7.80s/it]Task 0, Epoch 9/20 => Loss 1.289, Train_accy 70.09:  40%|████      | 8/20 [01:10<01:33,  7.80s/it]Task 0, Epoch 9/20 => Loss 1.289, Train_accy 70.09:  45%|████▌     | 9/20 [01:10<01:25,  7.80s/it]Task 0, Epoch 10/20 => Loss 1.174, Train_accy 71.52:  45%|████▌     | 9/20 [01:18<01:25,  7.80s/it]Task 0, Epoch 10/20 => Loss 1.174, Train_accy 71.52:  50%|█████     | 10/20 [01:18<01:17,  7.77s/it]Task 0, Epoch 11/20 => Loss 1.113, Train_accy 74.24:  50%|█████     | 10/20 [01:25<01:17,  7.77s/it]Task 0, Epoch 11/20 => Loss 1.113, Train_accy 74.24:  55%|█████▌    | 11/20 [01:25<01:09,  7.77s/it]Task 0, Epoch 12/20 => Loss 0.995, Train_accy 77.97:  55%|█████▌    | 11/20 [01:33<01:09,  7.77s/it]Task 0, Epoch 12/20 => Loss 0.995, Train_accy 77.97:  60%|██████    | 12/20 [01:33<01:02,  7.78s/it]Task 0, Epoch 13/20 => Loss 0.978, Train_accy 77.63:  60%|██████    | 12/20 [01:41<01:02,  7.78s/it]Task 0, Epoch 13/20 => Loss 0.978, Train_accy 77.63:  65%|██████▌   | 13/20 [01:41<00:54,  7.77s/it]Task 0, Epoch 14/20 => Loss 0.940, Train_accy 78.45:  65%|██████▌   | 13/20 [01:49<00:54,  7.77s/it]Task 0, Epoch 14/20 => Loss 0.940, Train_accy 78.45:  70%|███████   | 14/20 [01:49<00:46,  7.76s/it]Task 0, Epoch 15/20 => Loss 0.918, Train_accy 77.91:  70%|███████   | 14/20 [01:57<00:46,  7.76s/it]Task 0, Epoch 15/20 => Loss 0.918, Train_accy 77.91:  75%|███████▌  | 15/20 [01:57<00:39,  7.82s/it]Task 0, Epoch 16/20 => Loss 0.856, Train_accy 80.29:  75%|███████▌  | 15/20 [02:04<00:39,  7.82s/it]Task 0, Epoch 16/20 => Loss 0.856, Train_accy 80.29:  80%|████████  | 16/20 [02:04<00:31,  7.85s/it]Task 0, Epoch 17/20 => Loss 0.830, Train_accy 81.44:  80%|████████  | 16/20 [02:12<00:31,  7.85s/it]Task 0, Epoch 17/20 => Loss 0.830, Train_accy 81.44:  85%|████████▌ | 17/20 [02:12<00:23,  7.86s/it]Task 0, Epoch 18/20 => Loss 0.854, Train_accy 80.76:  85%|████████▌ | 17/20 [02:20<00:23,  7.86s/it]Task 0, Epoch 18/20 => Loss 0.854, Train_accy 80.76:  90%|█████████ | 18/20 [02:20<00:15,  7.86s/it]Task 0, Epoch 19/20 => Loss 0.840, Train_accy 80.08:  90%|█████████ | 18/20 [02:28<00:15,  7.86s/it]Task 0, Epoch 19/20 => Loss 0.840, Train_accy 80.08:  95%|█████████▌| 19/20 [02:28<00:07,  7.83s/it]Task 0, Epoch 20/20 => Loss 0.826, Train_accy 81.24:  95%|█████████▌| 19/20 [02:36<00:07,  7.83s/it]Task 0, Epoch 20/20 => Loss 0.826, Train_accy 81.24: 100%|██████████| 20/20 [02:36<00:00,  7.81s/it]Task 0, Epoch 20/20 => Loss 0.826, Train_accy 81.24: 100%|██████████| 20/20 [02:36<00:00,  7.81s/it]
2024-04-22 21:51:29,858 [loramoeinc.py] => Task 0, Epoch 20/20 => Loss 0.826, Train_accy 81.24
2024-04-22 21:52:11,781 [trainer.py] => No NME accuracy.
2024-04-22 21:52:11,782 [trainer.py] => CNN: {'total': 81.39, '00-39': 81.39, 'old': 0, 'new': 81.39}
2024-04-22 21:52:11,782 [trainer.py] => Route: {'total': 71.39, '00-39': 71.39, 'old': 0, 'new': 71.39}
2024-04-22 21:52:11,782 [trainer.py] => CNN top1 curve: [81.39]
2024-04-22 21:52:11,782 [trainer.py] => CNN top5 curve: [95.0]
2024-04-22 21:52:11,782 [trainer.py] => Route top1 curve: [71.39]
2024-04-22 21:52:11,782 [trainer.py] => Route top5 curve: [92.22]

Average Accuracy (CNN): 81.39
Average Accuracy (Route): 71.39
2024-04-22 21:52:11,782 [trainer.py] => Average Accuracy (CNN): 81.39
2024-04-22 21:52:11,782 [trainer.py] => Average Accuracy (Route): 71.39

2024-04-22 21:52:11,782 [trainer.py] => Train Time: 156.28
2024-04-22 21:52:11,782 [trainer.py] => Test Time: 0 

2024-04-22 21:52:11,784 [trainer.py] => All params: 86067578
2024-04-22 21:52:11,785 [trainer.py] => Trainable params: 196705
2024-04-22 21:52:11,788 [loramoeinc.py] => Learning on 40-80
  0%|          | 0/20 [00:00<?, ?it/s]Task 1, Epoch 1/20 => Loss 3.097, Train_accy 32.66:   0%|          | 0/20 [00:06<?, ?it/s]Task 1, Epoch 1/20 => Loss 3.097, Train_accy 32.66:   5%|▌         | 1/20 [00:06<02:12,  6.97s/it]Task 1, Epoch 2/20 => Loss 2.496, Train_accy 48.73:   5%|▌         | 1/20 [00:14<02:12,  6.97s/it]Task 1, Epoch 2/20 => Loss 2.496, Train_accy 48.73:  10%|█         | 2/20 [00:14<02:08,  7.15s/it]Task 1, Epoch 3/20 => Loss 2.205, Train_accy 53.98:  10%|█         | 2/20 [00:21<02:08,  7.15s/it]Task 1, Epoch 3/20 => Loss 2.205, Train_accy 53.98:  15%|█▌        | 3/20 [00:21<02:01,  7.18s/it]Task 1, Epoch 4/20 => Loss 2.075, Train_accy 54.90:  15%|█▌        | 3/20 [00:28<02:01,  7.18s/it]Task 1, Epoch 4/20 => Loss 2.075, Train_accy 54.90:  20%|██        | 4/20 [00:28<01:54,  7.14s/it]Task 1, Epoch 5/20 => Loss 1.871, Train_accy 60.54:  20%|██        | 4/20 [00:35<01:54,  7.14s/it]Task 1, Epoch 5/20 => Loss 1.871, Train_accy 60.54:  25%|██▌       | 5/20 [00:35<01:46,  7.12s/it]Task 1, Epoch 6/20 => Loss 1.745, Train_accy 62.01:  25%|██▌       | 5/20 [00:42<01:46,  7.12s/it]Task 1, Epoch 6/20 => Loss 1.745, Train_accy 62.01:  30%|███       | 6/20 [00:42<01:38,  7.05s/it]Task 1, Epoch 7/20 => Loss 1.690, Train_accy 62.78:  30%|███       | 6/20 [00:49<01:38,  7.05s/it]Task 1, Epoch 7/20 => Loss 1.690, Train_accy 62.78:  35%|███▌      | 7/20 [00:49<01:31,  7.06s/it]Task 1, Epoch 8/20 => Loss 1.596, Train_accy 64.02:  35%|███▌      | 7/20 [00:56<01:31,  7.06s/it]Task 1, Epoch 8/20 => Loss 1.596, Train_accy 64.02:  40%|████      | 8/20 [00:56<01:24,  7.02s/it]Task 1, Epoch 9/20 => Loss 1.488, Train_accy 66.10:  40%|████      | 8/20 [01:03<01:24,  7.02s/it]Task 1, Epoch 9/20 => Loss 1.488, Train_accy 66.10:  45%|████▌     | 9/20 [01:03<01:17,  7.01s/it]Task 1, Epoch 10/20 => Loss 1.490, Train_accy 65.41:  45%|████▌     | 9/20 [01:10<01:17,  7.01s/it]Task 1, Epoch 10/20 => Loss 1.490, Train_accy 65.41:  50%|█████     | 10/20 [01:10<01:10,  7.04s/it]Task 1, Epoch 11/20 => Loss 1.413, Train_accy 68.19:  50%|█████     | 10/20 [01:17<01:10,  7.04s/it]Task 1, Epoch 11/20 => Loss 1.413, Train_accy 68.19:  55%|█████▌    | 11/20 [01:17<01:03,  7.03s/it]Task 1, Epoch 12/20 => Loss 1.371, Train_accy 67.03:  55%|█████▌    | 11/20 [01:24<01:03,  7.03s/it]Task 1, Epoch 12/20 => Loss 1.371, Train_accy 67.03:  60%|██████    | 12/20 [01:24<00:56,  7.00s/it]Task 1, Epoch 13/20 => Loss 1.317, Train_accy 69.65:  60%|██████    | 12/20 [01:31<00:56,  7.00s/it]Task 1, Epoch 13/20 => Loss 1.317, Train_accy 69.65:  65%|██████▌   | 13/20 [01:31<00:48,  6.98s/it]Task 1, Epoch 14/20 => Loss 1.299, Train_accy 69.65:  65%|██████▌   | 13/20 [01:38<00:48,  6.98s/it]Task 1, Epoch 14/20 => Loss 1.299, Train_accy 69.65:  70%|███████   | 14/20 [01:38<00:42,  7.02s/it]Task 1, Epoch 15/20 => Loss 1.197, Train_accy 71.35:  70%|███████   | 14/20 [01:45<00:42,  7.02s/it]Task 1, Epoch 15/20 => Loss 1.197, Train_accy 71.35:  75%|███████▌  | 15/20 [01:45<00:35,  7.01s/it]Task 1, Epoch 16/20 => Loss 1.220, Train_accy 71.20:  75%|███████▌  | 15/20 [01:52<00:35,  7.01s/it]Task 1, Epoch 16/20 => Loss 1.220, Train_accy 71.20:  80%|████████  | 16/20 [01:52<00:27,  7.00s/it]Task 1, Epoch 17/20 => Loss 1.170, Train_accy 72.43:  80%|████████  | 16/20 [01:59<00:27,  7.00s/it]Task 1, Epoch 17/20 => Loss 1.170, Train_accy 72.43:  85%|████████▌ | 17/20 [01:59<00:20,  7.00s/it]Task 1, Epoch 18/20 => Loss 1.186, Train_accy 71.27:  85%|████████▌ | 17/20 [02:06<00:20,  7.00s/it]Task 1, Epoch 18/20 => Loss 1.186, Train_accy 71.27:  90%|█████████ | 18/20 [02:06<00:14,  7.04s/it]Task 1, Epoch 19/20 => Loss 1.181, Train_accy 71.66:  90%|█████████ | 18/20 [02:13<00:14,  7.04s/it]Task 1, Epoch 19/20 => Loss 1.181, Train_accy 71.66:  95%|█████████▌| 19/20 [02:13<00:07,  7.03s/it]Task 1, Epoch 20/20 => Loss 1.166, Train_accy 72.36:  95%|█████████▌| 19/20 [02:20<00:07,  7.03s/it]Task 1, Epoch 20/20 => Loss 1.166, Train_accy 72.36: 100%|██████████| 20/20 [02:20<00:00,  7.07s/it]Task 1, Epoch 20/20 => Loss 1.166, Train_accy 72.36: 100%|██████████| 20/20 [02:20<00:00,  7.04s/it]
2024-04-22 21:54:32,700 [loramoeinc.py] => Task 1, Epoch 20/20 => Loss 1.166, Train_accy 72.36
2024-04-22 21:55:15,444 [trainer.py] => No NME accuracy.
2024-04-22 21:55:15,445 [trainer.py] => CNN: {'total': 77.51, '00-39': 81.11, '40-79': 73.67, 'old': 81.11, 'new': 73.67}
2024-04-22 21:55:15,445 [trainer.py] => Route: {'total': 62.75, '00-39': 60.83, '40-79': 64.79, 'old': 60.83, 'new': 64.79}
2024-04-22 21:55:15,445 [trainer.py] => CNN top1 curve: [81.39, 77.51]
2024-04-22 21:55:15,445 [trainer.py] => CNN top5 curve: [95.0, 91.55]
2024-04-22 21:55:15,445 [trainer.py] => Route top1 curve: [71.39, 62.75]
2024-04-22 21:55:15,445 [trainer.py] => Route top5 curve: [92.22, 88.4]

Average Accuracy (CNN): 79.45
Average Accuracy (Route): 67.07
2024-04-22 21:55:15,445 [trainer.py] => Average Accuracy (CNN): 79.45
2024-04-22 21:55:15,445 [trainer.py] => Average Accuracy (Route): 67.07

2024-04-22 21:55:15,445 [trainer.py] => Train Time: 297.18
2024-04-22 21:55:15,445 [trainer.py] => Test Time: 0 

2024-04-22 21:55:15,446 [trainer.py] => All params: 86129018
2024-04-22 21:55:15,448 [trainer.py] => Trainable params: 185929
2024-04-22 21:55:15,452 [loramoeinc.py] => Learning on 80-120
  0%|          | 0/20 [00:00<?, ?it/s]Task 2, Epoch 1/20 => Loss 3.913, Train_accy 23.21:   0%|          | 0/20 [00:05<?, ?it/s]Task 2, Epoch 1/20 => Loss 3.913, Train_accy 23.21:   5%|▌         | 1/20 [00:05<01:53,  5.95s/it]Task 2, Epoch 2/20 => Loss 3.192, Train_accy 37.82:   5%|▌         | 1/20 [00:11<01:53,  5.95s/it]Task 2, Epoch 2/20 => Loss 3.192, Train_accy 37.82:  10%|█         | 2/20 [00:11<01:46,  5.90s/it]Task 2, Epoch 3/20 => Loss 2.687, Train_accy 46.42:  10%|█         | 2/20 [00:17<01:46,  5.90s/it]Task 2, Epoch 3/20 => Loss 2.687, Train_accy 46.42:  15%|█▌        | 3/20 [00:17<01:40,  5.89s/it]Task 2, Epoch 4/20 => Loss 2.402, Train_accy 49.57:  15%|█▌        | 3/20 [00:23<01:40,  5.89s/it]Task 2, Epoch 4/20 => Loss 2.402, Train_accy 49.57:  20%|██        | 4/20 [00:23<01:33,  5.86s/it]Task 2, Epoch 5/20 => Loss 2.077, Train_accy 54.63:  20%|██        | 4/20 [00:29<01:33,  5.86s/it]Task 2, Epoch 5/20 => Loss 2.077, Train_accy 54.63:  25%|██▌       | 5/20 [00:29<01:28,  5.89s/it]Task 2, Epoch 6/20 => Loss 1.960, Train_accy 56.45:  25%|██▌       | 5/20 [00:35<01:28,  5.89s/it]Task 2, Epoch 6/20 => Loss 1.960, Train_accy 56.45:  30%|███       | 6/20 [00:35<01:22,  5.87s/it]Task 2, Epoch 7/20 => Loss 1.850, Train_accy 58.45:  30%|███       | 6/20 [00:41<01:22,  5.87s/it]Task 2, Epoch 7/20 => Loss 1.850, Train_accy 58.45:  35%|███▌      | 7/20 [00:41<01:16,  5.87s/it]Task 2, Epoch 8/20 => Loss 1.830, Train_accy 58.17:  35%|███▌      | 7/20 [00:47<01:16,  5.87s/it]Task 2, Epoch 8/20 => Loss 1.830, Train_accy 58.17:  40%|████      | 8/20 [00:47<01:10,  5.87s/it]Task 2, Epoch 9/20 => Loss 1.705, Train_accy 59.31:  40%|████      | 8/20 [00:52<01:10,  5.87s/it]Task 2, Epoch 9/20 => Loss 1.705, Train_accy 59.31:  45%|████▌     | 9/20 [00:52<01:04,  5.88s/it]Task 2, Epoch 10/20 => Loss 1.590, Train_accy 61.99:  45%|████▌     | 9/20 [00:58<01:04,  5.88s/it]Task 2, Epoch 10/20 => Loss 1.590, Train_accy 61.99:  50%|█████     | 10/20 [00:58<00:58,  5.87s/it]Task 2, Epoch 11/20 => Loss 1.557, Train_accy 62.85:  50%|█████     | 10/20 [01:04<00:58,  5.87s/it]Task 2, Epoch 11/20 => Loss 1.557, Train_accy 62.85:  55%|█████▌    | 11/20 [01:04<00:53,  5.89s/it]Task 2, Epoch 12/20 => Loss 1.484, Train_accy 63.42:  55%|█████▌    | 11/20 [01:10<00:53,  5.89s/it]Task 2, Epoch 12/20 => Loss 1.484, Train_accy 63.42:  60%|██████    | 12/20 [01:10<00:47,  5.90s/it]Task 2, Epoch 13/20 => Loss 1.464, Train_accy 64.57:  60%|██████    | 12/20 [01:16<00:47,  5.90s/it]Task 2, Epoch 13/20 => Loss 1.464, Train_accy 64.57:  65%|██████▌   | 13/20 [01:16<00:41,  5.91s/it]Task 2, Epoch 14/20 => Loss 1.431, Train_accy 64.28:  65%|██████▌   | 13/20 [01:22<00:41,  5.91s/it]Task 2, Epoch 14/20 => Loss 1.431, Train_accy 64.28:  70%|███████   | 14/20 [01:22<00:35,  5.89s/it]Task 2, Epoch 15/20 => Loss 1.322, Train_accy 66.48:  70%|███████   | 14/20 [01:28<00:35,  5.89s/it]Task 2, Epoch 15/20 => Loss 1.322, Train_accy 66.48:  75%|███████▌  | 15/20 [01:28<00:29,  5.93s/it]Task 2, Epoch 16/20 => Loss 1.279, Train_accy 68.10:  75%|███████▌  | 15/20 [01:34<00:29,  5.93s/it]Task 2, Epoch 16/20 => Loss 1.279, Train_accy 68.10:  80%|████████  | 16/20 [01:34<00:23,  5.91s/it]Task 2, Epoch 17/20 => Loss 1.272, Train_accy 67.81:  80%|████████  | 16/20 [01:40<00:23,  5.91s/it]Task 2, Epoch 17/20 => Loss 1.272, Train_accy 67.81:  85%|████████▌ | 17/20 [01:40<00:17,  5.93s/it]Task 2, Epoch 18/20 => Loss 1.317, Train_accy 66.28:  85%|████████▌ | 17/20 [01:46<00:17,  5.93s/it]Task 2, Epoch 18/20 => Loss 1.317, Train_accy 66.28:  90%|█████████ | 18/20 [01:46<00:11,  5.94s/it]Task 2, Epoch 19/20 => Loss 1.294, Train_accy 66.38:  90%|█████████ | 18/20 [01:52<00:11,  5.94s/it]Task 2, Epoch 19/20 => Loss 1.294, Train_accy 66.38:  95%|█████████▌| 19/20 [01:52<00:05,  5.94s/it]Task 2, Epoch 20/20 => Loss 1.260, Train_accy 66.67:  95%|█████████▌| 19/20 [01:58<00:05,  5.94s/it]Task 2, Epoch 20/20 => Loss 1.260, Train_accy 66.67: 100%|██████████| 20/20 [01:58<00:00,  5.93s/it]Task 2, Epoch 20/20 => Loss 1.260, Train_accy 66.67: 100%|██████████| 20/20 [01:58<00:00,  5.90s/it]
2024-04-22 21:57:13,564 [loramoeinc.py] => Task 2, Epoch 20/20 => Loss 1.260, Train_accy 66.67
2024-04-22 21:57:53,882 [trainer.py] => No NME accuracy.
2024-04-22 21:57:53,882 [trainer.py] => CNN: {'total': 74.77, '00-39': 81.11, '40-79': 73.67, '80-119': 67.87, 'old': 77.51, 'new': 67.87}
2024-04-22 21:57:53,882 [trainer.py] => Route: {'total': 56.92, '00-39': 53.06, '40-79': 58.88, '80-119': 59.57, 'old': 55.87, 'new': 59.57}
2024-04-22 21:57:53,882 [trainer.py] => CNN top1 curve: [81.39, 77.51, 74.77]
2024-04-22 21:57:53,882 [trainer.py] => CNN top5 curve: [95.0, 91.55, 89.13]
2024-04-22 21:57:53,882 [trainer.py] => Route top1 curve: [71.39, 62.75, 56.92]
2024-04-22 21:57:53,883 [trainer.py] => Route top5 curve: [92.22, 88.4, 84.41]

Average Accuracy (CNN): 77.89
Average Accuracy (Route): 63.68666666666667
2024-04-22 21:57:53,883 [trainer.py] => Average Accuracy (CNN): 77.89
2024-04-22 21:57:53,883 [trainer.py] => Average Accuracy (Route): 63.68666666666667

2024-04-22 21:57:53,883 [trainer.py] => Train Time: 415.28
2024-04-22 21:57:53,883 [trainer.py] => Test Time: 0 

2024-04-22 21:57:53,884 [trainer.py] => All params: 86190458
2024-04-22 21:57:53,885 [trainer.py] => Trainable params: 175153
2024-04-22 21:57:53,890 [loramoeinc.py] => Learning on 120-160
  0%|          | 0/20 [00:00<?, ?it/s]Task 3, Epoch 1/20 => Loss 4.404, Train_accy 14.39:   0%|          | 0/20 [00:05<?, ?it/s]Task 3, Epoch 1/20 => Loss 4.404, Train_accy 14.39:   5%|▌         | 1/20 [00:05<01:52,  5.91s/it]Task 3, Epoch 2/20 => Loss 3.595, Train_accy 27.76:   5%|▌         | 1/20 [00:11<01:52,  5.91s/it]Task 3, Epoch 2/20 => Loss 3.595, Train_accy 27.76:  10%|█         | 2/20 [00:11<01:47,  5.95s/it]Task 3, Epoch 3/20 => Loss 3.121, Train_accy 36.82:  10%|█         | 2/20 [00:17<01:47,  5.95s/it]Task 3, Epoch 3/20 => Loss 3.121, Train_accy 36.82:  15%|█▌        | 3/20 [00:17<01:41,  5.99s/it]Task 3, Epoch 4/20 => Loss 2.769, Train_accy 43.55:  15%|█▌        | 3/20 [00:23<01:41,  5.99s/it]Task 3, Epoch 4/20 => Loss 2.769, Train_accy 43.55:  20%|██        | 4/20 [00:23<01:35,  5.95s/it]Task 3, Epoch 5/20 => Loss 2.560, Train_accy 46.64:  20%|██        | 4/20 [00:29<01:35,  5.95s/it]Task 3, Epoch 5/20 => Loss 2.560, Train_accy 46.64:  25%|██▌       | 5/20 [00:29<01:29,  5.97s/it]Task 3, Epoch 6/20 => Loss 2.406, Train_accy 47.66:  25%|██▌       | 5/20 [00:35<01:29,  5.97s/it]Task 3, Epoch 6/20 => Loss 2.406, Train_accy 47.66:  30%|███       | 6/20 [00:35<01:23,  5.99s/it]Task 3, Epoch 7/20 => Loss 2.253, Train_accy 48.69:  30%|███       | 6/20 [00:41<01:23,  5.99s/it]Task 3, Epoch 7/20 => Loss 2.253, Train_accy 48.69:  35%|███▌      | 7/20 [00:41<01:17,  5.98s/it]Task 3, Epoch 8/20 => Loss 2.084, Train_accy 52.99:  35%|███▌      | 7/20 [00:47<01:17,  5.98s/it]Task 3, Epoch 8/20 => Loss 2.084, Train_accy 52.99:  40%|████      | 8/20 [00:47<01:12,  6.00s/it]Task 3, Epoch 9/20 => Loss 2.097, Train_accy 53.46:  40%|████      | 8/20 [00:53<01:12,  6.00s/it]Task 3, Epoch 9/20 => Loss 2.097, Train_accy 53.46:  45%|████▌     | 9/20 [00:53<01:05,  5.99s/it]Task 3, Epoch 10/20 => Loss 1.951, Train_accy 55.89:  45%|████▌     | 9/20 [00:59<01:05,  5.99s/it]Task 3, Epoch 10/20 => Loss 1.951, Train_accy 55.89:  50%|█████     | 10/20 [00:59<00:59,  5.99s/it]Task 3, Epoch 11/20 => Loss 1.887, Train_accy 56.36:  50%|█████     | 10/20 [01:05<00:59,  5.99s/it]Task 3, Epoch 11/20 => Loss 1.887, Train_accy 56.36:  55%|█████▌    | 11/20 [01:05<00:53,  5.99s/it]Task 3, Epoch 12/20 => Loss 1.808, Train_accy 58.69:  55%|█████▌    | 11/20 [01:11<00:53,  5.99s/it]Task 3, Epoch 12/20 => Loss 1.808, Train_accy 58.69:  60%|██████    | 12/20 [01:11<00:47,  6.00s/it]Task 3, Epoch 13/20 => Loss 1.727, Train_accy 57.94:  60%|██████    | 12/20 [01:17<00:47,  6.00s/it]Task 3, Epoch 13/20 => Loss 1.727, Train_accy 57.94:  65%|██████▌   | 13/20 [01:17<00:42,  6.00s/it]Task 3, Epoch 14/20 => Loss 1.673, Train_accy 59.72:  65%|██████▌   | 13/20 [01:23<00:42,  6.00s/it]Task 3, Epoch 14/20 => Loss 1.673, Train_accy 59.72:  70%|███████   | 14/20 [01:23<00:35,  6.00s/it]Task 3, Epoch 15/20 => Loss 1.672, Train_accy 59.25:  70%|███████   | 14/20 [01:29<00:35,  6.00s/it]Task 3, Epoch 15/20 => Loss 1.672, Train_accy 59.25:  75%|███████▌  | 15/20 [01:29<00:29,  5.98s/it]Task 3, Epoch 16/20 => Loss 1.650, Train_accy 60.19:  75%|███████▌  | 15/20 [01:35<00:29,  5.98s/it]Task 3, Epoch 16/20 => Loss 1.650, Train_accy 60.19:  80%|████████  | 16/20 [01:35<00:24,  6.01s/it]Task 3, Epoch 17/20 => Loss 1.581, Train_accy 60.65:  80%|████████  | 16/20 [01:41<00:24,  6.01s/it]Task 3, Epoch 17/20 => Loss 1.581, Train_accy 60.65:  85%|████████▌ | 17/20 [01:41<00:17,  5.99s/it]Task 3, Epoch 18/20 => Loss 1.556, Train_accy 62.71:  85%|████████▌ | 17/20 [01:47<00:17,  5.99s/it]Task 3, Epoch 18/20 => Loss 1.556, Train_accy 62.71:  90%|█████████ | 18/20 [01:47<00:11,  5.96s/it]Task 3, Epoch 19/20 => Loss 1.509, Train_accy 63.64:  90%|█████████ | 18/20 [01:53<00:11,  5.96s/it]Task 3, Epoch 19/20 => Loss 1.509, Train_accy 63.64:  95%|█████████▌| 19/20 [01:53<00:05,  5.96s/it]Task 3, Epoch 20/20 => Loss 1.539, Train_accy 62.06:  95%|█████████▌| 19/20 [01:59<00:05,  5.96s/it]Task 3, Epoch 20/20 => Loss 1.539, Train_accy 62.06: 100%|██████████| 20/20 [01:59<00:00,  5.96s/it]Task 3, Epoch 20/20 => Loss 1.539, Train_accy 62.06: 100%|██████████| 20/20 [01:59<00:00,  5.98s/it]
2024-04-22 21:59:53,503 [loramoeinc.py] => Task 3, Epoch 20/20 => Loss 1.539, Train_accy 62.06
2024-04-22 22:00:33,307 [trainer.py] => No NME accuracy.
2024-04-22 22:00:33,308 [trainer.py] => CNN: {'total': 70.27, '00-39': 81.11, '40-79': 73.67, '80-119': 67.87, '120-159': 54.21, 'old': 74.77, 'new': 54.21}
2024-04-22 22:00:33,308 [trainer.py] => Route: {'total': 52.0, '00-39': 50.28, '40-79': 53.55, '80-119': 57.76, '120-159': 46.52, 'old': 53.54, 'new': 46.52}
2024-04-22 22:00:33,308 [trainer.py] => CNN top1 curve: [81.39, 77.51, 74.77, 70.27]
2024-04-22 22:00:33,308 [trainer.py] => CNN top5 curve: [95.0, 91.55, 89.13, 85.58]
2024-04-22 22:00:33,308 [trainer.py] => Route top1 curve: [71.39, 62.75, 56.92, 52.0]
2024-04-22 22:00:33,308 [trainer.py] => Route top5 curve: [92.22, 88.4, 84.41, 80.13]

Average Accuracy (CNN): 75.985
Average Accuracy (Route): 60.765
2024-04-22 22:00:33,308 [trainer.py] => Average Accuracy (CNN): 75.985
2024-04-22 22:00:33,308 [trainer.py] => Average Accuracy (Route): 60.765

2024-04-22 22:00:33,308 [trainer.py] => Train Time: 534.88
2024-04-22 22:00:33,308 [trainer.py] => Test Time: 0 

2024-04-22 22:00:33,309 [trainer.py] => All params: 86251898
2024-04-22 22:00:33,310 [trainer.py] => Trainable params: 164377
2024-04-22 22:00:33,316 [loramoeinc.py] => Learning on 160-200
  0%|          | 0/20 [00:00<?, ?it/s]Task 4, Epoch 1/20 => Loss 4.593, Train_accy 13.30:   0%|          | 0/20 [00:06<?, ?it/s]Task 4, Epoch 1/20 => Loss 4.593, Train_accy 13.30:   5%|▌         | 1/20 [00:06<01:54,  6.04s/it]Task 4, Epoch 2/20 => Loss 3.701, Train_accy 29.14:   5%|▌         | 1/20 [00:12<01:54,  6.04s/it]Task 4, Epoch 2/20 => Loss 3.701, Train_accy 29.14:  10%|█         | 2/20 [00:12<01:48,  6.04s/it]Task 4, Epoch 3/20 => Loss 3.268, Train_accy 37.89:  10%|█         | 2/20 [00:18<01:48,  6.04s/it]Task 4, Epoch 3/20 => Loss 3.268, Train_accy 37.89:  15%|█▌        | 3/20 [00:18<01:42,  6.06s/it]Task 4, Epoch 4/20 => Loss 2.875, Train_accy 46.17:  15%|█▌        | 3/20 [00:24<01:42,  6.06s/it]Task 4, Epoch 4/20 => Loss 2.875, Train_accy 46.17:  20%|██        | 4/20 [00:24<01:36,  6.06s/it]Task 4, Epoch 5/20 => Loss 2.800, Train_accy 47.09:  20%|██        | 4/20 [00:30<01:36,  6.06s/it]Task 4, Epoch 5/20 => Loss 2.800, Train_accy 47.09:  25%|██▌       | 5/20 [00:30<01:30,  6.05s/it]Task 4, Epoch 6/20 => Loss 2.638, Train_accy 48.00:  25%|██▌       | 5/20 [00:36<01:30,  6.05s/it]Task 4, Epoch 6/20 => Loss 2.638, Train_accy 48.00:  30%|███       | 6/20 [00:36<01:24,  6.06s/it]Task 4, Epoch 7/20 => Loss 2.484, Train_accy 49.45:  30%|███       | 6/20 [00:42<01:24,  6.06s/it]Task 4, Epoch 7/20 => Loss 2.484, Train_accy 49.45:  35%|███▌      | 7/20 [00:42<01:19,  6.10s/it]Task 4, Epoch 8/20 => Loss 2.374, Train_accy 51.37:  35%|███▌      | 7/20 [00:48<01:19,  6.10s/it]Task 4, Epoch 8/20 => Loss 2.374, Train_accy 51.37:  40%|████      | 8/20 [00:48<01:13,  6.09s/it]Task 4, Epoch 9/20 => Loss 2.192, Train_accy 55.46:  40%|████      | 8/20 [00:54<01:13,  6.09s/it]Task 4, Epoch 9/20 => Loss 2.192, Train_accy 55.46:  45%|████▌     | 9/20 [00:54<01:06,  6.08s/it]Task 4, Epoch 10/20 => Loss 2.155, Train_accy 57.01:  45%|████▌     | 9/20 [01:00<01:06,  6.08s/it]Task 4, Epoch 10/20 => Loss 2.155, Train_accy 57.01:  50%|█████     | 10/20 [01:00<01:01,  6.10s/it]Task 4, Epoch 11/20 => Loss 2.159, Train_accy 53.73:  50%|█████     | 10/20 [01:06<01:01,  6.10s/it]Task 4, Epoch 11/20 => Loss 2.159, Train_accy 53.73:  55%|█████▌    | 11/20 [01:06<00:54,  6.07s/it]Task 4, Epoch 12/20 => Loss 2.029, Train_accy 58.29:  55%|█████▌    | 11/20 [01:12<00:54,  6.07s/it]Task 4, Epoch 12/20 => Loss 2.029, Train_accy 58.29:  60%|██████    | 12/20 [01:12<00:48,  6.11s/it]Task 4, Epoch 13/20 => Loss 1.925, Train_accy 58.56:  60%|██████    | 12/20 [01:19<00:48,  6.11s/it]Task 4, Epoch 13/20 => Loss 1.925, Train_accy 58.56:  65%|██████▌   | 13/20 [01:19<00:42,  6.10s/it]Task 4, Epoch 14/20 => Loss 1.868, Train_accy 60.56:  65%|██████▌   | 13/20 [01:25<00:42,  6.10s/it]Task 4, Epoch 14/20 => Loss 1.868, Train_accy 60.56:  70%|███████   | 14/20 [01:25<00:36,  6.15s/it]Task 4, Epoch 15/20 => Loss 1.881, Train_accy 60.11:  70%|███████   | 14/20 [01:31<00:36,  6.15s/it]Task 4, Epoch 15/20 => Loss 1.881, Train_accy 60.11:  75%|███████▌  | 15/20 [01:31<00:30,  6.13s/it]Task 4, Epoch 16/20 => Loss 1.787, Train_accy 60.38:  75%|███████▌  | 15/20 [01:37<00:30,  6.13s/it]Task 4, Epoch 16/20 => Loss 1.787, Train_accy 60.38:  80%|████████  | 16/20 [01:37<00:24,  6.09s/it]Task 4, Epoch 17/20 => Loss 1.766, Train_accy 61.93:  80%|████████  | 16/20 [01:43<00:24,  6.09s/it]Task 4, Epoch 17/20 => Loss 1.766, Train_accy 61.93:  85%|████████▌ | 17/20 [01:43<00:18,  6.08s/it]Task 4, Epoch 18/20 => Loss 1.662, Train_accy 63.57:  85%|████████▌ | 17/20 [01:49<00:18,  6.08s/it]Task 4, Epoch 18/20 => Loss 1.662, Train_accy 63.57:  90%|█████████ | 18/20 [01:49<00:12,  6.08s/it]Task 4, Epoch 19/20 => Loss 1.704, Train_accy 63.75:  90%|█████████ | 18/20 [01:55<00:12,  6.08s/it]Task 4, Epoch 19/20 => Loss 1.704, Train_accy 63.75:  95%|█████████▌| 19/20 [01:55<00:06,  6.10s/it]Task 4, Epoch 20/20 => Loss 1.678, Train_accy 62.93:  95%|█████████▌| 19/20 [02:01<00:06,  6.10s/it]Task 4, Epoch 20/20 => Loss 1.678, Train_accy 62.93: 100%|██████████| 20/20 [02:01<00:00,  6.09s/it]Task 4, Epoch 20/20 => Loss 1.678, Train_accy 62.93: 100%|██████████| 20/20 [02:01<00:00,  6.09s/it]
2024-04-22 22:02:35,085 [loramoeinc.py] => Task 4, Epoch 20/20 => Loss 1.678, Train_accy 62.93
2024-04-22 22:03:16,282 [trainer.py] => No NME accuracy.
2024-04-22 22:03:16,283 [trainer.py] => CNN: {'total': 68.8, '00-39': 81.11, '40-79': 73.67, '80-119': 67.87, '120-159': 54.21, '160-199': 61.99, 'old': 70.27, 'new': 61.99}
2024-04-22 22:03:16,283 [trainer.py] => Route: {'total': 48.45, '00-39': 47.78, '40-79': 51.78, '80-119': 55.23, '120-159': 43.96, '160-199': 42.8, 'old': 49.68, 'new': 42.8}
2024-04-22 22:03:16,283 [trainer.py] => CNN top1 curve: [81.39, 77.51, 74.77, 70.27, 68.8]
2024-04-22 22:03:16,283 [trainer.py] => CNN top5 curve: [95.0, 91.55, 89.13, 85.58, 85.19]
2024-04-22 22:03:16,283 [trainer.py] => Route top1 curve: [71.39, 62.75, 56.92, 52.0, 48.45]
2024-04-22 22:03:16,283 [trainer.py] => Route top5 curve: [92.22, 88.4, 84.41, 80.13, 75.64]

Average Accuracy (CNN): 74.548
Average Accuracy (Route): 58.302
2024-04-22 22:03:16,283 [trainer.py] => Average Accuracy (CNN): 74.548
2024-04-22 22:03:16,283 [trainer.py] => Average Accuracy (Route): 58.302

2024-04-22 22:03:16,283 [trainer.py] => Train Time: 656.64
2024-04-22 22:03:16,283 [trainer.py] => Test Time: 0 

2024-04-22 22:03:20,229 [trainer.py] => config: ./exps/loramoe_inc_vtab_B0_Inc5.json
2024-04-22 22:03:20,229 [trainer.py] => prefix: reproduce
2024-04-22 22:03:20,229 [trainer.py] => dataset: vtab
2024-04-22 22:03:20,229 [trainer.py] => memory_size: 0
2024-04-22 22:03:20,229 [trainer.py] => memory_per_class: 0
2024-04-22 22:03:20,229 [trainer.py] => fixed_memory: False
2024-04-22 22:03:20,229 [trainer.py] => shuffle: True
2024-04-22 22:03:20,230 [trainer.py] => init_cls: 10
2024-04-22 22:03:20,230 [trainer.py] => increment: 10
2024-04-22 22:03:20,230 [trainer.py] => model_name: loramoeinc
2024-04-22 22:03:20,230 [trainer.py] => backbone_type: pretrained_vit_b16_224_inc
2024-04-22 22:03:20,230 [trainer.py] => device: [device(type='cuda', index=6)]
2024-04-22 22:03:20,230 [trainer.py] => seed: 1993
2024-04-22 22:03:20,230 [trainer.py] => tuned_epoch: 20
2024-04-22 22:03:20,230 [trainer.py] => init_lr: 0.01
2024-04-22 22:03:20,230 [trainer.py] => batch_size: 48
2024-04-22 22:03:20,230 [trainer.py] => weight_decay: 0.0005
2024-04-22 22:03:20,230 [trainer.py] => min_lr: 0
2024-04-22 22:03:20,230 [trainer.py] => ffn_num: 4
2024-04-22 22:03:20,230 [trainer.py] => optimizer: sgd
2024-04-22 22:03:20,230 [trainer.py] => vpt_type: shallow
2024-04-22 22:03:20,230 [trainer.py] => prompt_token_num: 5
2024-04-22 22:03:20,230 [trainer.py] => expert_num: 5
{'10': 0, '11': 1, '12': 2, '13': 3, '14': 4, '15': 5, '16': 6, '17': 7, '18': 8, '19': 9, '20': 10, '21': 11, '22': 12, '23': 13, '24': 14, '25': 15, '26': 16, '27': 17, '28': 18, '29': 19, '30': 20, '31': 21, '32': 22, '33': 23, '34': 24, '35': 25, '36': 26, '37': 27, '38': 28, '39': 29, '40': 30, '41': 31, '42': 32, '43': 33, '44': 34, '45': 35, '46': 36, '47': 37, '48': 38, '49': 39, '50': 40, '51': 41, '52': 42, '53': 43, '54': 44, '55': 45, '56': 46, '57': 47, '58': 48, '59': 49}
{'10': 0, '11': 1, '12': 2, '13': 3, '14': 4, '15': 5, '16': 6, '17': 7, '18': 8, '19': 9, '20': 10, '21': 11, '22': 12, '23': 13, '24': 14, '25': 15, '26': 16, '27': 17, '28': 18, '29': 19, '30': 20, '31': 21, '32': 22, '33': 23, '34': 24, '35': 25, '36': 26, '37': 27, '38': 28, '39': 29, '40': 30, '41': 31, '42': 32, '43': 33, '44': 34, '45': 35, '46': 36, '47': 37, '48': 38, '49': 39, '50': 40, '51': 41, '52': 42, '53': 43, '54': 44, '55': 45, '56': 46, '57': 47, '58': 48, '59': 49}
2024-04-22 22:03:20,274 [data_manager.py] => [43, 41, 23, 14, 13, 40, 42, 22, 16, 45, 17, 10, 27, 46, 35, 8, 2, 34, 1, 37, 21, 0, 18, 36, 38, 24, 12, 6, 15, 20, 25, 48, 30, 19, 44, 26, 7, 28, 11, 5, 32, 4, 9, 47, 39, 31, 3, 29, 49, 33]
/home/team/zhaohongwei/anaconda3/envs/peft/lib/python3.10/site-packages/bitsandbytes/cuda_setup/main.py:136: UserWarning: /home/team/zhaohongwei/anaconda3/envs/peft did not contain libcudart.so as expected! Searching further paths...
  warn(msg)

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please submit your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
CUDA SETUP: CUDA runtime path found: /usr/local/cuda-11.8/lib64/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 8.6
CUDA SETUP: Detected CUDA version 118
CUDA SETUP: Loading binary /home/team/zhaohongwei/anaconda3/envs/peft/lib/python3.10/site-packages/bitsandbytes/libbitsandbytes_cuda118.so...
I'm using ViT with adapters.
2024-04-22 22:03:35,027 [trainer.py] => All params: 86006136
2024-04-22 22:03:35,028 [trainer.py] => Trainable params: 207480
2024-04-22 22:03:35,164 [loramoeinc.py] => Learning on 0-10
  0%|          | 0/20 [00:00<?, ?it/s]Task 0, Epoch 1/20 => Loss 2.300, Train_accy 6.83:   0%|          | 0/20 [00:01<?, ?it/s]Task 0, Epoch 1/20 => Loss 2.300, Train_accy 6.83:   5%|▌         | 1/20 [00:01<00:34,  1.79s/it]Task 0, Epoch 2/20 => Loss 2.279, Train_accy 17.39:   5%|▌         | 1/20 [00:03<00:34,  1.79s/it]Task 0, Epoch 2/20 => Loss 2.279, Train_accy 17.39:  10%|█         | 2/20 [00:03<00:27,  1.52s/it]Task 0, Epoch 3/20 => Loss 2.249, Train_accy 45.34:  10%|█         | 2/20 [00:04<00:27,  1.52s/it]Task 0, Epoch 3/20 => Loss 2.249, Train_accy 45.34:  15%|█▌        | 3/20 [00:04<00:24,  1.42s/it]Task 0, Epoch 4/20 => Loss 2.209, Train_accy 68.94:  15%|█▌        | 3/20 [00:05<00:24,  1.42s/it]Task 0, Epoch 4/20 => Loss 2.209, Train_accy 68.94:  20%|██        | 4/20 [00:05<00:22,  1.39s/it]Task 0, Epoch 5/20 => Loss 2.162, Train_accy 75.16:  20%|██        | 4/20 [00:07<00:22,  1.39s/it]Task 0, Epoch 5/20 => Loss 2.162, Train_accy 75.16:  25%|██▌       | 5/20 [00:07<00:20,  1.38s/it]Task 0, Epoch 6/20 => Loss 2.120, Train_accy 81.37:  25%|██▌       | 5/20 [00:08<00:20,  1.38s/it]Task 0, Epoch 6/20 => Loss 2.120, Train_accy 81.37:  30%|███       | 6/20 [00:08<00:19,  1.40s/it]Task 0, Epoch 7/20 => Loss 2.062, Train_accy 85.09:  30%|███       | 6/20 [00:09<00:19,  1.40s/it]Task 0, Epoch 7/20 => Loss 2.062, Train_accy 85.09:  35%|███▌      | 7/20 [00:09<00:18,  1.38s/it]Task 0, Epoch 8/20 => Loss 2.004, Train_accy 90.68:  35%|███▌      | 7/20 [00:11<00:18,  1.38s/it]Task 0, Epoch 8/20 => Loss 2.004, Train_accy 90.68:  40%|████      | 8/20 [00:11<00:16,  1.41s/it]Task 0, Epoch 9/20 => Loss 1.966, Train_accy 88.82:  40%|████      | 8/20 [00:12<00:16,  1.41s/it]Task 0, Epoch 9/20 => Loss 1.966, Train_accy 88.82:  45%|████▌     | 9/20 [00:12<00:15,  1.38s/it]Task 0, Epoch 10/20 => Loss 1.920, Train_accy 91.30:  45%|████▌     | 9/20 [00:14<00:15,  1.38s/it]Task 0, Epoch 10/20 => Loss 1.920, Train_accy 91.30:  50%|█████     | 10/20 [00:14<00:14,  1.40s/it]Task 0, Epoch 11/20 => Loss 1.858, Train_accy 90.06:  50%|█████     | 10/20 [00:15<00:14,  1.40s/it]Task 0, Epoch 11/20 => Loss 1.858, Train_accy 90.06:  55%|█████▌    | 11/20 [00:15<00:12,  1.40s/it]Task 0, Epoch 12/20 => Loss 1.816, Train_accy 87.58:  55%|█████▌    | 11/20 [00:16<00:12,  1.40s/it]Task 0, Epoch 12/20 => Loss 1.816, Train_accy 87.58:  60%|██████    | 12/20 [00:16<00:10,  1.37s/it]Task 0, Epoch 13/20 => Loss 1.752, Train_accy 92.55:  60%|██████    | 12/20 [00:18<00:10,  1.37s/it]Task 0, Epoch 13/20 => Loss 1.752, Train_accy 92.55:  65%|██████▌   | 13/20 [00:18<00:09,  1.37s/it]Task 0, Epoch 14/20 => Loss 1.743, Train_accy 90.06:  65%|██████▌   | 13/20 [00:19<00:09,  1.37s/it]Task 0, Epoch 14/20 => Loss 1.743, Train_accy 90.06:  70%|███████   | 14/20 [00:19<00:08,  1.38s/it]Task 0, Epoch 15/20 => Loss 1.702, Train_accy 93.17:  70%|███████   | 14/20 [00:21<00:08,  1.38s/it]Task 0, Epoch 15/20 => Loss 1.702, Train_accy 93.17:  75%|███████▌  | 15/20 [00:21<00:07,  1.41s/it]Task 0, Epoch 16/20 => Loss 1.713, Train_accy 90.68:  75%|███████▌  | 15/20 [00:22<00:07,  1.41s/it]Task 0, Epoch 16/20 => Loss 1.713, Train_accy 90.68:  80%|████████  | 16/20 [00:22<00:05,  1.37s/it]Task 0, Epoch 17/20 => Loss 1.676, Train_accy 90.68:  80%|████████  | 16/20 [00:23<00:05,  1.37s/it]Task 0, Epoch 17/20 => Loss 1.676, Train_accy 90.68:  85%|████████▌ | 17/20 [00:23<00:04,  1.37s/it]Task 0, Epoch 18/20 => Loss 1.667, Train_accy 91.93:  85%|████████▌ | 17/20 [00:25<00:04,  1.37s/it]Task 0, Epoch 18/20 => Loss 1.667, Train_accy 91.93:  90%|█████████ | 18/20 [00:25<00:02,  1.38s/it]Task 0, Epoch 19/20 => Loss 1.642, Train_accy 92.55:  90%|█████████ | 18/20 [00:26<00:02,  1.38s/it]Task 0, Epoch 19/20 => Loss 1.642, Train_accy 92.55:  95%|█████████▌| 19/20 [00:26<00:01,  1.39s/it]Task 0, Epoch 20/20 => Loss 1.654, Train_accy 93.17:  95%|█████████▌| 19/20 [00:27<00:01,  1.39s/it]Task 0, Epoch 20/20 => Loss 1.654, Train_accy 93.17: 100%|██████████| 20/20 [00:27<00:00,  1.38s/it]Task 0, Epoch 20/20 => Loss 1.654, Train_accy 93.17: 100%|██████████| 20/20 [00:27<00:00,  1.40s/it]
2024-04-22 22:04:03,278 [loramoeinc.py] => Task 0, Epoch 20/20 => Loss 1.654, Train_accy 93.17
2024-04-22 22:04:31,819 [trainer.py] => No NME accuracy.
2024-04-22 22:04:31,819 [trainer.py] => CNN: {'total': 99.76, '00-09': 99.76, 'old': 0, 'new': 99.76}
2024-04-22 22:04:31,819 [trainer.py] => Route: {'total': 98.79, '00-09': 98.79, 'old': 0, 'new': 98.79}
2024-04-22 22:04:31,819 [trainer.py] => CNN top1 curve: [99.76]
2024-04-22 22:04:31,819 [trainer.py] => CNN top5 curve: [100.0]
2024-04-22 22:04:31,819 [trainer.py] => Route top1 curve: [98.79]
2024-04-22 22:04:31,819 [trainer.py] => Route top5 curve: [99.64]

Average Accuracy (CNN): 99.76
Average Accuracy (Route): 98.79
2024-04-22 22:04:31,819 [trainer.py] => Average Accuracy (CNN): 99.76
2024-04-22 22:04:31,819 [trainer.py] => Average Accuracy (Route): 98.79

2024-04-22 22:04:31,819 [trainer.py] => Train Time: 27.93
2024-04-22 22:04:31,819 [trainer.py] => Test Time: 0 

2024-04-22 22:04:31,821 [trainer.py] => All params: 86021498
2024-04-22 22:04:31,822 [trainer.py] => Trainable params: 173665
2024-04-22 22:04:31,824 [loramoeinc.py] => Learning on 10-20
  0%|          | 0/20 [00:00<?, ?it/s]Task 1, Epoch 1/20 => Loss 2.304, Train_accy 66.43:   0%|          | 0/20 [00:02<?, ?it/s]Task 1, Epoch 1/20 => Loss 2.304, Train_accy 66.43:   5%|▌         | 1/20 [00:02<00:47,  2.48s/it]Task 1, Epoch 2/20 => Loss 2.098, Train_accy 77.54:   5%|▌         | 1/20 [00:05<00:47,  2.48s/it]Task 1, Epoch 2/20 => Loss 2.098, Train_accy 77.54:  10%|█         | 2/20 [00:05<00:45,  2.54s/it]Task 1, Epoch 3/20 => Loss 1.922, Train_accy 75.85:  10%|█         | 2/20 [00:07<00:45,  2.54s/it]Task 1, Epoch 3/20 => Loss 1.922, Train_accy 75.85:  15%|█▌        | 3/20 [00:07<00:43,  2.56s/it]Task 1, Epoch 4/20 => Loss 1.712, Train_accy 82.37:  15%|█▌        | 3/20 [00:10<00:43,  2.56s/it]Task 1, Epoch 4/20 => Loss 1.712, Train_accy 82.37:  20%|██        | 4/20 [00:10<00:41,  2.56s/it]Task 1, Epoch 5/20 => Loss 1.501, Train_accy 85.99:  20%|██        | 4/20 [00:12<00:41,  2.56s/it]Task 1, Epoch 5/20 => Loss 1.501, Train_accy 85.99:  25%|██▌       | 5/20 [00:12<00:39,  2.62s/it]Task 1, Epoch 6/20 => Loss 1.367, Train_accy 85.75:  25%|██▌       | 5/20 [00:15<00:39,  2.62s/it]Task 1, Epoch 6/20 => Loss 1.367, Train_accy 85.75:  30%|███       | 6/20 [00:15<00:36,  2.61s/it]Task 1, Epoch 7/20 => Loss 1.237, Train_accy 85.75:  30%|███       | 6/20 [00:18<00:36,  2.61s/it]Task 1, Epoch 7/20 => Loss 1.237, Train_accy 85.75:  35%|███▌      | 7/20 [00:18<00:33,  2.60s/it]Task 1, Epoch 8/20 => Loss 1.121, Train_accy 89.61:  35%|███▌      | 7/20 [00:20<00:33,  2.60s/it]Task 1, Epoch 8/20 => Loss 1.121, Train_accy 89.61:  40%|████      | 8/20 [00:20<00:31,  2.59s/it]Task 1, Epoch 9/20 => Loss 1.037, Train_accy 91.79:  40%|████      | 8/20 [00:23<00:31,  2.59s/it]Task 1, Epoch 9/20 => Loss 1.037, Train_accy 91.79:  45%|████▌     | 9/20 [00:23<00:28,  2.58s/it]Task 1, Epoch 10/20 => Loss 0.978, Train_accy 91.55:  45%|████▌     | 9/20 [00:25<00:28,  2.58s/it]Task 1, Epoch 10/20 => Loss 0.978, Train_accy 91.55:  50%|█████     | 10/20 [00:25<00:25,  2.57s/it]Task 1, Epoch 11/20 => Loss 0.903, Train_accy 95.41:  50%|█████     | 10/20 [00:28<00:25,  2.57s/it]Task 1, Epoch 11/20 => Loss 0.903, Train_accy 95.41:  55%|█████▌    | 11/20 [00:28<00:23,  2.58s/it]Task 1, Epoch 12/20 => Loss 0.881, Train_accy 94.20:  55%|█████▌    | 11/20 [00:30<00:23,  2.58s/it]Task 1, Epoch 12/20 => Loss 0.881, Train_accy 94.20:  60%|██████    | 12/20 [00:30<00:20,  2.58s/it]Task 1, Epoch 13/20 => Loss 0.823, Train_accy 94.44:  60%|██████    | 12/20 [00:33<00:20,  2.58s/it]Task 1, Epoch 13/20 => Loss 0.823, Train_accy 94.44:  65%|██████▌   | 13/20 [00:33<00:18,  2.58s/it]Task 1, Epoch 14/20 => Loss 0.794, Train_accy 95.17:  65%|██████▌   | 13/20 [00:36<00:18,  2.58s/it]Task 1, Epoch 14/20 => Loss 0.794, Train_accy 95.17:  70%|███████   | 14/20 [00:36<00:15,  2.57s/it]Task 1, Epoch 15/20 => Loss 0.765, Train_accy 96.86:  70%|███████   | 14/20 [00:38<00:15,  2.57s/it]Task 1, Epoch 15/20 => Loss 0.765, Train_accy 96.86:  75%|███████▌  | 15/20 [00:38<00:13,  2.60s/it]Task 1, Epoch 16/20 => Loss 0.763, Train_accy 94.44:  75%|███████▌  | 15/20 [00:41<00:13,  2.60s/it]Task 1, Epoch 16/20 => Loss 0.763, Train_accy 94.44:  80%|████████  | 16/20 [00:41<00:10,  2.59s/it]Task 1, Epoch 17/20 => Loss 0.765, Train_accy 94.93:  80%|████████  | 16/20 [00:43<00:10,  2.59s/it]Task 1, Epoch 17/20 => Loss 0.765, Train_accy 94.93:  85%|████████▌ | 17/20 [00:43<00:07,  2.57s/it]Task 1, Epoch 18/20 => Loss 0.758, Train_accy 94.93:  85%|████████▌ | 17/20 [00:46<00:07,  2.57s/it]Task 1, Epoch 18/20 => Loss 0.758, Train_accy 94.93:  90%|█████████ | 18/20 [00:46<00:05,  2.56s/it]Task 1, Epoch 19/20 => Loss 0.746, Train_accy 93.96:  90%|█████████ | 18/20 [00:49<00:05,  2.56s/it]Task 1, Epoch 19/20 => Loss 0.746, Train_accy 93.96:  95%|█████████▌| 19/20 [00:49<00:02,  2.58s/it]Task 1, Epoch 20/20 => Loss 0.748, Train_accy 95.17:  95%|█████████▌| 19/20 [00:51<00:02,  2.58s/it]Task 1, Epoch 20/20 => Loss 0.748, Train_accy 95.17: 100%|██████████| 20/20 [00:51<00:00,  2.58s/it]Task 1, Epoch 20/20 => Loss 0.748, Train_accy 95.17: 100%|██████████| 20/20 [00:51<00:00,  2.58s/it]
2024-04-22 22:05:23,422 [loramoeinc.py] => Task 1, Epoch 20/20 => Loss 0.748, Train_accy 95.17
2024-04-22 22:06:06,299 [trainer.py] => No NME accuracy.
2024-04-22 22:06:06,299 [trainer.py] => CNN: {'total': 97.12, '00-09': 98.18, '10-19': 96.68, 'old': 98.18, 'new': 96.68}
2024-04-22 22:06:06,299 [trainer.py] => Route: {'total': 94.49, '00-09': 98.18, '10-19': 92.97, 'old': 98.18, 'new': 92.97}
2024-04-22 22:06:06,299 [trainer.py] => CNN top1 curve: [99.76, 97.12]
2024-04-22 22:06:06,299 [trainer.py] => CNN top5 curve: [100.0, 100.0]
2024-04-22 22:06:06,299 [trainer.py] => Route top1 curve: [98.79, 94.49]
2024-04-22 22:06:06,299 [trainer.py] => Route top5 curve: [99.64, 99.61]

Average Accuracy (CNN): 98.44
Average Accuracy (Route): 96.64
2024-04-22 22:06:06,299 [trainer.py] => Average Accuracy (CNN): 98.44
2024-04-22 22:06:06,299 [trainer.py] => Average Accuracy (Route): 96.64

2024-04-22 22:06:06,299 [trainer.py] => Train Time: 79.52000000000001
2024-04-22 22:06:06,300 [trainer.py] => Test Time: 0 

2024-04-22 22:06:06,301 [trainer.py] => All params: 86036858
2024-04-22 22:06:06,302 [trainer.py] => Trainable params: 139849
2024-04-22 22:06:06,304 [loramoeinc.py] => Learning on 20-30
  0%|          | 0/20 [00:00<?, ?it/s]Task 2, Epoch 1/20 => Loss 1.915, Train_accy 64.11:   0%|          | 0/20 [00:02<?, ?it/s]Task 2, Epoch 1/20 => Loss 1.915, Train_accy 64.11:   5%|▌         | 1/20 [00:02<00:48,  2.54s/it]Task 2, Epoch 2/20 => Loss 1.528, Train_accy 78.90:   5%|▌         | 1/20 [00:05<00:48,  2.54s/it]Task 2, Epoch 2/20 => Loss 1.528, Train_accy 78.90:  10%|█         | 2/20 [00:05<00:45,  2.51s/it]Task 2, Epoch 3/20 => Loss 1.416, Train_accy 83.01:  10%|█         | 2/20 [00:07<00:45,  2.51s/it]Task 2, Epoch 3/20 => Loss 1.416, Train_accy 83.01:  15%|█▌        | 3/20 [00:07<00:42,  2.50s/it]Task 2, Epoch 4/20 => Loss 1.285, Train_accy 86.03:  15%|█▌        | 3/20 [00:09<00:42,  2.50s/it]Task 2, Epoch 4/20 => Loss 1.285, Train_accy 86.03:  20%|██        | 4/20 [00:09<00:39,  2.45s/it]Task 2, Epoch 5/20 => Loss 1.147, Train_accy 87.95:  20%|██        | 4/20 [00:12<00:39,  2.45s/it]Task 2, Epoch 5/20 => Loss 1.147, Train_accy 87.95:  25%|██▌       | 5/20 [00:12<00:36,  2.45s/it]Task 2, Epoch 6/20 => Loss 1.052, Train_accy 89.32:  25%|██▌       | 5/20 [00:14<00:36,  2.45s/it]Task 2, Epoch 6/20 => Loss 1.052, Train_accy 89.32:  30%|███       | 6/20 [00:14<00:34,  2.47s/it]Task 2, Epoch 7/20 => Loss 0.903, Train_accy 91.51:  30%|███       | 6/20 [00:17<00:34,  2.47s/it]Task 2, Epoch 7/20 => Loss 0.903, Train_accy 91.51:  35%|███▌      | 7/20 [00:17<00:32,  2.46s/it]Task 2, Epoch 8/20 => Loss 0.838, Train_accy 91.23:  35%|███▌      | 7/20 [00:19<00:32,  2.46s/it]Task 2, Epoch 8/20 => Loss 0.838, Train_accy 91.23:  40%|████      | 8/20 [00:19<00:29,  2.46s/it]Task 2, Epoch 9/20 => Loss 0.750, Train_accy 93.97:  40%|████      | 8/20 [00:22<00:29,  2.46s/it]Task 2, Epoch 9/20 => Loss 0.750, Train_accy 93.97:  45%|████▌     | 9/20 [00:22<00:26,  2.42s/it]Task 2, Epoch 10/20 => Loss 0.697, Train_accy 94.79:  45%|████▌     | 9/20 [00:24<00:26,  2.42s/it]Task 2, Epoch 10/20 => Loss 0.697, Train_accy 94.79:  50%|█████     | 10/20 [00:24<00:24,  2.43s/it]Task 2, Epoch 11/20 => Loss 0.676, Train_accy 94.79:  50%|█████     | 10/20 [00:27<00:24,  2.43s/it]Task 2, Epoch 11/20 => Loss 0.676, Train_accy 94.79:  55%|█████▌    | 11/20 [00:27<00:22,  2.45s/it]Task 2, Epoch 12/20 => Loss 0.613, Train_accy 95.07:  55%|█████▌    | 11/20 [00:29<00:22,  2.45s/it]Task 2, Epoch 12/20 => Loss 0.613, Train_accy 95.07:  60%|██████    | 12/20 [00:29<00:19,  2.44s/it]Task 2, Epoch 13/20 => Loss 0.594, Train_accy 95.89:  60%|██████    | 12/20 [00:31<00:19,  2.44s/it]Task 2, Epoch 13/20 => Loss 0.594, Train_accy 95.89:  65%|██████▌   | 13/20 [00:31<00:17,  2.46s/it]Task 2, Epoch 14/20 => Loss 0.575, Train_accy 96.44:  65%|██████▌   | 13/20 [00:34<00:17,  2.46s/it]Task 2, Epoch 14/20 => Loss 0.575, Train_accy 96.44:  70%|███████   | 14/20 [00:34<00:14,  2.45s/it]Task 2, Epoch 15/20 => Loss 0.554, Train_accy 96.44:  70%|███████   | 14/20 [00:36<00:14,  2.45s/it]Task 2, Epoch 15/20 => Loss 0.554, Train_accy 96.44:  75%|███████▌  | 15/20 [00:36<00:12,  2.42s/it]Task 2, Epoch 16/20 => Loss 0.545, Train_accy 95.89:  75%|███████▌  | 15/20 [00:39<00:12,  2.42s/it]Task 2, Epoch 16/20 => Loss 0.545, Train_accy 95.89:  80%|████████  | 16/20 [00:39<00:09,  2.41s/it]Task 2, Epoch 17/20 => Loss 0.513, Train_accy 97.26:  80%|████████  | 16/20 [00:41<00:09,  2.41s/it]Task 2, Epoch 17/20 => Loss 0.513, Train_accy 97.26:  85%|████████▌ | 17/20 [00:41<00:07,  2.40s/it]Task 2, Epoch 18/20 => Loss 0.552, Train_accy 95.62:  85%|████████▌ | 17/20 [00:43<00:07,  2.40s/it]Task 2, Epoch 18/20 => Loss 0.552, Train_accy 95.62:  90%|█████████ | 18/20 [00:43<00:04,  2.39s/it]Task 2, Epoch 19/20 => Loss 0.545, Train_accy 95.34:  90%|█████████ | 18/20 [00:46<00:04,  2.39s/it]Task 2, Epoch 19/20 => Loss 0.545, Train_accy 95.34:  95%|█████████▌| 19/20 [00:46<00:02,  2.38s/it]Task 2, Epoch 20/20 => Loss 0.519, Train_accy 97.26:  95%|█████████▌| 19/20 [00:48<00:02,  2.38s/it]Task 2, Epoch 20/20 => Loss 0.519, Train_accy 97.26: 100%|██████████| 20/20 [00:48<00:00,  2.38s/it]Task 2, Epoch 20/20 => Loss 0.519, Train_accy 97.26: 100%|██████████| 20/20 [00:48<00:00,  2.43s/it]
2024-04-22 22:06:54,906 [loramoeinc.py] => Task 2, Epoch 20/20 => Loss 0.519, Train_accy 97.26
2024-04-22 22:07:44,551 [trainer.py] => No NME accuracy.
2024-04-22 22:07:44,552 [trainer.py] => CNN: {'total': 97.12, '00-09': 98.18, '10-19': 96.04, '20-29': 97.92, 'old': 96.66, 'new': 97.92}
2024-04-22 22:07:44,552 [trainer.py] => Route: {'total': 88.37, '00-09': 95.64, '10-19': 90.6, '20-29': 81.94, 'old': 92.06, 'new': 81.94}
2024-04-22 22:07:44,552 [trainer.py] => CNN top1 curve: [99.76, 97.12, 97.12]
2024-04-22 22:07:44,552 [trainer.py] => CNN top5 curve: [100.0, 100.0, 100.0]
2024-04-22 22:07:44,552 [trainer.py] => Route top1 curve: [98.79, 94.49, 88.37]
2024-04-22 22:07:44,552 [trainer.py] => Route top5 curve: [99.64, 99.61, 99.33]

Average Accuracy (CNN): 98.0
Average Accuracy (Route): 93.88333333333333
2024-04-22 22:07:44,552 [trainer.py] => Average Accuracy (CNN): 98.0
2024-04-22 22:07:44,552 [trainer.py] => Average Accuracy (Route): 93.88333333333333

2024-04-22 22:07:44,552 [trainer.py] => Train Time: 128.11
2024-04-22 22:07:44,552 [trainer.py] => Test Time: 0 

2024-04-22 22:07:44,553 [trainer.py] => All params: 86052218
2024-04-22 22:07:44,555 [trainer.py] => Trainable params: 106033
2024-04-22 22:07:44,557 [loramoeinc.py] => Learning on 30-40
  0%|          | 0/20 [00:00<?, ?it/s]Task 3, Epoch 1/20 => Loss 2.089, Train_accy 65.02:   0%|          | 0/20 [00:02<?, ?it/s]Task 3, Epoch 1/20 => Loss 2.089, Train_accy 65.02:   5%|▌         | 1/20 [00:02<00:41,  2.17s/it]Task 3, Epoch 2/20 => Loss 1.526, Train_accy 83.83:   5%|▌         | 1/20 [00:04<00:41,  2.17s/it]Task 3, Epoch 2/20 => Loss 1.526, Train_accy 83.83:  10%|█         | 2/20 [00:04<00:38,  2.14s/it]Task 3, Epoch 3/20 => Loss 1.404, Train_accy 84.49:  10%|█         | 2/20 [00:06<00:38,  2.14s/it]Task 3, Epoch 3/20 => Loss 1.404, Train_accy 84.49:  15%|█▌        | 3/20 [00:06<00:36,  2.13s/it]Task 3, Epoch 4/20 => Loss 1.184, Train_accy 84.16:  15%|█▌        | 3/20 [00:08<00:36,  2.13s/it]Task 3, Epoch 4/20 => Loss 1.184, Train_accy 84.16:  20%|██        | 4/20 [00:08<00:34,  2.15s/it]Task 3, Epoch 5/20 => Loss 0.955, Train_accy 87.46:  20%|██        | 4/20 [00:10<00:34,  2.15s/it]Task 3, Epoch 5/20 => Loss 0.955, Train_accy 87.46:  25%|██▌       | 5/20 [00:10<00:32,  2.15s/it]Task 3, Epoch 6/20 => Loss 0.871, Train_accy 89.44:  25%|██▌       | 5/20 [00:12<00:32,  2.15s/it]Task 3, Epoch 6/20 => Loss 0.871, Train_accy 89.44:  30%|███       | 6/20 [00:12<00:30,  2.15s/it]Task 3, Epoch 7/20 => Loss 0.768, Train_accy 91.75:  30%|███       | 6/20 [00:15<00:30,  2.15s/it]Task 3, Epoch 7/20 => Loss 0.768, Train_accy 91.75:  35%|███▌      | 7/20 [00:15<00:28,  2.16s/it]Task 3, Epoch 8/20 => Loss 0.678, Train_accy 91.42:  35%|███▌      | 7/20 [00:17<00:28,  2.16s/it]Task 3, Epoch 8/20 => Loss 0.678, Train_accy 91.42:  40%|████      | 8/20 [00:17<00:25,  2.16s/it]Task 3, Epoch 9/20 => Loss 0.593, Train_accy 92.41:  40%|████      | 8/20 [00:19<00:25,  2.16s/it]Task 3, Epoch 9/20 => Loss 0.593, Train_accy 92.41:  45%|████▌     | 9/20 [00:19<00:23,  2.15s/it]Task 3, Epoch 10/20 => Loss 0.560, Train_accy 93.07:  45%|████▌     | 9/20 [00:21<00:23,  2.15s/it]Task 3, Epoch 10/20 => Loss 0.560, Train_accy 93.07:  50%|█████     | 10/20 [00:21<00:21,  2.13s/it]Task 3, Epoch 11/20 => Loss 0.533, Train_accy 93.07:  50%|█████     | 10/20 [00:23<00:21,  2.13s/it]Task 3, Epoch 11/20 => Loss 0.533, Train_accy 93.07:  55%|█████▌    | 11/20 [00:23<00:19,  2.15s/it]Task 3, Epoch 12/20 => Loss 0.566, Train_accy 92.08:  55%|█████▌    | 11/20 [00:25<00:19,  2.15s/it]Task 3, Epoch 12/20 => Loss 0.566, Train_accy 92.08:  60%|██████    | 12/20 [00:25<00:17,  2.16s/it]Task 3, Epoch 13/20 => Loss 0.526, Train_accy 92.41:  60%|██████    | 12/20 [00:28<00:17,  2.16s/it]Task 3, Epoch 13/20 => Loss 0.526, Train_accy 92.41:  65%|██████▌   | 13/20 [00:28<00:15,  2.19s/it]Task 3, Epoch 14/20 => Loss 0.475, Train_accy 93.07:  65%|██████▌   | 13/20 [00:30<00:15,  2.19s/it]Task 3, Epoch 14/20 => Loss 0.475, Train_accy 93.07:  70%|███████   | 14/20 [00:30<00:13,  2.18s/it]Task 3, Epoch 15/20 => Loss 0.458, Train_accy 92.74:  70%|███████   | 14/20 [00:32<00:13,  2.18s/it]Task 3, Epoch 15/20 => Loss 0.458, Train_accy 92.74:  75%|███████▌  | 15/20 [00:32<00:10,  2.16s/it]Task 3, Epoch 16/20 => Loss 0.471, Train_accy 93.40:  75%|███████▌  | 15/20 [00:34<00:10,  2.16s/it]Task 3, Epoch 16/20 => Loss 0.471, Train_accy 93.40:  80%|████████  | 16/20 [00:34<00:08,  2.14s/it]Task 3, Epoch 17/20 => Loss 0.422, Train_accy 94.06:  80%|████████  | 16/20 [00:36<00:08,  2.14s/it]Task 3, Epoch 17/20 => Loss 0.422, Train_accy 94.06:  85%|████████▌ | 17/20 [00:36<00:06,  2.17s/it]Task 3, Epoch 18/20 => Loss 0.450, Train_accy 93.40:  85%|████████▌ | 17/20 [00:38<00:06,  2.17s/it]Task 3, Epoch 18/20 => Loss 0.450, Train_accy 93.40:  90%|█████████ | 18/20 [00:38<00:04,  2.17s/it]Task 3, Epoch 19/20 => Loss 0.444, Train_accy 93.40:  90%|█████████ | 18/20 [00:40<00:04,  2.17s/it]Task 3, Epoch 19/20 => Loss 0.444, Train_accy 93.40:  95%|█████████▌| 19/20 [00:40<00:02,  2.14s/it]Task 3, Epoch 20/20 => Loss 0.477, Train_accy 91.75:  95%|█████████▌| 19/20 [00:43<00:02,  2.14s/it]Task 3, Epoch 20/20 => Loss 0.477, Train_accy 91.75: 100%|██████████| 20/20 [00:43<00:00,  2.12s/it]Task 3, Epoch 20/20 => Loss 0.477, Train_accy 91.75: 100%|██████████| 20/20 [00:43<00:00,  2.15s/it]
2024-04-22 22:08:27,591 [loramoeinc.py] => Task 3, Epoch 20/20 => Loss 0.477, Train_accy 91.75
2024-04-22 22:09:21,067 [trainer.py] => No NME accuracy.
2024-04-22 22:09:21,067 [trainer.py] => CNN: {'total': 97.35, '00-09': 98.18, '10-19': 96.04, '20-29': 97.06, '30-39': 99.28, 'old': 96.81, 'new': 99.28}
2024-04-22 22:09:21,067 [trainer.py] => Route: {'total': 87.87, '00-09': 94.43, '10-19': 90.25, '20-29': 78.69, '30-39': 91.68, 'old': 86.81, 'new': 91.68}
2024-04-22 22:09:21,067 [trainer.py] => CNN top1 curve: [99.76, 97.12, 97.12, 97.35]
2024-04-22 22:09:21,067 [trainer.py] => CNN top5 curve: [100.0, 100.0, 100.0, 99.95]
2024-04-22 22:09:21,067 [trainer.py] => Route top1 curve: [98.79, 94.49, 88.37, 87.87]
2024-04-22 22:09:21,067 [trainer.py] => Route top5 curve: [99.64, 99.61, 99.33, 98.97]

Average Accuracy (CNN): 97.8375
Average Accuracy (Route): 92.38
2024-04-22 22:09:21,067 [trainer.py] => Average Accuracy (CNN): 97.8375
2024-04-22 22:09:21,067 [trainer.py] => Average Accuracy (Route): 92.38

2024-04-22 22:09:21,067 [trainer.py] => Train Time: 171.13000000000002
2024-04-22 22:09:21,067 [trainer.py] => Test Time: 0 

2024-04-22 22:09:21,068 [trainer.py] => All params: 86067578
2024-04-22 22:09:21,069 [trainer.py] => Trainable params: 72217
2024-04-22 22:09:21,070 [loramoeinc.py] => Learning on 40-50
  0%|          | 0/20 [00:00<?, ?it/s]Task 4, Epoch 1/20 => Loss 1.556, Train_accy 69.08:   0%|          | 0/20 [00:03<?, ?it/s]Task 4, Epoch 1/20 => Loss 1.556, Train_accy 69.08:   5%|▌         | 1/20 [00:03<01:04,  3.37s/it]Task 4, Epoch 2/20 => Loss 1.031, Train_accy 82.64:   5%|▌         | 1/20 [00:06<01:04,  3.37s/it]Task 4, Epoch 2/20 => Loss 1.031, Train_accy 82.64:  10%|█         | 2/20 [00:06<00:59,  3.31s/it]Task 4, Epoch 3/20 => Loss 0.942, Train_accy 83.00:  10%|█         | 2/20 [00:09<00:59,  3.31s/it]Task 4, Epoch 3/20 => Loss 0.942, Train_accy 83.00:  15%|█▌        | 3/20 [00:09<00:56,  3.31s/it]Task 4, Epoch 4/20 => Loss 0.801, Train_accy 87.16:  15%|█▌        | 3/20 [00:13<00:56,  3.31s/it]Task 4, Epoch 4/20 => Loss 0.801, Train_accy 87.16:  20%|██        | 4/20 [00:13<00:53,  3.31s/it]Task 4, Epoch 5/20 => Loss 0.720, Train_accy 87.34:  20%|██        | 4/20 [00:16<00:53,  3.31s/it]Task 4, Epoch 5/20 => Loss 0.720, Train_accy 87.34:  25%|██▌       | 5/20 [00:16<00:50,  3.34s/it]Task 4, Epoch 6/20 => Loss 0.638, Train_accy 90.96:  25%|██▌       | 5/20 [00:19<00:50,  3.34s/it]Task 4, Epoch 6/20 => Loss 0.638, Train_accy 90.96:  30%|███       | 6/20 [00:19<00:46,  3.31s/it]Task 4, Epoch 7/20 => Loss 0.572, Train_accy 93.31:  30%|███       | 6/20 [00:23<00:46,  3.31s/it]Task 4, Epoch 7/20 => Loss 0.572, Train_accy 93.31:  35%|███▌      | 7/20 [00:23<00:43,  3.32s/it]Task 4, Epoch 8/20 => Loss 0.519, Train_accy 94.58:  35%|███▌      | 7/20 [00:26<00:43,  3.32s/it]Task 4, Epoch 8/20 => Loss 0.519, Train_accy 94.58:  40%|████      | 8/20 [00:26<00:40,  3.34s/it]Task 4, Epoch 9/20 => Loss 0.505, Train_accy 93.13:  40%|████      | 8/20 [00:29<00:40,  3.34s/it]Task 4, Epoch 9/20 => Loss 0.505, Train_accy 93.13:  45%|████▌     | 9/20 [00:29<00:36,  3.31s/it]Task 4, Epoch 10/20 => Loss 0.485, Train_accy 94.03:  45%|████▌     | 9/20 [00:33<00:36,  3.31s/it]Task 4, Epoch 10/20 => Loss 0.485, Train_accy 94.03:  50%|█████     | 10/20 [00:33<00:33,  3.32s/it]Task 4, Epoch 11/20 => Loss 0.469, Train_accy 94.21:  50%|█████     | 10/20 [00:36<00:33,  3.32s/it]Task 4, Epoch 11/20 => Loss 0.469, Train_accy 94.21:  55%|█████▌    | 11/20 [00:36<00:29,  3.32s/it]Task 4, Epoch 12/20 => Loss 0.454, Train_accy 93.85:  55%|█████▌    | 11/20 [00:39<00:29,  3.32s/it]Task 4, Epoch 12/20 => Loss 0.454, Train_accy 93.85:  60%|██████    | 12/20 [00:39<00:26,  3.32s/it]Task 4, Epoch 13/20 => Loss 0.414, Train_accy 95.48:  60%|██████    | 12/20 [00:43<00:26,  3.32s/it]Task 4, Epoch 13/20 => Loss 0.414, Train_accy 95.48:  65%|██████▌   | 13/20 [00:43<00:23,  3.30s/it]Task 4, Epoch 14/20 => Loss 0.400, Train_accy 95.30:  65%|██████▌   | 13/20 [00:46<00:23,  3.30s/it]Task 4, Epoch 14/20 => Loss 0.400, Train_accy 95.30:  70%|███████   | 14/20 [00:46<00:19,  3.30s/it]Task 4, Epoch 15/20 => Loss 0.397, Train_accy 96.02:  70%|███████   | 14/20 [00:49<00:19,  3.30s/it]Task 4, Epoch 15/20 => Loss 0.397, Train_accy 96.02:  75%|███████▌  | 15/20 [00:49<00:16,  3.31s/it]Task 4, Epoch 16/20 => Loss 0.383, Train_accy 95.30:  75%|███████▌  | 15/20 [00:53<00:16,  3.31s/it]Task 4, Epoch 16/20 => Loss 0.383, Train_accy 95.30:  80%|████████  | 16/20 [00:53<00:13,  3.31s/it]Task 4, Epoch 17/20 => Loss 0.376, Train_accy 96.75:  80%|████████  | 16/20 [00:56<00:13,  3.31s/it]Task 4, Epoch 17/20 => Loss 0.376, Train_accy 96.75:  85%|████████▌ | 17/20 [00:56<00:09,  3.30s/it]Task 4, Epoch 18/20 => Loss 0.402, Train_accy 94.39:  85%|████████▌ | 17/20 [00:59<00:09,  3.30s/it]Task 4, Epoch 18/20 => Loss 0.402, Train_accy 94.39:  90%|█████████ | 18/20 [00:59<00:06,  3.27s/it]Task 4, Epoch 19/20 => Loss 0.420, Train_accy 94.21:  90%|█████████ | 18/20 [01:02<00:06,  3.27s/it]Task 4, Epoch 19/20 => Loss 0.420, Train_accy 94.21:  95%|█████████▌| 19/20 [01:02<00:03,  3.27s/it]Task 4, Epoch 20/20 => Loss 0.403, Train_accy 94.21:  95%|█████████▌| 19/20 [01:06<00:03,  3.27s/it]Task 4, Epoch 20/20 => Loss 0.403, Train_accy 94.21: 100%|██████████| 20/20 [01:06<00:00,  3.26s/it]Task 4, Epoch 20/20 => Loss 0.403, Train_accy 94.21: 100%|██████████| 20/20 [01:06<00:00,  3.30s/it]
2024-04-22 22:10:27,107 [loramoeinc.py] => Task 4, Epoch 20/20 => Loss 0.403, Train_accy 94.21
2024-04-22 22:11:37,215 [trainer.py] => No NME accuracy.
2024-04-22 22:11:37,215 [trainer.py] => CNN: {'total': 97.19, '00-09': 98.06, '10-19': 96.04, '20-29': 97.06, '30-39': 97.84, '40-49': 97.54, 'old': 97.02, 'new': 97.54}
2024-04-22 22:11:37,215 [trainer.py] => Route: {'total': 84.46, '00-09': 94.43, '10-19': 86.79, '20-29': 74.46, '30-39': 90.8, '40-49': 82.9, 'old': 85.25, 'new': 82.9}
2024-04-22 22:11:37,216 [trainer.py] => CNN top1 curve: [99.76, 97.12, 97.12, 97.35, 97.19]
2024-04-22 22:11:37,216 [trainer.py] => CNN top5 curve: [100.0, 100.0, 100.0, 99.95, 99.81]
2024-04-22 22:11:37,216 [trainer.py] => Route top1 curve: [98.79, 94.49, 88.37, 87.87, 84.46]
2024-04-22 22:11:37,216 [trainer.py] => Route top5 curve: [99.64, 99.61, 99.33, 98.97, 98.29]

Average Accuracy (CNN): 97.708
Average Accuracy (Route): 90.79599999999999
2024-04-22 22:11:37,216 [trainer.py] => Average Accuracy (CNN): 97.708
2024-04-22 22:11:37,216 [trainer.py] => Average Accuracy (Route): 90.79599999999999

2024-04-22 22:11:37,216 [trainer.py] => Train Time: 237.16000000000003
2024-04-22 22:11:37,216 [trainer.py] => Test Time: 0 

2024-04-22 22:11:40,961 [trainer.py] => config: ./exps/loramoe_inc_omn_inc5.json
2024-04-22 22:11:40,969 [trainer.py] => prefix: reproduce
2024-04-22 22:11:40,969 [trainer.py] => dataset: omnibenchmark
2024-04-22 22:11:40,969 [trainer.py] => memory_size: 0
2024-04-22 22:11:40,970 [trainer.py] => memory_per_class: 0
2024-04-22 22:11:40,970 [trainer.py] => fixed_memory: False
2024-04-22 22:11:40,970 [trainer.py] => shuffle: True
2024-04-22 22:11:40,970 [trainer.py] => init_cls: 60
2024-04-22 22:11:40,970 [trainer.py] => increment: 60
2024-04-22 22:11:40,970 [trainer.py] => model_name: loramoeinc
2024-04-22 22:11:40,970 [trainer.py] => backbone_type: pretrained_vit_b16_224_inc
2024-04-22 22:11:40,970 [trainer.py] => device: [device(type='cuda', index=6)]
2024-04-22 22:11:40,970 [trainer.py] => seed: 1993
2024-04-22 22:11:40,970 [trainer.py] => tuned_epoch: 20
2024-04-22 22:11:40,970 [trainer.py] => init_lr: 0.01
2024-04-22 22:11:40,970 [trainer.py] => batch_size: 48
2024-04-22 22:11:40,970 [trainer.py] => weight_decay: 0.0005
2024-04-22 22:11:40,970 [trainer.py] => min_lr: 0
2024-04-22 22:11:40,970 [trainer.py] => ffn_num: 4
2024-04-22 22:11:40,970 [trainer.py] => optimizer: sgd
2024-04-22 22:11:40,970 [trainer.py] => vpt_type: shallow
2024-04-22 22:11:40,970 [trainer.py] => prompt_token_num: 5
2024-04-22 22:11:40,970 [trainer.py] => expert_num: 5
2024-04-22 22:11:42,065 [data_manager.py] => [169, 221, 146, 296, 92, 229, 49, 70, 126, 77, 243, 57, 120, 223, 27, 217, 154, 8, 101, 182, 54, 50, 97, 162, 28, 193, 79, 6, 151, 0, 173, 187, 44, 277, 157, 16, 257, 122, 35, 9, 171, 176, 134, 4, 87, 255, 112, 153, 246, 286, 147, 186, 107, 98, 10, 7, 266, 214, 36, 165, 139, 254, 103, 269, 59, 23, 298, 39, 73, 208, 135, 299, 102, 20, 12, 268, 11, 209, 161, 210, 74, 42, 56, 99, 235, 133, 159, 189, 145, 238, 215, 241, 138, 195, 233, 279, 88, 199, 64, 280, 26, 203, 17, 245, 174, 236, 137, 252, 80, 68, 181, 150, 118, 94, 75, 2, 109, 119, 232, 15, 69, 184, 201, 261, 55, 287, 273, 66, 175, 32, 142, 136, 116, 76, 179, 1, 91, 248, 275, 240, 290, 170, 132, 106, 265, 270, 85, 19, 284, 43, 259, 293, 228, 200, 104, 227, 51, 224, 163, 297, 216, 260, 93, 46, 100, 272, 105, 72, 131, 3, 156, 256, 249, 48, 113, 82, 172, 213, 62, 53, 271, 168, 253, 226, 183, 180, 276, 283, 78, 61, 143, 278, 30, 141, 196, 264, 231, 52, 222, 40, 125, 219, 65, 166, 192, 289, 45, 205, 89, 267, 90, 71, 167, 262, 281, 212, 96, 84, 127, 67, 294, 178, 288, 197, 21, 18, 111, 108, 58, 230, 188, 31, 110, 291, 129, 24, 204, 83, 81, 251, 60, 13, 128, 14, 86, 63, 117, 198, 274, 5, 22, 144, 258, 121, 38, 207, 148, 292, 41, 234, 237, 114, 202, 37, 149, 206, 155, 29, 130, 177, 194, 152, 34, 33, 239, 160, 140, 47, 244, 25, 282, 158, 211, 123, 190, 218, 164, 247, 263, 191, 220, 115, 242, 250, 124, 295, 95, 285, 225, 185]
/home/team/zhaohongwei/anaconda3/envs/peft/lib/python3.10/site-packages/bitsandbytes/cuda_setup/main.py:136: UserWarning: /home/team/zhaohongwei/anaconda3/envs/peft did not contain libcudart.so as expected! Searching further paths...
  warn(msg)

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please submit your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
CUDA SETUP: CUDA runtime path found: /usr/local/cuda-11.8/lib64/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 8.6
CUDA SETUP: Detected CUDA version 118
CUDA SETUP: Loading binary /home/team/zhaohongwei/anaconda3/envs/peft/lib/python3.10/site-packages/bitsandbytes/libbitsandbytes_cuda118.so...
I'm using ViT with adapters.
2024-04-22 22:11:56,517 [trainer.py] => All params: 86006136
2024-04-22 22:11:56,518 [trainer.py] => Trainable params: 207480
2024-04-22 22:11:56,653 [loramoeinc.py] => Learning on 0-60
  0%|          | 0/20 [00:00<?, ?it/s]Task 0, Epoch 1/20 => Loss 2.196, Train_accy 63.09:   0%|          | 0/20 [02:07<?, ?it/s]Task 0, Epoch 1/20 => Loss 2.196, Train_accy 63.09:   5%|▌         | 1/20 [02:07<40:19, 127.34s/it]Task 0, Epoch 2/20 => Loss 0.617, Train_accy 82.06:   5%|▌         | 1/20 [03:42<40:19, 127.34s/it]Task 0, Epoch 2/20 => Loss 0.617, Train_accy 82.06:  10%|█         | 2/20 [03:42<32:30, 108.37s/it]Task 0, Epoch 3/20 => Loss 0.515, Train_accy 84.51:  10%|█         | 2/20 [05:44<32:30, 108.37s/it]Task 0, Epoch 3/20 => Loss 0.515, Train_accy 84.51:  15%|█▌        | 3/20 [05:44<32:28, 114.60s/it]Task 0, Epoch 4/20 => Loss 0.465, Train_accy 85.93:  15%|█▌        | 3/20 [07:38<32:28, 114.60s/it]Task 0, Epoch 4/20 => Loss 0.465, Train_accy 85.93:  20%|██        | 4/20 [07:38<30:27, 114.25s/it]Task 0, Epoch 5/20 => Loss 0.429, Train_accy 87.08:  20%|██        | 4/20 [09:29<30:27, 114.25s/it]Task 0, Epoch 5/20 => Loss 0.429, Train_accy 87.08:  25%|██▌       | 5/20 [09:29<28:20, 113.35s/it]Task 0, Epoch 6/20 => Loss 0.408, Train_accy 87.57:  25%|██▌       | 5/20 [11:20<28:20, 113.35s/it]Task 0, Epoch 6/20 => Loss 0.408, Train_accy 87.57:  30%|███       | 6/20 [11:20<26:14, 112.43s/it]Task 0, Epoch 7/20 => Loss 0.395, Train_accy 88.19:  30%|███       | 6/20 [13:10<26:14, 112.43s/it]Task 0, Epoch 7/20 => Loss 0.395, Train_accy 88.19:  35%|███▌      | 7/20 [13:10<24:13, 111.77s/it]Task 0, Epoch 8/20 => Loss 0.375, Train_accy 88.68:  35%|███▌      | 7/20 [15:01<24:13, 111.77s/it]Task 0, Epoch 8/20 => Loss 0.375, Train_accy 88.68:  40%|████      | 8/20 [15:01<22:18, 111.53s/it]Task 0, Epoch 9/20 => Loss 0.358, Train_accy 89.10:  40%|████      | 8/20 [17:12<22:18, 111.53s/it]Task 0, Epoch 9/20 => Loss 0.358, Train_accy 89.10:  45%|████▌     | 9/20 [17:12<21:31, 117.39s/it]Task 0, Epoch 10/20 => Loss 0.347, Train_accy 89.41:  45%|████▌     | 9/20 [19:38<21:31, 117.39s/it]Task 0, Epoch 10/20 => Loss 0.347, Train_accy 89.41:  50%|█████     | 10/20 [19:38<21:03, 126.40s/it]Task 0, Epoch 11/20 => Loss 0.332, Train_accy 90.11:  50%|█████     | 10/20 [22:05<21:03, 126.40s/it]Task 0, Epoch 11/20 => Loss 0.332, Train_accy 90.11:  55%|█████▌    | 11/20 [22:05<19:52, 132.46s/it]Task 0, Epoch 12/20 => Loss 0.327, Train_accy 90.15:  55%|█████▌    | 11/20 [24:31<19:52, 132.46s/it]Task 0, Epoch 12/20 => Loss 0.327, Train_accy 90.15:  60%|██████    | 12/20 [24:31<18:13, 136.65s/it]Task 0, Epoch 13/20 => Loss 0.314, Train_accy 90.57:  60%|██████    | 12/20 [26:40<18:13, 136.65s/it]Task 0, Epoch 13/20 => Loss 0.314, Train_accy 90.57:  65%|██████▌   | 13/20 [26:40<15:39, 134.28s/it]Task 0, Epoch 14/20 => Loss 0.297, Train_accy 91.31:  65%|██████▌   | 13/20 [28:29<15:39, 134.28s/it]Task 0, Epoch 14/20 => Loss 0.297, Train_accy 91.31:  70%|███████   | 14/20 [28:29<12:40, 126.76s/it]Task 0, Epoch 15/20 => Loss 0.296, Train_accy 91.23:  70%|███████   | 14/20 [30:20<12:40, 126.76s/it]Task 0, Epoch 15/20 => Loss 0.296, Train_accy 91.23:  75%|███████▌  | 15/20 [30:20<10:10, 122.13s/it]Task 0, Epoch 16/20 => Loss 0.286, Train_accy 91.59:  75%|███████▌  | 15/20 [32:11<10:10, 122.13s/it]Task 0, Epoch 16/20 => Loss 0.286, Train_accy 91.59:  80%|████████  | 16/20 [32:11<07:54, 118.68s/it]Task 0, Epoch 17/20 => Loss 0.275, Train_accy 91.93:  80%|████████  | 16/20 [34:01<07:54, 118.68s/it]Task 0, Epoch 17/20 => Loss 0.275, Train_accy 91.93:  85%|████████▌ | 17/20 [34:01<05:48, 116.13s/it]Task 0, Epoch 18/20 => Loss 0.274, Train_accy 91.85:  85%|████████▌ | 17/20 [35:55<05:48, 116.13s/it]Task 0, Epoch 18/20 => Loss 0.274, Train_accy 91.85:  90%|█████████ | 18/20 [35:55<03:50, 115.32s/it]Task 0, Epoch 19/20 => Loss 0.283, Train_accy 91.51:  90%|█████████ | 18/20 [38:22<03:50, 115.32s/it]Task 0, Epoch 19/20 => Loss 0.283, Train_accy 91.51:  95%|█████████▌| 19/20 [38:22<02:04, 124.84s/it]Task 0, Epoch 20/20 => Loss 0.272, Train_accy 91.88:  95%|█████████▌| 19/20 [40:48<02:04, 124.84s/it]Task 0, Epoch 20/20 => Loss 0.272, Train_accy 91.88: 100%|██████████| 20/20 [40:48<00:00, 131.18s/it]Task 0, Epoch 20/20 => Loss 0.272, Train_accy 91.88: 100%|██████████| 20/20 [40:48<00:00, 122.41s/it]
2024-04-22 22:52:45,010 [loramoeinc.py] => Task 0, Epoch 20/20 => Loss 0.272, Train_accy 91.88
2024-04-22 22:56:33,696 [trainer.py] => No NME accuracy.
2024-04-22 22:56:33,697 [trainer.py] => CNN: {'total': 92.49, '00-59': 92.49, 'old': 0, 'new': 92.49}
2024-04-22 22:56:33,697 [trainer.py] => Route: {'total': 87.57, '00-59': 87.57, 'old': 0, 'new': 87.57}
2024-04-22 22:56:33,697 [trainer.py] => CNN top1 curve: [92.49]
2024-04-22 22:56:33,697 [trainer.py] => CNN top5 curve: [99.17]
2024-04-22 22:56:33,697 [trainer.py] => Route top1 curve: [87.57]
2024-04-22 22:56:33,697 [trainer.py] => Route top5 curve: [98.0]

Average Accuracy (CNN): 92.49
Average Accuracy (Route): 87.57
2024-04-22 22:56:33,697 [trainer.py] => Average Accuracy (CNN): 92.49
2024-04-22 22:56:33,697 [trainer.py] => Average Accuracy (Route): 87.57

2024-04-22 22:56:33,697 [trainer.py] => Train Time: 2448.15
2024-04-22 22:56:33,697 [trainer.py] => Test Time: 0 

2024-04-22 22:56:33,699 [trainer.py] => All params: 86098298
2024-04-22 22:56:33,700 [trainer.py] => Trainable params: 212065
2024-04-22 22:56:33,777 [loramoeinc.py] => Learning on 60-120
  0%|          | 0/20 [00:00<?, ?it/s]Task 1, Epoch 1/20 => Loss 2.510, Train_accy 39.41:   0%|          | 0/20 [01:51<?, ?it/s]Task 1, Epoch 1/20 => Loss 2.510, Train_accy 39.41:   5%|▌         | 1/20 [01:51<35:21, 111.68s/it]Task 1, Epoch 2/20 => Loss 2.076, Train_accy 45.58:   5%|▌         | 1/20 [03:41<35:21, 111.68s/it]Task 1, Epoch 2/20 => Loss 2.076, Train_accy 45.58:  10%|█         | 2/20 [03:41<33:14, 110.80s/it]Task 1, Epoch 3/20 => Loss 1.990, Train_accy 46.75:  10%|█         | 2/20 [05:32<33:14, 110.80s/it]Task 1, Epoch 3/20 => Loss 1.990, Train_accy 46.75:  15%|█▌        | 3/20 [05:32<31:19, 110.54s/it]Task 1, Epoch 4/20 => Loss 1.954, Train_accy 47.82:  15%|█▌        | 3/20 [07:21<31:19, 110.54s/it]Task 1, Epoch 4/20 => Loss 1.954, Train_accy 47.82:  20%|██        | 4/20 [07:21<29:23, 110.22s/it]Task 1, Epoch 5/20 => Loss 1.920, Train_accy 48.28:  20%|██        | 4/20 [09:11<29:23, 110.22s/it]Task 1, Epoch 5/20 => Loss 1.920, Train_accy 48.28:  25%|██▌       | 5/20 [09:11<27:31, 110.12s/it]Task 1, Epoch 6/20 => Loss 1.919, Train_accy 48.56:  25%|██▌       | 5/20 [11:35<27:31, 110.12s/it]Task 1, Epoch 6/20 => Loss 1.919, Train_accy 48.56:  30%|███       | 6/20 [11:35<28:19, 121.38s/it]Task 1, Epoch 7/20 => Loss 1.886, Train_accy 49.47:  30%|███       | 6/20 [14:00<28:19, 121.38s/it]Task 1, Epoch 7/20 => Loss 1.886, Train_accy 49.47:  35%|███▌      | 7/20 [14:00<28:02, 129.41s/it]Task 1, Epoch 8/20 => Loss 1.862, Train_accy 49.88:  35%|███▌      | 7/20 [16:26<28:02, 129.41s/it]Task 1, Epoch 8/20 => Loss 1.862, Train_accy 49.88:  40%|████      | 8/20 [16:26<26:56, 134.69s/it]Task 1, Epoch 9/20 => Loss 1.850, Train_accy 50.17:  40%|████      | 8/20 [18:52<26:56, 134.69s/it]Task 1, Epoch 9/20 => Loss 1.850, Train_accy 50.17:  45%|████▌     | 9/20 [18:52<25:19, 138.11s/it]Task 1, Epoch 10/20 => Loss 1.830, Train_accy 50.39:  45%|████▌     | 9/20 [20:46<25:19, 138.11s/it]Task 1, Epoch 10/20 => Loss 1.830, Train_accy 50.39:  50%|█████     | 10/20 [20:46<21:47, 130.75s/it]Task 1, Epoch 11/20 => Loss 1.823, Train_accy 50.58:  50%|█████     | 10/20 [22:36<21:47, 130.75s/it]Task 1, Epoch 11/20 => Loss 1.823, Train_accy 50.58:  55%|█████▌    | 11/20 [22:36<18:37, 124.17s/it]Task 1, Epoch 12/20 => Loss 1.810, Train_accy 51.06:  55%|█████▌    | 11/20 [24:26<18:37, 124.17s/it]Task 1, Epoch 12/20 => Loss 1.810, Train_accy 51.06:  60%|██████    | 12/20 [24:26<15:59, 119.90s/it]Task 1, Epoch 13/20 => Loss 1.783, Train_accy 51.69:  60%|██████    | 12/20 [26:15<15:59, 119.90s/it]Task 1, Epoch 13/20 => Loss 1.783, Train_accy 51.69:  65%|██████▌   | 13/20 [26:15<13:37, 116.78s/it]Task 1, Epoch 14/20 => Loss 1.776, Train_accy 51.74:  65%|██████▌   | 13/20 [28:06<13:37, 116.78s/it]Task 1, Epoch 14/20 => Loss 1.776, Train_accy 51.74:  70%|███████   | 14/20 [28:06<11:28, 114.81s/it]Task 1, Epoch 15/20 => Loss 1.760, Train_accy 52.14:  70%|███████   | 14/20 [30:11<11:28, 114.81s/it]Task 1, Epoch 15/20 => Loss 1.760, Train_accy 52.14:  75%|███████▌  | 15/20 [30:11<09:49, 117.92s/it]Task 1, Epoch 16/20 => Loss 1.743, Train_accy 52.50:  75%|███████▌  | 15/20 [32:36<09:49, 117.92s/it]Task 1, Epoch 16/20 => Loss 1.743, Train_accy 52.50:  80%|████████  | 16/20 [32:36<08:24, 126.16s/it]Task 1, Epoch 17/20 => Loss 1.736, Train_accy 52.51:  80%|████████  | 16/20 [35:02<08:24, 126.16s/it]Task 1, Epoch 17/20 => Loss 1.736, Train_accy 52.51:  85%|████████▌ | 17/20 [35:02<06:36, 132.06s/it]Task 1, Epoch 18/20 => Loss 1.729, Train_accy 52.58:  85%|████████▌ | 17/20 [37:28<06:36, 132.06s/it]Task 1, Epoch 18/20 => Loss 1.729, Train_accy 52.58:  90%|█████████ | 18/20 [37:28<04:32, 136.23s/it]Task 1, Epoch 19/20 => Loss 1.718, Train_accy 53.00:  90%|█████████ | 18/20 [39:41<04:32, 136.23s/it]Task 1, Epoch 19/20 => Loss 1.718, Train_accy 53.00:  95%|█████████▌| 19/20 [39:41<02:15, 135.28s/it]Task 1, Epoch 20/20 => Loss 1.723, Train_accy 52.83:  95%|█████████▌| 19/20 [41:31<02:15, 135.28s/it]Task 1, Epoch 20/20 => Loss 1.723, Train_accy 52.83: 100%|██████████| 20/20 [41:31<00:00, 127.76s/it]Task 1, Epoch 20/20 => Loss 1.723, Train_accy 52.83: 100%|██████████| 20/20 [41:31<00:00, 124.58s/it]
2024-04-22 23:38:05,374 [loramoeinc.py] => Task 1, Epoch 20/20 => Loss 1.723, Train_accy 52.83
2024-04-22 23:41:23,739 [trainer.py] => No NME accuracy.
2024-04-22 23:41:23,740 [trainer.py] => CNN: {'total': 89.69, '00-59': 92.49, '60-119': 86.87, 'old': 92.49, 'new': 86.87}
2024-04-22 23:41:23,740 [trainer.py] => Route: {'total': 81.42, '00-59': 81.9, '60-119': 80.94, 'old': 81.9, 'new': 80.94}
2024-04-22 23:41:23,740 [trainer.py] => CNN top1 curve: [92.49, 89.69]
2024-04-22 23:41:23,740 [trainer.py] => CNN top5 curve: [99.17, 98.46]
2024-04-22 23:41:23,740 [trainer.py] => Route top1 curve: [87.57, 81.42]
2024-04-22 23:41:23,740 [trainer.py] => Route top5 curve: [98.0, 95.87]

Average Accuracy (CNN): 91.09
Average Accuracy (Route): 84.495
2024-04-22 23:41:23,740 [trainer.py] => Average Accuracy (CNN): 91.09
2024-04-22 23:41:23,740 [trainer.py] => Average Accuracy (Route): 84.495

2024-04-22 23:41:23,740 [trainer.py] => Train Time: 4939.6900000000005
2024-04-22 23:41:23,740 [trainer.py] => Test Time: 0 

2024-04-22 23:41:23,741 [trainer.py] => All params: 86190458
2024-04-22 23:41:23,742 [trainer.py] => Trainable params: 216649
2024-04-22 23:41:23,821 [loramoeinc.py] => Learning on 120-180
  0%|          | 0/20 [00:00<?, ?it/s]Task 2, Epoch 1/20 => Loss 2.690, Train_accy 37.22:   0%|          | 0/20 [02:18<?, ?it/s]Task 2, Epoch 1/20 => Loss 2.690, Train_accy 37.22:   5%|▌         | 1/20 [02:18<43:57, 138.82s/it]Task 2, Epoch 2/20 => Loss 2.274, Train_accy 42.98:   5%|▌         | 1/20 [04:44<43:57, 138.82s/it]Task 2, Epoch 2/20 => Loss 2.274, Train_accy 42.98:  10%|█         | 2/20 [04:44<42:56, 143.12s/it]Task 2, Epoch 3/20 => Loss 2.184, Train_accy 44.79:  10%|█         | 2/20 [07:13<42:56, 143.12s/it]Task 2, Epoch 3/20 => Loss 2.184, Train_accy 44.79:  15%|█▌        | 3/20 [07:13<41:14, 145.54s/it]Task 2, Epoch 4/20 => Loss 2.151, Train_accy 45.79:  15%|█▌        | 3/20 [09:41<41:14, 145.54s/it]Task 2, Epoch 4/20 => Loss 2.151, Train_accy 45.79:  20%|██        | 4/20 [09:41<39:03, 146.44s/it]Task 2, Epoch 5/20 => Loss 2.127, Train_accy 46.04:  20%|██        | 4/20 [11:42<39:03, 146.44s/it]Task 2, Epoch 5/20 => Loss 2.127, Train_accy 46.04:  25%|██▌       | 5/20 [11:42<34:19, 137.31s/it]Task 2, Epoch 6/20 => Loss 2.117, Train_accy 46.27:  25%|██▌       | 5/20 [13:34<34:19, 137.31s/it]Task 2, Epoch 6/20 => Loss 2.117, Train_accy 46.27:  30%|███       | 6/20 [13:34<30:02, 128.72s/it]Task 2, Epoch 7/20 => Loss 2.073, Train_accy 46.99:  30%|███       | 6/20 [15:24<30:02, 128.72s/it]Task 2, Epoch 7/20 => Loss 2.073, Train_accy 46.99:  35%|███▌      | 7/20 [15:24<26:32, 122.49s/it]Task 2, Epoch 8/20 => Loss 2.059, Train_accy 47.24:  35%|███▌      | 7/20 [17:15<26:32, 122.49s/it]Task 2, Epoch 8/20 => Loss 2.059, Train_accy 47.24:  40%|████      | 8/20 [17:15<23:47, 119.00s/it]Task 2, Epoch 9/20 => Loss 2.045, Train_accy 47.54:  40%|████      | 8/20 [19:06<23:47, 119.00s/it]Task 2, Epoch 9/20 => Loss 2.045, Train_accy 47.54:  45%|████▌     | 9/20 [19:06<21:20, 116.41s/it]Task 2, Epoch 10/20 => Loss 2.025, Train_accy 47.70:  45%|████▌     | 9/20 [21:10<21:20, 116.41s/it]Task 2, Epoch 10/20 => Loss 2.025, Train_accy 47.70:  50%|█████     | 10/20 [21:10<19:49, 118.97s/it]Task 2, Epoch 11/20 => Loss 2.015, Train_accy 47.95:  50%|█████     | 10/20 [23:37<19:49, 118.97s/it]Task 2, Epoch 11/20 => Loss 2.015, Train_accy 47.95:  55%|█████▌    | 11/20 [23:37<19:05, 127.27s/it]Task 2, Epoch 12/20 => Loss 1.997, Train_accy 48.11:  55%|█████▌    | 11/20 [26:03<19:05, 127.27s/it]Task 2, Epoch 12/20 => Loss 1.997, Train_accy 48.11:  60%|██████    | 12/20 [26:03<17:44, 133.06s/it]Task 2, Epoch 13/20 => Loss 1.989, Train_accy 48.37:  60%|██████    | 12/20 [28:29<17:44, 133.06s/it]Task 2, Epoch 13/20 => Loss 1.989, Train_accy 48.37:  65%|██████▌   | 13/20 [28:29<16:00, 137.17s/it]Task 2, Epoch 14/20 => Loss 1.977, Train_accy 48.56:  65%|██████▌   | 13/20 [30:43<16:00, 137.17s/it]Task 2, Epoch 14/20 => Loss 1.977, Train_accy 48.56:  70%|███████   | 14/20 [30:43<13:35, 135.97s/it]Task 2, Epoch 15/20 => Loss 1.961, Train_accy 48.47:  70%|███████   | 14/20 [32:33<13:35, 135.97s/it]Task 2, Epoch 15/20 => Loss 1.961, Train_accy 48.47:  75%|███████▌  | 15/20 [32:33<10:41, 128.21s/it]Task 2, Epoch 16/20 => Loss 1.955, Train_accy 49.05:  75%|███████▌  | 15/20 [34:24<10:41, 128.21s/it]Task 2, Epoch 16/20 => Loss 1.955, Train_accy 49.05:  80%|████████  | 16/20 [34:24<08:12, 123.10s/it]Task 2, Epoch 17/20 => Loss 1.941, Train_accy 48.99:  80%|████████  | 16/20 [36:14<08:12, 123.10s/it]Task 2, Epoch 17/20 => Loss 1.941, Train_accy 48.99:  85%|████████▌ | 17/20 [36:14<05:57, 119.23s/it]Task 2, Epoch 18/20 => Loss 1.931, Train_accy 49.22:  85%|████████▌ | 17/20 [38:04<05:57, 119.23s/it]Task 2, Epoch 18/20 => Loss 1.931, Train_accy 49.22:  90%|█████████ | 18/20 [38:04<03:52, 116.39s/it]Task 2, Epoch 19/20 => Loss 1.923, Train_accy 49.48:  90%|█████████ | 18/20 [39:55<03:52, 116.39s/it]Task 2, Epoch 19/20 => Loss 1.923, Train_accy 49.48:  95%|█████████▌| 19/20 [39:55<01:54, 114.65s/it]Task 2, Epoch 20/20 => Loss 1.924, Train_accy 49.39:  95%|█████████▌| 19/20 [42:20<01:54, 114.65s/it]Task 2, Epoch 20/20 => Loss 1.924, Train_accy 49.39: 100%|██████████| 20/20 [42:20<00:00, 123.84s/it]Task 2, Epoch 20/20 => Loss 1.924, Train_accy 49.39: 100%|██████████| 20/20 [42:20<00:00, 127.03s/it]
2024-04-23 00:23:44,392 [loramoeinc.py] => Task 2, Epoch 20/20 => Loss 1.924, Train_accy 49.39
2024-04-23 00:27:50,240 [trainer.py] => No NME accuracy.
2024-04-23 00:27:50,240 [trainer.py] => CNN: {'total': 89.31, '00-59': 92.49, '60-119': 86.87, '120-179': 88.55, 'old': 89.69, 'new': 88.55}
2024-04-23 00:27:50,240 [trainer.py] => Route: {'total': 76.73, '00-59': 76.81, '60-119': 76.59, '120-179': 76.78, 'old': 76.7, 'new': 76.78}
2024-04-23 00:27:50,240 [trainer.py] => CNN top1 curve: [92.49, 89.69, 89.31]
2024-04-23 00:27:50,240 [trainer.py] => CNN top5 curve: [99.17, 98.46, 98.05]
2024-04-23 00:27:50,240 [trainer.py] => Route top1 curve: [87.57, 81.42, 76.73]
2024-04-23 00:27:50,240 [trainer.py] => Route top5 curve: [98.0, 95.87, 93.26]

Average Accuracy (CNN): 90.49666666666667
Average Accuracy (Route): 81.90666666666668
2024-04-23 00:27:50,240 [trainer.py] => Average Accuracy (CNN): 90.49666666666667
2024-04-23 00:27:50,241 [trainer.py] => Average Accuracy (Route): 81.90666666666668

2024-04-23 00:27:50,241 [trainer.py] => Train Time: 7480.210000000001
2024-04-23 00:27:50,241 [trainer.py] => Test Time: 0 

2024-04-23 00:27:50,242 [trainer.py] => All params: 86282618
2024-04-23 00:27:50,243 [trainer.py] => Trainable params: 221233
2024-04-23 00:27:50,333 [loramoeinc.py] => Learning on 180-240
  0%|          | 0/20 [00:00<?, ?it/s]Task 3, Epoch 1/20 => Loss 2.591, Train_accy 35.09:   0%|          | 0/20 [02:21<?, ?it/s]Task 3, Epoch 1/20 => Loss 2.591, Train_accy 35.09:   5%|▌         | 1/20 [02:21<44:57, 141.96s/it]Task 3, Epoch 2/20 => Loss 2.260, Train_accy 39.69:   5%|▌         | 1/20 [04:14<44:57, 141.96s/it]Task 3, Epoch 2/20 => Loss 2.260, Train_accy 39.69:  10%|█         | 2/20 [04:14<37:24, 124.67s/it]Task 3, Epoch 3/20 => Loss 2.201, Train_accy 40.70:  10%|█         | 2/20 [06:06<37:24, 124.67s/it]Task 3, Epoch 3/20 => Loss 2.201, Train_accy 40.70:  15%|█▌        | 3/20 [06:06<33:39, 118.79s/it]Task 3, Epoch 4/20 => Loss 2.142, Train_accy 42.13:  15%|█▌        | 3/20 [07:58<33:39, 118.79s/it]Task 3, Epoch 4/20 => Loss 2.142, Train_accy 42.13:  20%|██        | 4/20 [07:58<30:58, 116.19s/it]Task 3, Epoch 5/20 => Loss 2.123, Train_accy 42.70:  20%|██        | 4/20 [09:49<30:58, 116.19s/it]Task 3, Epoch 5/20 => Loss 2.123, Train_accy 42.70:  25%|██▌       | 5/20 [09:49<28:33, 114.22s/it]Task 3, Epoch 6/20 => Loss 2.106, Train_accy 43.09:  25%|██▌       | 5/20 [11:41<28:33, 114.22s/it]Task 3, Epoch 6/20 => Loss 2.106, Train_accy 43.09:  30%|███       | 6/20 [11:41<26:30, 113.58s/it]Task 3, Epoch 7/20 => Loss 2.078, Train_accy 43.43:  30%|███       | 6/20 [14:03<26:30, 113.58s/it]Task 3, Epoch 7/20 => Loss 2.078, Train_accy 43.43:  35%|███▌      | 7/20 [14:03<26:37, 122.86s/it]Task 3, Epoch 8/20 => Loss 2.072, Train_accy 43.85:  35%|███▌      | 7/20 [16:31<26:37, 122.86s/it]Task 3, Epoch 8/20 => Loss 2.072, Train_accy 43.85:  40%|████      | 8/20 [16:31<26:10, 130.92s/it]Task 3, Epoch 9/20 => Loss 2.054, Train_accy 44.21:  40%|████      | 8/20 [19:00<26:10, 130.92s/it]Task 3, Epoch 9/20 => Loss 2.054, Train_accy 44.21:  45%|████▌     | 9/20 [19:00<25:00, 136.38s/it]Task 3, Epoch 10/20 => Loss 2.023, Train_accy 44.94:  45%|████▌     | 9/20 [21:28<25:00, 136.38s/it]Task 3, Epoch 10/20 => Loss 2.023, Train_accy 44.94:  50%|█████     | 10/20 [21:28<23:21, 140.14s/it]Task 3, Epoch 11/20 => Loss 2.025, Train_accy 45.01:  50%|█████     | 10/20 [23:23<23:21, 140.14s/it]Task 3, Epoch 11/20 => Loss 2.025, Train_accy 45.01:  55%|█████▌    | 11/20 [23:23<19:51, 132.42s/it]Task 3, Epoch 12/20 => Loss 1.993, Train_accy 45.50:  55%|█████▌    | 11/20 [25:15<19:51, 132.42s/it]Task 3, Epoch 12/20 => Loss 1.993, Train_accy 45.50:  60%|██████    | 12/20 [25:15<16:49, 126.19s/it]Task 3, Epoch 13/20 => Loss 1.988, Train_accy 45.65:  60%|██████    | 12/20 [27:07<16:49, 126.19s/it]Task 3, Epoch 13/20 => Loss 1.988, Train_accy 45.65:  65%|██████▌   | 13/20 [27:07<14:13, 121.86s/it]Task 3, Epoch 14/20 => Loss 1.966, Train_accy 46.26:  65%|██████▌   | 13/20 [28:59<14:13, 121.86s/it]Task 3, Epoch 14/20 => Loss 1.966, Train_accy 46.26:  70%|███████   | 14/20 [28:59<11:52, 118.77s/it]Task 3, Epoch 15/20 => Loss 1.954, Train_accy 46.41:  70%|███████   | 14/20 [30:49<11:52, 118.77s/it]Task 3, Epoch 15/20 => Loss 1.954, Train_accy 46.41:  75%|███████▌  | 15/20 [30:49<09:41, 116.36s/it]Task 3, Epoch 16/20 => Loss 1.938, Train_accy 46.74:  75%|███████▌  | 15/20 [33:00<09:41, 116.36s/it]Task 3, Epoch 16/20 => Loss 1.938, Train_accy 46.74:  80%|████████  | 16/20 [33:00<08:02, 120.69s/it]Task 3, Epoch 17/20 => Loss 1.935, Train_accy 46.77:  80%|████████  | 16/20 [35:28<08:02, 120.69s/it]Task 3, Epoch 17/20 => Loss 1.935, Train_accy 46.77:  85%|████████▌ | 17/20 [35:28<06:26, 128.86s/it]Task 3, Epoch 18/20 => Loss 1.933, Train_accy 47.04:  85%|████████▌ | 17/20 [37:56<06:26, 128.86s/it]Task 3, Epoch 18/20 => Loss 1.933, Train_accy 47.04:  90%|█████████ | 18/20 [37:56<04:29, 134.60s/it]Task 3, Epoch 19/20 => Loss 1.924, Train_accy 46.87:  90%|█████████ | 18/20 [40:24<04:29, 134.60s/it]Task 3, Epoch 19/20 => Loss 1.924, Train_accy 46.87:  95%|█████████▌| 19/20 [40:24<02:18, 138.69s/it]Task 3, Epoch 20/20 => Loss 1.923, Train_accy 47.34:  95%|█████████▌| 19/20 [42:32<02:18, 138.69s/it]Task 3, Epoch 20/20 => Loss 1.923, Train_accy 47.34: 100%|██████████| 20/20 [42:32<00:00, 135.33s/it]Task 3, Epoch 20/20 => Loss 1.923, Train_accy 47.34: 100%|██████████| 20/20 [42:32<00:00, 127.61s/it]
2024-04-23 01:10:22,520 [loramoeinc.py] => Task 3, Epoch 20/20 => Loss 1.923, Train_accy 47.34
2024-04-23 01:13:53,921 [trainer.py] => No NME accuracy.
2024-04-23 01:13:53,921 [trainer.py] => CNN: {'total': 88.07, '00-59': 92.41, '60-119': 86.87, '120-179': 88.55, '180-239': 84.45, 'old': 89.28, 'new': 84.45}
2024-04-23 01:13:53,922 [trainer.py] => Route: {'total': 74.12, '00-59': 75.06, '60-119': 73.58, '120-179': 74.69, '180-239': 73.16, 'old': 74.44, 'new': 73.16}
2024-04-23 01:13:53,922 [trainer.py] => CNN top1 curve: [92.49, 89.69, 89.31, 88.07]
2024-04-23 01:13:53,922 [trainer.py] => CNN top5 curve: [99.17, 98.46, 98.05, 97.66]
2024-04-23 01:13:53,922 [trainer.py] => Route top1 curve: [87.57, 81.42, 76.73, 74.12]
2024-04-23 01:13:53,922 [trainer.py] => Route top5 curve: [98.0, 95.87, 93.26, 91.21]

Average Accuracy (CNN): 89.89
Average Accuracy (Route): 79.96000000000001
2024-04-23 01:13:53,922 [trainer.py] => Average Accuracy (CNN): 89.89
2024-04-23 01:13:53,922 [trainer.py] => Average Accuracy (Route): 79.96000000000001

2024-04-23 01:13:53,922 [trainer.py] => Train Time: 10032.34
2024-04-23 01:13:53,922 [trainer.py] => Test Time: 0 

2024-04-23 01:13:53,923 [trainer.py] => All params: 86374778
2024-04-23 01:13:53,924 [trainer.py] => Trainable params: 225817
2024-04-23 01:13:53,977 [loramoeinc.py] => Learning on 240-300
  0%|          | 0/20 [00:00<?, ?it/s]Task 4, Epoch 1/20 => Loss 2.343, Train_accy 45.26:   0%|          | 0/20 [01:49<?, ?it/s]Task 4, Epoch 1/20 => Loss 2.343, Train_accy 45.26:   5%|▌         | 1/20 [01:49<34:46, 109.84s/it]Task 4, Epoch 2/20 => Loss 1.889, Train_accy 52.00:   5%|▌         | 1/20 [04:09<34:46, 109.84s/it]Task 4, Epoch 2/20 => Loss 1.889, Train_accy 52.00:  10%|█         | 2/20 [04:09<38:17, 127.65s/it]Task 4, Epoch 3/20 => Loss 1.814, Train_accy 53.34:  10%|█         | 2/20 [06:35<38:17, 127.65s/it]Task 4, Epoch 3/20 => Loss 1.814, Train_accy 53.34:  15%|█▌        | 3/20 [06:35<38:25, 135.61s/it]Task 4, Epoch 4/20 => Loss 1.793, Train_accy 53.69:  15%|█▌        | 3/20 [09:00<38:25, 135.61s/it]Task 4, Epoch 4/20 => Loss 1.793, Train_accy 53.69:  20%|██        | 4/20 [09:00<37:11, 139.45s/it]Task 4, Epoch 5/20 => Loss 1.761, Train_accy 54.43:  20%|██        | 4/20 [11:26<37:11, 139.45s/it]Task 4, Epoch 5/20 => Loss 1.761, Train_accy 54.43:  25%|██▌       | 5/20 [11:26<35:26, 141.76s/it]Task 4, Epoch 6/20 => Loss 1.730, Train_accy 54.87:  25%|██▌       | 5/20 [13:21<35:26, 141.76s/it]Task 4, Epoch 6/20 => Loss 1.730, Train_accy 54.87:  30%|███       | 6/20 [13:21<30:59, 132.84s/it]Task 4, Epoch 7/20 => Loss 1.731, Train_accy 55.01:  30%|███       | 6/20 [15:11<30:59, 132.84s/it]Task 4, Epoch 7/20 => Loss 1.731, Train_accy 55.01:  35%|███▌      | 7/20 [15:11<27:08, 125.29s/it]Task 4, Epoch 8/20 => Loss 1.708, Train_accy 55.29:  35%|███▌      | 7/20 [16:59<27:08, 125.29s/it]Task 4, Epoch 8/20 => Loss 1.708, Train_accy 55.29:  40%|████      | 8/20 [16:59<23:57, 119.78s/it]Task 4, Epoch 9/20 => Loss 1.692, Train_accy 55.59:  40%|████      | 8/20 [18:49<23:57, 119.78s/it]Task 4, Epoch 9/20 => Loss 1.692, Train_accy 55.59:  45%|████▌     | 9/20 [18:49<21:25, 116.86s/it]Task 4, Epoch 10/20 => Loss 1.671, Train_accy 55.96:  45%|████▌     | 9/20 [20:38<21:25, 116.86s/it]Task 4, Epoch 10/20 => Loss 1.671, Train_accy 55.96:  50%|█████     | 10/20 [20:38<19:04, 114.44s/it]Task 4, Epoch 11/20 => Loss 1.660, Train_accy 55.85:  50%|█████     | 10/20 [22:42<19:04, 114.44s/it]Task 4, Epoch 11/20 => Loss 1.660, Train_accy 55.85:  55%|█████▌    | 11/20 [22:42<17:34, 117.15s/it]Task 4, Epoch 12/20 => Loss 1.649, Train_accy 56.35:  55%|█████▌    | 11/20 [25:07<17:34, 117.15s/it]Task 4, Epoch 12/20 => Loss 1.649, Train_accy 56.35:  60%|██████    | 12/20 [25:07<16:46, 125.84s/it]Task 4, Epoch 13/20 => Loss 1.626, Train_accy 56.49:  60%|██████    | 12/20 [27:32<16:46, 125.84s/it]Task 4, Epoch 13/20 => Loss 1.626, Train_accy 56.49:  65%|██████▌   | 13/20 [27:32<15:20, 131.57s/it]Task 4, Epoch 14/20 => Loss 1.620, Train_accy 56.65:  65%|██████▌   | 13/20 [29:57<15:20, 131.57s/it]Task 4, Epoch 14/20 => Loss 1.620, Train_accy 56.65:  70%|███████   | 14/20 [29:57<13:32, 135.46s/it]Task 4, Epoch 15/20 => Loss 1.617, Train_accy 56.70:  70%|███████   | 14/20 [32:10<13:32, 135.46s/it]Task 4, Epoch 15/20 => Loss 1.617, Train_accy 56.70:  75%|███████▌  | 15/20 [32:10<11:14, 134.94s/it]Task 4, Epoch 16/20 => Loss 1.607, Train_accy 56.72:  75%|███████▌  | 15/20 [33:59<11:14, 134.94s/it]Task 4, Epoch 16/20 => Loss 1.607, Train_accy 56.72:  80%|████████  | 16/20 [33:59<08:28, 127.08s/it]Task 4, Epoch 17/20 => Loss 1.596, Train_accy 56.95:  80%|████████  | 16/20 [35:49<08:28, 127.08s/it]Task 4, Epoch 17/20 => Loss 1.596, Train_accy 56.95:  85%|████████▌ | 17/20 [35:49<06:05, 121.98s/it]Task 4, Epoch 18/20 => Loss 1.592, Train_accy 57.03:  85%|████████▌ | 17/20 [37:38<06:05, 121.98s/it]Task 4, Epoch 18/20 => Loss 1.592, Train_accy 57.03:  90%|█████████ | 18/20 [37:38<03:56, 118.04s/it]Task 4, Epoch 19/20 => Loss 1.584, Train_accy 57.26:  90%|█████████ | 18/20 [39:27<03:56, 118.04s/it]Task 4, Epoch 19/20 => Loss 1.584, Train_accy 57.26:  95%|█████████▌| 19/20 [39:27<01:55, 115.31s/it]Task 4, Epoch 20/20 => Loss 1.583, Train_accy 57.16:  95%|█████████▌| 19/20 [41:16<01:55, 115.31s/it]Task 4, Epoch 20/20 => Loss 1.583, Train_accy 57.16: 100%|██████████| 20/20 [41:16<00:00, 113.37s/it]Task 4, Epoch 20/20 => Loss 1.583, Train_accy 57.16: 100%|██████████| 20/20 [41:16<00:00, 123.83s/it]
2024-04-23 01:55:10,566 [loramoeinc.py] => Task 4, Epoch 20/20 => Loss 1.583, Train_accy 57.16
2024-04-23 01:59:36,026 [trainer.py] => No NME accuracy.
2024-04-23 01:59:36,027 [trainer.py] => CNN: {'total': 88.32, '00-59': 92.41, '60-119': 86.87, '120-179': 88.55, '180-239': 84.45, '240-299': 89.31, 'old': 88.07, 'new': 89.31}
2024-04-23 01:59:36,027 [trainer.py] => Route: {'total': 73.3, '00-59': 74.23, '60-119': 71.15, '120-179': 71.85, '180-239': 72.07, '240-299': 77.19, 'old': 72.33, 'new': 77.19}
2024-04-23 01:59:36,027 [trainer.py] => CNN top1 curve: [92.49, 89.69, 89.31, 88.07, 88.32]
2024-04-23 01:59:36,027 [trainer.py] => CNN top5 curve: [99.17, 98.46, 98.05, 97.66, 97.61]
2024-04-23 01:59:36,027 [trainer.py] => Route top1 curve: [87.57, 81.42, 76.73, 74.12, 73.3]
2024-04-23 01:59:36,027 [trainer.py] => Route top5 curve: [98.0, 95.87, 93.26, 91.21, 91.45]

Average Accuracy (CNN): 89.576
Average Accuracy (Route): 78.62800000000001
2024-04-23 01:59:36,027 [trainer.py] => Average Accuracy (CNN): 89.576
2024-04-23 01:59:36,027 [trainer.py] => Average Accuracy (Route): 78.62800000000001

2024-04-23 01:59:36,027 [trainer.py] => Train Time: 12508.87
2024-04-23 01:59:36,027 [trainer.py] => Test Time: 0 

