nohup: 忽略输入
2024-04-18 16:45:56,130 [trainer.py] => config: ./exps/finetune_inr.json
2024-04-18 16:45:56,130 [trainer.py] => prefix: reproduce
2024-04-18 16:45:56,130 [trainer.py] => dataset: imagenetr
2024-04-18 16:45:56,130 [trainer.py] => memory_size: 0
2024-04-18 16:45:56,130 [trainer.py] => memory_per_class: 0
2024-04-18 16:45:56,130 [trainer.py] => fixed_memory: False
2024-04-18 16:45:56,130 [trainer.py] => shuffle: True
2024-04-18 16:45:56,130 [trainer.py] => init_cls: 40
2024-04-18 16:45:56,130 [trainer.py] => increment: 40
2024-04-18 16:45:56,130 [trainer.py] => model_name: finetune
2024-04-18 16:45:56,130 [trainer.py] => backbone_type: vit_base_patch16_224
2024-04-18 16:45:56,130 [trainer.py] => device: [device(type='cuda', index=4)]
2024-04-18 16:45:56,130 [trainer.py] => seed: 1993
2024-04-18 16:45:56,130 [trainer.py] => init_epoch: 20
2024-04-18 16:45:56,130 [trainer.py] => init_lr: 0.001
2024-04-18 16:45:56,130 [trainer.py] => init_milestones: [60, 120, 170]
2024-04-18 16:45:56,130 [trainer.py] => init_lr_decay: 0.1
2024-04-18 16:45:56,130 [trainer.py] => init_weight_decay: 0.0005
2024-04-18 16:45:56,130 [trainer.py] => epochs: 20
2024-04-18 16:45:56,130 [trainer.py] => lrate: 0.001
2024-04-18 16:45:56,130 [trainer.py] => milestones: [40, 70]
2024-04-18 16:45:56,130 [trainer.py] => lrate_decay: 0.1
2024-04-18 16:45:56,131 [trainer.py] => batch_size: 48
2024-04-18 16:45:56,131 [trainer.py] => weight_decay: 0.0002
2024-04-18 16:45:57,161 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-04-18 16:46:00,688 [trainer.py] => All params: 85798656
2024-04-18 16:46:00,689 [trainer.py] => Trainable params: 85798656
2024-04-18 16:46:00,690 [finetune.py] => Learning on 0-40
  0%|          | 0/20 [00:00<?, ?it/s]Task 0, Epoch 1/20 => Loss 2.086, Train_accy 49.76, Test_accy 81.30:   0%|          | 0/20 [00:42<?, ?it/s]Task 0, Epoch 1/20 => Loss 2.086, Train_accy 49.76, Test_accy 81.30:   5%|▌         | 1/20 [00:42<13:35, 42.92s/it]Task 0, Epoch 2/20 => Loss 0.836, Train_accy 78.14:   5%|▌         | 1/20 [01:18<13:35, 42.92s/it]                 Task 0, Epoch 2/20 => Loss 0.836, Train_accy 78.14:  10%|█         | 2/20 [01:18<11:36, 38.68s/it]Task 0, Epoch 3/20 => Loss 0.649, Train_accy 82.31:  10%|█         | 2/20 [01:54<11:36, 38.68s/it]Task 0, Epoch 3/20 => Loss 0.649, Train_accy 82.31:  15%|█▌        | 3/20 [01:54<10:38, 37.53s/it]Task 0, Epoch 4/20 => Loss 0.551, Train_accy 85.07:  15%|█▌        | 3/20 [02:31<10:38, 37.53s/it]Task 0, Epoch 4/20 => Loss 0.551, Train_accy 85.07:  20%|██        | 4/20 [02:31<09:52, 37.06s/it]Task 0, Epoch 5/20 => Loss 0.506, Train_accy 86.64:  20%|██        | 4/20 [03:07<09:52, 37.06s/it]Task 0, Epoch 5/20 => Loss 0.506, Train_accy 86.64:  25%|██▌       | 5/20 [03:07<09:11, 36.78s/it]Task 0, Epoch 6/20 => Loss 0.459, Train_accy 87.31, Test_accy 90.16:  25%|██▌       | 5/20 [03:47<09:11, 36.78s/it]Task 0, Epoch 6/20 => Loss 0.459, Train_accy 87.31, Test_accy 90.16:  30%|███       | 6/20 [03:47<08:49, 37.81s/it]Task 0, Epoch 7/20 => Loss 0.424, Train_accy 89.10:  30%|███       | 6/20 [04:23<08:49, 37.81s/it]                 Task 0, Epoch 7/20 => Loss 0.424, Train_accy 89.10:  35%|███▌      | 7/20 [04:23<08:03, 37.22s/it]Task 0, Epoch 8/20 => Loss 0.382, Train_accy 89.28:  35%|███▌      | 7/20 [04:59<08:03, 37.22s/it]Task 0, Epoch 8/20 => Loss 0.382, Train_accy 89.28:  40%|████      | 8/20 [04:59<07:22, 36.86s/it]Task 0, Epoch 9/20 => Loss 0.349, Train_accy 90.57:  40%|████      | 8/20 [05:35<07:22, 36.86s/it]Task 0, Epoch 9/20 => Loss 0.349, Train_accy 90.57:  45%|████▌     | 9/20 [05:35<06:42, 36.61s/it]Task 0, Epoch 10/20 => Loss 0.350, Train_accy 90.46:  45%|████▌     | 9/20 [06:11<06:42, 36.61s/it]Task 0, Epoch 10/20 => Loss 0.350, Train_accy 90.46:  50%|█████     | 10/20 [06:11<06:04, 36.45s/it]Task 0, Epoch 11/20 => Loss 0.363, Train_accy 90.01, Test_accy 90.84:  50%|█████     | 10/20 [06:51<06:04, 36.45s/it]Task 0, Epoch 11/20 => Loss 0.363, Train_accy 90.01, Test_accy 90.84:  55%|█████▌    | 11/20 [06:51<05:38, 37.58s/it]Task 0, Epoch 12/20 => Loss 0.318, Train_accy 91.39:  55%|█████▌    | 11/20 [07:27<05:38, 37.58s/it]                 Task 0, Epoch 12/20 => Loss 0.318, Train_accy 91.39:  60%|██████    | 12/20 [07:27<04:56, 37.12s/it]Task 0, Epoch 13/20 => Loss 0.325, Train_accy 91.39:  60%|██████    | 12/20 [08:03<04:56, 37.12s/it]Task 0, Epoch 13/20 => Loss 0.325, Train_accy 91.39:  65%|██████▌   | 13/20 [08:03<04:17, 36.86s/it]Task 0, Epoch 14/20 => Loss 0.316, Train_accy 91.45:  65%|██████▌   | 13/20 [08:39<04:17, 36.86s/it]Task 0, Epoch 14/20 => Loss 0.316, Train_accy 91.45:  70%|███████   | 14/20 [08:39<03:39, 36.61s/it]Task 0, Epoch 15/20 => Loss 0.315, Train_accy 91.58:  70%|███████   | 14/20 [09:16<03:39, 36.61s/it]Task 0, Epoch 15/20 => Loss 0.315, Train_accy 91.58:  75%|███████▌  | 15/20 [09:16<03:02, 36.52s/it]Task 0, Epoch 16/20 => Loss 0.303, Train_accy 91.78, Test_accy 90.61:  75%|███████▌  | 15/20 [09:56<03:02, 36.52s/it]Task 0, Epoch 16/20 => Loss 0.303, Train_accy 91.78, Test_accy 90.61:  80%|████████  | 16/20 [09:56<02:30, 37.61s/it]Task 0, Epoch 17/20 => Loss 0.281, Train_accy 92.34:  80%|████████  | 16/20 [10:32<02:30, 37.61s/it]                 Task 0, Epoch 17/20 => Loss 0.281, Train_accy 92.34:  85%|████████▌ | 17/20 [10:32<01:51, 37.13s/it]Task 0, Epoch 18/20 => Loss 0.269, Train_accy 92.69:  85%|████████▌ | 17/20 [11:08<01:51, 37.13s/it]Task 0, Epoch 18/20 => Loss 0.269, Train_accy 92.69:  90%|█████████ | 18/20 [11:08<01:13, 36.82s/it]Task 0, Epoch 19/20 => Loss 0.280, Train_accy 92.51:  90%|█████████ | 18/20 [11:44<01:13, 36.82s/it]Task 0, Epoch 19/20 => Loss 0.280, Train_accy 92.51:  95%|█████████▌| 19/20 [11:44<00:36, 36.64s/it]Task 0, Epoch 20/20 => Loss 0.281, Train_accy 92.19:  95%|█████████▌| 19/20 [12:20<00:36, 36.64s/it]Task 0, Epoch 20/20 => Loss 0.281, Train_accy 92.19: 100%|██████████| 20/20 [12:20<00:00, 36.48s/it]Task 0, Epoch 20/20 => Loss 0.281, Train_accy 92.19: 100%|██████████| 20/20 [12:20<00:00, 37.04s/it]
Traceback (most recent call last):
  File "/home/team/zhaohongwei/Code/Research/CIL/LAMDA-PILOT/main.py", line 25, in <module>
    main()
  File "/home/team/zhaohongwei/Code/Research/CIL/LAMDA-PILOT/main.py", line 11, in main
    train(args)
  File "/home/team/zhaohongwei/Code/Research/CIL/LAMDA-PILOT/trainer.py", line 19, in train
    _train(args)
  File "/home/team/zhaohongwei/Code/Research/CIL/LAMDA-PILOT/trainer.py", line 73, in _train
    model.incremental_train(data_manager)
  File "/home/team/zhaohongwei/Code/Research/CIL/LAMDA-PILOT/models/finetune.py", line 53, in incremental_train
    self._train(self.train_loader, self.test_loader)
  File "/home/team/zhaohongwei/Code/Research/CIL/LAMDA-PILOT/models/finetune.py", line 69, in _train
    self._init_train(train_loader, test_loader, optimizer, scheduler)
  File "/home/team/zhaohongwei/Code/Research/CIL/LAMDA-PILOT/models/finetune.py", line 127, in _init_train
    self.train_time += round(total_time, 2)
AttributeError: 'Learner' object has no attribute 'train_time'
2024-04-18 16:58:24,940 [trainer.py] => config: ./exps/simplecil_inr.json
2024-04-18 16:58:24,940 [trainer.py] => prefix:  
2024-04-18 16:58:24,940 [trainer.py] => dataset: imagenetr
2024-04-18 16:58:24,940 [trainer.py] => memory_size: 0
2024-04-18 16:58:24,940 [trainer.py] => memory_per_class: 0
2024-04-18 16:58:24,940 [trainer.py] => fixed_memory: False
2024-04-18 16:58:24,940 [trainer.py] => shuffle: True
2024-04-18 16:58:24,940 [trainer.py] => init_cls: 40
2024-04-18 16:58:24,940 [trainer.py] => increment: 40
2024-04-18 16:58:24,940 [trainer.py] => model_name: simplecil
2024-04-18 16:58:24,940 [trainer.py] => backbone_type: pretrained_vit_b16_224
2024-04-18 16:58:24,940 [trainer.py] => device: [device(type='cuda', index=4)]
2024-04-18 16:58:24,940 [trainer.py] => seed: 1993
2024-04-18 16:58:24,941 [trainer.py] => tuned_epoch: 0
2024-04-18 16:58:24,941 [trainer.py] => init_lr: 0.01
2024-04-18 16:58:24,941 [trainer.py] => batch_size: 256
2024-04-18 16:58:24,941 [trainer.py] => weight_decay: 0.05
2024-04-18 16:58:24,941 [trainer.py] => min_lr: 1e-08
2024-04-18 16:58:24,941 [trainer.py] => optimizer: sgd
2024-04-18 16:58:24,941 [trainer.py] => vpt_type: shallow
2024-04-18 16:58:24,941 [trainer.py] => prompt_token_num: 3
2024-04-18 16:58:25,023 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
This is for the BaseNet initialization.
After BaseNet initialization.
2024-04-18 16:58:28,080 [trainer.py] => All params: 85798656
2024-04-18 16:58:28,081 [trainer.py] => Trainable params: 85798656
2024-04-18 16:58:28,483 [simplecil.py] => Learning on 0-40
Traceback (most recent call last):
  File "/home/team/zhaohongwei/Code/Research/CIL/LAMDA-PILOT/main.py", line 25, in <module>
    main()
  File "/home/team/zhaohongwei/Code/Research/CIL/LAMDA-PILOT/main.py", line 11, in main
    train(args)
  File "/home/team/zhaohongwei/Code/Research/CIL/LAMDA-PILOT/trainer.py", line 19, in train
    _train(args)
  File "/home/team/zhaohongwei/Code/Research/CIL/LAMDA-PILOT/trainer.py", line 73, in _train
    model.incremental_train(data_manager)
  File "/home/team/zhaohongwei/Code/Research/CIL/LAMDA-PILOT/models/simplecil.py", line 74, in incremental_train
    self._train(self.train_loader, self.test_loader, self.train_loader_for_protonet)
  File "/home/team/zhaohongwei/Code/Research/CIL/LAMDA-PILOT/models/simplecil.py", line 82, in _train
    self.train_time += round(total_time, 2)
AttributeError: 'Learner' object has no attribute 'train_time'
2024-04-18 16:58:31,308 [trainer.py] => config: ./exps/der_inr.json
2024-04-18 16:58:31,309 [trainer.py] => prefix: reproduce
2024-04-18 16:58:31,309 [trainer.py] => dataset: imagenetr
2024-04-18 16:58:31,309 [trainer.py] => memory_size: 4000
2024-04-18 16:58:31,309 [trainer.py] => memory_per_class: 20
2024-04-18 16:58:31,309 [trainer.py] => fixed_memory: True
2024-04-18 16:58:31,309 [trainer.py] => shuffle: True
2024-04-18 16:58:31,309 [trainer.py] => init_cls: 40
2024-04-18 16:58:31,309 [trainer.py] => increment: 40
2024-04-18 16:58:31,309 [trainer.py] => model_name: der
2024-04-18 16:58:31,309 [trainer.py] => backbone_type: vit_base_patch16_224
2024-04-18 16:58:31,309 [trainer.py] => device: [device(type='cuda', index=4)]
2024-04-18 16:58:31,309 [trainer.py] => seed: 1993
2024-04-18 16:58:31,309 [trainer.py] => init_epoch: 20
2024-04-18 16:58:31,309 [trainer.py] => init_lr: 0.001
2024-04-18 16:58:31,309 [trainer.py] => init_milestones: [60, 120, 170]
2024-04-18 16:58:31,309 [trainer.py] => init_lr_decay: 0.1
2024-04-18 16:58:31,309 [trainer.py] => init_weight_decay: 0.0005
2024-04-18 16:58:31,309 [trainer.py] => epochs: 20
2024-04-18 16:58:31,309 [trainer.py] => lrate: 0.001
2024-04-18 16:58:31,309 [trainer.py] => milestones: [80, 120, 150]
2024-04-18 16:58:31,309 [trainer.py] => lrate_decay: 0.1
2024-04-18 16:58:31,309 [trainer.py] => batch_size: 48
2024-04-18 16:58:31,309 [trainer.py] => weight_decay: 0.0002
2024-04-18 16:58:31,309 [trainer.py] => T: 2
2024-04-18 16:58:31,393 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-04-18 16:58:31,801 [trainer.py] => All params: 0
2024-04-18 16:58:31,801 [trainer.py] => Trainable params: 0
2024-04-18 16:58:33,742 [der.py] => Learning on 0-40
2024-04-18 16:58:33,742 [der.py] => All params: 85860945
2024-04-18 16:58:33,743 [der.py] => Trainable params: 85860945
  0%|          | 0/20 [00:00<?, ?it/s]Task 0, Epoch 1/20 => Loss 2.058, Train_accy 49.46, Test_accy 83.95:   0%|          | 0/20 [00:40<?, ?it/s]Task 0, Epoch 1/20 => Loss 2.058, Train_accy 49.46, Test_accy 83.95:   5%|▌         | 1/20 [00:40<12:42, 40.15s/it]Task 0, Epoch 2/20 => Loss 0.800, Train_accy 78.62:   5%|▌         | 1/20 [01:16<12:42, 40.15s/it]                 Task 0, Epoch 2/20 => Loss 0.800, Train_accy 78.62:  10%|█         | 2/20 [01:16<11:21, 37.85s/it]Task 0, Epoch 3/20 => Loss 0.654, Train_accy 82.22:  10%|█         | 2/20 [01:52<11:21, 37.85s/it]Task 0, Epoch 3/20 => Loss 0.654, Train_accy 82.22:  15%|█▌        | 3/20 [01:52<10:30, 37.12s/it]Task 0, Epoch 4/20 => Loss 0.562, Train_accy 85.00:  15%|█▌        | 3/20 [02:29<10:30, 37.12s/it]Task 0, Epoch 4/20 => Loss 0.562, Train_accy 85.00:  20%|██        | 4/20 [02:29<09:49, 36.82s/it]Task 0, Epoch 5/20 => Loss 0.506, Train_accy 86.45:  20%|██        | 4/20 [03:05<09:49, 36.82s/it]Task 0, Epoch 5/20 => Loss 0.506, Train_accy 86.45:  25%|██▌       | 5/20 [03:05<09:08, 36.58s/it]Task 0, Epoch 6/20 => Loss 0.469, Train_accy 87.48, Test_accy 88.27:  25%|██▌       | 5/20 [03:45<09:08, 36.58s/it]Task 0, Epoch 6/20 => Loss 0.469, Train_accy 87.48, Test_accy 88.27:  30%|███       | 6/20 [03:45<08:48, 37.77s/it]Task 0, Epoch 7/20 => Loss 0.425, Train_accy 88.56:  30%|███       | 6/20 [04:21<08:48, 37.77s/it]                 Task 0, Epoch 7/20 => Loss 0.425, Train_accy 88.56:  35%|███▌      | 7/20 [04:21<08:04, 37.30s/it]Task 0, Epoch 8/20 => Loss 0.398, Train_accy 89.38:  35%|███▌      | 7/20 [04:57<08:04, 37.30s/it]Task 0, Epoch 8/20 => Loss 0.398, Train_accy 89.38:  40%|████      | 8/20 [04:57<07:23, 36.99s/it]Task 0, Epoch 9/20 => Loss 0.400, Train_accy 89.43:  40%|████      | 8/20 [05:33<07:23, 36.99s/it]Task 0, Epoch 9/20 => Loss 0.400, Train_accy 89.43:  45%|████▌     | 9/20 [05:33<06:43, 36.71s/it]Task 0, Epoch 10/20 => Loss 0.378, Train_accy 89.69:  45%|████▌     | 9/20 [06:09<06:43, 36.71s/it]Task 0, Epoch 10/20 => Loss 0.378, Train_accy 89.69:  50%|█████     | 10/20 [06:09<06:04, 36.47s/it]Task 0, Epoch 11/20 => Loss 0.369, Train_accy 89.94, Test_accy 90.23:  50%|█████     | 10/20 [06:49<06:04, 36.47s/it]Task 0, Epoch 11/20 => Loss 0.369, Train_accy 89.94, Test_accy 90.23:  55%|█████▌    | 11/20 [06:49<05:37, 37.55s/it]Task 0, Epoch 12/20 => Loss 0.328, Train_accy 90.81:  55%|█████▌    | 11/20 [07:26<05:37, 37.55s/it]                 Task 0, Epoch 12/20 => Loss 0.328, Train_accy 90.81:  60%|██████    | 12/20 [07:26<04:57, 37.20s/it]Task 0, Epoch 13/20 => Loss 0.331, Train_accy 90.94:  60%|██████    | 12/20 [08:02<04:57, 37.20s/it]Task 0, Epoch 13/20 => Loss 0.331, Train_accy 90.94:  65%|██████▌   | 13/20 [08:02<04:18, 36.86s/it]Task 0, Epoch 14/20 => Loss 0.314, Train_accy 91.07:  65%|██████▌   | 13/20 [08:38<04:18, 36.86s/it]Task 0, Epoch 14/20 => Loss 0.314, Train_accy 91.07:  70%|███████   | 14/20 [08:38<03:40, 36.68s/it]Task 0, Epoch 15/20 => Loss 0.297, Train_accy 91.39:  70%|███████   | 14/20 [09:14<03:40, 36.68s/it]Task 0, Epoch 15/20 => Loss 0.297, Train_accy 91.39:  75%|███████▌  | 15/20 [09:14<03:02, 36.47s/it]Task 0, Epoch 16/20 => Loss 0.334, Train_accy 90.72, Test_accy 90.16:  75%|███████▌  | 15/20 [09:54<03:02, 36.47s/it]Task 0, Epoch 16/20 => Loss 0.334, Train_accy 90.72, Test_accy 90.16:  80%|████████  | 16/20 [09:54<02:30, 37.53s/it]Task 0, Epoch 17/20 => Loss 0.272, Train_accy 92.32:  80%|████████  | 16/20 [10:30<02:30, 37.53s/it]                 Task 0, Epoch 17/20 => Loss 0.272, Train_accy 92.32:  85%|████████▌ | 17/20 [10:30<01:51, 37.13s/it]Task 0, Epoch 18/20 => Loss 0.302, Train_accy 91.48:  85%|████████▌ | 17/20 [11:06<01:51, 37.13s/it]Task 0, Epoch 18/20 => Loss 0.302, Train_accy 91.48:  90%|█████████ | 18/20 [11:06<01:13, 36.80s/it]Task 0, Epoch 19/20 => Loss 0.281, Train_accy 92.45:  90%|█████████ | 18/20 [11:42<01:13, 36.80s/it]Task 0, Epoch 19/20 => Loss 0.281, Train_accy 92.45:  95%|█████████▌| 19/20 [11:42<00:36, 36.60s/it]Task 0, Epoch 20/20 => Loss 0.268, Train_accy 92.71:  95%|█████████▌| 19/20 [12:19<00:36, 36.60s/it]Task 0, Epoch 20/20 => Loss 0.268, Train_accy 92.71: 100%|██████████| 20/20 [12:19<00:00, 36.46s/it]Task 0, Epoch 20/20 => Loss 0.268, Train_accy 92.71: 100%|██████████| 20/20 [12:19<00:00, 36.96s/it]
2024-04-18 17:10:53,365 [der.py] => Task 0, Epoch 20/20 => Loss 0.268, Train_accy 92.71
2024-04-18 17:10:53,367 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-18 17:11:52,888 [der.py] => Exemplar size: 800
2024-04-18 17:11:52,888 [trainer.py] => CNN: {'total': 88.8, '00-39': 88.8, 'old': 0, 'new': 88.8}
2024-04-18 17:11:52,888 [trainer.py] => NME: {'total': 90.76, '00-39': 90.76, 'old': 0, 'new': 90.76}
2024-04-18 17:11:52,888 [trainer.py] => CNN top1 curve: [88.8]
2024-04-18 17:11:52,888 [trainer.py] => CNN top5 curve: [96.97]
2024-04-18 17:11:52,888 [trainer.py] => NME top1 curve: [90.76]
2024-04-18 17:11:52,888 [trainer.py] => NME top5 curve: [97.88]

Average Accuracy (CNN): 88.8
Average Accuracy (NME): 90.76
2024-04-18 17:11:52,889 [trainer.py] => Average Accuracy (CNN): 88.8
2024-04-18 17:11:52,889 [trainer.py] => Average Accuracy (NME): 90.76
2024-04-18 17:11:52,889 [trainer.py] => Train Time: 739.62
2024-04-18 17:11:52,889 [trainer.py] => Test Time: 7.62 

2024-04-18 17:11:52,889 [trainer.py] => All params: 85860945
2024-04-18 17:11:52,890 [trainer.py] => Trainable params: 85860945
2024-04-18 17:11:54,834 [der.py] => Learning on 40-80
2024-04-18 17:11:54,835 [der.py] => All params: 171751801
2024-04-18 17:11:54,836 [der.py] => Trainable params: 85953145
  0%|          | 0/20 [00:00<?, ?it/s]Task 1, Epoch 1/20 => Loss 4.191, Loss_clf 2.182, Loss_aux 2.008, Train_accy 52.61, Test_accy 75.70:   0%|          | 0/20 [01:04<?, ?it/s]Task 1, Epoch 1/20 => Loss 4.191, Loss_clf 2.182, Loss_aux 2.008, Train_accy 52.61, Test_accy 75.70:   5%|▌         | 1/20 [01:04<20:21, 64.28s/it]Task 1, Epoch 2/20 => Loss 1.912, Loss_clf 0.949, Loss_aux 0.964, Train_accy 75.07:   5%|▌         | 1/20 [01:54<20:21, 64.28s/it]                 Task 1, Epoch 2/20 => Loss 1.912, Loss_clf 0.949, Loss_aux 0.964, Train_accy 75.07:  10%|█         | 2/20 [01:54<16:46, 55.91s/it]Task 1, Epoch 3/20 => Loss 1.621, Loss_clf 0.789, Loss_aux 0.832, Train_accy 79.78:  10%|█         | 2/20 [02:43<16:46, 55.91s/it]Task 1, Epoch 3/20 => Loss 1.621, Loss_clf 0.789, Loss_aux 0.832, Train_accy 79.78:  15%|█▌        | 3/20 [02:43<14:59, 52.89s/it]Task 1, Epoch 4/20 => Loss 1.381, Loss_clf 0.678, Loss_aux 0.703, Train_accy 82.25:  15%|█▌        | 3/20 [03:32<14:59, 52.89s/it]Task 1, Epoch 4/20 => Loss 1.381, Loss_clf 0.678, Loss_aux 0.703, Train_accy 82.25:  20%|██        | 4/20 [03:32<13:43, 51.46s/it]Task 1, Epoch 5/20 => Loss 1.308, Loss_clf 0.640, Loss_aux 0.668, Train_accy 83.06:  20%|██        | 4/20 [04:22<13:43, 51.46s/it]Task 1, Epoch 5/20 => Loss 1.308, Loss_clf 0.640, Loss_aux 0.668, Train_accy 83.06:  25%|██▌       | 5/20 [04:22<12:39, 50.66s/it]Task 1, Epoch 6/20 => Loss 1.119, Loss_clf 0.538, Loss_aux 0.580, Train_accy 85.67, Test_accy 81.59:  25%|██▌       | 5/20 [05:24<12:39, 50.66s/it]Task 1, Epoch 6/20 => Loss 1.119, Loss_clf 0.538, Loss_aux 0.580, Train_accy 85.67, Test_accy 81.59:  30%|███       | 6/20 [05:24<12:45, 54.65s/it]Task 1, Epoch 7/20 => Loss 1.059, Loss_clf 0.523, Loss_aux 0.536, Train_accy 86.57:  30%|███       | 6/20 [06:13<12:45, 54.65s/it]                 Task 1, Epoch 7/20 => Loss 1.059, Loss_clf 0.523, Loss_aux 0.536, Train_accy 86.57:  35%|███▌      | 7/20 [06:13<11:26, 52.82s/it]Task 1, Epoch 8/20 => Loss 0.987, Loss_clf 0.485, Loss_aux 0.502, Train_accy 87.40:  35%|███▌      | 7/20 [07:02<11:26, 52.82s/it]Task 1, Epoch 8/20 => Loss 0.987, Loss_clf 0.485, Loss_aux 0.502, Train_accy 87.40:  40%|████      | 8/20 [07:02<10:20, 51.68s/it]Task 1, Epoch 9/20 => Loss 0.955, Loss_clf 0.465, Loss_aux 0.489, Train_accy 87.95:  40%|████      | 8/20 [07:52<10:20, 51.68s/it]Task 1, Epoch 9/20 => Loss 0.955, Loss_clf 0.465, Loss_aux 0.489, Train_accy 87.95:  45%|████▌     | 9/20 [07:52<09:20, 50.93s/it]Task 1, Epoch 10/20 => Loss 0.889, Loss_clf 0.437, Loss_aux 0.453, Train_accy 88.15:  45%|████▌     | 9/20 [08:41<09:20, 50.93s/it]Task 1, Epoch 10/20 => Loss 0.889, Loss_clf 0.437, Loss_aux 0.453, Train_accy 88.15:  50%|█████     | 10/20 [08:41<08:23, 50.34s/it]Task 1, Epoch 11/20 => Loss 0.868, Loss_clf 0.429, Loss_aux 0.439, Train_accy 89.18, Test_accy 81.14:  50%|█████     | 10/20 [09:43<08:23, 50.34s/it]Task 1, Epoch 11/20 => Loss 0.868, Loss_clf 0.429, Loss_aux 0.439, Train_accy 89.18, Test_accy 81.14:  55%|█████▌    | 11/20 [09:43<08:05, 53.92s/it]Task 1, Epoch 12/20 => Loss 0.863, Loss_clf 0.431, Loss_aux 0.432, Train_accy 88.54:  55%|█████▌    | 11/20 [10:32<08:05, 53.92s/it]                 Task 1, Epoch 12/20 => Loss 0.863, Loss_clf 0.431, Loss_aux 0.432, Train_accy 88.54:  60%|██████    | 12/20 [10:32<07:00, 52.52s/it]Task 1, Epoch 13/20 => Loss 0.864, Loss_clf 0.428, Loss_aux 0.436, Train_accy 89.31:  60%|██████    | 12/20 [11:21<07:00, 52.52s/it]Task 1, Epoch 13/20 => Loss 0.864, Loss_clf 0.428, Loss_aux 0.436, Train_accy 89.31:  65%|██████▌   | 13/20 [11:21<06:00, 51.47s/it]Task 1, Epoch 14/20 => Loss 0.755, Loss_clf 0.374, Loss_aux 0.381, Train_accy 90.05:  65%|██████▌   | 13/20 [12:10<06:00, 51.47s/it]Task 1, Epoch 14/20 => Loss 0.755, Loss_clf 0.374, Loss_aux 0.381, Train_accy 90.05:  70%|███████   | 14/20 [12:10<05:04, 50.79s/it]Task 1, Epoch 15/20 => Loss 0.804, Loss_clf 0.395, Loss_aux 0.409, Train_accy 89.75:  70%|███████   | 14/20 [13:00<05:04, 50.79s/it]Task 1, Epoch 15/20 => Loss 0.804, Loss_clf 0.395, Loss_aux 0.409, Train_accy 89.75:  75%|███████▌  | 15/20 [13:00<04:12, 50.41s/it]Task 1, Epoch 16/20 => Loss 0.706, Loss_clf 0.346, Loss_aux 0.360, Train_accy 91.06, Test_accy 81.47:  75%|███████▌  | 15/20 [14:02<04:12, 50.41s/it]Task 1, Epoch 16/20 => Loss 0.706, Loss_clf 0.346, Loss_aux 0.360, Train_accy 91.06, Test_accy 81.47:  80%|████████  | 16/20 [14:02<03:35, 53.88s/it]Task 1, Epoch 17/20 => Loss 0.765, Loss_clf 0.377, Loss_aux 0.389, Train_accy 89.85:  80%|████████  | 16/20 [14:51<03:35, 53.88s/it]                 Task 1, Epoch 17/20 => Loss 0.765, Loss_clf 0.377, Loss_aux 0.389, Train_accy 89.85:  85%|████████▌ | 17/20 [14:51<02:37, 52.53s/it]Task 1, Epoch 18/20 => Loss 0.767, Loss_clf 0.383, Loss_aux 0.383, Train_accy 90.34:  85%|████████▌ | 17/20 [15:41<02:37, 52.53s/it]Task 1, Epoch 18/20 => Loss 0.767, Loss_clf 0.383, Loss_aux 0.383, Train_accy 90.34:  90%|█████████ | 18/20 [15:41<01:43, 51.59s/it]Task 1, Epoch 19/20 => Loss 0.715, Loss_clf 0.360, Loss_aux 0.355, Train_accy 90.64:  90%|█████████ | 18/20 [16:30<01:43, 51.59s/it]Task 1, Epoch 19/20 => Loss 0.715, Loss_clf 0.360, Loss_aux 0.355, Train_accy 90.64:  95%|█████████▌| 19/20 [16:30<00:50, 50.88s/it]Task 1, Epoch 20/20 => Loss 0.675, Loss_clf 0.335, Loss_aux 0.340, Train_accy 91.28:  95%|█████████▌| 19/20 [17:19<00:50, 50.88s/it]Task 1, Epoch 20/20 => Loss 0.675, Loss_clf 0.335, Loss_aux 0.340, Train_accy 91.28: 100%|██████████| 20/20 [17:19<00:00, 50.41s/it]Task 1, Epoch 20/20 => Loss 0.675, Loss_clf 0.335, Loss_aux 0.340, Train_accy 91.28: 100%|██████████| 20/20 [17:19<00:00, 51.98s/it]
2024-04-18 17:29:14,439 [der.py] => Task 1, Epoch 20/20 => Loss 0.675, Loss_clf 0.335, Loss_aux 0.340, Train_accy 91.28
2024-04-18 17:29:14,440 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-18 17:31:03,764 [der.py] => Exemplar size: 1600
2024-04-18 17:31:03,764 [trainer.py] => CNN: {'total': 82.51, '00-39': 79.94, '40-79': 85.39, 'old': 79.94, 'new': 85.39}
2024-04-18 17:31:03,764 [trainer.py] => NME: {'total': 84.87, '00-39': 86.37, '40-79': 83.18, 'old': 86.37, 'new': 83.18}
2024-04-18 17:31:03,764 [trainer.py] => CNN top1 curve: [88.8, 82.51]
2024-04-18 17:31:03,764 [trainer.py] => CNN top5 curve: [96.97, 93.23]
2024-04-18 17:31:03,764 [trainer.py] => NME top1 curve: [90.76, 84.87]
2024-04-18 17:31:03,764 [trainer.py] => NME top5 curve: [97.88, 95.04]

Average Accuracy (CNN): 85.655
Average Accuracy (NME): 87.815
2024-04-18 17:31:03,764 [trainer.py] => Average Accuracy (CNN): 85.655
2024-04-18 17:31:03,764 [trainer.py] => Average Accuracy (NME): 87.815
2024-04-18 17:31:03,764 [trainer.py] => Train Time: 1779.2199999999998
2024-04-18 17:31:03,764 [trainer.py] => Test Time: 33.269999999999996 

2024-04-18 17:31:03,766 [trainer.py] => All params: 171751801
2024-04-18 17:31:03,767 [trainer.py] => Trainable params: 85953145
2024-04-18 17:31:39,586 [der.py] => Learning on 80-120
2024-04-18 17:31:39,592 [der.py] => All params: 257704097
2024-04-18 17:31:39,594 [der.py] => Trainable params: 86106785
  0%|          | 0/20 [00:00<?, ?it/s]Task 2, Epoch 1/20 => Loss 3.917, Loss_clf 2.058, Loss_aux 1.859, Train_accy 57.86, Test_accy 72.59:   0%|          | 0/20 [01:40<?, ?it/s]Task 2, Epoch 1/20 => Loss 3.917, Loss_clf 2.058, Loss_aux 1.859, Train_accy 57.86, Test_accy 72.59:   5%|▌         | 1/20 [01:40<31:55, 100.83s/it]Task 2, Epoch 2/20 => Loss 1.871, Loss_clf 0.926, Loss_aux 0.945, Train_accy 75.64:   5%|▌         | 1/20 [02:54<31:55, 100.83s/it]                 Task 2, Epoch 2/20 => Loss 1.871, Loss_clf 0.926, Loss_aux 0.945, Train_accy 75.64:  10%|█         | 2/20 [02:54<25:22, 84.59s/it] Task 2, Epoch 3/20 => Loss 1.609, Loss_clf 0.809, Loss_aux 0.800, Train_accy 79.60:  10%|█         | 2/20 [04:07<25:22, 84.59s/it]Task 2, Epoch 3/20 => Loss 1.609, Loss_clf 0.809, Loss_aux 0.800, Train_accy 79.60:  15%|█▌        | 3/20 [04:07<22:30, 79.43s/it]Task 2, Epoch 4/20 => Loss 1.372, Loss_clf 0.681, Loss_aux 0.691, Train_accy 81.86:  15%|█▌        | 3/20 [05:20<22:30, 79.43s/it]Task 2, Epoch 4/20 => Loss 1.372, Loss_clf 0.681, Loss_aux 0.691, Train_accy 81.86:  20%|██        | 4/20 [05:20<20:30, 76.92s/it]Task 2, Epoch 5/20 => Loss 1.228, Loss_clf 0.627, Loss_aux 0.601, Train_accy 83.73:  20%|██        | 4/20 [06:33<20:30, 76.92s/it]Task 2, Epoch 5/20 => Loss 1.228, Loss_clf 0.627, Loss_aux 0.601, Train_accy 83.73:  25%|██▌       | 5/20 [06:33<18:54, 75.62s/it]Task 2, Epoch 6/20 => Loss 1.205, Loss_clf 0.602, Loss_aux 0.603, Train_accy 84.08, Test_accy 75.17:  25%|██▌       | 5/20 [08:13<18:54, 75.62s/it]Task 2, Epoch 6/20 => Loss 1.205, Loss_clf 0.602, Loss_aux 0.603, Train_accy 84.08, Test_accy 75.17:  30%|███       | 6/20 [08:13<19:35, 83.93s/it]Task 2, Epoch 7/20 => Loss 1.097, Loss_clf 0.550, Loss_aux 0.546, Train_accy 85.56:  30%|███       | 6/20 [09:26<19:35, 83.93s/it]                 Task 2, Epoch 7/20 => Loss 1.097, Loss_clf 0.550, Loss_aux 0.546, Train_accy 85.56:  35%|███▌      | 7/20 [09:26<17:24, 80.38s/it]Task 2, Epoch 8/20 => Loss 1.042, Loss_clf 0.525, Loss_aux 0.517, Train_accy 86.26:  35%|███▌      | 7/20 [10:39<17:24, 80.38s/it]Task 2, Epoch 8/20 => Loss 1.042, Loss_clf 0.525, Loss_aux 0.517, Train_accy 86.26:  40%|████      | 8/20 [10:39<15:36, 78.02s/it]Task 2, Epoch 9/20 => Loss 0.983, Loss_clf 0.498, Loss_aux 0.485, Train_accy 87.45:  40%|████      | 8/20 [11:52<15:36, 78.02s/it]Task 2, Epoch 9/20 => Loss 0.983, Loss_clf 0.498, Loss_aux 0.485, Train_accy 87.45:  45%|████▌     | 9/20 [11:52<14:00, 76.44s/it]Task 2, Epoch 10/20 => Loss 0.944, Loss_clf 0.476, Loss_aux 0.468, Train_accy 88.23:  45%|████▌     | 9/20 [13:06<14:00, 76.44s/it]Task 2, Epoch 10/20 => Loss 0.944, Loss_clf 0.476, Loss_aux 0.468, Train_accy 88.23:  50%|█████     | 10/20 [13:06<12:34, 75.47s/it]Task 2, Epoch 11/20 => Loss 0.857, Loss_clf 0.438, Loss_aux 0.419, Train_accy 88.87, Test_accy 76.38:  50%|█████     | 10/20 [14:46<12:34, 75.47s/it]Task 2, Epoch 11/20 => Loss 0.857, Loss_clf 0.438, Loss_aux 0.419, Train_accy 88.87, Test_accy 76.38:  55%|█████▌    | 11/20 [14:46<12:26, 82.98s/it]Task 2, Epoch 12/20 => Loss 0.855, Loss_clf 0.429, Loss_aux 0.426, Train_accy 88.94:  55%|█████▌    | 11/20 [15:59<12:26, 82.98s/it]                 Task 2, Epoch 12/20 => Loss 0.855, Loss_clf 0.429, Loss_aux 0.426, Train_accy 88.94:  60%|██████    | 12/20 [15:59<10:40, 80.07s/it]Task 2, Epoch 13/20 => Loss 0.784, Loss_clf 0.399, Loss_aux 0.385, Train_accy 89.70:  60%|██████    | 12/20 [17:12<10:40, 80.07s/it]Task 2, Epoch 13/20 => Loss 0.784, Loss_clf 0.399, Loss_aux 0.385, Train_accy 89.70:  65%|██████▌   | 13/20 [17:12<09:06, 78.01s/it]Task 2, Epoch 14/20 => Loss 0.805, Loss_clf 0.412, Loss_aux 0.392, Train_accy 89.57:  65%|██████▌   | 13/20 [18:26<09:06, 78.01s/it]Task 2, Epoch 14/20 => Loss 0.805, Loss_clf 0.412, Loss_aux 0.392, Train_accy 89.57:  70%|███████   | 14/20 [18:26<07:39, 76.59s/it]Task 2, Epoch 15/20 => Loss 0.737, Loss_clf 0.384, Loss_aux 0.354, Train_accy 89.88:  70%|███████   | 14/20 [19:39<07:39, 76.59s/it]Task 2, Epoch 15/20 => Loss 0.737, Loss_clf 0.384, Loss_aux 0.354, Train_accy 89.88:  75%|███████▌  | 15/20 [19:39<06:17, 75.59s/it]Task 2, Epoch 16/20 => Loss 0.764, Loss_clf 0.391, Loss_aux 0.373, Train_accy 89.94, Test_accy 76.63:  75%|███████▌  | 15/20 [21:19<06:17, 75.59s/it]Task 2, Epoch 16/20 => Loss 0.764, Loss_clf 0.391, Loss_aux 0.373, Train_accy 89.94, Test_accy 76.63:  80%|████████  | 16/20 [21:19<05:31, 83.00s/it]Task 2, Epoch 17/20 => Loss 0.714, Loss_clf 0.369, Loss_aux 0.346, Train_accy 90.85:  80%|████████  | 16/20 [22:32<05:31, 83.00s/it]                 Task 2, Epoch 17/20 => Loss 0.714, Loss_clf 0.369, Loss_aux 0.346, Train_accy 90.85:  85%|████████▌ | 17/20 [22:32<04:00, 80.11s/it]Task 2, Epoch 18/20 => Loss 0.705, Loss_clf 0.363, Loss_aux 0.342, Train_accy 90.87:  85%|████████▌ | 17/20 [23:46<04:00, 80.11s/it]Task 2, Epoch 18/20 => Loss 0.705, Loss_clf 0.363, Loss_aux 0.342, Train_accy 90.87:  90%|█████████ | 18/20 [23:46<02:36, 78.12s/it]Task 2, Epoch 19/20 => Loss 0.701, Loss_clf 0.364, Loss_aux 0.337, Train_accy 90.85:  90%|█████████ | 18/20 [24:59<02:36, 78.12s/it]Task 2, Epoch 19/20 => Loss 0.701, Loss_clf 0.364, Loss_aux 0.337, Train_accy 90.85:  95%|█████████▌| 19/20 [24:59<01:16, 76.64s/it]Task 2, Epoch 20/20 => Loss 0.693, Loss_clf 0.368, Loss_aux 0.325, Train_accy 90.70:  95%|█████████▌| 19/20 [26:12<01:16, 76.64s/it]Task 2, Epoch 20/20 => Loss 0.693, Loss_clf 0.368, Loss_aux 0.325, Train_accy 90.70: 100%|██████████| 20/20 [26:12<00:00, 75.58s/it]Task 2, Epoch 20/20 => Loss 0.693, Loss_clf 0.368, Loss_aux 0.325, Train_accy 90.70: 100%|██████████| 20/20 [26:12<00:00, 78.64s/it]
2024-04-18 17:57:52,445 [der.py] => Task 2, Epoch 20/20 => Loss 0.693, Loss_clf 0.368, Loss_aux 0.325, Train_accy 90.70
2024-04-18 17:57:52,447 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-18 18:00:52,241 [der.py] => Exemplar size: 2400
2024-04-18 18:00:52,241 [trainer.py] => CNN: {'total': 76.87, '00-39': 74.72, '40-79': 72.64, '80-119': 83.7, 'old': 73.74, 'new': 83.7}
2024-04-18 18:00:52,241 [trainer.py] => NME: {'total': 81.07, '00-39': 83.65, '40-79': 79.61, '80-119': 79.6, 'old': 81.75, 'new': 79.6}
2024-04-18 18:00:52,241 [trainer.py] => CNN top1 curve: [88.8, 82.51, 76.87]
2024-04-18 18:00:52,241 [trainer.py] => CNN top5 curve: [96.97, 93.23, 90.7]
2024-04-18 18:00:52,241 [trainer.py] => NME top1 curve: [90.76, 84.87, 81.07]
2024-04-18 18:00:52,241 [trainer.py] => NME top5 curve: [97.88, 95.04, 93.2]

Average Accuracy (CNN): 82.72666666666667
Average Accuracy (NME): 85.56666666666666
2024-04-18 18:00:52,241 [trainer.py] => Average Accuracy (CNN): 82.72666666666667
2024-04-18 18:00:52,241 [trainer.py] => Average Accuracy (NME): 85.56666666666666
2024-04-18 18:00:52,242 [trainer.py] => Train Time: 3352.0499999999997
2024-04-18 18:00:52,242 [trainer.py] => Test Time: 87.97 

2024-04-18 18:00:52,243 [trainer.py] => All params: 257704097
2024-04-18 18:00:52,245 [trainer.py] => Trainable params: 86106785
2024-04-18 18:00:54,520 [der.py] => Learning on 120-160
2024-04-18 18:00:54,525 [der.py] => All params: 343717833
2024-04-18 18:00:54,529 [der.py] => Trainable params: 86321865
  0%|          | 0/20 [00:00<?, ?it/s]Task 3, Epoch 1/20 => Loss 3.474, Loss_clf 1.820, Loss_aux 1.654, Train_accy 63.68, Test_accy 71.01:   0%|          | 0/20 [02:31<?, ?it/s]Task 3, Epoch 1/20 => Loss 3.474, Loss_clf 1.820, Loss_aux 1.654, Train_accy 63.68, Test_accy 71.01:   5%|▌         | 1/20 [02:31<47:53, 151.25s/it]Task 3, Epoch 2/20 => Loss 1.695, Loss_clf 0.847, Loss_aux 0.848, Train_accy 78.02:   5%|▌         | 1/20 [04:11<47:53, 151.25s/it]                 Task 3, Epoch 2/20 => Loss 1.695, Loss_clf 0.847, Loss_aux 0.848, Train_accy 78.02:  10%|█         | 2/20 [04:11<36:27, 121.54s/it]Task 3, Epoch 3/20 => Loss 1.400, Loss_clf 0.724, Loss_aux 0.677, Train_accy 81.40:  10%|█         | 2/20 [05:52<36:27, 121.54s/it]Task 3, Epoch 3/20 => Loss 1.400, Loss_clf 0.724, Loss_aux 0.677, Train_accy 81.40:  15%|█▌        | 3/20 [05:52<31:43, 112.00s/it]Task 3, Epoch 4/20 => Loss 1.181, Loss_clf 0.609, Loss_aux 0.572, Train_accy 84.56:  15%|█▌        | 3/20 [07:33<31:43, 112.00s/it]Task 3, Epoch 4/20 => Loss 1.181, Loss_clf 0.609, Loss_aux 0.572, Train_accy 84.56:  20%|██        | 4/20 [07:33<28:38, 107.43s/it]Task 3, Epoch 5/20 => Loss 1.034, Loss_clf 0.531, Loss_aux 0.503, Train_accy 86.43:  20%|██        | 4/20 [09:13<28:38, 107.43s/it]Task 3, Epoch 5/20 => Loss 1.034, Loss_clf 0.531, Loss_aux 0.503, Train_accy 86.43:  25%|██▌       | 5/20 [09:13<26:10, 104.73s/it]Task 3, Epoch 6/20 => Loss 0.988, Loss_clf 0.512, Loss_aux 0.476, Train_accy 86.88, Test_accy 73.50:  25%|██▌       | 5/20 [11:40<26:10, 104.73s/it]Task 3, Epoch 6/20 => Loss 0.988, Loss_clf 0.512, Loss_aux 0.476, Train_accy 86.88, Test_accy 73.50:  30%|███       | 6/20 [11:40<27:48, 119.17s/it]Task 3, Epoch 7/20 => Loss 0.950, Loss_clf 0.500, Loss_aux 0.450, Train_accy 87.57:  30%|███       | 6/20 [13:20<27:48, 119.17s/it]                 Task 3, Epoch 7/20 => Loss 0.950, Loss_clf 0.500, Loss_aux 0.450, Train_accy 87.57:  35%|███▌      | 7/20 [13:20<24:27, 112.88s/it]Task 3, Epoch 8/20 => Loss 0.890, Loss_clf 0.459, Loss_aux 0.432, Train_accy 88.47:  35%|███▌      | 7/20 [15:00<24:27, 112.88s/it]Task 3, Epoch 8/20 => Loss 0.890, Loss_clf 0.459, Loss_aux 0.432, Train_accy 88.47:  40%|████      | 8/20 [15:00<21:45, 108.78s/it]Task 3, Epoch 9/20 => Loss 0.871, Loss_clf 0.454, Loss_aux 0.417, Train_accy 88.58:  40%|████      | 8/20 [16:40<21:45, 108.78s/it]Task 3, Epoch 9/20 => Loss 0.871, Loss_clf 0.454, Loss_aux 0.417, Train_accy 88.58:  45%|████▌     | 9/20 [16:40<19:26, 106.07s/it]Task 3, Epoch 10/20 => Loss 0.850, Loss_clf 0.445, Loss_aux 0.405, Train_accy 89.39:  45%|████▌     | 9/20 [18:20<19:26, 106.07s/it]Task 3, Epoch 10/20 => Loss 0.850, Loss_clf 0.445, Loss_aux 0.405, Train_accy 89.39:  50%|█████     | 10/20 [18:20<17:23, 104.31s/it]Task 3, Epoch 11/20 => Loss 0.809, Loss_clf 0.424, Loss_aux 0.385, Train_accy 89.40, Test_accy 74.23:  50%|█████     | 10/20 [20:48<17:23, 104.31s/it]Task 3, Epoch 11/20 => Loss 0.809, Loss_clf 0.424, Loss_aux 0.385, Train_accy 89.40, Test_accy 74.23:  55%|█████▌    | 11/20 [20:48<17:39, 117.72s/it]Task 3, Epoch 12/20 => Loss 0.804, Loss_clf 0.422, Loss_aux 0.382, Train_accy 89.65:  55%|█████▌    | 11/20 [22:28<17:39, 117.72s/it]                 Task 3, Epoch 12/20 => Loss 0.804, Loss_clf 0.422, Loss_aux 0.382, Train_accy 89.65:  60%|██████    | 12/20 [22:28<14:59, 112.40s/it]Task 3, Epoch 13/20 => Loss 0.756, Loss_clf 0.411, Loss_aux 0.345, Train_accy 90.00:  60%|██████    | 12/20 [24:09<14:59, 112.40s/it]Task 3, Epoch 13/20 => Loss 0.756, Loss_clf 0.411, Loss_aux 0.345, Train_accy 90.00:  65%|██████▌   | 13/20 [24:09<12:40, 108.70s/it]Task 3, Epoch 14/20 => Loss 0.785, Loss_clf 0.419, Loss_aux 0.366, Train_accy 89.81:  65%|██████▌   | 13/20 [25:49<12:40, 108.70s/it]Task 3, Epoch 14/20 => Loss 0.785, Loss_clf 0.419, Loss_aux 0.366, Train_accy 89.81:  70%|███████   | 14/20 [25:49<10:36, 106.06s/it]Task 3, Epoch 15/20 => Loss 0.728, Loss_clf 0.390, Loss_aux 0.338, Train_accy 90.00:  70%|███████   | 14/20 [27:29<10:36, 106.06s/it]Task 3, Epoch 15/20 => Loss 0.728, Loss_clf 0.390, Loss_aux 0.338, Train_accy 90.00:  75%|███████▌  | 15/20 [27:29<08:41, 104.28s/it]Task 3, Epoch 16/20 => Loss 0.663, Loss_clf 0.358, Loss_aux 0.305, Train_accy 91.24, Test_accy 74.51:  75%|███████▌  | 15/20 [29:57<08:41, 104.28s/it]Task 3, Epoch 16/20 => Loss 0.663, Loss_clf 0.358, Loss_aux 0.305, Train_accy 91.24, Test_accy 74.51:  80%|████████  | 16/20 [29:57<07:49, 117.44s/it]Task 3, Epoch 17/20 => Loss 0.652, Loss_clf 0.347, Loss_aux 0.306, Train_accy 91.29:  80%|████████  | 16/20 [31:37<07:49, 117.44s/it]                 Task 3, Epoch 17/20 => Loss 0.652, Loss_clf 0.347, Loss_aux 0.306, Train_accy 91.29:  85%|████████▌ | 17/20 [31:37<05:36, 112.24s/it]Task 3, Epoch 18/20 => Loss 0.631, Loss_clf 0.338, Loss_aux 0.293, Train_accy 91.72:  85%|████████▌ | 17/20 [33:17<05:36, 112.24s/it]Task 3, Epoch 18/20 => Loss 0.631, Loss_clf 0.338, Loss_aux 0.293, Train_accy 91.72:  90%|█████████ | 18/20 [33:17<03:37, 108.60s/it]Task 3, Epoch 19/20 => Loss 0.662, Loss_clf 0.353, Loss_aux 0.309, Train_accy 91.10:  90%|█████████ | 18/20 [34:57<03:37, 108.60s/it]Task 3, Epoch 19/20 => Loss 0.662, Loss_clf 0.353, Loss_aux 0.309, Train_accy 91.10:  95%|█████████▌| 19/20 [34:57<01:46, 106.05s/it]Task 3, Epoch 20/20 => Loss 0.653, Loss_clf 0.347, Loss_aux 0.306, Train_accy 91.29:  95%|█████████▌| 19/20 [36:37<01:46, 106.05s/it]Task 3, Epoch 20/20 => Loss 0.653, Loss_clf 0.347, Loss_aux 0.306, Train_accy 91.29: 100%|██████████| 20/20 [36:37<00:00, 104.31s/it]Task 3, Epoch 20/20 => Loss 0.653, Loss_clf 0.347, Loss_aux 0.306, Train_accy 91.29: 100%|██████████| 20/20 [36:37<00:00, 109.90s/it]
2024-04-18 18:37:32,521 [der.py] => Task 3, Epoch 20/20 => Loss 0.653, Loss_clf 0.347, Loss_aux 0.306, Train_accy 91.29
2024-04-18 18:37:32,523 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-18 18:42:04,097 [der.py] => Exemplar size: 3200
2024-04-18 18:42:04,097 [trainer.py] => CNN: {'total': 72.87, '00-39': 67.52, '40-79': 68.56, '80-119': 69.31, '120-159': 85.36, 'old': 68.42, 'new': 85.36}
2024-04-18 18:42:04,097 [trainer.py] => NME: {'total': 79.14, '00-39': 79.79, '40-79': 77.4, '80-119': 78.55, '120-159': 80.59, 'old': 78.63, 'new': 80.59}
2024-04-18 18:42:04,097 [trainer.py] => CNN top1 curve: [88.8, 82.51, 76.87, 72.87]
2024-04-18 18:42:04,097 [trainer.py] => CNN top5 curve: [96.97, 93.23, 90.7, 87.5]
2024-04-18 18:42:04,097 [trainer.py] => NME top1 curve: [90.76, 84.87, 81.07, 79.14]
2024-04-18 18:42:04,097 [trainer.py] => NME top5 curve: [97.88, 95.04, 93.2, 91.85]

Average Accuracy (CNN): 80.2625
Average Accuracy (NME): 83.96
2024-04-18 18:42:04,097 [trainer.py] => Average Accuracy (CNN): 80.2625
2024-04-18 18:42:04,097 [trainer.py] => Average Accuracy (NME): 83.96
2024-04-18 18:42:04,097 [trainer.py] => Train Time: 5550.03
2024-04-18 18:42:04,097 [trainer.py] => Test Time: 186.47 

2024-04-18 18:42:04,100 [trainer.py] => All params: 343717833
2024-04-18 18:42:04,101 [trainer.py] => Trainable params: 86321865
2024-04-18 18:42:07,114 [der.py] => Learning on 160-200
2024-04-18 18:42:07,120 [der.py] => All params: 429793009
2024-04-18 18:42:07,123 [der.py] => Trainable params: 86598385
  0%|          | 0/20 [00:00<?, ?it/s]Task 4, Epoch 1/20 => Loss 3.483, Loss_clf 1.869, Loss_aux 1.614, Train_accy 64.56, Test_accy 68.72:   0%|          | 0/20 [03:13<?, ?it/s]Task 4, Epoch 1/20 => Loss 3.483, Loss_clf 1.869, Loss_aux 1.614, Train_accy 64.56, Test_accy 68.72:   5%|▌         | 1/20 [03:13<1:01:10, 193.21s/it]Task 4, Epoch 2/20 => Loss 1.638, Loss_clf 0.832, Loss_aux 0.806, Train_accy 79.39:   5%|▌         | 1/20 [05:12<1:01:10, 193.21s/it]                 Task 4, Epoch 2/20 => Loss 1.638, Loss_clf 0.832, Loss_aux 0.806, Train_accy 79.39:  10%|█         | 2/20 [05:12<44:53, 149.64s/it]  Task 4, Epoch 3/20 => Loss 1.340, Loss_clf 0.707, Loss_aux 0.633, Train_accy 82.31:  10%|█         | 2/20 [07:10<44:53, 149.64s/it]Task 4, Epoch 3/20 => Loss 1.340, Loss_clf 0.707, Loss_aux 0.633, Train_accy 82.31:  15%|█▌        | 3/20 [07:10<38:22, 135.46s/it]Task 4, Epoch 4/20 => Loss 1.138, Loss_clf 0.607, Loss_aux 0.531, Train_accy 84.63:  15%|█▌        | 3/20 [09:09<38:22, 135.46s/it]Task 4, Epoch 4/20 => Loss 1.138, Loss_clf 0.607, Loss_aux 0.531, Train_accy 84.63:  20%|██        | 4/20 [09:09<34:21, 128.82s/it]Task 4, Epoch 5/20 => Loss 1.048, Loss_clf 0.569, Loss_aux 0.479, Train_accy 85.66:  20%|██        | 4/20 [11:07<34:21, 128.82s/it]Task 4, Epoch 5/20 => Loss 1.048, Loss_clf 0.569, Loss_aux 0.479, Train_accy 85.66:  25%|██▌       | 5/20 [11:07<31:15, 125.05s/it]Task 4, Epoch 6/20 => Loss 1.008, Loss_clf 0.533, Loss_aux 0.476, Train_accy 86.73, Test_accy 71.13:  25%|██▌       | 5/20 [14:17<31:15, 125.05s/it]Task 4, Epoch 6/20 => Loss 1.008, Loss_clf 0.533, Loss_aux 0.476, Train_accy 86.73, Test_accy 71.13:  30%|███       | 6/20 [14:17<34:19, 147.13s/it]Task 4, Epoch 7/20 => Loss 0.954, Loss_clf 0.519, Loss_aux 0.435, Train_accy 87.13:  30%|███       | 6/20 [16:16<34:19, 147.13s/it]                 Task 4, Epoch 7/20 => Loss 0.954, Loss_clf 0.519, Loss_aux 0.435, Train_accy 87.13:  35%|███▌      | 7/20 [16:16<29:50, 137.71s/it]Task 4, Epoch 8/20 => Loss 0.876, Loss_clf 0.474, Loss_aux 0.402, Train_accy 88.29:  35%|███▌      | 7/20 [18:14<29:50, 137.71s/it]Task 4, Epoch 8/20 => Loss 0.876, Loss_clf 0.474, Loss_aux 0.402, Train_accy 88.29:  40%|████      | 8/20 [18:14<26:18, 131.55s/it]Task 4, Epoch 9/20 => Loss 0.819, Loss_clf 0.443, Loss_aux 0.377, Train_accy 89.24:  40%|████      | 8/20 [20:13<26:18, 131.55s/it]Task 4, Epoch 9/20 => Loss 0.819, Loss_clf 0.443, Loss_aux 0.377, Train_accy 89.24:  45%|████▌     | 9/20 [20:13<23:22, 127.51s/it]Task 4, Epoch 10/20 => Loss 0.769, Loss_clf 0.421, Loss_aux 0.348, Train_accy 89.59:  45%|████▌     | 9/20 [22:11<23:22, 127.51s/it]Task 4, Epoch 10/20 => Loss 0.769, Loss_clf 0.421, Loss_aux 0.348, Train_accy 89.59:  50%|█████     | 10/20 [22:11<20:47, 124.73s/it]Task 4, Epoch 11/20 => Loss 0.792, Loss_clf 0.437, Loss_aux 0.355, Train_accy 89.47, Test_accy 72.08:  50%|█████     | 10/20 [25:21<20:47, 124.73s/it]Task 4, Epoch 11/20 => Loss 0.792, Loss_clf 0.437, Loss_aux 0.355, Train_accy 89.47, Test_accy 72.08:  55%|█████▌    | 11/20 [25:21<21:41, 144.57s/it]Task 4, Epoch 12/20 => Loss 0.774, Loss_clf 0.428, Loss_aux 0.347, Train_accy 89.90:  55%|█████▌    | 11/20 [27:19<21:41, 144.57s/it]                 Task 4, Epoch 12/20 => Loss 0.774, Loss_clf 0.428, Loss_aux 0.347, Train_accy 89.90:  60%|██████    | 12/20 [27:19<18:12, 136.55s/it]Task 4, Epoch 13/20 => Loss 0.712, Loss_clf 0.403, Loss_aux 0.308, Train_accy 90.04:  60%|██████    | 12/20 [29:17<18:12, 136.55s/it]Task 4, Epoch 13/20 => Loss 0.712, Loss_clf 0.403, Loss_aux 0.308, Train_accy 90.04:  65%|██████▌   | 13/20 [29:17<15:16, 130.98s/it]Task 4, Epoch 14/20 => Loss 0.721, Loss_clf 0.404, Loss_aux 0.317, Train_accy 90.31:  65%|██████▌   | 13/20 [31:16<15:16, 130.98s/it]Task 4, Epoch 14/20 => Loss 0.721, Loss_clf 0.404, Loss_aux 0.317, Train_accy 90.31:  70%|███████   | 14/20 [31:16<12:43, 127.20s/it]Task 4, Epoch 15/20 => Loss 0.667, Loss_clf 0.378, Loss_aux 0.289, Train_accy 90.66:  70%|███████   | 14/20 [34:04<12:43, 127.20s/it]Task 4, Epoch 15/20 => Loss 0.667, Loss_clf 0.378, Loss_aux 0.289, Train_accy 90.66:  75%|███████▌  | 15/20 [34:04<11:38, 139.63s/it]Task 4, Epoch 16/20 => Loss 0.728, Loss_clf 0.410, Loss_aux 0.318, Train_accy 89.96, Test_accy 72.75:  75%|███████▌  | 15/20 [38:42<11:38, 139.63s/it]Task 4, Epoch 16/20 => Loss 0.728, Loss_clf 0.410, Loss_aux 0.318, Train_accy 89.96, Test_accy 72.75:  80%|████████  | 16/20 [38:42<12:05, 181.32s/it]Task 4, Epoch 17/20 => Loss 0.657, Loss_clf 0.360, Loss_aux 0.297, Train_accy 90.93:  80%|████████  | 16/20 [40:41<12:05, 181.32s/it]                 Task 4, Epoch 17/20 => Loss 0.657, Loss_clf 0.360, Loss_aux 0.297, Train_accy 90.93:  85%|████████▌ | 17/20 [40:41<08:07, 162.47s/it]Task 4, Epoch 18/20 => Loss 0.671, Loss_clf 0.387, Loss_aux 0.284, Train_accy 90.52:  85%|████████▌ | 17/20 [42:39<08:07, 162.47s/it]Task 4, Epoch 18/20 => Loss 0.671, Loss_clf 0.387, Loss_aux 0.284, Train_accy 90.52:  90%|█████████ | 18/20 [42:39<04:58, 149.28s/it]Task 4, Epoch 19/20 => Loss 0.610, Loss_clf 0.338, Loss_aux 0.272, Train_accy 91.63:  90%|█████████ | 18/20 [44:38<04:58, 149.28s/it]Task 4, Epoch 19/20 => Loss 0.610, Loss_clf 0.338, Loss_aux 0.272, Train_accy 91.63:  95%|█████████▌| 19/20 [44:38<02:19, 139.92s/it]Task 4, Epoch 20/20 => Loss 0.617, Loss_clf 0.345, Loss_aux 0.272, Train_accy 91.52:  95%|█████████▌| 19/20 [46:36<02:19, 139.92s/it]Task 4, Epoch 20/20 => Loss 0.617, Loss_clf 0.345, Loss_aux 0.272, Train_accy 91.52: 100%|██████████| 20/20 [46:36<00:00, 133.41s/it]Task 4, Epoch 20/20 => Loss 0.617, Loss_clf 0.345, Loss_aux 0.272, Train_accy 91.52: 100%|██████████| 20/20 [46:36<00:00, 139.81s/it]
2024-04-18 19:28:43,483 [der.py] => Task 4, Epoch 20/20 => Loss 0.617, Loss_clf 0.345, Loss_aux 0.272, Train_accy 91.52
2024-04-18 19:28:43,484 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-18 19:34:41,228 [der.py] => Exemplar size: 4000
2024-04-18 19:34:41,229 [trainer.py] => CNN: {'total': 72.18, '00-39': 67.07, '40-79': 67.63, '80-119': 67.57, '120-159': 76.5, '160-199': 83.35, 'old': 69.8, 'new': 83.35}
2024-04-18 19:34:41,229 [trainer.py] => NME: {'total': 77.58, '00-39': 76.68, '40-79': 74.68, '80-119': 76.55, '120-159': 80.82, '160-199': 79.09, 'old': 77.26, 'new': 79.09}
2024-04-18 19:34:41,229 [trainer.py] => CNN top1 curve: [88.8, 82.51, 76.87, 72.87, 72.18]
2024-04-18 19:34:41,229 [trainer.py] => CNN top5 curve: [96.97, 93.23, 90.7, 87.5, 86.47]
2024-04-18 19:34:41,229 [trainer.py] => NME top1 curve: [90.76, 84.87, 81.07, 79.14, 77.58]
2024-04-18 19:34:41,229 [trainer.py] => NME top5 curve: [97.88, 95.04, 93.2, 91.85, 90.48]

Average Accuracy (CNN): 78.646
Average Accuracy (NME): 82.684
2024-04-18 19:34:41,229 [trainer.py] => Average Accuracy (CNN): 78.646
2024-04-18 19:34:41,229 [trainer.py] => Average Accuracy (NME): 82.684
2024-04-18 19:34:41,229 [trainer.py] => Train Time: 8346.38
2024-04-18 19:34:41,229 [trainer.py] => Test Time: 332.73 

Accuracy Matrix (CNN):
[[88.8  79.94 74.72 67.52 67.07]
 [ 0.   85.39 72.64 68.56 67.63]
 [ 0.    0.   83.7  69.31 67.57]
 [ 0.    0.    0.   85.36 76.5 ]
 [ 0.    0.    0.    0.   83.35]]
2024-04-18 19:34:41,230 [trainer.py] => Forgetting (CNN): 16.120000000000005
Accuracy Matrix (NME):
[[90.76 86.37 83.65 79.79 76.68]
 [ 0.   83.18 79.61 77.4  74.68]
 [ 0.    0.   79.6  78.55 76.55]
 [ 0.    0.    0.   80.59 80.82]
 [ 0.    0.    0.    0.   79.09]]
2024-04-18 19:34:41,230 [trainer.py] => Forgetting (NME): 6.407499999999999
2024-04-18 19:34:43,935 [trainer.py] => config: ./exps/foster_inr.json
2024-04-18 19:34:43,935 [trainer.py] => prefix: cil
2024-04-18 19:34:43,935 [trainer.py] => dataset: imagenetr
2024-04-18 19:34:43,935 [trainer.py] => memory_size: 4000
2024-04-18 19:34:43,935 [trainer.py] => memory_per_class: 20
2024-04-18 19:34:43,935 [trainer.py] => fixed_memory: True
2024-04-18 19:34:43,935 [trainer.py] => shuffle: True
2024-04-18 19:34:43,935 [trainer.py] => init_cls: 40
2024-04-18 19:34:43,935 [trainer.py] => increment: 40
2024-04-18 19:34:43,936 [trainer.py] => model_name: foster
2024-04-18 19:34:43,936 [trainer.py] => backbone_type: vit_base_patch16_224
2024-04-18 19:34:43,936 [trainer.py] => device: [device(type='cuda', index=4)]
2024-04-18 19:34:43,936 [trainer.py] => seed: 1993
2024-04-18 19:34:43,936 [trainer.py] => beta1: 0.96
2024-04-18 19:34:43,936 [trainer.py] => beta2: 0.97
2024-04-18 19:34:43,936 [trainer.py] => oofc: ft
2024-04-18 19:34:43,936 [trainer.py] => is_teacher_wa: False
2024-04-18 19:34:43,936 [trainer.py] => is_student_wa: False
2024-04-18 19:34:43,936 [trainer.py] => lambda_okd: 1
2024-04-18 19:34:43,936 [trainer.py] => wa_value: 1
2024-04-18 19:34:43,936 [trainer.py] => init_epochs: 20
2024-04-18 19:34:43,936 [trainer.py] => init_lr: 0.001
2024-04-18 19:34:43,936 [trainer.py] => init_weight_decay: 0.0005
2024-04-18 19:34:43,936 [trainer.py] => boosting_epochs: 20
2024-04-18 19:34:43,936 [trainer.py] => compression_epochs: 20
2024-04-18 19:34:43,936 [trainer.py] => lr: 0.001
2024-04-18 19:34:43,936 [trainer.py] => batch_size: 48
2024-04-18 19:34:43,936 [trainer.py] => weight_decay: 0.0005
2024-04-18 19:34:43,936 [trainer.py] => num_workers: 8
2024-04-18 19:34:43,936 [trainer.py] => T: 2
2024-04-18 19:34:44,060 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-04-18 19:34:44,426 [trainer.py] => All params: 0
2024-04-18 19:34:44,426 [trainer.py] => Trainable params: 0
2024-04-18 19:34:46,456 [foster.py] => Learning on 0-40
2024-04-18 19:34:46,457 [foster.py] => All params: 85860176
2024-04-18 19:34:46,457 [foster.py] => Trainable params: 85860176
  0%|          | 0/20 [00:00<?, ?it/s]Task 0, Epoch 1/20 => Loss 1.901, Train_accy 55.22, Test_accy 83.88:   0%|          | 0/20 [00:39<?, ?it/s]Task 0, Epoch 1/20 => Loss 1.901, Train_accy 55.22, Test_accy 83.88:   5%|▌         | 1/20 [00:39<12:22, 39.07s/it]Task 0, Epoch 2/20 => Loss 0.793, Train_accy 79.02:   5%|▌         | 1/20 [01:14<12:22, 39.07s/it]                 Task 0, Epoch 2/20 => Loss 0.793, Train_accy 79.02:  10%|█         | 2/20 [01:14<11:00, 36.69s/it]Task 0, Epoch 3/20 => Loss 0.624, Train_accy 83.77:  10%|█         | 2/20 [01:49<11:00, 36.69s/it]Task 0, Epoch 3/20 => Loss 0.624, Train_accy 83.77:  15%|█▌        | 3/20 [01:49<10:11, 35.95s/it]Task 0, Epoch 4/20 => Loss 0.560, Train_accy 84.77:  15%|█▌        | 3/20 [02:24<10:11, 35.95s/it]Task 0, Epoch 4/20 => Loss 0.560, Train_accy 84.77:  20%|██        | 4/20 [02:24<09:28, 35.55s/it]Task 0, Epoch 5/20 => Loss 0.502, Train_accy 86.19:  20%|██        | 4/20 [03:15<09:28, 35.55s/it]Task 0, Epoch 5/20 => Loss 0.502, Train_accy 86.19:  25%|██▌       | 5/20 [03:15<10:18, 41.25s/it]Task 0, Epoch 6/20 => Loss 0.459, Train_accy 87.46, Test_accy 90.31:  25%|██▌       | 5/20 [03:54<10:18, 41.25s/it]Task 0, Epoch 6/20 => Loss 0.459, Train_accy 87.46, Test_accy 90.31:  30%|███       | 6/20 [03:54<09:25, 40.38s/it]Task 0, Epoch 7/20 => Loss 0.411, Train_accy 88.76:  30%|███       | 6/20 [04:29<09:25, 40.38s/it]                 Task 0, Epoch 7/20 => Loss 0.411, Train_accy 88.76:  35%|███▌      | 7/20 [04:29<08:21, 38.61s/it]Task 0, Epoch 8/20 => Loss 0.368, Train_accy 89.68:  35%|███▌      | 7/20 [05:04<08:21, 38.61s/it]Task 0, Epoch 8/20 => Loss 0.368, Train_accy 89.68:  40%|████      | 8/20 [05:04<07:29, 37.46s/it]Task 0, Epoch 9/20 => Loss 0.327, Train_accy 90.85:  40%|████      | 8/20 [05:39<07:29, 37.46s/it]Task 0, Epoch 9/20 => Loss 0.327, Train_accy 90.85:  45%|████▌     | 9/20 [05:39<06:43, 36.67s/it]Task 0, Epoch 10/20 => Loss 0.317, Train_accy 91.32:  45%|████▌     | 9/20 [06:13<06:43, 36.67s/it]Task 0, Epoch 10/20 => Loss 0.317, Train_accy 91.32:  50%|█████     | 10/20 [06:13<06:01, 36.14s/it]Task 0, Epoch 11/20 => Loss 0.285, Train_accy 92.14, Test_accy 91.14:  50%|█████     | 10/20 [06:52<06:01, 36.14s/it]Task 0, Epoch 11/20 => Loss 0.285, Train_accy 92.14, Test_accy 91.14:  55%|█████▌    | 11/20 [06:52<05:32, 36.96s/it]Task 0, Epoch 12/20 => Loss 0.285, Train_accy 92.62:  55%|█████▌    | 11/20 [07:27<05:32, 36.96s/it]                 Task 0, Epoch 12/20 => Loss 0.285, Train_accy 92.62:  60%|██████    | 12/20 [07:27<04:50, 36.37s/it]Task 0, Epoch 13/20 => Loss 0.273, Train_accy 92.64:  60%|██████    | 12/20 [08:02<04:50, 36.37s/it]Task 0, Epoch 13/20 => Loss 0.273, Train_accy 92.64:  65%|██████▌   | 13/20 [08:02<04:11, 35.98s/it]Task 0, Epoch 14/20 => Loss 0.273, Train_accy 92.68:  65%|██████▌   | 13/20 [08:37<04:11, 35.98s/it]Task 0, Epoch 14/20 => Loss 0.273, Train_accy 92.68:  70%|███████   | 14/20 [08:37<03:34, 35.70s/it]Task 0, Epoch 15/20 => Loss 0.254, Train_accy 93.48:  70%|███████   | 14/20 [09:12<03:34, 35.70s/it]Task 0, Epoch 15/20 => Loss 0.254, Train_accy 93.48:  75%|███████▌  | 15/20 [09:12<02:57, 35.50s/it]Task 0, Epoch 16/20 => Loss 0.252, Train_accy 93.03, Test_accy 93.04:  75%|███████▌  | 15/20 [09:51<02:57, 35.50s/it]Task 0, Epoch 16/20 => Loss 0.252, Train_accy 93.03, Test_accy 93.04:  80%|████████  | 16/20 [09:51<02:25, 36.49s/it]Task 0, Epoch 17/20 => Loss 0.220, Train_accy 94.24:  80%|████████  | 16/20 [10:26<02:25, 36.49s/it]                 Task 0, Epoch 17/20 => Loss 0.220, Train_accy 94.24:  85%|████████▌ | 17/20 [10:26<01:48, 36.01s/it]Task 0, Epoch 18/20 => Loss 0.257, Train_accy 93.35:  85%|████████▌ | 17/20 [11:01<01:48, 36.01s/it]Task 0, Epoch 18/20 => Loss 0.257, Train_accy 93.35:  90%|█████████ | 18/20 [11:01<01:11, 35.73s/it]Task 0, Epoch 19/20 => Loss 0.235, Train_accy 93.38:  90%|█████████ | 18/20 [11:36<01:11, 35.73s/it]Task 0, Epoch 19/20 => Loss 0.235, Train_accy 93.38:  95%|█████████▌| 19/20 [11:36<00:35, 35.49s/it]Task 0, Epoch 20/20 => Loss 0.231, Train_accy 93.83:  95%|█████████▌| 19/20 [12:11<00:35, 35.49s/it]Task 0, Epoch 20/20 => Loss 0.231, Train_accy 93.83: 100%|██████████| 20/20 [12:11<00:00, 35.32s/it]Task 0, Epoch 20/20 => Loss 0.231, Train_accy 93.83: 100%|██████████| 20/20 [12:11<00:00, 36.58s/it]
2024-04-18 19:46:58,577 [foster.py] => Task 0, Epoch 20/20 => Loss 0.231, Train_accy 93.83
2024-04-18 19:46:58,578 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-18 19:47:57,371 [foster.py] => Exemplar size: 800
2024-04-18 19:47:57,371 [trainer.py] => CNN: {'total': 92.88, '00-39': 92.88, 'old': 0, 'new': 92.88}
2024-04-18 19:47:57,371 [trainer.py] => NME: {'total': 92.51, '00-39': 92.51, 'old': 0, 'new': 92.51}
2024-04-18 19:47:57,371 [trainer.py] => CNN top1 curve: [92.88]
2024-04-18 19:47:57,371 [trainer.py] => CNN top5 curve: [98.18]
2024-04-18 19:47:57,371 [trainer.py] => NME top1 curve: [92.51]
2024-04-18 19:47:57,371 [trainer.py] => NME top5 curve: [98.33]

Average Accuracy (CNN): 92.88
Average Accuracy (NME): 92.51
2024-04-18 19:47:57,371 [trainer.py] => Average Accuracy (CNN): 92.88
2024-04-18 19:47:57,371 [trainer.py] => Average Accuracy (NME): 92.51
2024-04-18 19:47:57,371 [trainer.py] => Train Time: 732.12
2024-04-18 19:47:57,371 [trainer.py] => Test Time: 7.75 

2024-04-18 19:47:57,372 [trainer.py] => All params: 85860176
2024-04-18 19:47:57,372 [trainer.py] => Trainable params: 85860176
2024-04-18 19:47:59,358 [foster.py] => Learning on 40-80
2024-04-18 19:47:59,359 [foster.py] => All params: 171812552
2024-04-18 19:47:59,360 [foster.py] => Trainable params: 85983136
2024-04-18 19:47:59,409 [foster.py] => per cls weights : [1.28369905 1.28369905 1.28369905 1.28369905 1.28369905 1.28369905
 1.28369905 1.28369905 1.28369905 1.28369905 1.28369905 1.28369905
 1.28369905 1.28369905 1.28369905 1.28369905 1.28369905 1.28369905
 1.28369905 1.28369905 1.28369905 1.28369905 1.28369905 1.28369905
 1.28369905 1.28369905 1.28369905 1.28369905 1.28369905 1.28369905
 1.28369905 1.28369905 1.28369905 1.28369905 1.28369905 1.28369905
 1.28369905 1.28369905 1.28369905 1.28369905 0.71630095 0.71630095
 0.71630095 0.71630095 0.71630095 0.71630095 0.71630095 0.71630095
 0.71630095 0.71630095 0.71630095 0.71630095 0.71630095 0.71630095
 0.71630095 0.71630095 0.71630095 0.71630095 0.71630095 0.71630095
 0.71630095 0.71630095 0.71630095 0.71630095 0.71630095 0.71630095
 0.71630095 0.71630095 0.71630095 0.71630095 0.71630095 0.71630095
 0.71630095 0.71630095 0.71630095 0.71630095 0.71630095 0.71630095
 0.71630095 0.71630095]
  0%|          | 0/20 [00:00<?, ?it/s]Task 1, Epoch 1/20 => Loss 6.279, Loss_clf 1.846, Loss_fe 2.281, Loss_kd 1.076, Train_accy 50.57, Test_accy 78.98:   0%|          | 0/20 [01:01<?, ?it/s]Task 1, Epoch 1/20 => Loss 6.279, Loss_clf 1.846, Loss_fe 2.281, Loss_kd 1.076, Train_accy 50.57, Test_accy 78.98:   5%|▌         | 1/20 [01:01<19:30, 61.61s/it]Task 1, Epoch 2/20 => Loss 4.146, Loss_clf 0.914, Loss_fe 1.088, Loss_kd 1.072, Train_accy 66.26:   5%|▌         | 1/20 [01:50<19:30, 61.61s/it]                 Task 1, Epoch 2/20 => Loss 4.146, Loss_clf 0.914, Loss_fe 1.088, Loss_kd 1.072, Train_accy 66.26:  10%|█         | 2/20 [01:50<16:10, 53.90s/it]Task 1, Epoch 3/20 => Loss 3.836, Loss_clf 0.783, Loss_fe 0.921, Loss_kd 1.066, Train_accy 69.55:  10%|█         | 2/20 [02:38<16:10, 53.90s/it]Task 1, Epoch 3/20 => Loss 3.836, Loss_clf 0.783, Loss_fe 0.921, Loss_kd 1.066, Train_accy 69.55:  15%|█▌        | 3/20 [02:38<14:32, 51.31s/it]Task 1, Epoch 4/20 => Loss 3.606, Loss_clf 0.684, Loss_fe 0.805, Loss_kd 1.059, Train_accy 72.06:  15%|█▌        | 3/20 [03:26<14:32, 51.31s/it]Task 1, Epoch 4/20 => Loss 3.606, Loss_clf 0.684, Loss_fe 0.805, Loss_kd 1.059, Train_accy 72.06:  20%|██        | 4/20 [03:26<13:21, 50.11s/it]Task 1, Epoch 5/20 => Loss 3.419, Loss_clf 0.599, Loss_fe 0.697, Loss_kd 1.062, Train_accy 74.15:  20%|██        | 4/20 [04:14<13:21, 50.11s/it]Task 1, Epoch 5/20 => Loss 3.419, Loss_clf 0.599, Loss_fe 0.697, Loss_kd 1.062, Train_accy 74.15:  25%|██▌       | 5/20 [04:14<12:21, 49.42s/it]Task 1, Epoch 6/20 => Loss 3.275, Loss_clf 0.530, Loss_fe 0.629, Loss_kd 1.058, Train_accy 76.36, Test_accy 83.91:  25%|██▌       | 5/20 [05:15<12:21, 49.42s/it]Task 1, Epoch 6/20 => Loss 3.275, Loss_clf 0.530, Loss_fe 0.629, Loss_kd 1.058, Train_accy 76.36, Test_accy 83.91:  30%|███       | 6/20 [05:15<12:26, 53.30s/it]Task 1, Epoch 7/20 => Loss 3.116, Loss_clf 0.471, Loss_fe 0.524, Loss_kd 1.061, Train_accy 79.14:  30%|███       | 6/20 [06:03<12:26, 53.30s/it]                 Task 1, Epoch 7/20 => Loss 3.116, Loss_clf 0.471, Loss_fe 0.524, Loss_kd 1.061, Train_accy 79.14:  35%|███▌      | 7/20 [06:03<11:11, 51.66s/it]Task 1, Epoch 8/20 => Loss 3.138, Loss_clf 0.473, Loss_fe 0.531, Loss_kd 1.067, Train_accy 79.42:  35%|███▌      | 7/20 [06:52<11:11, 51.66s/it]Task 1, Epoch 8/20 => Loss 3.138, Loss_clf 0.473, Loss_fe 0.531, Loss_kd 1.067, Train_accy 79.42:  40%|████      | 8/20 [06:52<10:07, 50.60s/it]Task 1, Epoch 9/20 => Loss 3.029, Loss_clf 0.438, Loss_fe 0.479, Loss_kd 1.056, Train_accy 79.51:  40%|████      | 8/20 [07:40<10:07, 50.60s/it]Task 1, Epoch 9/20 => Loss 3.029, Loss_clf 0.438, Loss_fe 0.479, Loss_kd 1.056, Train_accy 79.51:  45%|████▌     | 9/20 [07:40<09:08, 49.82s/it]Task 1, Epoch 10/20 => Loss 2.963, Loss_clf 0.414, Loss_fe 0.445, Loss_kd 1.052, Train_accy 80.96:  45%|████▌     | 9/20 [08:28<09:08, 49.82s/it]Task 1, Epoch 10/20 => Loss 2.963, Loss_clf 0.414, Loss_fe 0.445, Loss_kd 1.052, Train_accy 80.96:  50%|█████     | 10/20 [08:28<08:13, 49.35s/it]Task 1, Epoch 11/20 => Loss 2.929, Loss_clf 0.392, Loss_fe 0.410, Loss_kd 1.064, Train_accy 82.03, Test_accy 84.35:  50%|█████     | 10/20 [09:29<08:13, 49.35s/it]Task 1, Epoch 11/20 => Loss 2.929, Loss_clf 0.392, Loss_fe 0.410, Loss_kd 1.064, Train_accy 82.03, Test_accy 84.35:  55%|█████▌    | 11/20 [09:29<07:55, 52.86s/it]Task 1, Epoch 12/20 => Loss 2.818, Loss_clf 0.348, Loss_fe 0.362, Loss_kd 1.054, Train_accy 83.52:  55%|█████▌    | 11/20 [10:17<07:55, 52.86s/it]                 Task 1, Epoch 12/20 => Loss 2.818, Loss_clf 0.348, Loss_fe 0.362, Loss_kd 1.054, Train_accy 83.52:  60%|██████    | 12/20 [10:17<06:50, 51.36s/it]Task 1, Epoch 13/20 => Loss 2.855, Loss_clf 0.352, Loss_fe 0.369, Loss_kd 1.067, Train_accy 83.35:  60%|██████    | 12/20 [11:05<06:50, 51.36s/it]Task 1, Epoch 13/20 => Loss 2.855, Loss_clf 0.352, Loss_fe 0.369, Loss_kd 1.067, Train_accy 83.35:  65%|██████▌   | 13/20 [11:05<05:52, 50.37s/it]Task 1, Epoch 14/20 => Loss 2.851, Loss_clf 0.363, Loss_fe 0.369, Loss_kd 1.059, Train_accy 82.84:  65%|██████▌   | 13/20 [11:53<05:52, 50.37s/it]Task 1, Epoch 14/20 => Loss 2.851, Loss_clf 0.363, Loss_fe 0.369, Loss_kd 1.059, Train_accy 82.84:  70%|███████   | 14/20 [11:53<04:57, 49.67s/it]Task 1, Epoch 15/20 => Loss 2.785, Loss_clf 0.337, Loss_fe 0.337, Loss_kd 1.056, Train_accy 84.01:  70%|███████   | 14/20 [12:41<04:57, 49.67s/it]Task 1, Epoch 15/20 => Loss 2.785, Loss_clf 0.337, Loss_fe 0.337, Loss_kd 1.056, Train_accy 84.01:  75%|███████▌  | 15/20 [12:41<04:05, 49.16s/it]Task 1, Epoch 16/20 => Loss 2.745, Loss_clf 0.320, Loss_fe 0.306, Loss_kd 1.059, Train_accy 84.44, Test_accy 85.59:  75%|███████▌  | 15/20 [13:42<04:05, 49.16s/it]Task 1, Epoch 16/20 => Loss 2.745, Loss_clf 0.320, Loss_fe 0.306, Loss_kd 1.059, Train_accy 84.44, Test_accy 85.59:  80%|████████  | 16/20 [13:42<03:30, 52.66s/it]Task 1, Epoch 17/20 => Loss 2.719, Loss_clf 0.295, Loss_fe 0.290, Loss_kd 1.067, Train_accy 85.91:  80%|████████  | 16/20 [14:30<03:30, 52.66s/it]                 Task 1, Epoch 17/20 => Loss 2.719, Loss_clf 0.295, Loss_fe 0.290, Loss_kd 1.067, Train_accy 85.91:  85%|████████▌ | 17/20 [14:30<02:34, 51.42s/it]Task 1, Epoch 18/20 => Loss 2.717, Loss_clf 0.296, Loss_fe 0.285, Loss_kd 1.068, Train_accy 85.69:  85%|████████▌ | 17/20 [15:18<02:34, 51.42s/it]Task 1, Epoch 18/20 => Loss 2.717, Loss_clf 0.296, Loss_fe 0.285, Loss_kd 1.068, Train_accy 85.69:  90%|█████████ | 18/20 [15:18<01:40, 50.43s/it]Task 1, Epoch 19/20 => Loss 2.692, Loss_clf 0.292, Loss_fe 0.281, Loss_kd 1.059, Train_accy 86.22:  90%|█████████ | 18/20 [16:07<01:40, 50.43s/it]Task 1, Epoch 19/20 => Loss 2.692, Loss_clf 0.292, Loss_fe 0.281, Loss_kd 1.059, Train_accy 86.22:  95%|█████████▌| 19/20 [16:07<00:49, 49.74s/it]Task 1, Epoch 20/20 => Loss 2.708, Loss_clf 0.286, Loss_fe 0.299, Loss_kd 1.061, Train_accy 85.96:  95%|█████████▌| 19/20 [16:55<00:49, 49.74s/it]Task 1, Epoch 20/20 => Loss 2.708, Loss_clf 0.286, Loss_fe 0.299, Loss_kd 1.061, Train_accy 85.96: 100%|██████████| 20/20 [16:55<00:00, 49.22s/it]Task 1, Epoch 20/20 => Loss 2.708, Loss_clf 0.286, Loss_fe 0.299, Loss_kd 1.061, Train_accy 85.96: 100%|██████████| 20/20 [16:55<00:00, 50.75s/it]
2024-04-18 20:04:54,509 [foster.py] => Task 1, Epoch 20/20 => Loss 2.708, Loss_clf 0.286, Loss_fe 0.299, Loss_kd 1.061, Train_accy 85.96
2024-04-18 20:04:54,510 [foster.py] => do not weight align teacher!
2024-04-18 20:04:54,512 [foster.py] => per cls weights : [1.37343238 1.37343238 1.37343238 1.37343238 1.37343238 1.37343238
 1.37343238 1.37343238 1.37343238 1.37343238 1.37343238 1.37343238
 1.37343238 1.37343238 1.37343238 1.37343238 1.37343238 1.37343238
 1.37343238 1.37343238 1.37343238 1.37343238 1.37343238 1.37343238
 1.37343238 1.37343238 1.37343238 1.37343238 1.37343238 1.37343238
 1.37343238 1.37343238 1.37343238 1.37343238 1.37343238 1.37343238
 1.37343238 1.37343238 1.37343238 1.37343238 0.62656762 0.62656762
 0.62656762 0.62656762 0.62656762 0.62656762 0.62656762 0.62656762
 0.62656762 0.62656762 0.62656762 0.62656762 0.62656762 0.62656762
 0.62656762 0.62656762 0.62656762 0.62656762 0.62656762 0.62656762
 0.62656762 0.62656762 0.62656762 0.62656762 0.62656762 0.62656762
 0.62656762 0.62656762 0.62656762 0.62656762 0.62656762 0.62656762
 0.62656762 0.62656762 0.62656762 0.62656762 0.62656762 0.62656762
 0.62656762 0.62656762]
  0%|          | 0/20 [00:00<?, ?it/s]SNet: Task 1, Epoch 1/20 => Loss 2.533,  Train_accy 44.43, Test_accy 80.58:   0%|          | 0/20 [01:07<?, ?it/s]SNet: Task 1, Epoch 1/20 => Loss 2.533,  Train_accy 44.43, Test_accy 80.58:   5%|▌         | 1/20 [01:07<21:23, 67.53s/it]SNet: Task 1, Epoch 2/20 => Loss 1.978,  Train_accy 66.32:   5%|▌         | 1/20 [02:08<21:23, 67.53s/it]                 SNet: Task 1, Epoch 2/20 => Loss 1.978,  Train_accy 66.32:  10%|█         | 2/20 [02:08<19:03, 63.52s/it]SNet: Task 1, Epoch 3/20 => Loss 1.929,  Train_accy 68.54:  10%|█         | 2/20 [03:08<19:03, 63.52s/it]SNet: Task 1, Epoch 3/20 => Loss 1.929,  Train_accy 68.54:  15%|█▌        | 3/20 [03:08<17:38, 62.25s/it]SNet: Task 1, Epoch 4/20 => Loss 1.905,  Train_accy 70.11:  15%|█▌        | 3/20 [04:09<17:38, 62.25s/it]SNet: Task 1, Epoch 4/20 => Loss 1.905,  Train_accy 70.11:  20%|██        | 4/20 [04:09<16:26, 61.64s/it]SNet: Task 1, Epoch 5/20 => Loss 1.883,  Train_accy 71.80:  20%|██        | 4/20 [05:10<16:26, 61.64s/it]SNet: Task 1, Epoch 5/20 => Loss 1.883,  Train_accy 71.80:  25%|██▌       | 5/20 [05:10<15:19, 61.27s/it]SNet: Task 1, Epoch 6/20 => Loss 1.853,  Train_accy 72.98, Test_accy 84.19:  25%|██▌       | 5/20 [06:17<15:19, 61.27s/it]SNet: Task 1, Epoch 6/20 => Loss 1.853,  Train_accy 72.98, Test_accy 84.19:  30%|███       | 6/20 [06:17<14:47, 63.40s/it]SNet: Task 1, Epoch 7/20 => Loss 1.848,  Train_accy 72.65:  30%|███       | 6/20 [07:18<14:47, 63.40s/it]                 SNet: Task 1, Epoch 7/20 => Loss 1.848,  Train_accy 72.65:  35%|███▌      | 7/20 [07:18<13:31, 62.45s/it]SNet: Task 1, Epoch 8/20 => Loss 1.849,  Train_accy 72.50:  35%|███▌      | 7/20 [08:18<13:31, 62.45s/it]SNet: Task 1, Epoch 8/20 => Loss 1.849,  Train_accy 72.50:  40%|████      | 8/20 [08:18<12:21, 61.81s/it]SNet: Task 1, Epoch 9/20 => Loss 1.839,  Train_accy 72.85:  40%|████      | 8/20 [09:19<12:21, 61.81s/it]SNet: Task 1, Epoch 9/20 => Loss 1.839,  Train_accy 72.85:  45%|████▌     | 9/20 [09:19<11:15, 61.38s/it]SNet: Task 1, Epoch 10/20 => Loss 1.837,  Train_accy 73.62:  45%|████▌     | 9/20 [10:19<11:15, 61.38s/it]SNet: Task 1, Epoch 10/20 => Loss 1.837,  Train_accy 73.62:  50%|█████     | 10/20 [10:19<10:11, 61.13s/it]SNet: Task 1, Epoch 11/20 => Loss 1.831,  Train_accy 73.36, Test_accy 84.11:  50%|█████     | 10/20 [11:27<10:11, 61.13s/it]SNet: Task 1, Epoch 11/20 => Loss 1.831,  Train_accy 73.36, Test_accy 84.11:  55%|█████▌    | 11/20 [11:27<09:28, 63.11s/it]SNet: Task 1, Epoch 12/20 => Loss 1.811,  Train_accy 73.64:  55%|█████▌    | 11/20 [12:27<09:28, 63.11s/it]                 SNet: Task 1, Epoch 12/20 => Loss 1.811,  Train_accy 73.64:  60%|██████    | 12/20 [12:27<08:18, 62.31s/it]SNet: Task 1, Epoch 13/20 => Loss 1.827,  Train_accy 74.36:  60%|██████    | 12/20 [13:28<08:18, 62.31s/it]SNet: Task 1, Epoch 13/20 => Loss 1.827,  Train_accy 74.36:  65%|██████▌   | 13/20 [13:28<07:12, 61.80s/it]SNet: Task 1, Epoch 14/20 => Loss 1.822,  Train_accy 74.74:  65%|██████▌   | 13/20 [14:28<07:12, 61.80s/it]SNet: Task 1, Epoch 14/20 => Loss 1.822,  Train_accy 74.74:  70%|███████   | 14/20 [14:28<06:08, 61.41s/it]SNet: Task 1, Epoch 15/20 => Loss 1.834,  Train_accy 73.95:  70%|███████   | 14/20 [15:29<06:08, 61.41s/it]SNet: Task 1, Epoch 15/20 => Loss 1.834,  Train_accy 73.95:  75%|███████▌  | 15/20 [15:29<05:05, 61.15s/it]SNet: Task 1, Epoch 16/20 => Loss 1.818,  Train_accy 73.55, Test_accy 83.95:  75%|███████▌  | 15/20 [16:37<05:05, 61.15s/it]SNet: Task 1, Epoch 16/20 => Loss 1.818,  Train_accy 73.55, Test_accy 83.95:  80%|████████  | 16/20 [16:37<04:12, 63.14s/it]SNet: Task 1, Epoch 17/20 => Loss 1.817,  Train_accy 74.19:  80%|████████  | 16/20 [17:37<04:12, 63.14s/it]                 SNet: Task 1, Epoch 17/20 => Loss 1.817,  Train_accy 74.19:  85%|████████▌ | 17/20 [17:37<03:07, 62.37s/it]SNet: Task 1, Epoch 18/20 => Loss 1.811,  Train_accy 73.79:  85%|████████▌ | 17/20 [18:38<03:07, 62.37s/it]SNet: Task 1, Epoch 18/20 => Loss 1.811,  Train_accy 73.79:  90%|█████████ | 18/20 [18:38<02:03, 61.81s/it]SNet: Task 1, Epoch 19/20 => Loss 1.824,  Train_accy 74.15:  90%|█████████ | 18/20 [19:38<02:03, 61.81s/it]SNet: Task 1, Epoch 19/20 => Loss 1.824,  Train_accy 74.15:  95%|█████████▌| 19/20 [19:38<01:01, 61.45s/it]SNet: Task 1, Epoch 20/20 => Loss 1.811,  Train_accy 74.01:  95%|█████████▌| 19/20 [20:39<01:01, 61.45s/it]SNet: Task 1, Epoch 20/20 => Loss 1.811,  Train_accy 74.01: 100%|██████████| 20/20 [20:39<00:00, 61.19s/it]SNet: Task 1, Epoch 20/20 => Loss 1.811,  Train_accy 74.01: 100%|██████████| 20/20 [20:39<00:00, 61.98s/it]
2024-04-18 20:25:40,631 [foster.py] => SNet: Task 1, Epoch 20/20 => Loss 1.811,  Train_accy 74.01
2024-04-18 20:25:40,631 [foster.py] => do not weight align student!
2024-04-18 20:25:47,622 [foster.py] => darknet eval: 
2024-04-18 20:25:47,623 [foster.py] => CNN top1 curve: 83.99
2024-04-18 20:25:47,623 [foster.py] => CNN top5 curve: 95.8
2024-04-18 20:25:47,626 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-18 20:27:38,121 [foster.py] => Exemplar size: 1600
2024-04-18 20:27:38,121 [trainer.py] => CNN: {'total': 85.83, '00-39': 92.2, '40-79': 78.67, 'old': 92.2, 'new': 78.67}
2024-04-18 20:27:38,121 [trainer.py] => NME: {'total': 88.83, '00-39': 90.61, '40-79': 86.83, 'old': 90.61, 'new': 86.83}
2024-04-18 20:27:38,121 [trainer.py] => CNN top1 curve: [92.88, 85.83]
2024-04-18 20:27:38,121 [trainer.py] => CNN top5 curve: [98.18, 95.92]
2024-04-18 20:27:38,121 [trainer.py] => NME top1 curve: [92.51, 88.83]
2024-04-18 20:27:38,121 [trainer.py] => NME top5 curve: [98.33, 96.56]

Average Accuracy (CNN): 89.35499999999999
Average Accuracy (NME): 90.67
2024-04-18 20:27:38,121 [trainer.py] => Average Accuracy (CNN): 89.35499999999999
2024-04-18 20:27:38,121 [trainer.py] => Average Accuracy (NME): 90.67
2024-04-18 20:27:38,121 [trainer.py] => Train Time: 3000.38
2024-04-18 20:27:38,121 [trainer.py] => Test Time: 33.25 

2024-04-18 20:27:38,123 [trainer.py] => All params: 171812552
2024-04-18 20:27:38,123 [trainer.py] => Trainable params: 85983136
2024-04-18 20:27:40,777 [foster.py] => Learning on 80-120
2024-04-18 20:27:40,779 [foster.py] => All params: 171935552
2024-04-18 20:27:40,780 [foster.py] => Trainable params: 86075376
2024-04-18 20:27:40,855 [foster.py] => per cls weights : [1.17279236 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236
 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236
 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236
 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236
 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236
 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236
 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236
 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236
 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236
 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236
 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236
 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236
 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236
 1.17279236 1.17279236 0.65441528 0.65441528 0.65441528 0.65441528
 0.65441528 0.65441528 0.65441528 0.65441528 0.65441528 0.65441528
 0.65441528 0.65441528 0.65441528 0.65441528 0.65441528 0.65441528
 0.65441528 0.65441528 0.65441528 0.65441528 0.65441528 0.65441528
 0.65441528 0.65441528 0.65441528 0.65441528 0.65441528 0.65441528
 0.65441528 0.65441528 0.65441528 0.65441528 0.65441528 0.65441528
 0.65441528 0.65441528 0.65441528 0.65441528 0.65441528 0.65441528]
  0%|          | 0/20 [00:00<?, ?it/s]Task 2, Epoch 1/20 => Loss 6.884, Loss_clf 1.814, Loss_fe 2.537, Loss_kd 1.688, Train_accy 48.29, Test_accy 75.78:   0%|          | 0/20 [01:14<?, ?it/s]Task 2, Epoch 1/20 => Loss 6.884, Loss_clf 1.814, Loss_fe 2.537, Loss_kd 1.688, Train_accy 48.29, Test_accy 75.78:   5%|▌         | 1/20 [01:14<23:40, 74.77s/it]Task 2, Epoch 2/20 => Loss 4.842, Loss_clf 1.015, Loss_fe 1.288, Loss_kd 1.692, Train_accy 58.07:   5%|▌         | 1/20 [02:11<23:40, 74.77s/it]                 Task 2, Epoch 2/20 => Loss 4.842, Loss_clf 1.015, Loss_fe 1.288, Loss_kd 1.692, Train_accy 58.07:  10%|█         | 2/20 [02:11<19:15, 64.17s/it]Task 2, Epoch 3/20 => Loss 4.468, Loss_clf 0.873, Loss_fe 1.054, Loss_kd 1.694, Train_accy 61.30:  10%|█         | 2/20 [03:08<19:15, 64.17s/it]Task 2, Epoch 3/20 => Loss 4.468, Loss_clf 0.873, Loss_fe 1.054, Loss_kd 1.694, Train_accy 61.30:  15%|█▌        | 3/20 [03:08<17:15, 60.89s/it]Task 2, Epoch 4/20 => Loss 4.228, Loss_clf 0.787, Loss_fe 0.908, Loss_kd 1.690, Train_accy 63.60:  15%|█▌        | 3/20 [04:05<17:15, 60.89s/it]Task 2, Epoch 4/20 => Loss 4.228, Loss_clf 0.787, Loss_fe 0.908, Loss_kd 1.690, Train_accy 63.60:  20%|██        | 4/20 [04:05<15:48, 59.26s/it]Task 2, Epoch 5/20 => Loss 4.000, Loss_clf 0.689, Loss_fe 0.787, Loss_kd 1.683, Train_accy 66.15:  20%|██        | 4/20 [05:02<15:48, 59.26s/it]Task 2, Epoch 5/20 => Loss 4.000, Loss_clf 0.689, Loss_fe 0.787, Loss_kd 1.683, Train_accy 66.15:  25%|██▌       | 5/20 [05:02<14:36, 58.44s/it]Task 2, Epoch 6/20 => Loss 3.864, Loss_clf 0.647, Loss_fe 0.705, Loss_kd 1.675, Train_accy 68.15, Test_accy 77.91:  25%|██▌       | 5/20 [06:17<14:36, 58.44s/it]Task 2, Epoch 6/20 => Loss 3.864, Loss_clf 0.647, Loss_fe 0.705, Loss_kd 1.675, Train_accy 68.15, Test_accy 77.91:  30%|███       | 6/20 [06:17<14:58, 64.18s/it]Task 2, Epoch 7/20 => Loss 3.838, Loss_clf 0.617, Loss_fe 0.675, Loss_kd 1.697, Train_accy 68.84:  30%|███       | 6/20 [07:14<14:58, 64.18s/it]                 Task 2, Epoch 7/20 => Loss 3.838, Loss_clf 0.617, Loss_fe 0.675, Loss_kd 1.697, Train_accy 68.84:  35%|███▌      | 7/20 [07:14<13:24, 61.86s/it]Task 2, Epoch 8/20 => Loss 3.677, Loss_clf 0.544, Loss_fe 0.596, Loss_kd 1.691, Train_accy 71.04:  35%|███▌      | 7/20 [08:11<13:24, 61.86s/it]Task 2, Epoch 8/20 => Loss 3.677, Loss_clf 0.544, Loss_fe 0.596, Loss_kd 1.691, Train_accy 71.04:  40%|████      | 8/20 [08:11<12:03, 60.32s/it]Task 2, Epoch 9/20 => Loss 3.585, Loss_clf 0.524, Loss_fe 0.535, Loss_kd 1.684, Train_accy 71.82:  40%|████      | 8/20 [09:08<12:03, 60.32s/it]Task 2, Epoch 9/20 => Loss 3.585, Loss_clf 0.524, Loss_fe 0.535, Loss_kd 1.684, Train_accy 71.82:  45%|████▌     | 9/20 [09:08<10:52, 59.29s/it]Task 2, Epoch 10/20 => Loss 3.444, Loss_clf 0.463, Loss_fe 0.465, Loss_kd 1.678, Train_accy 73.73:  45%|████▌     | 9/20 [10:05<10:52, 59.29s/it]Task 2, Epoch 10/20 => Loss 3.444, Loss_clf 0.463, Loss_fe 0.465, Loss_kd 1.678, Train_accy 73.73:  50%|█████     | 10/20 [10:05<09:45, 58.54s/it]Task 2, Epoch 11/20 => Loss 3.448, Loss_clf 0.465, Loss_fe 0.461, Loss_kd 1.681, Train_accy 73.57, Test_accy 79.56:  50%|█████     | 10/20 [11:20<09:45, 58.54s/it]Task 2, Epoch 11/20 => Loss 3.448, Loss_clf 0.465, Loss_fe 0.461, Loss_kd 1.681, Train_accy 73.57, Test_accy 79.56:  55%|█████▌    | 11/20 [11:20<09:32, 63.66s/it]Task 2, Epoch 12/20 => Loss 3.389, Loss_clf 0.446, Loss_fe 0.413, Loss_kd 1.686, Train_accy 74.52:  55%|█████▌    | 11/20 [12:17<09:32, 63.66s/it]                 Task 2, Epoch 12/20 => Loss 3.389, Loss_clf 0.446, Loss_fe 0.413, Loss_kd 1.686, Train_accy 74.52:  60%|██████    | 12/20 [12:17<08:13, 61.66s/it]Task 2, Epoch 13/20 => Loss 3.298, Loss_clf 0.397, Loss_fe 0.378, Loss_kd 1.682, Train_accy 76.18:  60%|██████    | 12/20 [13:14<08:13, 61.66s/it]Task 2, Epoch 13/20 => Loss 3.298, Loss_clf 0.397, Loss_fe 0.378, Loss_kd 1.682, Train_accy 76.18:  65%|██████▌   | 13/20 [13:14<07:01, 60.19s/it]Task 2, Epoch 14/20 => Loss 3.267, Loss_clf 0.397, Loss_fe 0.359, Loss_kd 1.674, Train_accy 77.11:  65%|██████▌   | 13/20 [14:11<07:01, 60.19s/it]Task 2, Epoch 14/20 => Loss 3.267, Loss_clf 0.397, Loss_fe 0.359, Loss_kd 1.674, Train_accy 77.11:  70%|███████   | 14/20 [14:11<05:54, 59.16s/it]Task 2, Epoch 15/20 => Loss 3.300, Loss_clf 0.394, Loss_fe 0.360, Loss_kd 1.697, Train_accy 77.41:  70%|███████   | 14/20 [15:09<05:54, 59.16s/it]Task 2, Epoch 15/20 => Loss 3.300, Loss_clf 0.394, Loss_fe 0.360, Loss_kd 1.697, Train_accy 77.41:  75%|███████▌  | 15/20 [15:09<04:54, 58.92s/it]Task 2, Epoch 16/20 => Loss 3.264, Loss_clf 0.394, Loss_fe 0.350, Loss_kd 1.680, Train_accy 77.13, Test_accy 80.00:  75%|███████▌  | 15/20 [16:24<04:54, 58.92s/it]Task 2, Epoch 16/20 => Loss 3.264, Loss_clf 0.394, Loss_fe 0.350, Loss_kd 1.680, Train_accy 77.13, Test_accy 80.00:  80%|████████  | 16/20 [16:24<04:15, 63.77s/it]Task 2, Epoch 17/20 => Loss 3.216, Loss_clf 0.376, Loss_fe 0.332, Loss_kd 1.672, Train_accy 78.23:  80%|████████  | 16/20 [17:21<04:15, 63.77s/it]                 Task 2, Epoch 17/20 => Loss 3.216, Loss_clf 0.376, Loss_fe 0.332, Loss_kd 1.672, Train_accy 78.23:  85%|████████▌ | 17/20 [17:21<03:04, 61.66s/it]Task 2, Epoch 18/20 => Loss 3.215, Loss_clf 0.357, Loss_fe 0.324, Loss_kd 1.690, Train_accy 78.12:  85%|████████▌ | 17/20 [18:18<03:04, 61.66s/it]Task 2, Epoch 18/20 => Loss 3.215, Loss_clf 0.357, Loss_fe 0.324, Loss_kd 1.690, Train_accy 78.12:  90%|█████████ | 18/20 [18:18<02:00, 60.18s/it]Task 2, Epoch 19/20 => Loss 3.196, Loss_clf 0.358, Loss_fe 0.311, Loss_kd 1.685, Train_accy 78.26:  90%|█████████ | 18/20 [19:15<02:00, 60.18s/it]Task 2, Epoch 19/20 => Loss 3.196, Loss_clf 0.358, Loss_fe 0.311, Loss_kd 1.685, Train_accy 78.26:  95%|█████████▌| 19/20 [19:15<00:59, 59.16s/it]Task 2, Epoch 20/20 => Loss 3.162, Loss_clf 0.350, Loss_fe 0.301, Loss_kd 1.673, Train_accy 78.46:  95%|█████████▌| 19/20 [20:11<00:59, 59.16s/it]Task 2, Epoch 20/20 => Loss 3.162, Loss_clf 0.350, Loss_fe 0.301, Loss_kd 1.673, Train_accy 78.46: 100%|██████████| 20/20 [20:11<00:00, 58.43s/it]Task 2, Epoch 20/20 => Loss 3.162, Loss_clf 0.350, Loss_fe 0.301, Loss_kd 1.673, Train_accy 78.46: 100%|██████████| 20/20 [20:11<00:00, 60.60s/it]
2024-04-18 20:47:52,762 [foster.py] => Task 2, Epoch 20/20 => Loss 3.162, Loss_clf 0.350, Loss_fe 0.301, Loss_kd 1.673, Train_accy 78.46
2024-04-18 20:47:52,763 [foster.py] => do not weight align teacher!
2024-04-18 20:47:52,766 [foster.py] => per cls weights : [1.2213961  1.2213961  1.2213961  1.2213961  1.2213961  1.2213961
 1.2213961  1.2213961  1.2213961  1.2213961  1.2213961  1.2213961
 1.2213961  1.2213961  1.2213961  1.2213961  1.2213961  1.2213961
 1.2213961  1.2213961  1.2213961  1.2213961  1.2213961  1.2213961
 1.2213961  1.2213961  1.2213961  1.2213961  1.2213961  1.2213961
 1.2213961  1.2213961  1.2213961  1.2213961  1.2213961  1.2213961
 1.2213961  1.2213961  1.2213961  1.2213961  1.2213961  1.2213961
 1.2213961  1.2213961  1.2213961  1.2213961  1.2213961  1.2213961
 1.2213961  1.2213961  1.2213961  1.2213961  1.2213961  1.2213961
 1.2213961  1.2213961  1.2213961  1.2213961  1.2213961  1.2213961
 1.2213961  1.2213961  1.2213961  1.2213961  1.2213961  1.2213961
 1.2213961  1.2213961  1.2213961  1.2213961  1.2213961  1.2213961
 1.2213961  1.2213961  1.2213961  1.2213961  1.2213961  1.2213961
 1.2213961  1.2213961  0.55720781 0.55720781 0.55720781 0.55720781
 0.55720781 0.55720781 0.55720781 0.55720781 0.55720781 0.55720781
 0.55720781 0.55720781 0.55720781 0.55720781 0.55720781 0.55720781
 0.55720781 0.55720781 0.55720781 0.55720781 0.55720781 0.55720781
 0.55720781 0.55720781 0.55720781 0.55720781 0.55720781 0.55720781
 0.55720781 0.55720781 0.55720781 0.55720781 0.55720781 0.55720781
 0.55720781 0.55720781 0.55720781 0.55720781 0.55720781 0.55720781]
  0%|          | 0/20 [00:00<?, ?it/s]SNet: Task 2, Epoch 1/20 => Loss 2.730,  Train_accy 41.09, Test_accy 76.19:   0%|          | 0/20 [01:21<?, ?it/s]SNet: Task 2, Epoch 1/20 => Loss 2.730,  Train_accy 41.09, Test_accy 76.19:   5%|▌         | 1/20 [01:21<25:44, 81.31s/it]SNet: Task 2, Epoch 2/20 => Loss 2.422,  Train_accy 54.81:   5%|▌         | 1/20 [02:32<25:44, 81.31s/it]                 SNet: Task 2, Epoch 2/20 => Loss 2.422,  Train_accy 54.81:  10%|█         | 2/20 [02:32<22:40, 75.61s/it]SNet: Task 2, Epoch 3/20 => Loss 2.357,  Train_accy 58.12:  10%|█         | 2/20 [03:44<22:40, 75.61s/it]SNet: Task 2, Epoch 3/20 => Loss 2.357,  Train_accy 58.12:  15%|█▌        | 3/20 [03:44<20:55, 73.86s/it]SNet: Task 2, Epoch 4/20 => Loss 2.335,  Train_accy 59.58:  15%|█▌        | 3/20 [04:56<20:55, 73.86s/it]SNet: Task 2, Epoch 4/20 => Loss 2.335,  Train_accy 59.58:  20%|██        | 4/20 [04:56<19:27, 72.98s/it]SNet: Task 2, Epoch 5/20 => Loss 2.338,  Train_accy 59.43:  20%|██        | 4/20 [06:07<19:27, 72.98s/it]SNet: Task 2, Epoch 5/20 => Loss 2.338,  Train_accy 59.43:  25%|██▌       | 5/20 [06:07<18:07, 72.48s/it]SNet: Task 2, Epoch 6/20 => Loss 2.328,  Train_accy 60.16, Test_accy 77.75:  25%|██▌       | 5/20 [07:29<18:07, 72.48s/it]SNet: Task 2, Epoch 6/20 => Loss 2.328,  Train_accy 60.16, Test_accy 77.75:  30%|███       | 6/20 [07:29<17:37, 75.54s/it]SNet: Task 2, Epoch 7/20 => Loss 2.306,  Train_accy 60.93:  30%|███       | 6/20 [08:41<17:37, 75.54s/it]                 SNet: Task 2, Epoch 7/20 => Loss 2.306,  Train_accy 60.93:  35%|███▌      | 7/20 [08:41<16:05, 74.27s/it]SNet: Task 2, Epoch 8/20 => Loss 2.308,  Train_accy 61.27:  35%|███▌      | 7/20 [09:52<16:05, 74.27s/it]SNet: Task 2, Epoch 8/20 => Loss 2.308,  Train_accy 61.27:  40%|████      | 8/20 [09:52<14:41, 73.43s/it]SNet: Task 2, Epoch 9/20 => Loss 2.305,  Train_accy 62.05:  40%|████      | 8/20 [11:04<14:41, 73.43s/it]SNet: Task 2, Epoch 9/20 => Loss 2.305,  Train_accy 62.05:  45%|████▌     | 9/20 [11:04<13:21, 72.90s/it]SNet: Task 2, Epoch 10/20 => Loss 2.281,  Train_accy 62.78:  45%|████▌     | 9/20 [12:16<13:21, 72.90s/it]SNet: Task 2, Epoch 10/20 => Loss 2.281,  Train_accy 62.78:  50%|█████     | 10/20 [12:16<12:05, 72.51s/it]SNet: Task 2, Epoch 11/20 => Loss 2.316,  Train_accy 62.13, Test_accy 78.16:  50%|█████     | 10/20 [13:37<12:05, 72.51s/it]SNet: Task 2, Epoch 11/20 => Loss 2.316,  Train_accy 62.13, Test_accy 78.16:  55%|█████▌    | 11/20 [13:37<11:17, 75.27s/it]SNet: Task 2, Epoch 12/20 => Loss 2.275,  Train_accy 63.18:  55%|█████▌    | 11/20 [14:49<11:17, 75.27s/it]                 SNet: Task 2, Epoch 12/20 => Loss 2.275,  Train_accy 63.18:  60%|██████    | 12/20 [14:49<09:53, 74.20s/it]SNet: Task 2, Epoch 13/20 => Loss 2.311,  Train_accy 62.05:  60%|██████    | 12/20 [16:00<09:53, 74.20s/it]SNet: Task 2, Epoch 13/20 => Loss 2.311,  Train_accy 62.05:  65%|██████▌   | 13/20 [16:00<08:33, 73.42s/it]SNet: Task 2, Epoch 14/20 => Loss 2.284,  Train_accy 62.78:  65%|██████▌   | 13/20 [17:12<08:33, 73.42s/it]SNet: Task 2, Epoch 14/20 => Loss 2.284,  Train_accy 62.78:  70%|███████   | 14/20 [17:12<07:17, 72.87s/it]SNet: Task 2, Epoch 15/20 => Loss 2.288,  Train_accy 61.83:  70%|███████   | 14/20 [18:24<07:17, 72.87s/it]SNet: Task 2, Epoch 15/20 => Loss 2.288,  Train_accy 61.83:  75%|███████▌  | 15/20 [18:24<06:02, 72.55s/it]SNet: Task 2, Epoch 16/20 => Loss 2.274,  Train_accy 62.56, Test_accy 78.46:  75%|███████▌  | 15/20 [19:46<06:02, 72.55s/it]SNet: Task 2, Epoch 16/20 => Loss 2.274,  Train_accy 62.56, Test_accy 78.46:  80%|████████  | 16/20 [19:46<05:01, 75.29s/it]SNet: Task 2, Epoch 17/20 => Loss 2.286,  Train_accy 63.26:  80%|████████  | 16/20 [20:57<05:01, 75.29s/it]                 SNet: Task 2, Epoch 17/20 => Loss 2.286,  Train_accy 63.26:  85%|████████▌ | 17/20 [20:57<03:42, 74.20s/it]SNet: Task 2, Epoch 18/20 => Loss 2.290,  Train_accy 62.64:  85%|████████▌ | 17/20 [22:09<03:42, 74.20s/it]SNet: Task 2, Epoch 18/20 => Loss 2.290,  Train_accy 62.64:  90%|█████████ | 18/20 [22:09<02:26, 73.42s/it]SNet: Task 2, Epoch 19/20 => Loss 2.304,  Train_accy 62.75:  90%|█████████ | 18/20 [23:21<02:26, 73.42s/it]SNet: Task 2, Epoch 19/20 => Loss 2.304,  Train_accy 62.75:  95%|█████████▌| 19/20 [23:21<01:12, 72.92s/it]SNet: Task 2, Epoch 20/20 => Loss 2.279,  Train_accy 62.97:  95%|█████████▌| 19/20 [24:32<01:12, 72.92s/it]SNet: Task 2, Epoch 20/20 => Loss 2.279,  Train_accy 62.97: 100%|██████████| 20/20 [24:32<00:00, 72.54s/it]SNet: Task 2, Epoch 20/20 => Loss 2.279,  Train_accy 62.97: 100%|██████████| 20/20 [24:32<00:00, 73.64s/it]
2024-04-18 21:12:29,462 [foster.py] => SNet: Task 2, Epoch 20/20 => Loss 2.279,  Train_accy 62.97
2024-04-18 21:12:29,462 [foster.py] => do not weight align student!
2024-04-18 21:12:39,420 [foster.py] => darknet eval: 
2024-04-18 21:12:39,421 [foster.py] => CNN top1 curve: 78.38
2024-04-18 21:12:39,421 [foster.py] => CNN top5 curve: 93.8
2024-04-18 21:12:39,424 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-18 21:14:59,240 [foster.py] => Exemplar size: 2400
2024-04-18 21:14:59,241 [trainer.py] => CNN: {'total': 79.86, '00-39': 91.29, '40-79': 80.63, '80-119': 65.91, 'old': 86.27, 'new': 65.91}
2024-04-18 21:14:59,241 [trainer.py] => NME: {'total': 85.46, '00-39': 88.12, '40-79': 83.86, '80-119': 84.05, 'old': 86.11, 'new': 84.05}
2024-04-18 21:14:59,241 [trainer.py] => CNN top1 curve: [92.88, 85.83, 79.86]
2024-04-18 21:14:59,241 [trainer.py] => CNN top5 curve: [98.18, 95.92, 94.4]
2024-04-18 21:14:59,241 [trainer.py] => NME top1 curve: [92.51, 88.83, 85.46]
2024-04-18 21:14:59,241 [trainer.py] => NME top5 curve: [98.33, 96.56, 95.56]

Average Accuracy (CNN): 86.19
Average Accuracy (NME): 88.93333333333334
2024-04-18 21:14:59,241 [trainer.py] => Average Accuracy (CNN): 86.19
2024-04-18 21:14:59,241 [trainer.py] => Average Accuracy (NME): 88.93333333333334
2024-04-18 21:14:59,241 [trainer.py] => Train Time: 5699.02
2024-04-18 21:14:59,241 [trainer.py] => Test Time: 70.39 

2024-04-18 21:14:59,242 [trainer.py] => All params: 171935552
2024-04-18 21:14:59,243 [trainer.py] => Trainable params: 86075376
2024-04-18 21:15:01,728 [foster.py] => Learning on 120-160
2024-04-18 21:15:01,732 [foster.py] => All params: 172058552
2024-04-18 21:15:01,734 [foster.py] => Trainable params: 86167616
2024-04-18 21:15:01,835 [foster.py] => per cls weights : [1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 0.62731641 0.62731641 0.62731641 0.62731641 0.62731641 0.62731641
 0.62731641 0.62731641 0.62731641 0.62731641 0.62731641 0.62731641
 0.62731641 0.62731641 0.62731641 0.62731641 0.62731641 0.62731641
 0.62731641 0.62731641 0.62731641 0.62731641 0.62731641 0.62731641
 0.62731641 0.62731641 0.62731641 0.62731641 0.62731641 0.62731641
 0.62731641 0.62731641 0.62731641 0.62731641 0.62731641 0.62731641
 0.62731641 0.62731641 0.62731641 0.62731641]
  0%|          | 0/20 [00:00<?, ?it/s]Task 3, Epoch 1/20 => Loss 7.391, Loss_clf 1.846, Loss_fe 2.869, Loss_kd 2.007, Train_accy 46.35, Test_accy 71.86:   0%|          | 0/20 [01:30<?, ?it/s]Task 3, Epoch 1/20 => Loss 7.391, Loss_clf 1.846, Loss_fe 2.869, Loss_kd 2.007, Train_accy 46.35, Test_accy 71.86:   5%|▌         | 1/20 [01:30<28:48, 90.98s/it]Task 3, Epoch 2/20 => Loss 5.068, Loss_clf 1.047, Loss_fe 1.374, Loss_kd 1.986, Train_accy 56.28:   5%|▌         | 1/20 [02:36<28:48, 90.98s/it]                 Task 3, Epoch 2/20 => Loss 5.068, Loss_clf 1.047, Loss_fe 1.374, Loss_kd 1.986, Train_accy 56.28:  10%|█         | 2/20 [02:36<22:46, 75.91s/it]Task 3, Epoch 3/20 => Loss 4.661, Loss_clf 0.892, Loss_fe 1.119, Loss_kd 1.987, Train_accy 58.79:  10%|█         | 2/20 [03:41<22:46, 75.91s/it]Task 3, Epoch 3/20 => Loss 4.661, Loss_clf 0.892, Loss_fe 1.119, Loss_kd 1.987, Train_accy 58.79:  15%|█▌        | 3/20 [03:41<20:06, 70.95s/it]Task 3, Epoch 4/20 => Loss 4.390, Loss_clf 0.794, Loss_fe 0.952, Loss_kd 1.984, Train_accy 61.65:  15%|█▌        | 3/20 [04:46<20:06, 70.95s/it]Task 3, Epoch 4/20 => Loss 4.390, Loss_clf 0.794, Loss_fe 0.952, Loss_kd 1.984, Train_accy 61.65:  20%|██        | 4/20 [04:46<18:16, 68.53s/it]Task 3, Epoch 5/20 => Loss 4.145, Loss_clf 0.704, Loss_fe 0.810, Loss_kd 1.973, Train_accy 63.54:  20%|██        | 4/20 [05:50<18:16, 68.53s/it]Task 3, Epoch 5/20 => Loss 4.145, Loss_clf 0.704, Loss_fe 0.810, Loss_kd 1.973, Train_accy 63.54:  25%|██▌       | 5/20 [05:50<16:46, 67.13s/it]Task 3, Epoch 6/20 => Loss 4.021, Loss_clf 0.664, Loss_fe 0.718, Loss_kd 1.979, Train_accy 64.99, Test_accy 74.65:  25%|██▌       | 5/20 [07:19<16:46, 67.13s/it]Task 3, Epoch 6/20 => Loss 4.021, Loss_clf 0.664, Loss_fe 0.718, Loss_kd 1.979, Train_accy 64.99, Test_accy 74.65:  30%|███       | 6/20 [07:19<17:23, 74.53s/it]Task 3, Epoch 7/20 => Loss 3.892, Loss_clf 0.603, Loss_fe 0.659, Loss_kd 1.973, Train_accy 66.44:  30%|███       | 6/20 [08:24<17:23, 74.53s/it]                 Task 3, Epoch 7/20 => Loss 3.892, Loss_clf 0.603, Loss_fe 0.659, Loss_kd 1.973, Train_accy 66.44:  35%|███▌      | 7/20 [08:24<15:26, 71.31s/it]Task 3, Epoch 8/20 => Loss 3.854, Loss_clf 0.582, Loss_fe 0.613, Loss_kd 1.994, Train_accy 67.23:  35%|███▌      | 7/20 [09:29<15:26, 71.31s/it]Task 3, Epoch 8/20 => Loss 3.854, Loss_clf 0.582, Loss_fe 0.613, Loss_kd 1.994, Train_accy 67.23:  40%|████      | 8/20 [09:29<13:50, 69.20s/it]Task 3, Epoch 9/20 => Loss 3.847, Loss_clf 0.582, Loss_fe 0.596, Loss_kd 2.002, Train_accy 66.51:  40%|████      | 8/20 [10:33<13:50, 69.20s/it]Task 3, Epoch 9/20 => Loss 3.847, Loss_clf 0.582, Loss_fe 0.596, Loss_kd 2.002, Train_accy 66.51:  45%|████▌     | 9/20 [10:33<12:25, 67.80s/it]Task 3, Epoch 10/20 => Loss 3.690, Loss_clf 0.522, Loss_fe 0.507, Loss_kd 1.996, Train_accy 70.40:  45%|████▌     | 9/20 [11:38<12:25, 67.80s/it]Task 3, Epoch 10/20 => Loss 3.690, Loss_clf 0.522, Loss_fe 0.507, Loss_kd 1.996, Train_accy 70.40:  50%|█████     | 10/20 [11:38<11:08, 66.84s/it]Task 3, Epoch 11/20 => Loss 3.620, Loss_clf 0.499, Loss_fe 0.487, Loss_kd 1.975, Train_accy 70.08, Test_accy 75.42:  50%|█████     | 10/20 [13:07<11:08, 66.84s/it]Task 3, Epoch 11/20 => Loss 3.620, Loss_clf 0.499, Loss_fe 0.487, Loss_kd 1.975, Train_accy 70.08, Test_accy 75.42:  55%|█████▌    | 11/20 [13:07<11:03, 73.73s/it]Task 3, Epoch 12/20 => Loss 3.581, Loss_clf 0.482, Loss_fe 0.460, Loss_kd 1.980, Train_accy 69.81:  55%|█████▌    | 11/20 [14:12<11:03, 73.73s/it]                 Task 3, Epoch 12/20 => Loss 3.581, Loss_clf 0.482, Loss_fe 0.460, Loss_kd 1.980, Train_accy 69.81:  60%|██████    | 12/20 [14:12<09:28, 71.02s/it]Task 3, Epoch 13/20 => Loss 3.570, Loss_clf 0.485, Loss_fe 0.444, Loss_kd 1.981, Train_accy 71.16:  60%|██████    | 12/20 [15:17<09:28, 71.02s/it]Task 3, Epoch 13/20 => Loss 3.570, Loss_clf 0.485, Loss_fe 0.444, Loss_kd 1.981, Train_accy 71.16:  65%|██████▌   | 13/20 [15:17<08:03, 69.11s/it]Task 3, Epoch 14/20 => Loss 3.535, Loss_clf 0.464, Loss_fe 0.416, Loss_kd 1.991, Train_accy 71.89:  65%|██████▌   | 13/20 [16:22<08:03, 69.11s/it]Task 3, Epoch 14/20 => Loss 3.535, Loss_clf 0.464, Loss_fe 0.416, Loss_kd 1.991, Train_accy 71.89:  70%|███████   | 14/20 [16:22<06:46, 67.79s/it]Task 3, Epoch 15/20 => Loss 3.475, Loss_clf 0.442, Loss_fe 0.396, Loss_kd 1.978, Train_accy 72.51:  70%|███████   | 14/20 [17:26<06:46, 67.79s/it]Task 3, Epoch 15/20 => Loss 3.475, Loss_clf 0.442, Loss_fe 0.396, Loss_kd 1.978, Train_accy 72.51:  75%|███████▌  | 15/20 [17:26<05:34, 66.84s/it]Task 3, Epoch 16/20 => Loss 3.470, Loss_clf 0.439, Loss_fe 0.388, Loss_kd 1.981, Train_accy 72.49, Test_accy 76.47:  75%|███████▌  | 15/20 [18:56<05:34, 66.84s/it]Task 3, Epoch 16/20 => Loss 3.470, Loss_clf 0.439, Loss_fe 0.388, Loss_kd 1.981, Train_accy 72.49, Test_accy 76.47:  80%|████████  | 16/20 [18:56<04:54, 73.60s/it]Task 3, Epoch 17/20 => Loss 3.362, Loss_clf 0.385, Loss_fe 0.336, Loss_kd 1.981, Train_accy 74.11:  80%|████████  | 16/20 [20:00<04:54, 73.60s/it]                 Task 3, Epoch 17/20 => Loss 3.362, Loss_clf 0.385, Loss_fe 0.336, Loss_kd 1.981, Train_accy 74.11:  85%|████████▌ | 17/20 [20:00<03:32, 70.90s/it]Task 3, Epoch 18/20 => Loss 3.364, Loss_clf 0.395, Loss_fe 0.341, Loss_kd 1.970, Train_accy 74.29:  85%|████████▌ | 17/20 [21:05<03:32, 70.90s/it]Task 3, Epoch 18/20 => Loss 3.364, Loss_clf 0.395, Loss_fe 0.341, Loss_kd 1.970, Train_accy 74.29:  90%|█████████ | 18/20 [21:05<02:18, 69.00s/it]Task 3, Epoch 19/20 => Loss 3.391, Loss_clf 0.399, Loss_fe 0.341, Loss_kd 1.988, Train_accy 74.51:  90%|█████████ | 18/20 [22:09<02:18, 69.00s/it]Task 3, Epoch 19/20 => Loss 3.391, Loss_clf 0.399, Loss_fe 0.341, Loss_kd 1.988, Train_accy 74.51:  95%|█████████▌| 19/20 [22:09<01:07, 67.71s/it]Task 3, Epoch 20/20 => Loss 3.390, Loss_clf 0.402, Loss_fe 0.343, Loss_kd 1.984, Train_accy 74.26:  95%|█████████▌| 19/20 [23:14<01:07, 67.71s/it]Task 3, Epoch 20/20 => Loss 3.390, Loss_clf 0.402, Loss_fe 0.343, Loss_kd 1.984, Train_accy 74.26: 100%|██████████| 20/20 [23:14<00:00, 66.78s/it]Task 3, Epoch 20/20 => Loss 3.390, Loss_clf 0.402, Loss_fe 0.343, Loss_kd 1.984, Train_accy 74.26: 100%|██████████| 20/20 [23:14<00:00, 69.73s/it]
2024-04-18 21:38:16,449 [foster.py] => Task 3, Epoch 20/20 => Loss 3.390, Loss_clf 0.402, Loss_fe 0.343, Loss_kd 1.984, Train_accy 74.26
2024-04-18 21:38:16,450 [foster.py] => do not weight align teacher!
2024-04-18 21:38:16,454 [foster.py] => per cls weights : [1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 0.52798439 0.52798439 0.52798439 0.52798439 0.52798439 0.52798439
 0.52798439 0.52798439 0.52798439 0.52798439 0.52798439 0.52798439
 0.52798439 0.52798439 0.52798439 0.52798439 0.52798439 0.52798439
 0.52798439 0.52798439 0.52798439 0.52798439 0.52798439 0.52798439
 0.52798439 0.52798439 0.52798439 0.52798439 0.52798439 0.52798439
 0.52798439 0.52798439 0.52798439 0.52798439 0.52798439 0.52798439
 0.52798439 0.52798439 0.52798439 0.52798439]
  0%|          | 0/20 [00:00<?, ?it/s]SNet: Task 3, Epoch 1/20 => Loss 2.755,  Train_accy 41.96, Test_accy 72.34:   0%|          | 0/20 [01:34<?, ?it/s]SNet: Task 3, Epoch 1/20 => Loss 2.755,  Train_accy 41.96, Test_accy 72.34:   5%|▌         | 1/20 [01:34<29:53, 94.42s/it]SNet: Task 3, Epoch 2/20 => Loss 2.521,  Train_accy 51.87:   5%|▌         | 1/20 [02:55<29:53, 94.42s/it]                 SNet: Task 3, Epoch 2/20 => Loss 2.521,  Train_accy 51.87:  10%|█         | 2/20 [02:55<26:03, 86.85s/it]SNet: Task 3, Epoch 3/20 => Loss 2.507,  Train_accy 53.90:  10%|█         | 2/20 [04:17<26:03, 86.85s/it]SNet: Task 3, Epoch 3/20 => Loss 2.507,  Train_accy 53.90:  15%|█▌        | 3/20 [04:17<23:55, 84.44s/it]SNet: Task 3, Epoch 4/20 => Loss 2.486,  Train_accy 54.88:  15%|█▌        | 3/20 [05:39<23:55, 84.44s/it]SNet: Task 3, Epoch 4/20 => Loss 2.486,  Train_accy 54.88:  20%|██        | 4/20 [05:39<22:12, 83.30s/it]SNet: Task 3, Epoch 5/20 => Loss 2.461,  Train_accy 55.53:  20%|██        | 4/20 [07:00<22:12, 83.30s/it]SNet: Task 3, Epoch 5/20 => Loss 2.461,  Train_accy 55.53:  25%|██▌       | 5/20 [07:00<20:40, 82.67s/it]SNet: Task 3, Epoch 6/20 => Loss 2.458,  Train_accy 56.83, Test_accy 74.55:  25%|██▌       | 5/20 [09:01<20:40, 82.67s/it]SNet: Task 3, Epoch 6/20 => Loss 2.458,  Train_accy 56.83, Test_accy 74.55:  30%|███       | 6/20 [09:01<22:17, 95.50s/it]SNet: Task 3, Epoch 7/20 => Loss 2.442,  Train_accy 57.36:  30%|███       | 6/20 [10:22<22:17, 95.50s/it]                 SNet: Task 3, Epoch 7/20 => Loss 2.442,  Train_accy 57.36:  35%|███▌      | 7/20 [10:22<19:43, 91.05s/it]SNet: Task 3, Epoch 8/20 => Loss 2.428,  Train_accy 58.32:  35%|███▌      | 7/20 [11:44<19:43, 91.05s/it]SNet: Task 3, Epoch 8/20 => Loss 2.428,  Train_accy 58.32:  40%|████      | 8/20 [11:44<17:36, 88.00s/it]SNet: Task 3, Epoch 9/20 => Loss 2.452,  Train_accy 57.51:  40%|████      | 8/20 [13:06<17:36, 88.00s/it]SNet: Task 3, Epoch 9/20 => Loss 2.452,  Train_accy 57.51:  45%|████▌     | 9/20 [13:06<15:46, 86.00s/it]SNet: Task 3, Epoch 10/20 => Loss 2.436,  Train_accy 58.00:  45%|████▌     | 9/20 [14:27<15:46, 86.00s/it]SNet: Task 3, Epoch 10/20 => Loss 2.436,  Train_accy 58.00:  50%|█████     | 10/20 [14:27<14:06, 84.62s/it]SNet: Task 3, Epoch 11/20 => Loss 2.414,  Train_accy 58.76, Test_accy 74.57:  50%|█████     | 10/20 [16:02<14:06, 84.62s/it]SNet: Task 3, Epoch 11/20 => Loss 2.414,  Train_accy 58.76, Test_accy 74.57:  55%|█████▌    | 11/20 [16:02<13:09, 87.73s/it]SNet: Task 3, Epoch 12/20 => Loss 2.407,  Train_accy 58.61:  55%|█████▌    | 11/20 [17:23<13:09, 87.73s/it]                 SNet: Task 3, Epoch 12/20 => Loss 2.407,  Train_accy 58.61:  60%|██████    | 12/20 [17:23<11:26, 85.85s/it]SNet: Task 3, Epoch 13/20 => Loss 2.419,  Train_accy 58.91:  60%|██████    | 12/20 [18:45<11:26, 85.85s/it]SNet: Task 3, Epoch 13/20 => Loss 2.419,  Train_accy 58.91:  65%|██████▌   | 13/20 [18:45<09:51, 84.56s/it]SNet: Task 3, Epoch 14/20 => Loss 2.417,  Train_accy 58.68:  65%|██████▌   | 13/20 [20:07<09:51, 84.56s/it]SNet: Task 3, Epoch 14/20 => Loss 2.417,  Train_accy 58.68:  70%|███████   | 14/20 [20:07<08:22, 83.72s/it]SNet: Task 3, Epoch 15/20 => Loss 2.437,  Train_accy 58.49:  70%|███████   | 14/20 [21:28<08:22, 83.72s/it]SNet: Task 3, Epoch 15/20 => Loss 2.437,  Train_accy 58.49:  75%|███████▌  | 15/20 [21:28<06:55, 83.09s/it]SNet: Task 3, Epoch 16/20 => Loss 2.421,  Train_accy 58.71, Test_accy 74.83:  75%|███████▌  | 15/20 [23:03<06:55, 83.09s/it]SNet: Task 3, Epoch 16/20 => Loss 2.421,  Train_accy 58.71, Test_accy 74.83:  80%|████████  | 16/20 [23:03<05:46, 86.58s/it]SNet: Task 3, Epoch 17/20 => Loss 2.438,  Train_accy 57.87:  80%|████████  | 16/20 [24:24<05:46, 86.58s/it]                 SNet: Task 3, Epoch 17/20 => Loss 2.438,  Train_accy 57.87:  85%|████████▌ | 17/20 [24:24<04:15, 85.03s/it]SNet: Task 3, Epoch 18/20 => Loss 2.428,  Train_accy 58.91:  85%|████████▌ | 17/20 [25:46<04:15, 85.03s/it]SNet: Task 3, Epoch 18/20 => Loss 2.428,  Train_accy 58.91:  90%|█████████ | 18/20 [25:46<02:47, 83.98s/it]SNet: Task 3, Epoch 19/20 => Loss 2.428,  Train_accy 58.39:  90%|█████████ | 18/20 [27:08<02:47, 83.98s/it]SNet: Task 3, Epoch 19/20 => Loss 2.428,  Train_accy 58.39:  95%|█████████▌| 19/20 [27:08<01:23, 83.28s/it]SNet: Task 3, Epoch 20/20 => Loss 2.419,  Train_accy 59.11:  95%|█████████▌| 19/20 [28:29<01:23, 83.28s/it]SNet: Task 3, Epoch 20/20 => Loss 2.419,  Train_accy 59.11: 100%|██████████| 20/20 [28:29<00:00, 82.75s/it]SNet: Task 3, Epoch 20/20 => Loss 2.419,  Train_accy 59.11: 100%|██████████| 20/20 [28:29<00:00, 85.48s/it]
2024-04-18 22:06:48,322 [foster.py] => SNet: Task 3, Epoch 20/20 => Loss 2.419,  Train_accy 59.11
2024-04-18 22:06:48,322 [foster.py] => do not weight align student!
2024-04-18 22:07:01,420 [foster.py] => darknet eval: 
2024-04-18 22:07:01,421 [foster.py] => CNN top1 curve: 74.67
2024-04-18 22:07:01,421 [foster.py] => CNN top5 curve: 92.64
2024-04-18 22:07:01,422 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-18 22:10:00,308 [foster.py] => Exemplar size: 3200
2024-04-18 22:10:00,308 [trainer.py] => CNN: {'total': 76.51, '00-39': 90.31, '40-79': 83.01, '80-119': 72.45, '120-159': 60.17, 'old': 82.33, 'new': 60.17}
2024-04-18 22:10:00,308 [trainer.py] => NME: {'total': 82.99, '00-39': 86.68, '40-79': 81.9, '80-119': 79.25, '120-159': 83.51, 'old': 82.8, 'new': 83.51}
2024-04-18 22:10:00,308 [trainer.py] => CNN top1 curve: [92.88, 85.83, 79.86, 76.51]
2024-04-18 22:10:00,308 [trainer.py] => CNN top5 curve: [98.18, 95.92, 94.4, 93.61]
2024-04-18 22:10:00,308 [trainer.py] => NME top1 curve: [92.51, 88.83, 85.46, 82.99]
2024-04-18 22:10:00,308 [trainer.py] => NME top5 curve: [98.33, 96.56, 95.56, 94.38]

Average Accuracy (CNN): 83.77
Average Accuracy (NME): 87.4475
2024-04-18 22:10:00,308 [trainer.py] => Average Accuracy (CNN): 83.77
2024-04-18 22:10:00,308 [trainer.py] => Average Accuracy (NME): 87.4475
2024-04-18 22:10:00,308 [trainer.py] => Train Time: 8818.69
2024-04-18 22:10:00,308 [trainer.py] => Test Time: 119.7 

2024-04-18 22:10:00,310 [trainer.py] => All params: 172058552
2024-04-18 22:10:00,312 [trainer.py] => Trainable params: 86167616
2024-04-18 22:10:02,660 [foster.py] => Learning on 160-200
2024-04-18 22:10:02,662 [foster.py] => All params: 172181552
2024-04-18 22:10:02,663 [foster.py] => Trainable params: 86259856
2024-04-18 22:10:02,725 [foster.py] => per cls weights : [1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 0.61210823 0.61210823
 0.61210823 0.61210823 0.61210823 0.61210823 0.61210823 0.61210823
 0.61210823 0.61210823 0.61210823 0.61210823 0.61210823 0.61210823
 0.61210823 0.61210823 0.61210823 0.61210823 0.61210823 0.61210823
 0.61210823 0.61210823 0.61210823 0.61210823 0.61210823 0.61210823
 0.61210823 0.61210823 0.61210823 0.61210823 0.61210823 0.61210823
 0.61210823 0.61210823 0.61210823 0.61210823 0.61210823 0.61210823
 0.61210823 0.61210823]
  0%|          | 0/20 [00:00<?, ?it/s]Task 4, Epoch 1/20 => Loss 8.014, Loss_clf 1.861, Loss_fe 3.309, Loss_kd 2.275, Train_accy 48.34, Test_accy 72.95:   0%|          | 0/20 [01:35<?, ?it/s]Task 4, Epoch 1/20 => Loss 8.014, Loss_clf 1.861, Loss_fe 3.309, Loss_kd 2.275, Train_accy 48.34, Test_accy 72.95:   5%|▌         | 1/20 [01:35<30:16, 95.61s/it]Task 4, Epoch 2/20 => Loss 5.664, Loss_clf 1.176, Loss_fe 1.650, Loss_kd 2.271, Train_accy 55.94:   5%|▌         | 1/20 [02:40<30:16, 95.61s/it]                 Task 4, Epoch 2/20 => Loss 5.664, Loss_clf 1.176, Loss_fe 1.650, Loss_kd 2.271, Train_accy 55.94:  10%|█         | 2/20 [02:40<23:20, 77.81s/it]Task 4, Epoch 3/20 => Loss 5.202, Loss_clf 1.021, Loss_fe 1.325, Loss_kd 2.285, Train_accy 57.93:  10%|█         | 2/20 [03:46<23:20, 77.81s/it]Task 4, Epoch 3/20 => Loss 5.202, Loss_clf 1.021, Loss_fe 1.325, Loss_kd 2.285, Train_accy 57.93:  15%|█▌        | 3/20 [03:46<20:26, 72.12s/it]Task 4, Epoch 4/20 => Loss 4.817, Loss_clf 0.876, Loss_fe 1.083, Loss_kd 2.286, Train_accy 61.07:  15%|█▌        | 3/20 [04:51<20:26, 72.12s/it]Task 4, Epoch 4/20 => Loss 4.817, Loss_clf 0.876, Loss_fe 1.083, Loss_kd 2.286, Train_accy 61.07:  20%|██        | 4/20 [04:51<18:31, 69.45s/it]Task 4, Epoch 5/20 => Loss 4.662, Loss_clf 0.830, Loss_fe 0.975, Loss_kd 2.286, Train_accy 62.51:  20%|██        | 4/20 [05:57<18:31, 69.45s/it]Task 4, Epoch 5/20 => Loss 4.662, Loss_clf 0.830, Loss_fe 0.975, Loss_kd 2.286, Train_accy 62.51:  25%|██▌       | 5/20 [05:57<17:00, 68.06s/it]Task 4, Epoch 6/20 => Loss 4.517, Loss_clf 0.785, Loss_fe 0.888, Loss_kd 2.276, Train_accy 63.59, Test_accy 74.65:  25%|██▌       | 5/20 [07:32<17:00, 68.06s/it]Task 4, Epoch 6/20 => Loss 4.517, Loss_clf 0.785, Loss_fe 0.888, Loss_kd 2.276, Train_accy 63.59, Test_accy 74.65:  30%|███       | 6/20 [07:32<18:01, 77.27s/it]Task 4, Epoch 7/20 => Loss 4.365, Loss_clf 0.726, Loss_fe 0.784, Loss_kd 2.284, Train_accy 65.29:  30%|███       | 6/20 [08:37<18:01, 77.27s/it]                 Task 4, Epoch 7/20 => Loss 4.365, Loss_clf 0.726, Loss_fe 0.784, Loss_kd 2.284, Train_accy 65.29:  35%|███▌      | 7/20 [08:37<15:53, 73.38s/it]Task 4, Epoch 8/20 => Loss 4.248, Loss_clf 0.682, Loss_fe 0.710, Loss_kd 2.285, Train_accy 66.12:  35%|███▌      | 7/20 [09:43<15:53, 73.38s/it]Task 4, Epoch 8/20 => Loss 4.248, Loss_clf 0.682, Loss_fe 0.710, Loss_kd 2.285, Train_accy 66.12:  40%|████      | 8/20 [09:43<14:10, 70.88s/it]Task 4, Epoch 9/20 => Loss 4.217, Loss_clf 0.679, Loss_fe 0.683, Loss_kd 2.283, Train_accy 67.15:  40%|████      | 8/20 [10:48<14:10, 70.88s/it]Task 4, Epoch 9/20 => Loss 4.217, Loss_clf 0.679, Loss_fe 0.683, Loss_kd 2.283, Train_accy 67.15:  45%|████▌     | 9/20 [10:48<12:40, 69.15s/it]Task 4, Epoch 10/20 => Loss 4.006, Loss_clf 0.592, Loss_fe 0.572, Loss_kd 2.274, Train_accy 69.02:  45%|████▌     | 9/20 [11:54<12:40, 69.15s/it]Task 4, Epoch 10/20 => Loss 4.006, Loss_clf 0.592, Loss_fe 0.572, Loss_kd 2.274, Train_accy 69.02:  50%|█████     | 10/20 [11:54<11:19, 67.99s/it]Task 4, Epoch 11/20 => Loss 4.011, Loss_clf 0.585, Loss_fe 0.567, Loss_kd 2.287, Train_accy 68.98, Test_accy 75.22:  50%|█████     | 10/20 [13:29<11:19, 67.99s/it]Task 4, Epoch 11/20 => Loss 4.011, Loss_clf 0.585, Loss_fe 0.567, Loss_kd 2.287, Train_accy 68.98, Test_accy 75.22:  55%|█████▌    | 11/20 [13:29<11:27, 76.40s/it]Task 4, Epoch 12/20 => Loss 3.828, Loss_clf 0.525, Loss_fe 0.476, Loss_kd 2.261, Train_accy 71.12:  55%|█████▌    | 11/20 [14:34<11:27, 76.40s/it]                 Task 4, Epoch 12/20 => Loss 3.828, Loss_clf 0.525, Loss_fe 0.476, Loss_kd 2.261, Train_accy 71.12:  60%|██████    | 12/20 [14:34<09:44, 73.06s/it]Task 4, Epoch 13/20 => Loss 3.814, Loss_clf 0.516, Loss_fe 0.469, Loss_kd 2.263, Train_accy 71.64:  60%|██████    | 12/20 [15:40<09:44, 73.06s/it]Task 4, Epoch 13/20 => Loss 3.814, Loss_clf 0.516, Loss_fe 0.469, Loss_kd 2.263, Train_accy 71.64:  65%|██████▌   | 13/20 [15:40<08:15, 70.75s/it]Task 4, Epoch 14/20 => Loss 3.857, Loss_clf 0.531, Loss_fe 0.467, Loss_kd 2.287, Train_accy 72.09:  65%|██████▌   | 13/20 [16:45<08:15, 70.75s/it]Task 4, Epoch 14/20 => Loss 3.857, Loss_clf 0.531, Loss_fe 0.467, Loss_kd 2.287, Train_accy 72.09:  70%|███████   | 14/20 [16:45<06:54, 69.12s/it]Task 4, Epoch 15/20 => Loss 3.738, Loss_clf 0.484, Loss_fe 0.422, Loss_kd 2.266, Train_accy 72.77:  70%|███████   | 14/20 [17:51<06:54, 69.12s/it]Task 4, Epoch 15/20 => Loss 3.738, Loss_clf 0.484, Loss_fe 0.422, Loss_kd 2.266, Train_accy 72.77:  75%|███████▌  | 15/20 [17:51<05:39, 67.99s/it]Task 4, Epoch 16/20 => Loss 3.733, Loss_clf 0.482, Loss_fe 0.411, Loss_kd 2.273, Train_accy 73.16, Test_accy 74.83:  75%|███████▌  | 15/20 [19:26<05:39, 67.99s/it]Task 4, Epoch 16/20 => Loss 3.733, Loss_clf 0.482, Loss_fe 0.411, Loss_kd 2.273, Train_accy 73.16, Test_accy 74.83:  80%|████████  | 16/20 [19:26<05:04, 76.24s/it]Task 4, Epoch 17/20 => Loss 3.753, Loss_clf 0.489, Loss_fe 0.413, Loss_kd 2.281, Train_accy 72.47:  80%|████████  | 16/20 [20:31<05:04, 76.24s/it]                 Task 4, Epoch 17/20 => Loss 3.753, Loss_clf 0.489, Loss_fe 0.413, Loss_kd 2.281, Train_accy 72.47:  85%|████████▌ | 17/20 [20:31<03:38, 72.99s/it]Task 4, Epoch 18/20 => Loss 3.661, Loss_clf 0.454, Loss_fe 0.369, Loss_kd 2.271, Train_accy 73.82:  85%|████████▌ | 17/20 [21:37<03:38, 72.99s/it]Task 4, Epoch 18/20 => Loss 3.661, Loss_clf 0.454, Loss_fe 0.369, Loss_kd 2.271, Train_accy 73.82:  90%|█████████ | 18/20 [21:37<02:21, 70.79s/it]Task 4, Epoch 19/20 => Loss 3.703, Loss_clf 0.466, Loss_fe 0.381, Loss_kd 2.285, Train_accy 74.17:  90%|█████████ | 18/20 [22:43<02:21, 70.79s/it]Task 4, Epoch 19/20 => Loss 3.703, Loss_clf 0.466, Loss_fe 0.381, Loss_kd 2.285, Train_accy 74.17:  95%|█████████▌| 19/20 [22:43<01:09, 69.30s/it]Task 4, Epoch 20/20 => Loss 3.660, Loss_clf 0.450, Loss_fe 0.378, Loss_kd 2.265, Train_accy 74.43:  95%|█████████▌| 19/20 [23:49<01:09, 69.30s/it]Task 4, Epoch 20/20 => Loss 3.660, Loss_clf 0.450, Loss_fe 0.378, Loss_kd 2.265, Train_accy 74.43: 100%|██████████| 20/20 [23:49<00:00, 68.19s/it]Task 4, Epoch 20/20 => Loss 3.660, Loss_clf 0.450, Loss_fe 0.378, Loss_kd 2.265, Train_accy 74.43: 100%|██████████| 20/20 [23:49<00:00, 71.45s/it]
2024-04-18 22:33:51,737 [foster.py] => Task 4, Epoch 20/20 => Loss 3.660, Loss_clf 0.450, Loss_fe 0.378, Loss_kd 2.265, Train_accy 74.43
2024-04-18 22:33:51,738 [foster.py] => do not weight align teacher!
2024-04-18 22:33:51,740 [foster.py] => per cls weights : [1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 0.5118768
 0.5118768 0.5118768 0.5118768 0.5118768 0.5118768 0.5118768 0.5118768
 0.5118768 0.5118768 0.5118768 0.5118768 0.5118768 0.5118768 0.5118768
 0.5118768 0.5118768 0.5118768 0.5118768 0.5118768 0.5118768 0.5118768
 0.5118768 0.5118768 0.5118768 0.5118768 0.5118768 0.5118768 0.5118768
 0.5118768 0.5118768 0.5118768 0.5118768 0.5118768 0.5118768 0.5118768
 0.5118768 0.5118768 0.5118768 0.5118768]
  0%|          | 0/20 [00:00<?, ?it/s]SNet: Task 4, Epoch 1/20 => Loss 2.895,  Train_accy 43.65, Test_accy 72.38:   0%|          | 0/20 [01:38<?, ?it/s]SNet: Task 4, Epoch 1/20 => Loss 2.895,  Train_accy 43.65, Test_accy 72.38:   5%|▌         | 1/20 [01:38<31:07, 98.31s/it]SNet: Task 4, Epoch 2/20 => Loss 2.731,  Train_accy 51.58:   5%|▌         | 1/20 [03:00<31:07, 98.31s/it]                 SNet: Task 4, Epoch 2/20 => Loss 2.731,  Train_accy 51.58:  10%|█         | 2/20 [03:00<26:42, 89.02s/it]SNet: Task 4, Epoch 3/20 => Loss 2.692,  Train_accy 54.37:  10%|█         | 2/20 [04:23<26:42, 89.02s/it]SNet: Task 4, Epoch 3/20 => Loss 2.692,  Train_accy 54.37:  15%|█▌        | 3/20 [04:23<24:22, 86.05s/it]SNet: Task 4, Epoch 4/20 => Loss 2.669,  Train_accy 55.76:  15%|█▌        | 3/20 [05:45<24:22, 86.05s/it]SNet: Task 4, Epoch 4/20 => Loss 2.669,  Train_accy 55.76:  20%|██        | 4/20 [05:45<22:35, 84.70s/it]SNet: Task 4, Epoch 5/20 => Loss 2.663,  Train_accy 56.86:  20%|██        | 4/20 [07:08<22:35, 84.70s/it]SNet: Task 4, Epoch 5/20 => Loss 2.663,  Train_accy 56.86:  25%|██▌       | 5/20 [07:08<20:59, 83.96s/it]SNet: Task 4, Epoch 6/20 => Loss 2.659,  Train_accy 57.14, Test_accy 74.03:  25%|██▌       | 5/20 [08:47<20:59, 83.96s/it]SNet: Task 4, Epoch 6/20 => Loss 2.659,  Train_accy 57.14, Test_accy 74.03:  30%|███       | 6/20 [08:47<20:47, 89.09s/it]SNet: Task 4, Epoch 7/20 => Loss 2.656,  Train_accy 58.40:  30%|███       | 6/20 [10:10<20:47, 89.09s/it]                 SNet: Task 4, Epoch 7/20 => Loss 2.656,  Train_accy 58.40:  35%|███▌      | 7/20 [10:10<18:50, 86.96s/it]SNet: Task 4, Epoch 8/20 => Loss 2.661,  Train_accy 57.71:  35%|███▌      | 7/20 [11:32<18:50, 86.96s/it]SNet: Task 4, Epoch 8/20 => Loss 2.661,  Train_accy 57.71:  40%|████      | 8/20 [11:32<17:06, 85.55s/it]SNet: Task 4, Epoch 9/20 => Loss 2.625,  Train_accy 58.26:  40%|████      | 8/20 [12:55<17:06, 85.55s/it]SNet: Task 4, Epoch 9/20 => Loss 2.625,  Train_accy 58.26:  45%|████▌     | 9/20 [12:55<15:31, 84.66s/it]SNet: Task 4, Epoch 10/20 => Loss 2.647,  Train_accy 57.40:  45%|████▌     | 9/20 [14:17<15:31, 84.66s/it]SNet: Task 4, Epoch 10/20 => Loss 2.647,  Train_accy 57.40:  50%|█████     | 10/20 [14:17<13:59, 83.99s/it]SNet: Task 4, Epoch 11/20 => Loss 2.637,  Train_accy 58.94, Test_accy 74.12:  50%|█████     | 10/20 [15:56<13:59, 83.99s/it]SNet: Task 4, Epoch 11/20 => Loss 2.637,  Train_accy 58.94, Test_accy 74.12:  55%|█████▌    | 11/20 [15:56<13:16, 88.48s/it]SNet: Task 4, Epoch 12/20 => Loss 2.624,  Train_accy 58.24:  55%|█████▌    | 11/20 [17:26<13:16, 88.48s/it]                 SNet: Task 4, Epoch 12/20 => Loss 2.624,  Train_accy 58.24:  60%|██████    | 12/20 [17:26<11:51, 88.96s/it]SNet: Task 4, Epoch 13/20 => Loss 2.654,  Train_accy 58.55:  60%|██████    | 12/20 [18:49<11:51, 88.96s/it]SNet: Task 4, Epoch 13/20 => Loss 2.654,  Train_accy 58.55:  65%|██████▌   | 13/20 [18:49<10:09, 87.02s/it]SNet: Task 4, Epoch 14/20 => Loss 2.626,  Train_accy 59.17:  65%|██████▌   | 13/20 [20:13<10:09, 87.02s/it]SNet: Task 4, Epoch 14/20 => Loss 2.626,  Train_accy 59.17:  70%|███████   | 14/20 [20:13<08:37, 86.30s/it]SNet: Task 4, Epoch 15/20 => Loss 2.642,  Train_accy 58.88:  70%|███████   | 14/20 [21:36<08:37, 86.30s/it]SNet: Task 4, Epoch 15/20 => Loss 2.642,  Train_accy 58.88:  75%|███████▌  | 15/20 [21:36<07:06, 85.33s/it]SNet: Task 4, Epoch 16/20 => Loss 2.630,  Train_accy 58.41, Test_accy 74.00:  75%|███████▌  | 15/20 [23:15<07:06, 85.33s/it]SNet: Task 4, Epoch 16/20 => Loss 2.630,  Train_accy 58.41, Test_accy 74.00:  80%|████████  | 16/20 [23:15<05:57, 89.36s/it]SNet: Task 4, Epoch 17/20 => Loss 2.653,  Train_accy 58.39:  80%|████████  | 16/20 [24:38<05:57, 89.36s/it]                 SNet: Task 4, Epoch 17/20 => Loss 2.653,  Train_accy 58.39:  85%|████████▌ | 17/20 [24:38<04:21, 87.33s/it]SNet: Task 4, Epoch 18/20 => Loss 2.625,  Train_accy 59.36:  85%|████████▌ | 17/20 [26:00<04:21, 87.33s/it]SNet: Task 4, Epoch 18/20 => Loss 2.625,  Train_accy 59.36:  90%|█████████ | 18/20 [26:00<02:51, 85.90s/it]SNet: Task 4, Epoch 19/20 => Loss 2.636,  Train_accy 59.34:  90%|█████████ | 18/20 [27:23<02:51, 85.90s/it]SNet: Task 4, Epoch 19/20 => Loss 2.636,  Train_accy 59.34:  95%|█████████▌| 19/20 [27:23<01:24, 84.87s/it]SNet: Task 4, Epoch 20/20 => Loss 2.650,  Train_accy 58.98:  95%|█████████▌| 19/20 [28:45<01:24, 84.87s/it]SNet: Task 4, Epoch 20/20 => Loss 2.650,  Train_accy 58.98: 100%|██████████| 20/20 [28:45<00:00, 84.14s/it]SNet: Task 4, Epoch 20/20 => Loss 2.650,  Train_accy 58.98: 100%|██████████| 20/20 [28:45<00:00, 86.29s/it]
2024-04-18 23:02:44,113 [foster.py] => SNet: Task 4, Epoch 20/20 => Loss 2.650,  Train_accy 58.98
2024-04-18 23:02:44,113 [foster.py] => do not weight align student!
2024-04-18 23:03:00,222 [foster.py] => darknet eval: 
2024-04-18 23:03:00,222 [foster.py] => CNN top1 curve: 73.97
2024-04-18 23:03:00,222 [foster.py] => CNN top5 curve: 91.6
2024-04-18 23:03:00,224 [base.py] => Constructing exemplars for new classes...(20 per classes)
2024-04-18 23:06:26,091 [foster.py] => Exemplar size: 4000
2024-04-18 23:06:26,092 [trainer.py] => CNN: {'total': 74.98, '00-39': 88.95, '40-79': 80.88, '80-119': 76.63, '120-159': 72.57, '160-199': 52.13, 'old': 79.87, 'new': 52.13}
2024-04-18 23:06:26,092 [trainer.py] => NME: {'total': 81.95, '00-39': 85.16, '40-79': 80.71, '80-119': 79.42, '120-159': 81.97, '160-199': 82.02, 'old': 81.93, 'new': 82.02}
2024-04-18 23:06:26,092 [trainer.py] => CNN top1 curve: [92.88, 85.83, 79.86, 76.51, 74.98]
2024-04-18 23:06:26,092 [trainer.py] => CNN top5 curve: [98.18, 95.92, 94.4, 93.61, 92.38]
2024-04-18 23:06:26,092 [trainer.py] => NME top1 curve: [92.51, 88.83, 85.46, 82.99, 81.95]
2024-04-18 23:06:26,092 [trainer.py] => NME top5 curve: [98.33, 96.56, 95.56, 94.38, 93.15]

Average Accuracy (CNN): 82.012
Average Accuracy (NME): 86.348
2024-04-18 23:06:26,092 [trainer.py] => Average Accuracy (CNN): 82.012
2024-04-18 23:06:26,092 [trainer.py] => Average Accuracy (NME): 86.348
2024-04-18 23:06:26,092 [trainer.py] => Train Time: 11996.240000000002
2024-04-18 23:06:26,092 [trainer.py] => Test Time: 180.44 

Accuracy Matrix (CNN):
[[92.88 92.2  91.29 90.31 88.95]
 [ 0.   78.67 80.63 83.01 80.88]
 [ 0.    0.   65.91 72.45 76.63]
 [ 0.    0.    0.   60.17 72.57]
 [ 0.    0.    0.    0.   52.13]]
2024-04-18 23:06:26,093 [trainer.py] => Forgetting (CNN): 1.5150000000000006
Accuracy Matrix (NME):
[[92.51 90.61 88.12 86.68 85.16]
 [ 0.   86.83 83.86 81.9  80.71]
 [ 0.    0.   84.05 79.25 79.42]
 [ 0.    0.    0.   83.51 81.97]
 [ 0.    0.    0.    0.   82.02]]
2024-04-18 23:06:26,093 [trainer.py] => Forgetting (NME): 4.910000000000004
2024-04-18 23:06:29,168 [trainer.py] => config: ./exps/l2p_inr.json
2024-04-18 23:06:29,168 [trainer.py] => prefix:  
2024-04-18 23:06:29,168 [trainer.py] => dataset: imagenetr
2024-04-18 23:06:29,168 [trainer.py] => memory_size: 0
2024-04-18 23:06:29,168 [trainer.py] => memory_per_class: 0
2024-04-18 23:06:29,168 [trainer.py] => fixed_memory: False
2024-04-18 23:06:29,168 [trainer.py] => shuffle: True
2024-04-18 23:06:29,168 [trainer.py] => init_cls: 40
2024-04-18 23:06:29,168 [trainer.py] => increment: 40
2024-04-18 23:06:29,168 [trainer.py] => model_name: l2p
2024-04-18 23:06:29,168 [trainer.py] => backbone_type: vit_base_patch16_224_l2p
2024-04-18 23:06:29,168 [trainer.py] => get_original_backbone: True
2024-04-18 23:06:29,168 [trainer.py] => device: [device(type='cuda', index=4)]
2024-04-18 23:06:29,168 [trainer.py] => seed: 1993
2024-04-18 23:06:29,168 [trainer.py] => tuned_epoch: 20
2024-04-18 23:06:29,168 [trainer.py] => init_lr: 0.001875
2024-04-18 23:06:29,168 [trainer.py] => batch_size: 48
2024-04-18 23:06:29,168 [trainer.py] => weight_decay: 0
2024-04-18 23:06:29,168 [trainer.py] => min_lr: 1e-05
2024-04-18 23:06:29,168 [trainer.py] => optimizer: adam
2024-04-18 23:06:29,168 [trainer.py] => scheduler: constant
2024-04-18 23:06:29,168 [trainer.py] => reinit_optimizer: True
2024-04-18 23:06:29,168 [trainer.py] => global_pool: token
2024-04-18 23:06:29,168 [trainer.py] => head_type: prompt
2024-04-18 23:06:29,168 [trainer.py] => freeze: ['blocks', 'patch_embed', 'cls_token', 'norm', 'pos_embed']
2024-04-18 23:06:29,168 [trainer.py] => pretrained: True
2024-04-18 23:06:29,168 [trainer.py] => drop: 0.0
2024-04-18 23:06:29,168 [trainer.py] => drop_path: 0.0
2024-04-18 23:06:29,169 [trainer.py] => prompt_pool: True
2024-04-18 23:06:29,169 [trainer.py] => size: 10
2024-04-18 23:06:29,169 [trainer.py] => length: 5
2024-04-18 23:06:29,169 [trainer.py] => top_k: 5
2024-04-18 23:06:29,169 [trainer.py] => initializer: uniform
2024-04-18 23:06:29,169 [trainer.py] => prompt_key: True
2024-04-18 23:06:29,169 [trainer.py] => prompt_key_init: uniform
2024-04-18 23:06:29,169 [trainer.py] => use_prompt_mask: False
2024-04-18 23:06:29,169 [trainer.py] => shared_prompt_pool: False
2024-04-18 23:06:29,169 [trainer.py] => shared_prompt_key: False
2024-04-18 23:06:29,169 [trainer.py] => batchwise_prompt: True
2024-04-18 23:06:29,169 [trainer.py] => embedding_key: cls
2024-04-18 23:06:29,169 [trainer.py] => predefined_key: 
2024-04-18 23:06:29,169 [trainer.py] => pull_constraint: True
2024-04-18 23:06:29,169 [trainer.py] => pull_constraint_coeff: 0.1
2024-04-18 23:06:29,284 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-04-18 23:06:31,344 [vit_l2p.py] => Resized position embedding: torch.Size([1, 197, 768]) to torch.Size([1, 222, 768])
2024-04-18 23:06:31,344 [vit_l2p.py] => Position embedding grid-size from [14, 14] to (14, 14)
2024-04-18 23:06:34,925 [l2p.py] => 86,017,736 model total parameters.
2024-04-18 23:06:34,925 [l2p.py] => 199,880 model training parameters.
2024-04-18 23:06:34,926 [l2p.py] => prompt.prompt: 38400
2024-04-18 23:06:34,926 [l2p.py] => prompt.prompt_key: 7680
2024-04-18 23:06:34,926 [l2p.py] => head.weight: 153600
2024-04-18 23:06:34,926 [l2p.py] => head.bias: 200
2024-04-18 23:06:34,927 [trainer.py] => All params: 171970192
2024-04-18 23:06:34,928 [trainer.py] => Trainable params: 199880
2024-04-18 23:06:34,928 [l2p.py] => Learning on 0-40
  0%|          | 0/20 [00:00<?, ?it/s]Task 0, Epoch 1/20 => Loss 1.645, Train_accy 59.08:   0%|          | 0/20 [00:44<?, ?it/s]Task 0, Epoch 1/20 => Loss 1.645, Train_accy 59.08:   5%|▌         | 1/20 [00:44<14:09, 44.72s/it]Task 0, Epoch 2/20 => Loss 0.928, Train_accy 73.56:   5%|▌         | 1/20 [01:28<14:09, 44.72s/it]Task 0, Epoch 2/20 => Loss 0.928, Train_accy 73.56:  10%|█         | 2/20 [01:28<13:16, 44.24s/it]Task 0, Epoch 3/20 => Loss 0.787, Train_accy 76.63:  10%|█         | 2/20 [02:12<13:16, 44.24s/it]Task 0, Epoch 3/20 => Loss 0.787, Train_accy 76.63:  15%|█▌        | 3/20 [02:12<12:27, 43.99s/it]Task 0, Epoch 4/20 => Loss 0.648, Train_accy 79.59:  15%|█▌        | 3/20 [02:55<12:27, 43.99s/it]Task 0, Epoch 4/20 => Loss 0.648, Train_accy 79.59:  20%|██        | 4/20 [02:55<11:40, 43.79s/it]Task 0, Epoch 5/20 => Loss 0.567, Train_accy 80.54, Test_accy 81.45:  20%|██        | 4/20 [03:46<11:40, 43.79s/it]Task 0, Epoch 5/20 => Loss 0.567, Train_accy 80.54, Test_accy 81.45:  25%|██▌       | 5/20 [03:46<11:34, 46.33s/it]Task 0, Epoch 6/20 => Loss 0.505, Train_accy 82.07:  25%|██▌       | 5/20 [04:30<11:34, 46.33s/it]                 Task 0, Epoch 6/20 => Loss 0.505, Train_accy 82.07:  30%|███       | 6/20 [04:30<10:36, 45.43s/it]Task 0, Epoch 7/20 => Loss 0.452, Train_accy 83.41:  30%|███       | 6/20 [05:14<10:36, 45.43s/it]Task 0, Epoch 7/20 => Loss 0.452, Train_accy 83.41:  35%|███▌      | 7/20 [05:14<09:45, 45.02s/it]Task 0, Epoch 8/20 => Loss 0.413, Train_accy 84.20:  35%|███▌      | 7/20 [05:58<09:45, 45.02s/it]Task 0, Epoch 8/20 => Loss 0.413, Train_accy 84.20:  40%|████      | 8/20 [05:58<08:55, 44.58s/it]Task 0, Epoch 9/20 => Loss 0.425, Train_accy 83.73:  40%|████      | 8/20 [06:41<08:55, 44.58s/it]Task 0, Epoch 9/20 => Loss 0.425, Train_accy 83.73:  45%|████▌     | 9/20 [06:41<08:07, 44.29s/it]Task 0, Epoch 10/20 => Loss 0.407, Train_accy 84.55, Test_accy 83.57:  45%|████▌     | 9/20 [07:32<08:07, 44.29s/it]Task 0, Epoch 10/20 => Loss 0.407, Train_accy 84.55, Test_accy 83.57:  50%|█████     | 10/20 [07:32<07:43, 46.37s/it]Task 0, Epoch 11/20 => Loss 0.403, Train_accy 84.31:  50%|█████     | 10/20 [08:16<07:43, 46.37s/it]                 Task 0, Epoch 11/20 => Loss 0.403, Train_accy 84.31:  55%|█████▌    | 11/20 [08:16<06:49, 45.51s/it]Task 0, Epoch 12/20 => Loss 0.358, Train_accy 85.71:  55%|█████▌    | 11/20 [08:59<06:49, 45.51s/it]Task 0, Epoch 12/20 => Loss 0.358, Train_accy 85.71:  60%|██████    | 12/20 [08:59<05:59, 44.93s/it]Task 0, Epoch 13/20 => Loss 0.306, Train_accy 86.58:  60%|██████    | 12/20 [09:43<05:59, 44.93s/it]Task 0, Epoch 13/20 => Loss 0.306, Train_accy 86.58:  65%|██████▌   | 13/20 [09:43<05:11, 44.47s/it]Task 0, Epoch 14/20 => Loss 0.314, Train_accy 86.79:  65%|██████▌   | 13/20 [10:27<05:11, 44.47s/it]Task 0, Epoch 14/20 => Loss 0.314, Train_accy 86.79:  70%|███████   | 14/20 [10:27<04:25, 44.29s/it]Task 0, Epoch 15/20 => Loss 0.301, Train_accy 86.86, Test_accy 83.80:  70%|███████   | 14/20 [11:18<04:25, 44.29s/it]Task 0, Epoch 15/20 => Loss 0.301, Train_accy 86.86, Test_accy 83.80:  75%|███████▌  | 15/20 [11:18<03:51, 46.39s/it]Task 0, Epoch 16/20 => Loss 0.322, Train_accy 86.54:  75%|███████▌  | 15/20 [12:02<03:51, 46.39s/it]                 Task 0, Epoch 16/20 => Loss 0.322, Train_accy 86.54:  80%|████████  | 16/20 [12:02<03:02, 45.66s/it]Task 0, Epoch 17/20 => Loss 0.278, Train_accy 87.48:  80%|████████  | 16/20 [12:46<03:02, 45.66s/it]Task 0, Epoch 17/20 => Loss 0.278, Train_accy 87.48:  85%|████████▌ | 17/20 [12:46<02:15, 45.05s/it]Task 0, Epoch 18/20 => Loss 0.252, Train_accy 88.45:  85%|████████▌ | 17/20 [13:29<02:15, 45.05s/it]Task 0, Epoch 18/20 => Loss 0.252, Train_accy 88.45:  90%|█████████ | 18/20 [13:29<01:29, 44.63s/it]Task 0, Epoch 19/20 => Loss 0.292, Train_accy 87.14:  90%|█████████ | 18/20 [14:13<01:29, 44.63s/it]Task 0, Epoch 19/20 => Loss 0.292, Train_accy 87.14:  95%|█████████▌| 19/20 [14:13<00:44, 44.36s/it]Task 0, Epoch 20/20 => Loss 0.300, Train_accy 86.92, Test_accy 83.88:  95%|█████████▌| 19/20 [15:04<00:44, 44.36s/it]Task 0, Epoch 20/20 => Loss 0.300, Train_accy 86.92, Test_accy 83.88: 100%|██████████| 20/20 [15:04<00:00, 46.44s/it]Task 0, Epoch 20/20 => Loss 0.300, Train_accy 86.92, Test_accy 83.88: 100%|██████████| 20/20 [15:04<00:00, 45.24s/it]
2024-04-18 23:21:40,229 [l2p.py] => Task 0, Epoch 20/20 => Loss 0.300, Train_accy 86.92, Test_accy 83.88
2024-04-18 23:21:47,684 [trainer.py] => No NME accuracy.
2024-04-18 23:21:47,684 [trainer.py] => CNN: {'total': 83.88, '00-39': 83.88, 'old': 0, 'new': 83.88}
2024-04-18 23:21:47,684 [trainer.py] => CNN top1 curve: [83.88]
2024-04-18 23:21:47,684 [trainer.py] => CNN top5 curve: [94.32]

Average Accuracy (CNN): 83.88
2024-04-18 23:21:47,684 [trainer.py] => Average Accuracy (CNN): 83.88 

2024-04-18 23:21:47,685 [trainer.py] => Train Time: 1810.07
2024-04-18 23:21:47,685 [trainer.py] => Test Time: 7.45 

2024-04-18 23:21:47,687 [trainer.py] => All params: 171970192
2024-04-18 23:21:47,689 [trainer.py] => Trainable params: 199880
2024-04-18 23:21:47,689 [l2p.py] => Learning on 40-80
  0%|          | 0/20 [00:00<?, ?it/s]Task 1, Epoch 1/20 => Loss 1.241, Train_accy 63.55:   0%|          | 0/20 [00:38<?, ?it/s]Task 1, Epoch 1/20 => Loss 1.241, Train_accy 63.55:   5%|▌         | 1/20 [00:38<12:10, 38.45s/it]Task 1, Epoch 2/20 => Loss 0.665, Train_accy 77.72:   5%|▌         | 1/20 [01:16<12:10, 38.45s/it]Task 1, Epoch 2/20 => Loss 0.665, Train_accy 77.72:  10%|█         | 2/20 [01:16<11:25, 38.06s/it]Task 1, Epoch 3/20 => Loss 0.560, Train_accy 80.39:  10%|█         | 2/20 [01:53<11:25, 38.06s/it]Task 1, Epoch 3/20 => Loss 0.560, Train_accy 80.39:  15%|█▌        | 3/20 [01:53<10:43, 37.88s/it]Task 1, Epoch 4/20 => Loss 0.500, Train_accy 81.73:  15%|█▌        | 3/20 [02:31<10:43, 37.88s/it]Task 1, Epoch 4/20 => Loss 0.500, Train_accy 81.73:  20%|██        | 4/20 [02:31<10:06, 37.88s/it]Task 1, Epoch 5/20 => Loss 0.458, Train_accy 82.55, Test_accy 76.94:  20%|██        | 4/20 [03:23<10:06, 37.88s/it]Task 1, Epoch 5/20 => Loss 0.458, Train_accy 82.55, Test_accy 76.94:  25%|██▌       | 5/20 [03:23<10:42, 42.82s/it]Task 1, Epoch 6/20 => Loss 0.404, Train_accy 83.97:  25%|██▌       | 5/20 [04:01<10:42, 42.82s/it]                 Task 1, Epoch 6/20 => Loss 0.404, Train_accy 83.97:  30%|███       | 6/20 [04:01<09:36, 41.16s/it]Task 1, Epoch 7/20 => Loss 0.373, Train_accy 84.90:  30%|███       | 6/20 [04:39<09:36, 41.16s/it]Task 1, Epoch 7/20 => Loss 0.373, Train_accy 84.90:  35%|███▌      | 7/20 [04:39<08:40, 40.05s/it]Task 1, Epoch 8/20 => Loss 0.371, Train_accy 84.97:  35%|███▌      | 7/20 [05:16<08:40, 40.05s/it]Task 1, Epoch 8/20 => Loss 0.371, Train_accy 84.97:  40%|████      | 8/20 [05:16<07:51, 39.31s/it]Task 1, Epoch 9/20 => Loss 0.377, Train_accy 84.60:  40%|████      | 8/20 [05:54<07:51, 39.31s/it]Task 1, Epoch 9/20 => Loss 0.377, Train_accy 84.60:  45%|████▌     | 9/20 [05:54<07:07, 38.88s/it]Task 1, Epoch 10/20 => Loss 0.319, Train_accy 86.84, Test_accy 79.02:  45%|████▌     | 9/20 [06:45<07:07, 38.88s/it]Task 1, Epoch 10/20 => Loss 0.319, Train_accy 86.84, Test_accy 79.02:  50%|█████     | 10/20 [06:45<07:06, 42.65s/it]Task 1, Epoch 11/20 => Loss 0.323, Train_accy 86.54:  50%|█████     | 10/20 [07:23<07:06, 42.65s/it]                 Task 1, Epoch 11/20 => Loss 0.323, Train_accy 86.54:  55%|█████▌    | 11/20 [07:23<06:09, 41.09s/it]Task 1, Epoch 12/20 => Loss 0.274, Train_accy 87.60:  55%|█████▌    | 11/20 [08:01<06:09, 41.09s/it]Task 1, Epoch 12/20 => Loss 0.274, Train_accy 87.60:  60%|██████    | 12/20 [08:01<05:20, 40.06s/it]Task 1, Epoch 13/20 => Loss 0.254, Train_accy 87.77:  60%|██████    | 12/20 [08:38<05:20, 40.06s/it]Task 1, Epoch 13/20 => Loss 0.254, Train_accy 87.77:  65%|██████▌   | 13/20 [08:38<04:35, 39.38s/it]Task 1, Epoch 14/20 => Loss 0.293, Train_accy 87.62:  65%|██████▌   | 13/20 [09:16<04:35, 39.38s/it]Task 1, Epoch 14/20 => Loss 0.293, Train_accy 87.62:  70%|███████   | 14/20 [09:16<03:52, 38.82s/it]Task 1, Epoch 15/20 => Loss 0.275, Train_accy 87.51, Test_accy 79.50:  70%|███████   | 14/20 [10:07<03:52, 38.82s/it]Task 1, Epoch 15/20 => Loss 0.275, Train_accy 87.51, Test_accy 79.50:  75%|███████▌  | 15/20 [10:07<03:32, 42.54s/it]Task 1, Epoch 16/20 => Loss 0.263, Train_accy 88.07:  75%|███████▌  | 15/20 [10:45<03:32, 42.54s/it]                 Task 1, Epoch 16/20 => Loss 0.263, Train_accy 88.07:  80%|████████  | 16/20 [10:45<02:44, 41.08s/it]Task 1, Epoch 17/20 => Loss 0.228, Train_accy 88.81:  80%|████████  | 16/20 [11:22<02:44, 41.08s/it]Task 1, Epoch 17/20 => Loss 0.228, Train_accy 88.81:  85%|████████▌ | 17/20 [11:22<02:00, 40.05s/it]Task 1, Epoch 18/20 => Loss 0.265, Train_accy 87.64:  85%|████████▌ | 17/20 [12:00<02:00, 40.05s/it]Task 1, Epoch 18/20 => Loss 0.265, Train_accy 87.64:  90%|█████████ | 18/20 [12:00<01:18, 39.36s/it]Task 1, Epoch 19/20 => Loss 0.265, Train_accy 87.94:  90%|█████████ | 18/20 [12:38<01:18, 39.36s/it]Task 1, Epoch 19/20 => Loss 0.265, Train_accy 87.94:  95%|█████████▌| 19/20 [12:38<00:38, 38.87s/it]Task 1, Epoch 20/20 => Loss 0.241, Train_accy 87.83, Test_accy 79.66:  95%|█████████▌| 19/20 [13:29<00:38, 38.87s/it]Task 1, Epoch 20/20 => Loss 0.241, Train_accy 87.83, Test_accy 79.66: 100%|██████████| 20/20 [13:29<00:00, 42.57s/it]Task 1, Epoch 20/20 => Loss 0.241, Train_accy 87.83, Test_accy 79.66: 100%|██████████| 20/20 [13:29<00:00, 40.48s/it]
2024-04-18 23:35:17,326 [l2p.py] => Task 1, Epoch 20/20 => Loss 0.241, Train_accy 87.83, Test_accy 79.66
2024-04-18 23:35:30,697 [trainer.py] => No NME accuracy.
2024-04-18 23:35:30,698 [trainer.py] => CNN: {'total': 79.66, '00-39': 81.83, '40-79': 77.23, 'old': 81.83, 'new': 77.23}
2024-04-18 23:35:30,698 [trainer.py] => CNN top1 curve: [83.88, 79.66]
2024-04-18 23:35:30,698 [trainer.py] => CNN top5 curve: [94.32, 92.35]

Average Accuracy (CNN): 81.77
2024-04-18 23:35:30,698 [trainer.py] => Average Accuracy (CNN): 81.77 

2024-04-18 23:35:30,698 [trainer.py] => Train Time: 3429.32
2024-04-18 23:35:30,698 [trainer.py] => Test Time: 20.82 

2024-04-18 23:35:30,700 [trainer.py] => All params: 171970192
2024-04-18 23:35:30,702 [trainer.py] => Trainable params: 199880
2024-04-18 23:35:30,702 [l2p.py] => Learning on 80-120
  0%|          | 0/20 [00:00<?, ?it/s]Task 2, Epoch 1/20 => Loss 1.111, Train_accy 67.09:   0%|          | 0/20 [00:40<?, ?it/s]Task 2, Epoch 1/20 => Loss 1.111, Train_accy 67.09:   5%|▌         | 1/20 [00:40<12:40, 40.00s/it]Task 2, Epoch 2/20 => Loss 0.587, Train_accy 79.05:   5%|▌         | 1/20 [01:19<12:40, 40.00s/it]Task 2, Epoch 2/20 => Loss 0.587, Train_accy 79.05:  10%|█         | 2/20 [01:19<11:54, 39.71s/it]Task 2, Epoch 3/20 => Loss 0.493, Train_accy 81.12:  10%|█         | 2/20 [01:59<11:54, 39.71s/it]Task 2, Epoch 3/20 => Loss 0.493, Train_accy 81.12:  15%|█▌        | 3/20 [01:59<11:14, 39.65s/it]Task 2, Epoch 4/20 => Loss 0.427, Train_accy 82.81:  15%|█▌        | 3/20 [02:38<11:14, 39.65s/it]Task 2, Epoch 4/20 => Loss 0.427, Train_accy 82.81:  20%|██        | 4/20 [02:38<10:33, 39.62s/it]Task 2, Epoch 5/20 => Loss 0.383, Train_accy 85.06, Test_accy 74.27:  20%|██        | 4/20 [03:38<10:33, 39.62s/it]Task 2, Epoch 5/20 => Loss 0.383, Train_accy 85.06, Test_accy 74.27:  25%|██▌       | 5/20 [03:38<11:43, 46.87s/it]Task 2, Epoch 6/20 => Loss 0.362, Train_accy 85.41:  25%|██▌       | 5/20 [04:18<11:43, 46.87s/it]                 Task 2, Epoch 6/20 => Loss 0.362, Train_accy 85.41:  30%|███       | 6/20 [04:18<10:23, 44.51s/it]Task 2, Epoch 7/20 => Loss 0.354, Train_accy 85.14:  30%|███       | 6/20 [04:57<10:23, 44.51s/it]Task 2, Epoch 7/20 => Loss 0.354, Train_accy 85.14:  35%|███▌      | 7/20 [04:57<09:17, 42.88s/it]Task 2, Epoch 8/20 => Loss 0.338, Train_accy 85.52:  35%|███▌      | 7/20 [05:37<09:17, 42.88s/it]Task 2, Epoch 8/20 => Loss 0.338, Train_accy 85.52:  40%|████      | 8/20 [05:37<08:20, 41.75s/it]Task 2, Epoch 9/20 => Loss 0.304, Train_accy 86.51:  40%|████      | 8/20 [06:16<08:20, 41.75s/it]Task 2, Epoch 9/20 => Loss 0.304, Train_accy 86.51:  45%|████▌     | 9/20 [06:16<07:32, 41.12s/it]Task 2, Epoch 10/20 => Loss 0.253, Train_accy 88.22, Test_accy 76.32:  45%|████▌     | 9/20 [07:15<07:32, 41.12s/it]Task 2, Epoch 10/20 => Loss 0.253, Train_accy 88.22, Test_accy 76.32:  50%|█████     | 10/20 [07:15<07:46, 46.62s/it]Task 2, Epoch 11/20 => Loss 0.285, Train_accy 86.94:  50%|█████     | 10/20 [07:55<07:46, 46.62s/it]                 Task 2, Epoch 11/20 => Loss 0.285, Train_accy 86.94:  55%|█████▌    | 11/20 [07:55<06:40, 44.45s/it]Task 2, Epoch 12/20 => Loss 0.285, Train_accy 87.40:  55%|█████▌    | 11/20 [08:34<06:40, 44.45s/it]Task 2, Epoch 12/20 => Loss 0.285, Train_accy 87.40:  60%|██████    | 12/20 [08:34<05:43, 42.97s/it]Task 2, Epoch 13/20 => Loss 0.275, Train_accy 87.52:  60%|██████    | 12/20 [09:14<05:43, 42.97s/it]Task 2, Epoch 13/20 => Loss 0.275, Train_accy 87.52:  65%|██████▌   | 13/20 [09:14<04:53, 41.94s/it]Task 2, Epoch 14/20 => Loss 0.218, Train_accy 88.76:  65%|██████▌   | 13/20 [09:54<04:53, 41.94s/it]Task 2, Epoch 14/20 => Loss 0.218, Train_accy 88.76:  70%|███████   | 14/20 [09:54<04:07, 41.26s/it]Task 2, Epoch 15/20 => Loss 0.227, Train_accy 88.80, Test_accy 76.84:  70%|███████   | 14/20 [10:53<04:07, 41.26s/it]Task 2, Epoch 15/20 => Loss 0.227, Train_accy 88.80, Test_accy 76.84:  75%|███████▌  | 15/20 [10:53<03:52, 46.55s/it]Task 2, Epoch 16/20 => Loss 0.236, Train_accy 88.06:  75%|███████▌  | 15/20 [11:32<03:52, 46.55s/it]                 Task 2, Epoch 16/20 => Loss 0.236, Train_accy 88.06:  80%|████████  | 16/20 [11:32<02:57, 44.41s/it]Task 2, Epoch 17/20 => Loss 0.227, Train_accy 88.80:  80%|████████  | 16/20 [12:11<02:57, 44.41s/it]Task 2, Epoch 17/20 => Loss 0.227, Train_accy 88.80:  85%|████████▌ | 17/20 [12:11<02:08, 42.89s/it]Task 2, Epoch 18/20 => Loss 0.240, Train_accy 88.72:  85%|████████▌ | 17/20 [12:51<02:08, 42.89s/it]Task 2, Epoch 18/20 => Loss 0.240, Train_accy 88.72:  90%|█████████ | 18/20 [12:51<01:23, 41.81s/it]Task 2, Epoch 19/20 => Loss 0.210, Train_accy 88.84:  90%|█████████ | 18/20 [13:30<01:23, 41.81s/it]Task 2, Epoch 19/20 => Loss 0.210, Train_accy 88.84:  95%|█████████▌| 19/20 [13:30<00:41, 41.05s/it]Task 2, Epoch 20/20 => Loss 0.228, Train_accy 88.72, Test_accy 75.91:  95%|█████████▌| 19/20 [14:28<00:41, 41.05s/it]Task 2, Epoch 20/20 => Loss 0.228, Train_accy 88.72, Test_accy 75.91: 100%|██████████| 20/20 [14:28<00:00, 46.32s/it]Task 2, Epoch 20/20 => Loss 0.228, Train_accy 88.72, Test_accy 75.91: 100%|██████████| 20/20 [14:28<00:00, 43.45s/it]
2024-04-18 23:49:59,717 [l2p.py] => Task 2, Epoch 20/20 => Loss 0.228, Train_accy 88.72, Test_accy 75.91
2024-04-18 23:50:18,997 [trainer.py] => No NME accuracy.
2024-04-18 23:50:18,997 [trainer.py] => CNN: {'total': 75.91, '00-39': 78.35, '40-79': 73.66, '80-119': 75.41, 'old': 76.14, 'new': 75.41}
2024-04-18 23:50:18,997 [trainer.py] => CNN top1 curve: [83.88, 79.66, 75.91]
2024-04-18 23:50:18,997 [trainer.py] => CNN top5 curve: [94.32, 92.35, 90.59]

Average Accuracy (CNN): 79.81666666666666
2024-04-18 23:50:18,997 [trainer.py] => Average Accuracy (CNN): 79.81666666666666 

2024-04-18 23:50:18,997 [trainer.py] => Train Time: 5167.31
2024-04-18 23:50:18,997 [trainer.py] => Test Time: 40.1 

2024-04-18 23:50:18,999 [trainer.py] => All params: 171970192
2024-04-18 23:50:19,000 [trainer.py] => Trainable params: 199880
2024-04-18 23:50:19,000 [l2p.py] => Learning on 120-160
  0%|          | 0/20 [00:00<?, ?it/s]Task 3, Epoch 1/20 => Loss 1.013, Train_accy 69.60:   0%|          | 0/20 [00:40<?, ?it/s]Task 3, Epoch 1/20 => Loss 1.013, Train_accy 69.60:   5%|▌         | 1/20 [00:40<12:49, 40.49s/it]Task 3, Epoch 2/20 => Loss 0.536, Train_accy 80.43:   5%|▌         | 1/20 [01:20<12:49, 40.49s/it]Task 3, Epoch 2/20 => Loss 0.536, Train_accy 80.43:  10%|█         | 2/20 [01:20<12:04, 40.23s/it]Task 3, Epoch 3/20 => Loss 0.415, Train_accy 83.52:  10%|█         | 2/20 [02:00<12:04, 40.23s/it]Task 3, Epoch 3/20 => Loss 0.415, Train_accy 83.52:  15%|█▌        | 3/20 [02:00<11:23, 40.22s/it]Task 3, Epoch 4/20 => Loss 0.377, Train_accy 84.88:  15%|█▌        | 3/20 [02:40<11:23, 40.22s/it]Task 3, Epoch 4/20 => Loss 0.377, Train_accy 84.88:  20%|██        | 4/20 [02:40<10:43, 40.21s/it]Task 3, Epoch 5/20 => Loss 0.297, Train_accy 87.19, Test_accy 73.09:  20%|██        | 4/20 [03:50<10:43, 40.21s/it]Task 3, Epoch 5/20 => Loss 0.297, Train_accy 87.19, Test_accy 73.09:  25%|██▌       | 5/20 [03:50<12:43, 50.89s/it]Task 3, Epoch 6/20 => Loss 0.300, Train_accy 86.72:  25%|██▌       | 5/20 [04:30<12:43, 50.89s/it]                 Task 3, Epoch 6/20 => Loss 0.300, Train_accy 86.72:  30%|███       | 6/20 [04:30<11:01, 47.27s/it]Task 3, Epoch 7/20 => Loss 0.290, Train_accy 87.53:  30%|███       | 6/20 [05:11<11:01, 47.27s/it]Task 3, Epoch 7/20 => Loss 0.290, Train_accy 87.53:  35%|███▌      | 7/20 [05:11<09:44, 44.96s/it]Task 3, Epoch 8/20 => Loss 0.249, Train_accy 88.54:  35%|███▌      | 7/20 [05:51<09:44, 44.96s/it]Task 3, Epoch 8/20 => Loss 0.249, Train_accy 88.54:  40%|████      | 8/20 [05:51<08:41, 43.47s/it]Task 3, Epoch 9/20 => Loss 0.232, Train_accy 88.87:  40%|████      | 8/20 [06:31<08:41, 43.47s/it]Task 3, Epoch 9/20 => Loss 0.232, Train_accy 88.87:  45%|████▌     | 9/20 [06:31<07:47, 42.54s/it]Task 3, Epoch 10/20 => Loss 0.232, Train_accy 88.74, Test_accy 74.61:  45%|████▌     | 9/20 [07:38<07:47, 42.54s/it]Task 3, Epoch 10/20 => Loss 0.232, Train_accy 88.74, Test_accy 74.61:  50%|█████     | 10/20 [07:38<08:19, 49.95s/it]Task 3, Epoch 11/20 => Loss 0.224, Train_accy 88.83:  50%|█████     | 10/20 [08:18<08:19, 49.95s/it]                 Task 3, Epoch 11/20 => Loss 0.224, Train_accy 88.83:  55%|█████▌    | 11/20 [08:18<07:03, 47.03s/it]Task 3, Epoch 12/20 => Loss 0.219, Train_accy 89.21:  55%|█████▌    | 11/20 [08:59<07:03, 47.03s/it]Task 3, Epoch 12/20 => Loss 0.219, Train_accy 89.21:  60%|██████    | 12/20 [08:59<06:00, 45.03s/it]Task 3, Epoch 13/20 => Loss 0.196, Train_accy 89.64:  60%|██████    | 12/20 [09:39<06:00, 45.03s/it]Task 3, Epoch 13/20 => Loss 0.196, Train_accy 89.64:  65%|██████▌   | 13/20 [09:39<05:05, 43.65s/it]Task 3, Epoch 14/20 => Loss 0.193, Train_accy 89.60:  65%|██████▌   | 13/20 [10:20<05:05, 43.65s/it]Task 3, Epoch 14/20 => Loss 0.193, Train_accy 89.60:  70%|███████   | 14/20 [10:20<04:15, 42.62s/it]Task 3, Epoch 15/20 => Loss 0.205, Train_accy 89.76, Test_accy 75.78:  70%|███████   | 14/20 [11:26<04:15, 42.62s/it]Task 3, Epoch 15/20 => Loss 0.205, Train_accy 89.76, Test_accy 75.78:  75%|███████▌  | 15/20 [11:26<04:09, 49.81s/it]Task 3, Epoch 16/20 => Loss 0.180, Train_accy 89.84:  75%|███████▌  | 15/20 [12:06<04:09, 49.81s/it]                 Task 3, Epoch 16/20 => Loss 0.180, Train_accy 89.84:  80%|████████  | 16/20 [12:06<03:07, 46.85s/it]Task 3, Epoch 17/20 => Loss 0.158, Train_accy 90.55:  80%|████████  | 16/20 [12:46<03:07, 46.85s/it]Task 3, Epoch 17/20 => Loss 0.158, Train_accy 90.55:  85%|████████▌ | 17/20 [12:46<02:14, 44.89s/it]Task 3, Epoch 18/20 => Loss 0.192, Train_accy 90.24:  85%|████████▌ | 17/20 [13:27<02:14, 44.89s/it]Task 3, Epoch 18/20 => Loss 0.192, Train_accy 90.24:  90%|█████████ | 18/20 [13:27<01:26, 43.47s/it]Task 3, Epoch 19/20 => Loss 0.191, Train_accy 89.74:  90%|█████████ | 18/20 [14:07<01:26, 43.47s/it]Task 3, Epoch 19/20 => Loss 0.191, Train_accy 89.74:  95%|█████████▌| 19/20 [14:07<00:42, 42.47s/it]Task 3, Epoch 20/20 => Loss 0.145, Train_accy 91.09, Test_accy 76.11:  95%|█████████▌| 19/20 [15:13<00:42, 42.47s/it]Task 3, Epoch 20/20 => Loss 0.145, Train_accy 91.09, Test_accy 76.11: 100%|██████████| 20/20 [15:13<00:00, 49.66s/it]Task 3, Epoch 20/20 => Loss 0.145, Train_accy 91.09, Test_accy 76.11: 100%|██████████| 20/20 [15:13<00:00, 45.68s/it]
2024-04-19 00:05:32,599 [l2p.py] => Task 3, Epoch 20/20 => Loss 0.145, Train_accy 91.09, Test_accy 76.11
2024-04-19 00:05:58,624 [trainer.py] => No NME accuracy.
2024-04-19 00:05:58,625 [trainer.py] => CNN: {'total': 76.11, '00-39': 76.91, '40-79': 73.07, '80-119': 73.76, '120-159': 80.12, 'old': 74.68, 'new': 80.12}
2024-04-19 00:05:58,625 [trainer.py] => CNN top1 curve: [83.88, 79.66, 75.91, 76.11]
2024-04-19 00:05:58,625 [trainer.py] => CNN top5 curve: [94.32, 92.35, 90.59, 89.48]

Average Accuracy (CNN): 78.89
2024-04-19 00:05:58,625 [trainer.py] => Average Accuracy (CNN): 78.89 

2024-04-19 00:05:58,625 [trainer.py] => Train Time: 6994.490000000001
2024-04-19 00:05:58,625 [trainer.py] => Test Time: 66.12 

2024-04-19 00:05:58,627 [trainer.py] => All params: 171970192
2024-04-19 00:05:58,629 [trainer.py] => Trainable params: 199880
2024-04-19 00:05:58,629 [l2p.py] => Learning on 160-200
  0%|          | 0/20 [00:00<?, ?it/s]Task 4, Epoch 1/20 => Loss 1.138, Train_accy 66.62:   0%|          | 0/20 [00:35<?, ?it/s]Task 4, Epoch 1/20 => Loss 1.138, Train_accy 66.62:   5%|▌         | 1/20 [00:35<11:09, 35.26s/it]Task 4, Epoch 2/20 => Loss 0.560, Train_accy 79.71:   5%|▌         | 1/20 [01:09<11:09, 35.26s/it]Task 4, Epoch 2/20 => Loss 0.560, Train_accy 79.71:  10%|█         | 2/20 [01:09<10:26, 34.82s/it]Task 4, Epoch 3/20 => Loss 0.463, Train_accy 82.76:  10%|█         | 2/20 [01:44<10:26, 34.82s/it]Task 4, Epoch 3/20 => Loss 0.463, Train_accy 82.76:  15%|█▌        | 3/20 [01:44<09:50, 34.75s/it]Task 4, Epoch 4/20 => Loss 0.380, Train_accy 84.33:  15%|█▌        | 3/20 [02:18<09:50, 34.75s/it]Task 4, Epoch 4/20 => Loss 0.380, Train_accy 84.33:  20%|██        | 4/20 [02:18<09:13, 34.60s/it]Task 4, Epoch 5/20 => Loss 0.355, Train_accy 85.30, Test_accy 72.53:  20%|██        | 4/20 [03:24<09:13, 34.60s/it]Task 4, Epoch 5/20 => Loss 0.355, Train_accy 85.30, Test_accy 72.53:  25%|██▌       | 5/20 [03:24<11:27, 45.83s/it]Task 4, Epoch 6/20 => Loss 0.295, Train_accy 86.87:  25%|██▌       | 5/20 [03:59<11:27, 45.83s/it]                 Task 4, Epoch 6/20 => Loss 0.295, Train_accy 86.87:  30%|███       | 6/20 [03:59<09:48, 42.03s/it]Task 4, Epoch 7/20 => Loss 0.294, Train_accy 87.32:  30%|███       | 6/20 [04:33<09:48, 42.03s/it]Task 4, Epoch 7/20 => Loss 0.294, Train_accy 87.32:  35%|███▌      | 7/20 [04:33<08:34, 39.56s/it]Task 4, Epoch 8/20 => Loss 0.304, Train_accy 86.46:  35%|███▌      | 7/20 [05:07<08:34, 39.56s/it]Task 4, Epoch 8/20 => Loss 0.304, Train_accy 86.46:  40%|████      | 8/20 [05:07<07:34, 37.87s/it]Task 4, Epoch 9/20 => Loss 0.256, Train_accy 88.48:  40%|████      | 8/20 [05:42<07:34, 37.87s/it]Task 4, Epoch 9/20 => Loss 0.256, Train_accy 88.48:  45%|████▌     | 9/20 [05:42<06:44, 36.77s/it]Task 4, Epoch 10/20 => Loss 0.224, Train_accy 88.81, Test_accy 73.47:  45%|████▌     | 9/20 [06:48<06:44, 36.77s/it]Task 4, Epoch 10/20 => Loss 0.224, Train_accy 88.81, Test_accy 73.47:  50%|█████     | 10/20 [06:48<07:37, 45.75s/it]Task 4, Epoch 11/20 => Loss 0.248, Train_accy 88.00:  50%|█████     | 10/20 [07:22<07:37, 45.75s/it]                 Task 4, Epoch 11/20 => Loss 0.248, Train_accy 88.00:  55%|█████▌    | 11/20 [07:22<06:19, 42.22s/it]Task 4, Epoch 12/20 => Loss 0.216, Train_accy 89.14:  55%|█████▌    | 11/20 [07:56<06:19, 42.22s/it]Task 4, Epoch 12/20 => Loss 0.216, Train_accy 89.14:  60%|██████    | 12/20 [07:56<05:18, 39.86s/it]Task 4, Epoch 13/20 => Loss 0.200, Train_accy 89.12:  60%|██████    | 12/20 [08:31<05:18, 39.86s/it]Task 4, Epoch 13/20 => Loss 0.200, Train_accy 89.12:  65%|██████▌   | 13/20 [08:31<04:27, 38.19s/it]Task 4, Epoch 14/20 => Loss 0.182, Train_accy 90.16:  65%|██████▌   | 13/20 [09:05<04:27, 38.19s/it]Task 4, Epoch 14/20 => Loss 0.182, Train_accy 90.16:  70%|███████   | 14/20 [09:05<03:42, 37.03s/it]Task 4, Epoch 15/20 => Loss 0.194, Train_accy 90.11, Test_accy 73.77:  70%|███████   | 14/20 [10:11<03:42, 37.03s/it]Task 4, Epoch 15/20 => Loss 0.194, Train_accy 90.11, Test_accy 73.77:  75%|███████▌  | 15/20 [10:11<03:49, 45.81s/it]Task 4, Epoch 16/20 => Loss 0.225, Train_accy 88.62:  75%|███████▌  | 15/20 [10:46<03:49, 45.81s/it]                 Task 4, Epoch 16/20 => Loss 0.225, Train_accy 88.62:  80%|████████  | 16/20 [10:46<02:49, 42.37s/it]Task 4, Epoch 17/20 => Loss 0.191, Train_accy 89.83:  80%|████████  | 16/20 [11:20<02:49, 42.37s/it]Task 4, Epoch 17/20 => Loss 0.191, Train_accy 89.83:  85%|████████▌ | 17/20 [11:20<01:59, 39.94s/it]Task 4, Epoch 18/20 => Loss 0.221, Train_accy 88.55:  85%|████████▌ | 17/20 [11:54<01:59, 39.94s/it]Task 4, Epoch 18/20 => Loss 0.221, Train_accy 88.55:  90%|█████████ | 18/20 [11:54<01:16, 38.26s/it]Task 4, Epoch 19/20 => Loss 0.138, Train_accy 90.75:  90%|█████████ | 18/20 [12:29<01:16, 38.26s/it]Task 4, Epoch 19/20 => Loss 0.138, Train_accy 90.75:  95%|█████████▌| 19/20 [12:29<00:37, 37.12s/it]Task 4, Epoch 20/20 => Loss 0.166, Train_accy 90.54, Test_accy 73.95:  95%|█████████▌| 19/20 [13:34<00:37, 37.12s/it]Task 4, Epoch 20/20 => Loss 0.166, Train_accy 90.54, Test_accy 73.95: 100%|██████████| 20/20 [13:34<00:00, 45.69s/it]Task 4, Epoch 20/20 => Loss 0.166, Train_accy 90.54, Test_accy 73.95: 100%|██████████| 20/20 [13:34<00:00, 40.74s/it]
2024-04-19 00:19:33,465 [l2p.py] => Task 4, Epoch 20/20 => Loss 0.166, Train_accy 90.54, Test_accy 73.95
2024-04-19 00:20:04,870 [trainer.py] => No NME accuracy.
2024-04-19 00:20:04,870 [trainer.py] => CNN: {'total': 73.95, '00-39': 74.56, '40-79': 71.96, '80-119': 71.14, '120-159': 79.66, '160-199': 71.43, 'old': 74.49, 'new': 71.43}
2024-04-19 00:20:04,871 [trainer.py] => CNN top1 curve: [83.88, 79.66, 75.91, 76.11, 73.95]
2024-04-19 00:20:04,871 [trainer.py] => CNN top5 curve: [94.32, 92.35, 90.59, 89.48, 88.4]

Average Accuracy (CNN): 77.902
2024-04-19 00:20:04,871 [trainer.py] => Average Accuracy (CNN): 77.902 

2024-04-19 00:20:04,871 [trainer.py] => Train Time: 8624.130000000001
2024-04-19 00:20:04,871 [trainer.py] => Test Time: 97.52000000000001 

Accuracy Matrix (CNN):
[[83.88 81.83 78.35 76.91 74.56]
 [ 0.   77.23 73.66 73.07 71.96]
 [ 0.    0.   75.41 73.76 71.14]
 [ 0.    0.    0.   80.12 79.66]
 [ 0.    0.    0.    0.   71.43]]
2024-04-19 00:20:04,872 [trainer.py] => Forgetting (CNN): 4.830000000000002
2024-04-19 00:20:08,414 [trainer.py] => config: ./exps/dualprompt_inr.json
2024-04-19 00:20:08,414 [trainer.py] => prefix:  
2024-04-19 00:20:08,414 [trainer.py] => dataset: imagenetr
2024-04-19 00:20:08,414 [trainer.py] => memory_size: 0
2024-04-19 00:20:08,414 [trainer.py] => memory_per_class: 0
2024-04-19 00:20:08,414 [trainer.py] => fixed_memory: False
2024-04-19 00:20:08,414 [trainer.py] => shuffle: True
2024-04-19 00:20:08,415 [trainer.py] => init_cls: 40
2024-04-19 00:20:08,415 [trainer.py] => increment: 40
2024-04-19 00:20:08,415 [trainer.py] => model_name: dualprompt
2024-04-19 00:20:08,415 [trainer.py] => backbone_type: vit_base_patch16_224_dualprompt
2024-04-19 00:20:08,415 [trainer.py] => get_original_backbone: True
2024-04-19 00:20:08,415 [trainer.py] => device: [device(type='cuda', index=4)]
2024-04-19 00:20:08,415 [trainer.py] => seed: 1993
2024-04-19 00:20:08,415 [trainer.py] => tuned_epoch: 20
2024-04-19 00:20:08,415 [trainer.py] => init_lr: 0.001
2024-04-19 00:20:08,415 [trainer.py] => batch_size: 48
2024-04-19 00:20:08,415 [trainer.py] => weight_decay: 0
2024-04-19 00:20:08,415 [trainer.py] => min_lr: 1e-05
2024-04-19 00:20:08,416 [trainer.py] => optimizer: adam
2024-04-19 00:20:08,416 [trainer.py] => scheduler: constant
2024-04-19 00:20:08,416 [trainer.py] => reinit_optimizer: True
2024-04-19 00:20:08,416 [trainer.py] => global_pool: token
2024-04-19 00:20:08,416 [trainer.py] => head_type: token
2024-04-19 00:20:08,416 [trainer.py] => freeze: ['blocks', 'patch_embed', 'cls_token', 'norm', 'pos_embed']
2024-04-19 00:20:08,416 [trainer.py] => pretrained: True
2024-04-19 00:20:08,416 [trainer.py] => drop: 0.0
2024-04-19 00:20:08,416 [trainer.py] => drop_path: 0.0
2024-04-19 00:20:08,416 [trainer.py] => use_g_prompt: True
2024-04-19 00:20:08,416 [trainer.py] => g_prompt_length: 5
2024-04-19 00:20:08,416 [trainer.py] => g_prompt_layer_idx: [0, 1]
2024-04-19 00:20:08,417 [trainer.py] => use_prefix_tune_for_g_prompt: True
2024-04-19 00:20:08,417 [trainer.py] => use_e_prompt: True
2024-04-19 00:20:08,417 [trainer.py] => e_prompt_layer_idx: [2, 3, 4]
2024-04-19 00:20:08,417 [trainer.py] => use_prefix_tune_for_e_prompt: True
2024-04-19 00:20:08,417 [trainer.py] => prompt_pool: True
2024-04-19 00:20:08,417 [trainer.py] => size: 10
2024-04-19 00:20:08,417 [trainer.py] => length: 5
2024-04-19 00:20:08,417 [trainer.py] => top_k: 1
2024-04-19 00:20:08,417 [trainer.py] => initializer: uniform
2024-04-19 00:20:08,417 [trainer.py] => prompt_key: True
2024-04-19 00:20:08,417 [trainer.py] => prompt_key_init: uniform
2024-04-19 00:20:08,417 [trainer.py] => use_prompt_mask: True
2024-04-19 00:20:08,417 [trainer.py] => shared_prompt_pool: True
2024-04-19 00:20:08,418 [trainer.py] => shared_prompt_key: False
2024-04-19 00:20:08,418 [trainer.py] => batchwise_prompt: True
2024-04-19 00:20:08,418 [trainer.py] => embedding_key: cls
2024-04-19 00:20:08,418 [trainer.py] => predefined_key: 
2024-04-19 00:20:08,418 [trainer.py] => pull_constraint: True
2024-04-19 00:20:08,418 [trainer.py] => pull_constraint_coeff: 0.1
2024-04-19 00:20:08,418 [trainer.py] => same_key_value: False
2024-04-19 00:20:08,519 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
2024-04-19 00:20:14,026 [dualprompt.py] => 86,205,896 model total parameters.
2024-04-19 00:20:14,027 [dualprompt.py] => 407,240 model training parameters.
2024-04-19 00:20:14,027 [dualprompt.py] => g_prompt: 15360
2024-04-19 00:20:14,027 [dualprompt.py] => e_prompt.prompt: 230400
2024-04-19 00:20:14,027 [dualprompt.py] => e_prompt.prompt_key: 7680
2024-04-19 00:20:14,028 [dualprompt.py] => head.weight: 153600
2024-04-19 00:20:14,028 [dualprompt.py] => head.bias: 200
2024-04-19 00:20:14,029 [trainer.py] => All params: 172158352
2024-04-19 00:20:14,030 [trainer.py] => Trainable params: 407240
2024-04-19 00:20:14,030 [dualprompt.py] => Learning on 0-40
  0%|          | 0/20 [00:00<?, ?it/s]Task 0, Epoch 1/20 => Loss 1.650, Train_accy 59.24:   0%|          | 0/20 [00:40<?, ?it/s]Task 0, Epoch 1/20 => Loss 1.650, Train_accy 59.24:   5%|▌         | 1/20 [00:40<12:40, 40.01s/it]Task 0, Epoch 2/20 => Loss 0.890, Train_accy 75.57:   5%|▌         | 1/20 [01:19<12:40, 40.01s/it]Task 0, Epoch 2/20 => Loss 0.890, Train_accy 75.57:  10%|█         | 2/20 [01:19<11:59, 39.96s/it]Task 0, Epoch 3/20 => Loss 0.765, Train_accy 78.48:  10%|█         | 2/20 [01:59<11:59, 39.96s/it]Task 0, Epoch 3/20 => Loss 0.765, Train_accy 78.48:  15%|█▌        | 3/20 [01:59<11:18, 39.91s/it]Task 0, Epoch 4/20 => Loss 0.641, Train_accy 81.64:  15%|█▌        | 3/20 [02:39<11:18, 39.91s/it]Task 0, Epoch 4/20 => Loss 0.641, Train_accy 81.64:  20%|██        | 4/20 [02:39<10:36, 39.80s/it]Task 0, Epoch 5/20 => Loss 0.592, Train_accy 82.89, Test_accy 80.17:  20%|██        | 4/20 [03:26<10:36, 39.80s/it]Task 0, Epoch 5/20 => Loss 0.592, Train_accy 82.89, Test_accy 80.17:  25%|██▌       | 5/20 [03:26<10:33, 42.27s/it]Task 0, Epoch 6/20 => Loss 0.580, Train_accy 83.79:  25%|██▌       | 5/20 [04:05<10:33, 42.27s/it]                 Task 0, Epoch 6/20 => Loss 0.580, Train_accy 83.79:  30%|███       | 6/20 [04:05<09:39, 41.41s/it]Task 0, Epoch 7/20 => Loss 0.551, Train_accy 84.48:  30%|███       | 6/20 [04:45<09:39, 41.41s/it]Task 0, Epoch 7/20 => Loss 0.551, Train_accy 84.48:  35%|███▌      | 7/20 [04:45<08:51, 40.86s/it]Task 0, Epoch 8/20 => Loss 0.503, Train_accy 85.54:  35%|███▌      | 7/20 [05:25<08:51, 40.86s/it]Task 0, Epoch 8/20 => Loss 0.503, Train_accy 85.54:  40%|████      | 8/20 [05:25<08:05, 40.49s/it]Task 0, Epoch 9/20 => Loss 0.496, Train_accy 85.54:  40%|████      | 8/20 [06:04<08:05, 40.49s/it]Task 0, Epoch 9/20 => Loss 0.496, Train_accy 85.54:  45%|████▌     | 9/20 [06:04<07:22, 40.20s/it]Task 0, Epoch 10/20 => Loss 0.475, Train_accy 86.99, Test_accy 82.82:  45%|████▌     | 9/20 [06:51<07:22, 40.20s/it]Task 0, Epoch 10/20 => Loss 0.475, Train_accy 86.99, Test_accy 82.82:  50%|█████     | 10/20 [06:51<07:01, 42.18s/it]Task 0, Epoch 11/20 => Loss 0.452, Train_accy 86.84:  50%|█████     | 10/20 [07:31<07:01, 42.18s/it]                 Task 0, Epoch 11/20 => Loss 0.452, Train_accy 86.84:  55%|█████▌    | 11/20 [07:31<06:12, 41.43s/it]Task 0, Epoch 12/20 => Loss 0.457, Train_accy 86.51:  55%|█████▌    | 11/20 [08:10<06:12, 41.43s/it]Task 0, Epoch 12/20 => Loss 0.457, Train_accy 86.51:  60%|██████    | 12/20 [08:10<05:27, 40.91s/it]Task 0, Epoch 13/20 => Loss 0.425, Train_accy 87.25:  60%|██████    | 12/20 [08:50<05:27, 40.91s/it]Task 0, Epoch 13/20 => Loss 0.425, Train_accy 87.25:  65%|██████▌   | 13/20 [08:50<04:43, 40.55s/it]Task 0, Epoch 14/20 => Loss 0.423, Train_accy 87.72:  65%|██████▌   | 13/20 [09:30<04:43, 40.55s/it]Task 0, Epoch 14/20 => Loss 0.423, Train_accy 87.72:  70%|███████   | 14/20 [09:30<04:02, 40.34s/it]Task 0, Epoch 15/20 => Loss 0.443, Train_accy 87.14, Test_accy 81.60:  70%|███████   | 14/20 [10:17<04:02, 40.34s/it]Task 0, Epoch 15/20 => Loss 0.443, Train_accy 87.14, Test_accy 81.60:  75%|███████▌  | 15/20 [10:17<03:31, 42.34s/it]Task 0, Epoch 16/20 => Loss 0.391, Train_accy 88.56:  75%|███████▌  | 15/20 [10:57<03:31, 42.34s/it]                 Task 0, Epoch 16/20 => Loss 0.391, Train_accy 88.56:  80%|████████  | 16/20 [10:57<02:46, 41.57s/it]Task 0, Epoch 17/20 => Loss 0.425, Train_accy 88.35:  80%|████████  | 16/20 [11:36<02:46, 41.57s/it]Task 0, Epoch 17/20 => Loss 0.425, Train_accy 88.35:  85%|████████▌ | 17/20 [11:36<02:02, 40.97s/it]Task 0, Epoch 18/20 => Loss 0.391, Train_accy 88.95:  85%|████████▌ | 17/20 [12:16<02:02, 40.97s/it]Task 0, Epoch 18/20 => Loss 0.391, Train_accy 88.95:  90%|█████████ | 18/20 [12:16<01:21, 40.72s/it]Task 0, Epoch 19/20 => Loss 0.408, Train_accy 88.17:  90%|█████████ | 18/20 [12:56<01:21, 40.72s/it]Task 0, Epoch 19/20 => Loss 0.408, Train_accy 88.17:  95%|█████████▌| 19/20 [12:56<00:40, 40.51s/it]Task 0, Epoch 20/20 => Loss 0.386, Train_accy 88.73, Test_accy 82.74:  95%|█████████▌| 19/20 [13:43<00:40, 40.51s/it]Task 0, Epoch 20/20 => Loss 0.386, Train_accy 88.73, Test_accy 82.74: 100%|██████████| 20/20 [13:43<00:00, 42.34s/it]Task 0, Epoch 20/20 => Loss 0.386, Train_accy 88.73, Test_accy 82.74: 100%|██████████| 20/20 [13:43<00:00, 41.18s/it]
2024-04-19 00:33:58,264 [dualprompt.py] => Task 0, Epoch 20/20 => Loss 0.386, Train_accy 88.73, Test_accy 82.74
2024-04-19 00:34:05,321 [trainer.py] => No NME accuracy.
2024-04-19 00:34:05,321 [trainer.py] => CNN: {'total': 82.74, '00-39': 82.74, 'old': 0, 'new': 82.74}
2024-04-19 00:34:05,322 [trainer.py] => CNN top1 curve: [82.74]
2024-04-19 00:34:05,322 [trainer.py] => CNN top5 curve: [94.1]

Average Accuracy (CNN): 82.74
2024-04-19 00:34:05,322 [trainer.py] => Average Accuracy (CNN): 82.74 

2024-04-19 00:34:05,322 [trainer.py] => Train Time: 1647.75
2024-04-19 00:34:05,322 [trainer.py] => Test Time: 7.06 

2024-04-19 00:34:05,325 [trainer.py] => All params: 172158352
2024-04-19 00:34:05,327 [trainer.py] => Trainable params: 407240
2024-04-19 00:34:05,327 [dualprompt.py] => Learning on 40-80
  0%|          | 0/20 [00:00<?, ?it/s]Task 1, Epoch 1/20 => Loss 1.798, Train_accy 57.46:   0%|          | 0/20 [00:34<?, ?it/s]Task 1, Epoch 1/20 => Loss 1.798, Train_accy 57.46:   5%|▌         | 1/20 [00:34<10:52, 34.37s/it]Task 1, Epoch 2/20 => Loss 0.958, Train_accy 74.46:   5%|▌         | 1/20 [01:08<10:52, 34.37s/it]Task 1, Epoch 2/20 => Loss 0.958, Train_accy 74.46:  10%|█         | 2/20 [01:08<10:20, 34.48s/it]Task 1, Epoch 3/20 => Loss 0.783, Train_accy 78.45:  10%|█         | 2/20 [01:43<10:20, 34.48s/it]Task 1, Epoch 3/20 => Loss 0.783, Train_accy 78.45:  15%|█▌        | 3/20 [01:43<09:45, 34.42s/it]Task 1, Epoch 4/20 => Loss 0.673, Train_accy 80.87:  15%|█▌        | 3/20 [02:17<09:45, 34.42s/it]Task 1, Epoch 4/20 => Loss 0.673, Train_accy 80.87:  20%|██        | 4/20 [02:17<09:11, 34.45s/it]Task 1, Epoch 5/20 => Loss 0.625, Train_accy 82.79, Test_accy 74.54:  20%|██        | 4/20 [03:04<09:11, 34.45s/it]Task 1, Epoch 5/20 => Loss 0.625, Train_accy 82.79, Test_accy 74.54:  25%|██▌       | 5/20 [03:04<09:45, 39.01s/it]Task 1, Epoch 6/20 => Loss 0.596, Train_accy 83.74:  25%|██▌       | 5/20 [03:39<09:45, 39.01s/it]                 Task 1, Epoch 6/20 => Loss 0.596, Train_accy 83.74:  30%|███       | 6/20 [03:39<08:44, 37.44s/it]Task 1, Epoch 7/20 => Loss 0.558, Train_accy 84.23:  30%|███       | 6/20 [04:13<08:44, 37.44s/it]Task 1, Epoch 7/20 => Loss 0.558, Train_accy 84.23:  35%|███▌      | 7/20 [04:13<07:54, 36.53s/it]Task 1, Epoch 8/20 => Loss 0.531, Train_accy 85.27:  35%|███▌      | 7/20 [04:48<07:54, 36.53s/it]Task 1, Epoch 8/20 => Loss 0.531, Train_accy 85.27:  40%|████      | 8/20 [04:48<07:10, 35.90s/it]Task 1, Epoch 9/20 => Loss 0.497, Train_accy 85.59:  40%|████      | 8/20 [05:22<07:10, 35.90s/it]Task 1, Epoch 9/20 => Loss 0.497, Train_accy 85.59:  45%|████▌     | 9/20 [05:22<06:29, 35.40s/it]Task 1, Epoch 10/20 => Loss 0.481, Train_accy 86.54, Test_accy 76.50:  45%|████▌     | 9/20 [06:09<06:29, 35.40s/it]Task 1, Epoch 10/20 => Loss 0.481, Train_accy 86.54, Test_accy 76.50:  50%|█████     | 10/20 [06:09<06:29, 38.98s/it]Task 1, Epoch 11/20 => Loss 0.463, Train_accy 86.71:  50%|█████     | 10/20 [06:44<06:29, 38.98s/it]                 Task 1, Epoch 11/20 => Loss 0.463, Train_accy 86.71:  55%|█████▌    | 11/20 [06:44<05:38, 37.59s/it]Task 1, Epoch 12/20 => Loss 0.477, Train_accy 86.76:  55%|█████▌    | 11/20 [07:18<05:38, 37.59s/it]Task 1, Epoch 12/20 => Loss 0.477, Train_accy 86.76:  60%|██████    | 12/20 [07:18<04:52, 36.61s/it]Task 1, Epoch 13/20 => Loss 0.443, Train_accy 87.32:  60%|██████    | 12/20 [07:53<04:52, 36.61s/it]Task 1, Epoch 13/20 => Loss 0.443, Train_accy 87.32:  65%|██████▌   | 13/20 [07:53<04:11, 35.95s/it]Task 1, Epoch 14/20 => Loss 0.409, Train_accy 88.37:  65%|██████▌   | 13/20 [08:27<04:11, 35.95s/it]Task 1, Epoch 14/20 => Loss 0.409, Train_accy 88.37:  70%|███████   | 14/20 [08:27<03:33, 35.51s/it]Task 1, Epoch 15/20 => Loss 0.420, Train_accy 87.86, Test_accy 77.50:  70%|███████   | 14/20 [09:14<03:33, 35.51s/it]Task 1, Epoch 15/20 => Loss 0.420, Train_accy 87.86, Test_accy 77.50:  75%|███████▌  | 15/20 [09:14<03:15, 39.03s/it]Task 1, Epoch 16/20 => Loss 0.412, Train_accy 88.63:  75%|███████▌  | 15/20 [09:49<03:15, 39.03s/it]                 Task 1, Epoch 16/20 => Loss 0.412, Train_accy 88.63:  80%|████████  | 16/20 [09:49<02:30, 37.62s/it]Task 1, Epoch 17/20 => Loss 0.396, Train_accy 88.81:  80%|████████  | 16/20 [10:23<02:30, 37.62s/it]Task 1, Epoch 17/20 => Loss 0.396, Train_accy 88.81:  85%|████████▌ | 17/20 [10:23<01:49, 36.66s/it]Task 1, Epoch 18/20 => Loss 0.396, Train_accy 88.52:  85%|████████▌ | 17/20 [10:57<01:49, 36.66s/it]Task 1, Epoch 18/20 => Loss 0.396, Train_accy 88.52:  90%|█████████ | 18/20 [10:57<01:12, 36.02s/it]Task 1, Epoch 19/20 => Loss 0.432, Train_accy 87.70:  90%|█████████ | 18/20 [11:32<01:12, 36.02s/it]Task 1, Epoch 19/20 => Loss 0.432, Train_accy 87.70:  95%|█████████▌| 19/20 [11:32<00:35, 35.61s/it]Task 1, Epoch 20/20 => Loss 0.400, Train_accy 88.42, Test_accy 77.22:  95%|█████████▌| 19/20 [12:20<00:35, 35.61s/it]Task 1, Epoch 20/20 => Loss 0.400, Train_accy 88.42, Test_accy 77.22: 100%|██████████| 20/20 [12:20<00:00, 39.21s/it]Task 1, Epoch 20/20 => Loss 0.400, Train_accy 88.42, Test_accy 77.22: 100%|██████████| 20/20 [12:20<00:00, 37.01s/it]
2024-04-19 00:46:25,586 [dualprompt.py] => Task 1, Epoch 20/20 => Loss 0.400, Train_accy 88.42, Test_accy 77.22
2024-04-19 00:46:38,503 [trainer.py] => No NME accuracy.
2024-04-19 00:46:38,504 [trainer.py] => CNN: {'total': 77.22, '00-39': 79.49, '40-79': 74.68, 'old': 79.49, 'new': 74.68}
2024-04-19 00:46:38,504 [trainer.py] => CNN top1 curve: [82.74, 77.22]
2024-04-19 00:46:38,504 [trainer.py] => CNN top5 curve: [94.1, 90.71]

Average Accuracy (CNN): 79.97999999999999
2024-04-19 00:46:38,505 [trainer.py] => Average Accuracy (CNN): 79.97999999999999 

2024-04-19 00:46:38,505 [trainer.py] => Train Time: 3128.2599999999998
2024-04-19 00:46:38,505 [trainer.py] => Test Time: 19.96 

2024-04-19 00:46:38,508 [trainer.py] => All params: 172158352
2024-04-19 00:46:38,510 [trainer.py] => Trainable params: 407240
2024-04-19 00:46:38,510 [dualprompt.py] => Learning on 80-120
  0%|          | 0/20 [00:00<?, ?it/s]Task 2, Epoch 1/20 => Loss 1.623, Train_accy 61.05:   0%|          | 0/20 [00:36<?, ?it/s]Task 2, Epoch 1/20 => Loss 1.623, Train_accy 61.05:   5%|▌         | 1/20 [00:36<11:37, 36.71s/it]Task 2, Epoch 2/20 => Loss 0.862, Train_accy 76.96:   5%|▌         | 1/20 [01:12<11:37, 36.71s/it]Task 2, Epoch 2/20 => Loss 0.862, Train_accy 76.96:  10%|█         | 2/20 [01:12<10:51, 36.20s/it]Task 2, Epoch 3/20 => Loss 0.742, Train_accy 79.17:  10%|█         | 2/20 [01:48<10:51, 36.20s/it]Task 2, Epoch 3/20 => Loss 0.742, Train_accy 79.17:  15%|█▌        | 3/20 [01:48<10:14, 36.13s/it]Task 2, Epoch 4/20 => Loss 0.668, Train_accy 81.63:  15%|█▌        | 3/20 [02:24<10:14, 36.13s/it]Task 2, Epoch 4/20 => Loss 0.668, Train_accy 81.63:  20%|██        | 4/20 [02:24<09:38, 36.14s/it]Task 2, Epoch 5/20 => Loss 0.585, Train_accy 83.97, Test_accy 72.07:  20%|██        | 4/20 [03:19<09:38, 36.14s/it]Task 2, Epoch 5/20 => Loss 0.585, Train_accy 83.97, Test_accy 72.07:  25%|██▌       | 5/20 [03:19<10:40, 42.72s/it]Task 2, Epoch 6/20 => Loss 0.536, Train_accy 84.77:  25%|██▌       | 5/20 [03:55<10:40, 42.72s/it]                 Task 2, Epoch 6/20 => Loss 0.536, Train_accy 84.77:  30%|███       | 6/20 [03:55<09:26, 40.49s/it]Task 2, Epoch 7/20 => Loss 0.514, Train_accy 85.19:  30%|███       | 6/20 [04:31<09:26, 40.49s/it]Task 2, Epoch 7/20 => Loss 0.514, Train_accy 85.19:  35%|███▌      | 7/20 [04:31<08:26, 38.96s/it]Task 2, Epoch 8/20 => Loss 0.457, Train_accy 86.80:  35%|███▌      | 7/20 [05:06<08:26, 38.96s/it]Task 2, Epoch 8/20 => Loss 0.457, Train_accy 86.80:  40%|████      | 8/20 [05:06<07:35, 37.93s/it]Task 2, Epoch 9/20 => Loss 0.464, Train_accy 87.05:  40%|████      | 8/20 [05:42<07:35, 37.93s/it]Task 2, Epoch 9/20 => Loss 0.464, Train_accy 87.05:  45%|████▌     | 9/20 [05:42<06:49, 37.27s/it]Task 2, Epoch 10/20 => Loss 0.422, Train_accy 87.54, Test_accy 73.53:  45%|████▌     | 9/20 [06:37<06:49, 37.27s/it]Task 2, Epoch 10/20 => Loss 0.422, Train_accy 87.54, Test_accy 73.53:  50%|█████     | 10/20 [06:37<07:06, 42.62s/it]Task 2, Epoch 11/20 => Loss 0.453, Train_accy 87.21:  50%|█████     | 10/20 [07:13<07:06, 42.62s/it]                 Task 2, Epoch 11/20 => Loss 0.453, Train_accy 87.21:  55%|█████▌    | 11/20 [07:13<06:04, 40.53s/it]Task 2, Epoch 12/20 => Loss 0.421, Train_accy 87.54:  55%|█████▌    | 11/20 [07:48<06:04, 40.53s/it]Task 2, Epoch 12/20 => Loss 0.421, Train_accy 87.54:  60%|██████    | 12/20 [07:48<05:12, 39.05s/it]Task 2, Epoch 13/20 => Loss 0.413, Train_accy 87.67:  60%|██████    | 12/20 [08:24<05:12, 39.05s/it]Task 2, Epoch 13/20 => Loss 0.413, Train_accy 87.67:  65%|██████▌   | 13/20 [08:24<04:26, 38.08s/it]Task 2, Epoch 14/20 => Loss 0.418, Train_accy 87.77:  65%|██████▌   | 13/20 [09:00<04:26, 38.08s/it]Task 2, Epoch 14/20 => Loss 0.418, Train_accy 87.77:  70%|███████   | 14/20 [09:00<03:44, 37.47s/it]Task 2, Epoch 15/20 => Loss 0.390, Train_accy 88.80, Test_accy 74.21:  70%|███████   | 14/20 [09:55<03:44, 37.47s/it]Task 2, Epoch 15/20 => Loss 0.390, Train_accy 88.80, Test_accy 74.21:  75%|███████▌  | 15/20 [09:55<03:33, 42.61s/it]Task 2, Epoch 16/20 => Loss 0.375, Train_accy 88.97:  75%|███████▌  | 15/20 [10:31<03:33, 42.61s/it]                 Task 2, Epoch 16/20 => Loss 0.375, Train_accy 88.97:  80%|████████  | 16/20 [10:31<02:42, 40.66s/it]Task 2, Epoch 17/20 => Loss 0.387, Train_accy 88.82:  80%|████████  | 16/20 [11:07<02:42, 40.66s/it]Task 2, Epoch 17/20 => Loss 0.387, Train_accy 88.82:  85%|████████▌ | 17/20 [11:07<01:57, 39.29s/it]Task 2, Epoch 18/20 => Loss 0.382, Train_accy 89.40:  85%|████████▌ | 17/20 [11:43<01:57, 39.29s/it]Task 2, Epoch 18/20 => Loss 0.382, Train_accy 89.40:  90%|█████████ | 18/20 [11:43<01:16, 38.24s/it]Task 2, Epoch 19/20 => Loss 0.380, Train_accy 88.66:  90%|█████████ | 18/20 [12:19<01:16, 38.24s/it]Task 2, Epoch 19/20 => Loss 0.380, Train_accy 88.66:  95%|█████████▌| 19/20 [12:19<00:37, 37.71s/it]Task 2, Epoch 20/20 => Loss 0.386, Train_accy 89.01, Test_accy 74.07:  95%|█████████▌| 19/20 [13:13<00:37, 37.71s/it]Task 2, Epoch 20/20 => Loss 0.386, Train_accy 89.01, Test_accy 74.07: 100%|██████████| 20/20 [13:13<00:00, 42.67s/it]Task 2, Epoch 20/20 => Loss 0.386, Train_accy 89.01, Test_accy 74.07: 100%|██████████| 20/20 [13:13<00:00, 39.69s/it]
2024-04-19 00:59:52,420 [dualprompt.py] => Task 2, Epoch 20/20 => Loss 0.386, Train_accy 89.01, Test_accy 74.07
2024-04-19 01:00:11,003 [trainer.py] => No NME accuracy.
2024-04-19 01:00:11,003 [trainer.py] => CNN: {'total': 74.07, '00-39': 76.61, '40-79': 72.05, '80-119': 73.23, 'old': 74.46, 'new': 73.23}
2024-04-19 01:00:11,003 [trainer.py] => CNN top1 curve: [82.74, 77.22, 74.07]
2024-04-19 01:00:11,003 [trainer.py] => CNN top5 curve: [94.1, 90.71, 88.53]

Average Accuracy (CNN): 78.00999999999999
2024-04-19 01:00:11,003 [trainer.py] => Average Accuracy (CNN): 78.00999999999999 

2024-04-19 01:00:11,003 [trainer.py] => Train Time: 4716.049999999999
2024-04-19 01:00:11,003 [trainer.py] => Test Time: 38.54 

2024-04-19 01:00:11,005 [trainer.py] => All params: 172158352
2024-04-19 01:00:11,007 [trainer.py] => Trainable params: 407240
2024-04-19 01:00:11,007 [dualprompt.py] => Learning on 120-160
  0%|          | 0/20 [00:00<?, ?it/s]Task 3, Epoch 1/20 => Loss 1.486, Train_accy 64.35:   0%|          | 0/20 [00:36<?, ?it/s]Task 3, Epoch 1/20 => Loss 1.486, Train_accy 64.35:   5%|▌         | 1/20 [00:36<11:39, 36.81s/it]Task 3, Epoch 2/20 => Loss 0.778, Train_accy 79.70:   5%|▌         | 1/20 [01:13<11:39, 36.81s/it]Task 3, Epoch 2/20 => Loss 0.778, Train_accy 79.70:  10%|█         | 2/20 [01:13<11:03, 36.87s/it]Task 3, Epoch 3/20 => Loss 0.637, Train_accy 82.45:  10%|█         | 2/20 [01:50<11:03, 36.87s/it]Task 3, Epoch 3/20 => Loss 0.637, Train_accy 82.45:  15%|█▌        | 3/20 [01:50<10:26, 36.83s/it]Task 3, Epoch 4/20 => Loss 0.561, Train_accy 84.51:  15%|█▌        | 3/20 [02:27<10:26, 36.83s/it]Task 3, Epoch 4/20 => Loss 0.561, Train_accy 84.51:  20%|██        | 4/20 [02:27<09:48, 36.80s/it]Task 3, Epoch 5/20 => Loss 0.516, Train_accy 86.30, Test_accy 69.63:  20%|██        | 4/20 [03:29<09:48, 36.80s/it]Task 3, Epoch 5/20 => Loss 0.516, Train_accy 86.30, Test_accy 69.63:  25%|██▌       | 5/20 [03:29<11:27, 45.81s/it]Task 3, Epoch 6/20 => Loss 0.465, Train_accy 87.00:  25%|██▌       | 5/20 [04:05<11:27, 45.81s/it]                 Task 3, Epoch 6/20 => Loss 0.465, Train_accy 87.00:  30%|███       | 6/20 [04:05<09:56, 42.63s/it]Task 3, Epoch 7/20 => Loss 0.446, Train_accy 87.55:  30%|███       | 6/20 [04:42<09:56, 42.63s/it]Task 3, Epoch 7/20 => Loss 0.446, Train_accy 87.55:  35%|███▌      | 7/20 [04:42<08:49, 40.70s/it]Task 3, Epoch 8/20 => Loss 0.424, Train_accy 88.04:  35%|███▌      | 7/20 [05:18<08:49, 40.70s/it]Task 3, Epoch 8/20 => Loss 0.424, Train_accy 88.04:  40%|████      | 8/20 [05:18<07:52, 39.40s/it]Task 3, Epoch 9/20 => Loss 0.429, Train_accy 87.91:  40%|████      | 8/20 [05:55<07:52, 39.40s/it]Task 3, Epoch 9/20 => Loss 0.429, Train_accy 87.91:  45%|████▌     | 9/20 [05:55<07:04, 38.57s/it]Task 3, Epoch 10/20 => Loss 0.410, Train_accy 88.32, Test_accy 71.68:  45%|████▌     | 9/20 [06:57<07:04, 38.57s/it]Task 3, Epoch 10/20 => Loss 0.410, Train_accy 88.32, Test_accy 71.68:  50%|█████     | 10/20 [06:57<07:36, 45.67s/it]Task 3, Epoch 11/20 => Loss 0.366, Train_accy 89.33:  50%|█████     | 10/20 [07:33<07:36, 45.67s/it]                 Task 3, Epoch 11/20 => Loss 0.366, Train_accy 89.33:  55%|█████▌    | 11/20 [07:33<06:25, 42.88s/it]Task 3, Epoch 12/20 => Loss 0.385, Train_accy 89.01:  55%|█████▌    | 11/20 [08:10<06:25, 42.88s/it]Task 3, Epoch 12/20 => Loss 0.385, Train_accy 89.01:  60%|██████    | 12/20 [08:10<05:27, 40.95s/it]Task 3, Epoch 13/20 => Loss 0.360, Train_accy 89.49:  60%|██████    | 12/20 [08:46<05:27, 40.95s/it]Task 3, Epoch 13/20 => Loss 0.360, Train_accy 89.49:  65%|██████▌   | 13/20 [08:46<04:37, 39.65s/it]Task 3, Epoch 14/20 => Loss 0.378, Train_accy 89.66:  65%|██████▌   | 13/20 [09:23<04:37, 39.65s/it]Task 3, Epoch 14/20 => Loss 0.378, Train_accy 89.66:  70%|███████   | 14/20 [09:23<03:52, 38.77s/it]Task 3, Epoch 15/20 => Loss 0.357, Train_accy 89.80, Test_accy 72.81:  70%|███████   | 14/20 [10:24<03:52, 38.77s/it]Task 3, Epoch 15/20 => Loss 0.357, Train_accy 89.80, Test_accy 72.81:  75%|███████▌  | 15/20 [10:24<03:47, 45.57s/it]Task 3, Epoch 16/20 => Loss 0.346, Train_accy 90.16:  75%|███████▌  | 15/20 [11:01<03:47, 45.57s/it]                 Task 3, Epoch 16/20 => Loss 0.346, Train_accy 90.16:  80%|████████  | 16/20 [11:01<02:51, 42.88s/it]Task 3, Epoch 17/20 => Loss 0.342, Train_accy 90.12:  80%|████████  | 16/20 [11:38<02:51, 42.88s/it]Task 3, Epoch 17/20 => Loss 0.342, Train_accy 90.12:  85%|████████▌ | 17/20 [11:38<02:03, 41.03s/it]Task 3, Epoch 18/20 => Loss 0.343, Train_accy 89.68:  85%|████████▌ | 17/20 [12:15<02:03, 41.03s/it]Task 3, Epoch 18/20 => Loss 0.343, Train_accy 89.68:  90%|█████████ | 18/20 [12:15<01:19, 39.80s/it]Task 3, Epoch 19/20 => Loss 0.343, Train_accy 90.55:  90%|█████████ | 18/20 [12:52<01:19, 39.80s/it]Task 3, Epoch 19/20 => Loss 0.343, Train_accy 90.55:  95%|█████████▌| 19/20 [12:52<00:38, 38.95s/it]Task 3, Epoch 20/20 => Loss 0.350, Train_accy 89.78, Test_accy 72.87:  95%|█████████▌| 19/20 [13:53<00:38, 38.95s/it]Task 3, Epoch 20/20 => Loss 0.350, Train_accy 89.78, Test_accy 72.87: 100%|██████████| 20/20 [13:53<00:00, 45.69s/it]Task 3, Epoch 20/20 => Loss 0.350, Train_accy 89.78, Test_accy 72.87: 100%|██████████| 20/20 [13:53<00:00, 41.68s/it]
2024-04-19 01:14:04,668 [dualprompt.py] => Task 3, Epoch 20/20 => Loss 0.350, Train_accy 89.78, Test_accy 72.87
2024-04-19 01:14:29,185 [trainer.py] => No NME accuracy.
2024-04-19 01:14:29,186 [trainer.py] => CNN: {'total': 72.87, '00-39': 74.72, '40-79': 70.77, '80-119': 71.93, '120-159': 73.73, 'old': 72.57, 'new': 73.73}
2024-04-19 01:14:29,186 [trainer.py] => CNN top1 curve: [82.74, 77.22, 74.07, 72.87]
2024-04-19 01:14:29,186 [trainer.py] => CNN top5 curve: [94.1, 90.71, 88.53, 88.0]

Average Accuracy (CNN): 76.725
2024-04-19 01:14:29,186 [trainer.py] => Average Accuracy (CNN): 76.725 

2024-04-19 01:14:29,186 [trainer.py] => Train Time: 6383.339999999999
2024-04-19 01:14:29,186 [trainer.py] => Test Time: 63.06 

2024-04-19 01:14:29,187 [trainer.py] => All params: 172158352
2024-04-19 01:14:29,189 [trainer.py] => Trainable params: 407240
2024-04-19 01:14:29,189 [dualprompt.py] => Learning on 160-200
  0%|          | 0/20 [00:00<?, ?it/s]Task 4, Epoch 1/20 => Loss 1.604, Train_accy 61.10:   0%|          | 0/20 [00:33<?, ?it/s]Task 4, Epoch 1/20 => Loss 1.604, Train_accy 61.10:   5%|▌         | 1/20 [00:33<10:42, 33.84s/it]Task 4, Epoch 2/20 => Loss 0.844, Train_accy 77.00:   5%|▌         | 1/20 [01:05<10:42, 33.84s/it]Task 4, Epoch 2/20 => Loss 0.844, Train_accy 77.00:  10%|█         | 2/20 [01:05<09:43, 32.40s/it]Task 4, Epoch 3/20 => Loss 0.656, Train_accy 82.50:  10%|█         | 2/20 [01:36<09:43, 32.40s/it]Task 4, Epoch 3/20 => Loss 0.656, Train_accy 82.50:  15%|█▌        | 3/20 [01:36<09:02, 31.92s/it]Task 4, Epoch 4/20 => Loss 0.573, Train_accy 84.87:  15%|█▌        | 3/20 [02:07<09:02, 31.92s/it]Task 4, Epoch 4/20 => Loss 0.573, Train_accy 84.87:  20%|██        | 4/20 [02:07<08:26, 31.68s/it]Task 4, Epoch 5/20 => Loss 0.535, Train_accy 85.44, Test_accy 69.13:  20%|██        | 4/20 [03:09<08:26, 31.68s/it]Task 4, Epoch 5/20 => Loss 0.535, Train_accy 85.44, Test_accy 69.13:  25%|██▌       | 5/20 [03:09<10:35, 42.38s/it]Task 4, Epoch 6/20 => Loss 0.480, Train_accy 86.46:  25%|██▌       | 5/20 [03:40<10:35, 42.38s/it]                 Task 4, Epoch 6/20 => Loss 0.480, Train_accy 86.46:  30%|███       | 6/20 [03:40<09:00, 38.60s/it]Task 4, Epoch 7/20 => Loss 0.489, Train_accy 86.89:  30%|███       | 6/20 [04:11<09:00, 38.60s/it]Task 4, Epoch 7/20 => Loss 0.489, Train_accy 86.89:  35%|███▌      | 7/20 [04:11<07:51, 36.24s/it]Task 4, Epoch 8/20 => Loss 0.470, Train_accy 86.82:  35%|███▌      | 7/20 [04:43<07:51, 36.24s/it]Task 4, Epoch 8/20 => Loss 0.470, Train_accy 86.82:  40%|████      | 8/20 [04:43<06:56, 34.69s/it]Task 4, Epoch 9/20 => Loss 0.455, Train_accy 86.89:  40%|████      | 8/20 [05:14<06:56, 34.69s/it]Task 4, Epoch 9/20 => Loss 0.455, Train_accy 86.89:  45%|████▌     | 9/20 [05:14<06:09, 33.58s/it]Task 4, Epoch 10/20 => Loss 0.447, Train_accy 87.13, Test_accy 70.42:  45%|████▌     | 9/20 [06:15<06:09, 33.58s/it]Task 4, Epoch 10/20 => Loss 0.447, Train_accy 87.13, Test_accy 70.42:  50%|█████     | 10/20 [06:15<07:00, 42.05s/it]Task 4, Epoch 11/20 => Loss 0.375, Train_accy 88.93:  50%|█████     | 10/20 [06:46<07:00, 42.05s/it]                 Task 4, Epoch 11/20 => Loss 0.375, Train_accy 88.93:  55%|█████▌    | 11/20 [06:46<05:49, 38.82s/it]Task 4, Epoch 12/20 => Loss 0.415, Train_accy 88.67:  55%|█████▌    | 11/20 [07:18<05:49, 38.82s/it]Task 4, Epoch 12/20 => Loss 0.415, Train_accy 88.67:  60%|██████    | 12/20 [07:18<04:52, 36.61s/it]Task 4, Epoch 13/20 => Loss 0.379, Train_accy 89.00:  60%|██████    | 12/20 [07:50<04:52, 36.61s/it]Task 4, Epoch 13/20 => Loss 0.379, Train_accy 89.00:  65%|██████▌   | 13/20 [07:50<04:05, 35.08s/it]Task 4, Epoch 14/20 => Loss 0.368, Train_accy 89.47:  65%|██████▌   | 13/20 [08:21<04:05, 35.08s/it]Task 4, Epoch 14/20 => Loss 0.368, Train_accy 89.47:  70%|███████   | 14/20 [08:21<03:23, 33.92s/it]Task 4, Epoch 15/20 => Loss 0.349, Train_accy 89.64, Test_accy 70.77:  70%|███████   | 14/20 [09:22<03:23, 33.92s/it]Task 4, Epoch 15/20 => Loss 0.349, Train_accy 89.64, Test_accy 70.77:  75%|███████▌  | 15/20 [09:22<03:30, 42.16s/it]Task 4, Epoch 16/20 => Loss 0.374, Train_accy 88.31:  75%|███████▌  | 15/20 [09:54<03:30, 42.16s/it]                 Task 4, Epoch 16/20 => Loss 0.374, Train_accy 88.31:  80%|████████  | 16/20 [09:54<02:36, 39.09s/it]Task 4, Epoch 17/20 => Loss 0.377, Train_accy 89.57:  80%|████████  | 16/20 [10:25<02:36, 39.09s/it]Task 4, Epoch 17/20 => Loss 0.377, Train_accy 89.57:  85%|████████▌ | 17/20 [10:25<01:50, 36.80s/it]Task 4, Epoch 18/20 => Loss 0.387, Train_accy 88.41:  85%|████████▌ | 17/20 [10:57<01:50, 36.80s/it]Task 4, Epoch 18/20 => Loss 0.387, Train_accy 88.41:  90%|█████████ | 18/20 [10:57<01:10, 35.23s/it]Task 4, Epoch 19/20 => Loss 0.366, Train_accy 90.00:  90%|█████████ | 18/20 [11:28<01:10, 35.23s/it]Task 4, Epoch 19/20 => Loss 0.366, Train_accy 90.00:  95%|█████████▌| 19/20 [11:28<00:34, 34.09s/it]Task 4, Epoch 20/20 => Loss 0.372, Train_accy 89.83, Test_accy 71.27:  95%|█████████▌| 19/20 [12:29<00:34, 34.09s/it]Task 4, Epoch 20/20 => Loss 0.372, Train_accy 89.83, Test_accy 71.27: 100%|██████████| 20/20 [12:29<00:00, 42.15s/it]Task 4, Epoch 20/20 => Loss 0.372, Train_accy 89.83, Test_accy 71.27: 100%|██████████| 20/20 [12:29<00:00, 37.50s/it]
2024-04-19 01:26:59,112 [dualprompt.py] => Task 4, Epoch 20/20 => Loss 0.372, Train_accy 89.83, Test_accy 71.27
2024-04-19 01:27:28,925 [trainer.py] => No NME accuracy.
2024-04-19 01:27:28,926 [trainer.py] => CNN: {'total': 71.27, '00-39': 74.19, '40-79': 69.84, '80-119': 71.32, '120-159': 73.57, '160-199': 66.32, 'old': 72.32, 'new': 66.32}
2024-04-19 01:27:28,926 [trainer.py] => CNN top1 curve: [82.74, 77.22, 74.07, 72.87, 71.27]
2024-04-19 01:27:28,926 [trainer.py] => CNN top5 curve: [94.1, 90.71, 88.53, 88.0, 86.58]

Average Accuracy (CNN): 75.63399999999999
2024-04-19 01:27:28,926 [trainer.py] => Average Accuracy (CNN): 75.63399999999999 

2024-04-19 01:27:28,926 [trainer.py] => Train Time: 7883.149999999999
2024-04-19 01:27:28,926 [trainer.py] => Test Time: 92.87 

Accuracy Matrix (CNN):
[[82.74 79.49 76.61 74.72 74.19]
 [ 0.   74.68 72.05 70.77 69.84]
 [ 0.    0.   73.23 71.93 71.32]
 [ 0.    0.    0.   73.73 73.57]
 [ 0.    0.    0.    0.   66.32]]
2024-04-19 01:27:28,928 [trainer.py] => Forgetting (CNN): 3.8650000000000055
2024-04-19 01:27:34,112 [trainer.py] => config: ./exps/coda_prompt_inr.json
2024-04-19 01:27:34,113 [trainer.py] => prefix:  
2024-04-19 01:27:34,113 [trainer.py] => dataset: imagenetr
2024-04-19 01:27:34,113 [trainer.py] => memory_size: 0
2024-04-19 01:27:34,113 [trainer.py] => memory_per_class: 0
2024-04-19 01:27:34,113 [trainer.py] => fixed_memory: False
2024-04-19 01:27:34,113 [trainer.py] => shuffle: False
2024-04-19 01:27:34,114 [trainer.py] => init_cls: 40
2024-04-19 01:27:34,114 [trainer.py] => increment: 40
2024-04-19 01:27:34,114 [trainer.py] => model_name: coda_prompt
2024-04-19 01:27:34,114 [trainer.py] => backbone_type: vit_base_patch16_224_coda_prompt
2024-04-19 01:27:34,114 [trainer.py] => device: [device(type='cuda', index=4)]
2024-04-19 01:27:34,114 [trainer.py] => seed: 1993
2024-04-19 01:27:34,114 [trainer.py] => tuned_epoch: 20
2024-04-19 01:27:34,114 [trainer.py] => init_lr: 0.001
2024-04-19 01:27:34,114 [trainer.py] => batch_size: 48
2024-04-19 01:27:34,114 [trainer.py] => weight_decay: 0
2024-04-19 01:27:34,114 [trainer.py] => min_lr: 1e-05
2024-04-19 01:27:34,114 [trainer.py] => optimizer: adam
2024-04-19 01:27:34,114 [trainer.py] => scheduler: cosine
2024-04-19 01:27:34,114 [trainer.py] => reinit_optimizer: True
2024-04-19 01:27:34,114 [trainer.py] => pretrained: True
2024-04-19 01:27:34,114 [trainer.py] => drop: 0.0
2024-04-19 01:27:34,114 [trainer.py] => drop_path: 0.0
2024-04-19 01:27:34,114 [trainer.py] => prompt_param: [100, 8.0, 0.0]
2024-04-19 01:27:34,260 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199]
2024-04-19 01:27:37,572 [coda_prompt.py] => 89,792,456 total parameters.
2024-04-19 01:27:37,572 [coda_prompt.py] => 3,993,800 fc and prompt training parameters.
2024-04-19 01:27:37,573 [trainer.py] => All params: 89792456
2024-04-19 01:27:37,574 [trainer.py] => Trainable params: 89792456
2024-04-19 01:27:37,574 [coda_prompt.py] => Learning on 0-40
  0%|          | 0/20 [00:00<?, ?it/s]Task 0, Epoch 1/20 => Loss 1.871, Train_accy 54.02:   0%|          | 0/20 [00:52<?, ?it/s]Task 0, Epoch 1/20 => Loss 1.871, Train_accy 54.02:   5%|▌         | 1/20 [00:52<16:33, 52.30s/it]Task 0, Epoch 2/20 => Loss 0.908, Train_accy 75.46:   5%|▌         | 1/20 [01:43<16:33, 52.30s/it]Task 0, Epoch 2/20 => Loss 0.908, Train_accy 75.46:  10%|█         | 2/20 [01:43<15:33, 51.88s/it]Task 0, Epoch 3/20 => Loss 0.757, Train_accy 79.35:  10%|█         | 2/20 [02:35<15:33, 51.88s/it]Task 0, Epoch 3/20 => Loss 0.757, Train_accy 79.35:  15%|█▌        | 3/20 [02:35<14:40, 51.80s/it]Task 0, Epoch 4/20 => Loss 0.657, Train_accy 82.22:  15%|█▌        | 3/20 [03:27<14:40, 51.80s/it]Task 0, Epoch 4/20 => Loss 0.657, Train_accy 82.22:  20%|██        | 4/20 [03:27<13:48, 51.75s/it]Task 0, Epoch 5/20 => Loss 0.648, Train_accy 82.49, Test_accy 83.30:  20%|██        | 4/20 [04:26<13:48, 51.75s/it]Task 0, Epoch 5/20 => Loss 0.648, Train_accy 82.49, Test_accy 83.30:  25%|██▌       | 5/20 [04:26<13:34, 54.31s/it]Task 0, Epoch 6/20 => Loss 0.548, Train_accy 85.12:  25%|██▌       | 5/20 [05:17<13:34, 54.31s/it]                 Task 0, Epoch 6/20 => Loss 0.548, Train_accy 85.12:  30%|███       | 6/20 [05:17<12:26, 53.35s/it]Task 0, Epoch 7/20 => Loss 0.530, Train_accy 85.62:  30%|███       | 6/20 [06:09<12:26, 53.35s/it]Task 0, Epoch 7/20 => Loss 0.530, Train_accy 85.62:  35%|███▌      | 7/20 [06:09<11:25, 52.77s/it]Task 0, Epoch 8/20 => Loss 0.477, Train_accy 87.10:  35%|███▌      | 7/20 [07:00<11:25, 52.77s/it]Task 0, Epoch 8/20 => Loss 0.477, Train_accy 87.10:  40%|████      | 8/20 [07:00<10:28, 52.37s/it]Task 0, Epoch 9/20 => Loss 0.473, Train_accy 87.15:  40%|████      | 8/20 [07:52<10:28, 52.37s/it]Task 0, Epoch 9/20 => Loss 0.473, Train_accy 87.15:  45%|████▌     | 9/20 [07:52<09:32, 52.07s/it]Task 0, Epoch 10/20 => Loss 0.444, Train_accy 87.81, Test_accy 85.29:  45%|████▌     | 9/20 [08:50<09:32, 52.07s/it]Task 0, Epoch 10/20 => Loss 0.444, Train_accy 87.81, Test_accy 85.29:  50%|█████     | 10/20 [08:50<09:01, 54.14s/it]Task 0, Epoch 11/20 => Loss 0.397, Train_accy 88.93:  50%|█████     | 10/20 [09:42<09:01, 54.14s/it]                 Task 0, Epoch 11/20 => Loss 0.397, Train_accy 88.93:  55%|█████▌    | 11/20 [09:42<08:00, 53.36s/it]Task 0, Epoch 12/20 => Loss 0.411, Train_accy 88.67:  55%|█████▌    | 11/20 [10:33<08:00, 53.36s/it]Task 0, Epoch 12/20 => Loss 0.411, Train_accy 88.67:  60%|██████    | 12/20 [10:33<07:02, 52.77s/it]Task 0, Epoch 13/20 => Loss 0.388, Train_accy 89.40:  60%|██████    | 12/20 [11:25<07:02, 52.77s/it]Task 0, Epoch 13/20 => Loss 0.388, Train_accy 89.40:  65%|██████▌   | 13/20 [11:25<06:06, 52.37s/it]Task 0, Epoch 14/20 => Loss 0.367, Train_accy 89.67:  65%|██████▌   | 13/20 [12:16<06:06, 52.37s/it]Task 0, Epoch 14/20 => Loss 0.367, Train_accy 89.67:  70%|███████   | 14/20 [12:16<05:12, 52.08s/it]Task 0, Epoch 15/20 => Loss 0.369, Train_accy 90.10, Test_accy 85.00:  70%|███████   | 14/20 [13:15<05:12, 52.08s/it]Task 0, Epoch 15/20 => Loss 0.369, Train_accy 90.10, Test_accy 85.00:  75%|███████▌  | 15/20 [13:15<04:30, 54.01s/it]Task 0, Epoch 16/20 => Loss 0.314, Train_accy 91.34:  75%|███████▌  | 15/20 [14:06<04:30, 54.01s/it]                 Task 0, Epoch 16/20 => Loss 0.314, Train_accy 91.34:  80%|████████  | 16/20 [14:06<03:32, 53.24s/it]Task 0, Epoch 17/20 => Loss 0.332, Train_accy 90.70:  80%|████████  | 16/20 [14:58<03:32, 53.24s/it]Task 0, Epoch 17/20 => Loss 0.332, Train_accy 90.70:  85%|████████▌ | 17/20 [14:58<02:38, 52.73s/it]Task 0, Epoch 18/20 => Loss 0.340, Train_accy 90.66:  85%|████████▌ | 17/20 [15:49<02:38, 52.73s/it]Task 0, Epoch 18/20 => Loss 0.340, Train_accy 90.66:  90%|█████████ | 18/20 [15:49<01:44, 52.30s/it]Task 0, Epoch 19/20 => Loss 0.292, Train_accy 92.16:  90%|█████████ | 18/20 [16:40<01:44, 52.30s/it]Task 0, Epoch 19/20 => Loss 0.292, Train_accy 92.16:  95%|█████████▌| 19/20 [16:40<00:52, 52.04s/it]Task 0, Epoch 20/20 => Loss 0.298, Train_accy 91.85, Test_accy 85.44:  95%|█████████▌| 19/20 [17:39<00:52, 52.04s/it]Task 0, Epoch 20/20 => Loss 0.298, Train_accy 91.85, Test_accy 85.44: 100%|██████████| 20/20 [17:39<00:00, 53.95s/it]Task 0, Epoch 20/20 => Loss 0.298, Train_accy 91.85, Test_accy 85.44: 100%|██████████| 20/20 [17:39<00:00, 52.97s/it]
2024-04-19 01:45:17,508 [coda_prompt.py] => Task 0, Epoch 20/20 => Loss 0.298, Train_accy 91.85, Test_accy 85.44
2024-04-19 01:45:24,561 [trainer.py] => No NME accuracy.
2024-04-19 01:45:24,561 [trainer.py] => CNN: {'total': 85.44, '00-39': 85.44, 'old': 0, 'new': 85.44}
2024-04-19 01:45:24,561 [trainer.py] => CNN top1 curve: [85.44]
2024-04-19 01:45:24,561 [trainer.py] => CNN top5 curve: [95.27]

Average Accuracy (CNN): 85.44
2024-04-19 01:45:24,561 [trainer.py] => Average Accuracy (CNN): 85.44 

2024-04-19 01:45:24,562 [trainer.py] => Train Time: 2119.29
2024-04-19 01:45:24,562 [trainer.py] => Test Time: 7.05 

2024-04-19 01:45:24,563 [trainer.py] => All params: 89792456
2024-04-19 01:45:24,563 [trainer.py] => Trainable params: 89792456
2024-04-19 01:45:25,796 [coda_prompt.py] => Learning on 40-80
  0%|          | 0/20 [00:00<?, ?it/s]Task 1, Epoch 1/20 => Loss 1.708, Train_accy 57.28:   0%|          | 0/20 [00:38<?, ?it/s]Task 1, Epoch 1/20 => Loss 1.708, Train_accy 57.28:   5%|▌         | 1/20 [00:38<12:11, 38.49s/it]Task 1, Epoch 2/20 => Loss 0.875, Train_accy 75.88:   5%|▌         | 1/20 [01:17<12:11, 38.49s/it]Task 1, Epoch 2/20 => Loss 0.875, Train_accy 75.88:  10%|█         | 2/20 [01:17<11:34, 38.58s/it]Task 1, Epoch 3/20 => Loss 0.685, Train_accy 80.61:  10%|█         | 2/20 [01:55<11:34, 38.58s/it]Task 1, Epoch 3/20 => Loss 0.685, Train_accy 80.61:  15%|█▌        | 3/20 [01:55<10:56, 38.60s/it]Task 1, Epoch 4/20 => Loss 0.634, Train_accy 81.84:  15%|█▌        | 3/20 [02:34<10:56, 38.60s/it]Task 1, Epoch 4/20 => Loss 0.634, Train_accy 81.84:  20%|██        | 4/20 [02:34<10:17, 38.59s/it]Task 1, Epoch 5/20 => Loss 0.597, Train_accy 82.40, Test_accy 79.17:  20%|██        | 4/20 [03:24<10:17, 38.59s/it]Task 1, Epoch 5/20 => Loss 0.597, Train_accy 82.40, Test_accy 79.17:  25%|██▌       | 5/20 [03:24<10:43, 42.88s/it]Task 1, Epoch 6/20 => Loss 0.530, Train_accy 85.07:  25%|██▌       | 5/20 [04:03<10:43, 42.88s/it]                 Task 1, Epoch 6/20 => Loss 0.530, Train_accy 85.07:  30%|███       | 6/20 [04:03<09:40, 41.46s/it]Task 1, Epoch 7/20 => Loss 0.472, Train_accy 86.72:  30%|███       | 6/20 [04:42<09:40, 41.46s/it]Task 1, Epoch 7/20 => Loss 0.472, Train_accy 86.72:  35%|███▌      | 7/20 [04:42<08:46, 40.54s/it]Task 1, Epoch 8/20 => Loss 0.436, Train_accy 87.45:  35%|███▌      | 7/20 [05:20<08:46, 40.54s/it]Task 1, Epoch 8/20 => Loss 0.436, Train_accy 87.45:  40%|████      | 8/20 [05:20<07:59, 39.99s/it]Task 1, Epoch 9/20 => Loss 0.395, Train_accy 88.77:  40%|████      | 8/20 [05:59<07:59, 39.99s/it]Task 1, Epoch 9/20 => Loss 0.395, Train_accy 88.77:  45%|████▌     | 9/20 [05:59<07:15, 39.60s/it]Task 1, Epoch 10/20 => Loss 0.416, Train_accy 88.58, Test_accy 80.03:  45%|████▌     | 9/20 [06:50<07:15, 39.60s/it]Task 1, Epoch 10/20 => Loss 0.416, Train_accy 88.58, Test_accy 80.03:  50%|█████     | 10/20 [06:50<07:10, 43.06s/it]Task 1, Epoch 11/20 => Loss 0.390, Train_accy 88.70:  50%|█████     | 10/20 [07:29<07:10, 43.06s/it]                 Task 1, Epoch 11/20 => Loss 0.390, Train_accy 88.70:  55%|█████▌    | 11/20 [07:29<06:15, 41.69s/it]Task 1, Epoch 12/20 => Loss 0.366, Train_accy 89.41:  55%|█████▌    | 11/20 [08:07<06:15, 41.69s/it]Task 1, Epoch 12/20 => Loss 0.366, Train_accy 89.41:  60%|██████    | 12/20 [08:07<05:25, 40.75s/it]Task 1, Epoch 13/20 => Loss 0.356, Train_accy 90.02:  60%|██████    | 12/20 [08:46<05:25, 40.75s/it]Task 1, Epoch 13/20 => Loss 0.356, Train_accy 90.02:  65%|██████▌   | 13/20 [08:46<04:40, 40.09s/it]Task 1, Epoch 14/20 => Loss 0.341, Train_accy 91.00:  65%|██████▌   | 13/20 [09:24<04:40, 40.09s/it]Task 1, Epoch 14/20 => Loss 0.341, Train_accy 91.00:  70%|███████   | 14/20 [09:24<03:57, 39.64s/it]Task 1, Epoch 15/20 => Loss 0.324, Train_accy 90.81, Test_accy 80.62:  70%|███████   | 14/20 [10:15<03:57, 39.64s/it]Task 1, Epoch 15/20 => Loss 0.324, Train_accy 90.81, Test_accy 80.62:  75%|███████▌  | 15/20 [10:15<03:34, 42.94s/it]Task 1, Epoch 16/20 => Loss 0.310, Train_accy 91.08:  75%|███████▌  | 15/20 [10:54<03:34, 42.94s/it]                 Task 1, Epoch 16/20 => Loss 0.310, Train_accy 91.08:  80%|████████  | 16/20 [10:54<02:46, 41.67s/it]Task 1, Epoch 17/20 => Loss 0.280, Train_accy 91.96:  80%|████████  | 16/20 [11:32<02:46, 41.67s/it]Task 1, Epoch 17/20 => Loss 0.280, Train_accy 91.96:  85%|████████▌ | 17/20 [11:32<02:02, 40.75s/it]Task 1, Epoch 18/20 => Loss 0.280, Train_accy 91.94:  85%|████████▌ | 17/20 [12:11<02:02, 40.75s/it]Task 1, Epoch 18/20 => Loss 0.280, Train_accy 91.94:  90%|█████████ | 18/20 [12:11<01:20, 40.14s/it]Task 1, Epoch 19/20 => Loss 0.268, Train_accy 92.62:  90%|█████████ | 18/20 [12:50<01:20, 40.14s/it]Task 1, Epoch 19/20 => Loss 0.268, Train_accy 92.62:  95%|█████████▌| 19/20 [12:50<00:39, 39.69s/it]Task 1, Epoch 20/20 => Loss 0.281, Train_accy 92.23, Test_accy 80.75:  95%|█████████▌| 19/20 [13:40<00:39, 39.69s/it]Task 1, Epoch 20/20 => Loss 0.281, Train_accy 92.23, Test_accy 80.75: 100%|██████████| 20/20 [13:40<00:00, 42.91s/it]Task 1, Epoch 20/20 => Loss 0.281, Train_accy 92.23, Test_accy 80.75: 100%|██████████| 20/20 [13:40<00:00, 41.03s/it]
2024-04-19 01:59:06,385 [coda_prompt.py] => Task 1, Epoch 20/20 => Loss 0.281, Train_accy 92.23, Test_accy 80.75
2024-04-19 01:59:18,272 [trainer.py] => No NME accuracy.
2024-04-19 01:59:18,272 [trainer.py] => CNN: {'total': 80.75, '00-39': 82.78, '40-79': 77.97, 'old': 82.78, 'new': 77.97}
2024-04-19 01:59:18,272 [trainer.py] => CNN top1 curve: [85.44, 80.75]
2024-04-19 01:59:18,272 [trainer.py] => CNN top5 curve: [95.27, 93.97]

Average Accuracy (CNN): 83.095
2024-04-19 01:59:18,273 [trainer.py] => Average Accuracy (CNN): 83.095 

2024-04-19 01:59:18,273 [trainer.py] => Train Time: 3760.45
2024-04-19 01:59:18,273 [trainer.py] => Test Time: 18.93 

2024-04-19 01:59:18,274 [trainer.py] => All params: 89792456
2024-04-19 01:59:18,274 [trainer.py] => Trainable params: 89792456
2024-04-19 01:59:20,758 [coda_prompt.py] => Learning on 80-120
  0%|          | 0/20 [00:00<?, ?it/s]Task 2, Epoch 1/20 => Loss 1.589, Train_accy 60.94:   0%|          | 0/20 [00:54<?, ?it/s]Task 2, Epoch 1/20 => Loss 1.589, Train_accy 60.94:   5%|▌         | 1/20 [00:54<17:16, 54.55s/it]Task 2, Epoch 2/20 => Loss 0.816, Train_accy 77.94:   5%|▌         | 1/20 [01:41<17:16, 54.55s/it]Task 2, Epoch 2/20 => Loss 0.816, Train_accy 77.94:  10%|█         | 2/20 [01:41<15:05, 50.30s/it]Task 2, Epoch 3/20 => Loss 0.702, Train_accy 81.61:  10%|█         | 2/20 [02:29<15:05, 50.30s/it]Task 2, Epoch 3/20 => Loss 0.702, Train_accy 81.61:  15%|█▌        | 3/20 [02:29<13:51, 48.94s/it]Task 2, Epoch 4/20 => Loss 0.564, Train_accy 84.29:  15%|█▌        | 3/20 [03:16<13:51, 48.94s/it]Task 2, Epoch 4/20 => Loss 0.564, Train_accy 84.29:  20%|██        | 4/20 [03:16<12:50, 48.17s/it]Task 2, Epoch 5/20 => Loss 0.508, Train_accy 85.94, Test_accy 77.82:  20%|██        | 4/20 [04:21<12:50, 48.17s/it]Task 2, Epoch 5/20 => Loss 0.508, Train_accy 85.94, Test_accy 77.82:  25%|██▌       | 5/20 [04:21<13:34, 54.31s/it]Task 2, Epoch 6/20 => Loss 0.485, Train_accy 86.82:  25%|██▌       | 5/20 [05:08<13:34, 54.31s/it]                 Task 2, Epoch 6/20 => Loss 0.485, Train_accy 86.82:  30%|███       | 6/20 [05:08<12:06, 51.92s/it]Task 2, Epoch 7/20 => Loss 0.447, Train_accy 87.32:  30%|███       | 6/20 [05:55<12:06, 51.92s/it]Task 2, Epoch 7/20 => Loss 0.447, Train_accy 87.32:  35%|███▌      | 7/20 [05:55<10:55, 50.40s/it]Task 2, Epoch 8/20 => Loss 0.428, Train_accy 88.76:  35%|███▌      | 7/20 [06:43<10:55, 50.40s/it]Task 2, Epoch 8/20 => Loss 0.428, Train_accy 88.76:  40%|████      | 8/20 [06:43<09:52, 49.40s/it]Task 2, Epoch 9/20 => Loss 0.393, Train_accy 89.52:  40%|████      | 8/20 [07:30<09:52, 49.40s/it]Task 2, Epoch 9/20 => Loss 0.393, Train_accy 89.52:  45%|████▌     | 9/20 [07:30<08:55, 48.71s/it]Task 2, Epoch 10/20 => Loss 0.351, Train_accy 90.38, Test_accy 78.60:  45%|████▌     | 9/20 [08:35<08:55, 48.71s/it]Task 2, Epoch 10/20 => Loss 0.351, Train_accy 90.38, Test_accy 78.60:  50%|█████     | 10/20 [08:35<08:58, 53.83s/it]Task 2, Epoch 11/20 => Loss 0.368, Train_accy 89.76:  50%|█████     | 10/20 [09:23<08:58, 53.83s/it]                 Task 2, Epoch 11/20 => Loss 0.368, Train_accy 89.76:  55%|█████▌    | 11/20 [09:23<07:46, 51.88s/it]Task 2, Epoch 12/20 => Loss 0.377, Train_accy 90.16:  55%|█████▌    | 11/20 [10:10<07:46, 51.88s/it]Task 2, Epoch 12/20 => Loss 0.377, Train_accy 90.16:  60%|██████    | 12/20 [10:10<06:43, 50.47s/it]Task 2, Epoch 13/20 => Loss 0.335, Train_accy 90.85:  60%|██████    | 12/20 [10:57<06:43, 50.47s/it]Task 2, Epoch 13/20 => Loss 0.335, Train_accy 90.85:  65%|██████▌   | 13/20 [10:57<05:46, 49.47s/it]Task 2, Epoch 14/20 => Loss 0.342, Train_accy 91.21:  65%|██████▌   | 13/20 [11:44<05:46, 49.47s/it]Task 2, Epoch 14/20 => Loss 0.342, Train_accy 91.21:  70%|███████   | 14/20 [11:44<04:52, 48.80s/it]Task 2, Epoch 15/20 => Loss 0.323, Train_accy 91.43, Test_accy 78.68:  70%|███████   | 14/20 [12:49<04:52, 48.80s/it]Task 2, Epoch 15/20 => Loss 0.323, Train_accy 91.43, Test_accy 78.68:  75%|███████▌  | 15/20 [12:49<04:28, 53.72s/it]Task 2, Epoch 16/20 => Loss 0.286, Train_accy 92.65:  75%|███████▌  | 15/20 [13:37<04:28, 53.72s/it]                 Task 2, Epoch 16/20 => Loss 0.286, Train_accy 92.65:  80%|████████  | 16/20 [13:37<03:27, 51.78s/it]Task 2, Epoch 17/20 => Loss 0.287, Train_accy 92.17:  80%|████████  | 16/20 [14:24<03:27, 51.78s/it]Task 2, Epoch 17/20 => Loss 0.287, Train_accy 92.17:  85%|████████▌ | 17/20 [14:24<02:31, 50.42s/it]Task 2, Epoch 18/20 => Loss 0.302, Train_accy 91.71:  85%|████████▌ | 17/20 [15:11<02:31, 50.42s/it]Task 2, Epoch 18/20 => Loss 0.302, Train_accy 91.71:  90%|█████████ | 18/20 [15:11<01:38, 49.42s/it]Task 2, Epoch 19/20 => Loss 0.283, Train_accy 92.83:  90%|█████████ | 18/20 [15:58<01:38, 49.42s/it]Task 2, Epoch 19/20 => Loss 0.283, Train_accy 92.83:  95%|█████████▌| 19/20 [15:58<00:48, 48.80s/it]Task 2, Epoch 20/20 => Loss 0.281, Train_accy 92.39, Test_accy 78.93:  95%|█████████▌| 19/20 [17:04<00:48, 48.80s/it]Task 2, Epoch 20/20 => Loss 0.281, Train_accy 92.39, Test_accy 78.93: 100%|██████████| 20/20 [17:04<00:00, 53.78s/it]Task 2, Epoch 20/20 => Loss 0.281, Train_accy 92.39, Test_accy 78.93: 100%|██████████| 20/20 [17:04<00:00, 51.21s/it]
2024-04-19 02:16:25,039 [coda_prompt.py] => Task 2, Epoch 20/20 => Loss 0.281, Train_accy 92.39, Test_accy 78.93
2024-04-19 02:16:43,142 [trainer.py] => No NME accuracy.
2024-04-19 02:16:43,142 [trainer.py] => CNN: {'total': 78.93, '00-39': 83.07, '40-79': 76.04, '80-119': 76.76, 'old': 80.11, 'new': 76.76}
2024-04-19 02:16:43,142 [trainer.py] => CNN top1 curve: [85.44, 80.75, 78.93]
2024-04-19 02:16:43,142 [trainer.py] => CNN top5 curve: [95.27, 93.97, 91.65]

Average Accuracy (CNN): 81.70666666666666
2024-04-19 02:16:43,143 [trainer.py] => Average Accuracy (CNN): 81.70666666666666 

2024-04-19 02:16:43,143 [trainer.py] => Train Time: 5808.99
2024-04-19 02:16:43,143 [trainer.py] => Test Time: 37.03 

2024-04-19 02:16:43,144 [trainer.py] => All params: 89792456
2024-04-19 02:16:43,145 [trainer.py] => Trainable params: 89792456
2024-04-19 02:16:46,054 [coda_prompt.py] => Learning on 120-160
  0%|          | 0/20 [00:00<?, ?it/s]Task 3, Epoch 1/20 => Loss 1.861, Train_accy 55.26:   0%|          | 0/20 [00:38<?, ?it/s]Task 3, Epoch 1/20 => Loss 1.861, Train_accy 55.26:   5%|▌         | 1/20 [00:38<12:04, 38.13s/it]Task 3, Epoch 2/20 => Loss 0.962, Train_accy 74.83:   5%|▌         | 1/20 [01:16<12:04, 38.13s/it]Task 3, Epoch 2/20 => Loss 0.962, Train_accy 74.83:  10%|█         | 2/20 [01:16<11:28, 38.24s/it]Task 3, Epoch 3/20 => Loss 0.761, Train_accy 79.64:  10%|█         | 2/20 [01:54<11:28, 38.24s/it]Task 3, Epoch 3/20 => Loss 0.761, Train_accy 79.64:  15%|█▌        | 3/20 [01:54<10:50, 38.27s/it]Task 3, Epoch 4/20 => Loss 0.665, Train_accy 81.80:  15%|█▌        | 3/20 [02:32<10:50, 38.27s/it]Task 3, Epoch 4/20 => Loss 0.665, Train_accy 81.80:  20%|██        | 4/20 [02:32<10:11, 38.20s/it]Task 3, Epoch 5/20 => Loss 0.625, Train_accy 82.59, Test_accy 75.02:  20%|██        | 4/20 [03:34<10:11, 38.20s/it]Task 3, Epoch 5/20 => Loss 0.625, Train_accy 82.59, Test_accy 75.02:  25%|██▌       | 5/20 [03:34<11:38, 46.55s/it]Task 3, Epoch 6/20 => Loss 0.553, Train_accy 84.57:  25%|██▌       | 5/20 [04:12<11:38, 46.55s/it]                 Task 3, Epoch 6/20 => Loss 0.553, Train_accy 84.57:  30%|███       | 6/20 [04:12<10:12, 43.73s/it]Task 3, Epoch 7/20 => Loss 0.562, Train_accy 85.29:  30%|███       | 6/20 [04:50<10:12, 43.73s/it]Task 3, Epoch 7/20 => Loss 0.562, Train_accy 85.29:  35%|███▌      | 7/20 [04:50<09:05, 41.93s/it]Task 3, Epoch 8/20 => Loss 0.526, Train_accy 85.57:  35%|███▌      | 7/20 [05:28<09:05, 41.93s/it]Task 3, Epoch 8/20 => Loss 0.526, Train_accy 85.57:  40%|████      | 8/20 [05:28<08:08, 40.75s/it]Task 3, Epoch 9/20 => Loss 0.462, Train_accy 87.28:  40%|████      | 8/20 [06:07<08:08, 40.75s/it]Task 3, Epoch 9/20 => Loss 0.462, Train_accy 87.28:  45%|████▌     | 9/20 [06:07<07:20, 40.00s/it]Task 3, Epoch 10/20 => Loss 0.482, Train_accy 86.81, Test_accy 75.40:  45%|████▌     | 9/20 [07:09<07:20, 40.00s/it]Task 3, Epoch 10/20 => Loss 0.482, Train_accy 86.81, Test_accy 75.40:  50%|█████     | 10/20 [07:09<07:47, 46.72s/it]Task 3, Epoch 11/20 => Loss 0.462, Train_accy 87.43:  50%|█████     | 10/20 [07:47<07:47, 46.72s/it]                 Task 3, Epoch 11/20 => Loss 0.462, Train_accy 87.43:  55%|█████▌    | 11/20 [07:47<06:37, 44.20s/it]Task 3, Epoch 12/20 => Loss 0.447, Train_accy 87.60:  55%|█████▌    | 11/20 [08:25<06:37, 44.20s/it]Task 3, Epoch 12/20 => Loss 0.447, Train_accy 87.60:  60%|██████    | 12/20 [08:25<05:39, 42.42s/it]Task 3, Epoch 13/20 => Loss 0.425, Train_accy 88.14:  60%|██████    | 12/20 [09:04<05:39, 42.42s/it]Task 3, Epoch 13/20 => Loss 0.425, Train_accy 88.14:  65%|██████▌   | 13/20 [09:04<04:47, 41.12s/it]Task 3, Epoch 14/20 => Loss 0.403, Train_accy 88.99:  65%|██████▌   | 13/20 [09:42<04:47, 41.12s/it]Task 3, Epoch 14/20 => Loss 0.403, Train_accy 88.99:  70%|███████   | 14/20 [09:42<04:01, 40.29s/it]Task 3, Epoch 15/20 => Loss 0.387, Train_accy 89.38, Test_accy 75.08:  70%|███████   | 14/20 [10:44<04:01, 40.29s/it]Task 3, Epoch 15/20 => Loss 0.387, Train_accy 89.38, Test_accy 75.08:  75%|███████▌  | 15/20 [10:44<03:54, 46.81s/it]Task 3, Epoch 16/20 => Loss 0.376, Train_accy 89.43:  75%|███████▌  | 15/20 [11:22<03:54, 46.81s/it]                 Task 3, Epoch 16/20 => Loss 0.376, Train_accy 89.43:  80%|████████  | 16/20 [11:22<02:57, 44.32s/it]Task 3, Epoch 17/20 => Loss 0.350, Train_accy 90.20:  80%|████████  | 16/20 [12:01<02:57, 44.32s/it]Task 3, Epoch 17/20 => Loss 0.350, Train_accy 90.20:  85%|████████▌ | 17/20 [12:01<02:07, 42.48s/it]Task 3, Epoch 18/20 => Loss 0.343, Train_accy 90.45:  85%|████████▌ | 17/20 [12:39<02:07, 42.48s/it]Task 3, Epoch 18/20 => Loss 0.343, Train_accy 90.45:  90%|█████████ | 18/20 [12:39<01:22, 41.20s/it]Task 3, Epoch 19/20 => Loss 0.320, Train_accy 91.79:  90%|█████████ | 18/20 [13:17<01:22, 41.20s/it]Task 3, Epoch 19/20 => Loss 0.320, Train_accy 91.79:  95%|█████████▌| 19/20 [13:17<00:40, 40.41s/it]Task 3, Epoch 20/20 => Loss 0.320, Train_accy 91.29, Test_accy 75.04:  95%|█████████▌| 19/20 [14:19<00:40, 40.41s/it]Task 3, Epoch 20/20 => Loss 0.320, Train_accy 91.29, Test_accy 75.04: 100%|██████████| 20/20 [14:19<00:00, 46.82s/it]Task 3, Epoch 20/20 => Loss 0.320, Train_accy 91.29, Test_accy 75.04: 100%|██████████| 20/20 [14:19<00:00, 42.98s/it]
2024-04-19 02:31:05,644 [coda_prompt.py] => Task 3, Epoch 20/20 => Loss 0.320, Train_accy 91.29, Test_accy 75.04
2024-04-19 02:31:28,981 [trainer.py] => No NME accuracy.
2024-04-19 02:31:28,982 [trainer.py] => CNN: {'total': 75.04, '00-39': 80.86, '40-79': 75.43, '80-119': 73.79, '120-159': 68.86, 'old': 76.88, 'new': 68.86}
2024-04-19 02:31:28,982 [trainer.py] => CNN top1 curve: [85.44, 80.75, 78.93, 75.04]
2024-04-19 02:31:28,982 [trainer.py] => CNN top5 curve: [95.27, 93.97, 91.65, 88.84]

Average Accuracy (CNN): 80.04
2024-04-19 02:31:28,982 [trainer.py] => Average Accuracy (CNN): 80.04 

2024-04-19 02:31:28,982 [trainer.py] => Train Time: 7528.15
2024-04-19 02:31:28,983 [trainer.py] => Test Time: 60.36 

2024-04-19 02:31:28,984 [trainer.py] => All params: 89792456
2024-04-19 02:31:28,985 [trainer.py] => Trainable params: 89792456
2024-04-19 02:31:32,885 [coda_prompt.py] => Learning on 160-200
  0%|          | 0/20 [00:00<?, ?it/s]Task 4, Epoch 1/20 => Loss 1.424, Train_accy 65.52:   0%|          | 0/20 [00:50<?, ?it/s]Task 4, Epoch 1/20 => Loss 1.424, Train_accy 65.52:   5%|▌         | 1/20 [00:50<15:59, 50.50s/it]Task 4, Epoch 2/20 => Loss 0.697, Train_accy 81.57:   5%|▌         | 1/20 [01:40<15:59, 50.50s/it]Task 4, Epoch 2/20 => Loss 0.697, Train_accy 81.57:  10%|█         | 2/20 [01:40<15:07, 50.44s/it]Task 4, Epoch 3/20 => Loss 0.560, Train_accy 85.40:  10%|█         | 2/20 [02:31<15:07, 50.44s/it]Task 4, Epoch 3/20 => Loss 0.560, Train_accy 85.40:  15%|█▌        | 3/20 [02:31<14:16, 50.41s/it]Task 4, Epoch 4/20 => Loss 0.487, Train_accy 86.77:  15%|█▌        | 3/20 [03:21<14:16, 50.41s/it]Task 4, Epoch 4/20 => Loss 0.487, Train_accy 86.77:  20%|██        | 4/20 [03:21<13:26, 50.39s/it]Task 4, Epoch 5/20 => Loss 0.448, Train_accy 87.97, Test_accy 75.02:  20%|██        | 4/20 [04:41<13:26, 50.39s/it]Task 4, Epoch 5/20 => Loss 0.448, Train_accy 87.97, Test_accy 75.02:  25%|██▌       | 5/20 [04:41<15:17, 61.14s/it]Task 4, Epoch 6/20 => Loss 0.423, Train_accy 88.70:  25%|██▌       | 5/20 [05:32<15:17, 61.14s/it]                 Task 4, Epoch 6/20 => Loss 0.423, Train_accy 88.70:  30%|███       | 6/20 [05:32<13:25, 57.54s/it]Task 4, Epoch 7/20 => Loss 0.402, Train_accy 89.45:  30%|███       | 6/20 [06:22<13:25, 57.54s/it]Task 4, Epoch 7/20 => Loss 0.402, Train_accy 89.45:  35%|███▌      | 7/20 [06:22<11:57, 55.23s/it]Task 4, Epoch 8/20 => Loss 0.363, Train_accy 90.45:  35%|███▌      | 7/20 [07:13<11:57, 55.23s/it]Task 4, Epoch 8/20 => Loss 0.363, Train_accy 90.45:  40%|████      | 8/20 [07:13<10:45, 53.77s/it]Task 4, Epoch 9/20 => Loss 0.332, Train_accy 90.97:  40%|████      | 8/20 [08:04<10:45, 53.77s/it]Task 4, Epoch 9/20 => Loss 0.332, Train_accy 90.97:  45%|████▌     | 9/20 [08:04<09:40, 52.80s/it]Task 4, Epoch 10/20 => Loss 0.331, Train_accy 91.10, Test_accy 75.15:  45%|████▌     | 9/20 [09:24<09:40, 52.80s/it]Task 4, Epoch 10/20 => Loss 0.331, Train_accy 91.10, Test_accy 75.15:  50%|█████     | 10/20 [09:24<10:13, 61.31s/it]Task 4, Epoch 11/20 => Loss 0.328, Train_accy 91.40:  50%|█████     | 10/20 [10:15<10:13, 61.31s/it]                 Task 4, Epoch 11/20 => Loss 0.328, Train_accy 91.40:  55%|█████▌    | 11/20 [10:15<08:42, 58.08s/it]Task 4, Epoch 12/20 => Loss 0.321, Train_accy 91.44:  55%|█████▌    | 11/20 [11:05<08:42, 58.08s/it]Task 4, Epoch 12/20 => Loss 0.321, Train_accy 91.44:  60%|██████    | 12/20 [11:05<07:25, 55.75s/it]Task 4, Epoch 13/20 => Loss 0.295, Train_accy 92.15:  60%|██████    | 12/20 [11:56<07:25, 55.75s/it]Task 4, Epoch 13/20 => Loss 0.295, Train_accy 92.15:  65%|██████▌   | 13/20 [11:56<06:19, 54.15s/it]Task 4, Epoch 14/20 => Loss 0.290, Train_accy 92.74:  65%|██████▌   | 13/20 [12:46<06:19, 54.15s/it]Task 4, Epoch 14/20 => Loss 0.290, Train_accy 92.74:  70%|███████   | 14/20 [12:46<05:18, 53.07s/it]Task 4, Epoch 15/20 => Loss 0.288, Train_accy 92.49, Test_accy 75.22:  70%|███████   | 14/20 [14:06<05:18, 53.07s/it]Task 4, Epoch 15/20 => Loss 0.288, Train_accy 92.49, Test_accy 75.22:  75%|███████▌  | 15/20 [14:06<05:06, 61.21s/it]Task 4, Epoch 16/20 => Loss 0.263, Train_accy 92.79:  75%|███████▌  | 15/20 [14:57<05:06, 61.21s/it]                 Task 4, Epoch 16/20 => Loss 0.263, Train_accy 92.79:  80%|████████  | 16/20 [14:57<03:52, 58.06s/it]Task 4, Epoch 17/20 => Loss 0.276, Train_accy 93.00:  80%|████████  | 16/20 [15:47<03:52, 58.06s/it]Task 4, Epoch 17/20 => Loss 0.276, Train_accy 93.00:  85%|████████▌ | 17/20 [15:47<02:47, 55.74s/it]Task 4, Epoch 18/20 => Loss 0.242, Train_accy 93.43:  85%|████████▌ | 17/20 [16:38<02:47, 55.74s/it]Task 4, Epoch 18/20 => Loss 0.242, Train_accy 93.43:  90%|█████████ | 18/20 [16:38<01:48, 54.13s/it]Task 4, Epoch 19/20 => Loss 0.242, Train_accy 93.58:  90%|█████████ | 18/20 [17:28<01:48, 54.13s/it]Task 4, Epoch 19/20 => Loss 0.242, Train_accy 93.58:  95%|█████████▌| 19/20 [17:28<00:53, 53.03s/it]Task 4, Epoch 20/20 => Loss 0.242, Train_accy 93.92, Test_accy 75.02:  95%|█████████▌| 19/20 [18:48<00:53, 53.03s/it]Task 4, Epoch 20/20 => Loss 0.242, Train_accy 93.92, Test_accy 75.02: 100%|██████████| 20/20 [18:48<00:00, 61.18s/it]Task 4, Epoch 20/20 => Loss 0.242, Train_accy 93.92, Test_accy 75.02: 100%|██████████| 20/20 [18:48<00:00, 56.45s/it]
2024-04-19 02:50:21,812 [coda_prompt.py] => Task 4, Epoch 20/20 => Loss 0.242, Train_accy 93.92, Test_accy 75.02
2024-04-19 02:50:51,516 [trainer.py] => No NME accuracy.
2024-04-19 02:50:51,516 [trainer.py] => CNN: {'total': 75.02, '00-39': 79.23, '40-79': 74.11, '80-119': 73.24, '120-159': 66.08, '160-199': 80.46, 'old': 73.5, 'new': 80.46}
2024-04-19 02:50:51,517 [trainer.py] => CNN top1 curve: [85.44, 80.75, 78.93, 75.04, 75.02]
2024-04-19 02:50:51,517 [trainer.py] => CNN top5 curve: [95.27, 93.97, 91.65, 88.84, 87.95]

Average Accuracy (CNN): 79.036
2024-04-19 02:50:51,517 [trainer.py] => Average Accuracy (CNN): 79.036 

2024-04-19 02:50:51,517 [trainer.py] => Train Time: 9785.98
2024-04-19 02:50:51,517 [trainer.py] => Test Time: 90.06 

Accuracy Matrix (CNN):
[[85.44 82.78 83.07 80.86 79.23]
 [ 0.   77.97 76.04 75.43 74.11]
 [ 0.    0.   76.76 73.79 73.24]
 [ 0.    0.    0.   68.86 66.08]
 [ 0.    0.    0.    0.   80.46]]
2024-04-19 02:50:51,518 [trainer.py] => Forgetting (CNN): 4.092500000000001
2024-04-19 02:50:55,031 [trainer.py] => config: ./exps/ease_inr.json
2024-04-19 02:50:55,031 [trainer.py] => prefix:  
2024-04-19 02:50:55,031 [trainer.py] => dataset: imagenetr
2024-04-19 02:50:55,031 [trainer.py] => memory_size: 0
2024-04-19 02:50:55,032 [trainer.py] => memory_per_class: 0
2024-04-19 02:50:55,032 [trainer.py] => fixed_memory: False
2024-04-19 02:50:55,032 [trainer.py] => shuffle: True
2024-04-19 02:50:55,032 [trainer.py] => init_cls: 40
2024-04-19 02:50:55,032 [trainer.py] => increment: 40
2024-04-19 02:50:55,032 [trainer.py] => model_name: ease
2024-04-19 02:50:55,032 [trainer.py] => backbone_type: vit_base_patch16_224_ease
2024-04-19 02:50:55,032 [trainer.py] => device: [device(type='cuda', index=4)]
2024-04-19 02:50:55,032 [trainer.py] => seed: 1993
2024-04-19 02:50:55,032 [trainer.py] => init_epochs: 20
2024-04-19 02:50:55,032 [trainer.py] => init_lr: 0.05
2024-04-19 02:50:55,032 [trainer.py] => later_epochs: 20
2024-04-19 02:50:55,032 [trainer.py] => later_lr: 0.05
2024-04-19 02:50:55,032 [trainer.py] => batch_size: 48
2024-04-19 02:50:55,032 [trainer.py] => weight_decay: 0.005
2024-04-19 02:50:55,032 [trainer.py] => min_lr: 0
2024-04-19 02:50:55,032 [trainer.py] => optimizer: sgd
2024-04-19 02:50:55,032 [trainer.py] => scheduler: cosine
2024-04-19 02:50:55,032 [trainer.py] => pretrained: True
2024-04-19 02:50:55,032 [trainer.py] => vpt_type: Deep
2024-04-19 02:50:55,032 [trainer.py] => prompt_token_num: 5
2024-04-19 02:50:55,032 [trainer.py] => ffn_num: 64
2024-04-19 02:50:55,032 [trainer.py] => use_diagonal: False
2024-04-19 02:50:55,032 [trainer.py] => recalc_sim: True
2024-04-19 02:50:55,032 [trainer.py] => alpha: 0.1
2024-04-19 02:50:55,032 [trainer.py] => use_init_ptm: False
2024-04-19 02:50:55,032 [trainer.py] => beta: 0
2024-04-19 02:50:55,032 [trainer.py] => use_old_data: False
2024-04-19 02:50:55,032 [trainer.py] => use_reweight: True
2024-04-19 02:50:55,032 [trainer.py] => moni_adam: False
2024-04-19 02:50:55,033 [trainer.py] => adapter_num: -1
2024-04-19 02:50:55,119 [data_manager.py] => [168, 136, 51, 9, 183, 101, 171, 99, 42, 159, 191, 70, 16, 188, 27, 10, 175, 26, 68, 187, 98, 6, 85, 35, 112, 43, 100, 0, 103, 181, 88, 59, 4, 2, 116, 174, 94, 80, 106, 1, 147, 17, 141, 131, 72, 23, 173, 54, 197, 118, 87, 32, 79, 104, 91, 19, 135, 107, 178, 36, 11, 199, 142, 8, 122, 3, 28, 57, 153, 172, 190, 56, 49, 44, 97, 62, 151, 169, 194, 55, 192, 12, 189, 78, 66, 180, 15, 137, 109, 134, 92, 119, 126, 52, 170, 40, 148, 65, 144, 64, 138, 45, 77, 89, 154, 90, 71, 193, 74, 30, 113, 143, 96, 84, 67, 50, 186, 156, 69, 21, 18, 111, 108, 58, 125, 157, 150, 110, 182, 129, 166, 83, 81, 60, 13, 165, 14, 176, 63, 117, 5, 22, 145, 121, 38, 41, 82, 127, 114, 20, 31, 53, 37, 163, 196, 130, 152, 162, 86, 76, 24, 34, 184, 149, 33, 128, 198, 155, 146, 167, 139, 120, 140, 102, 47, 25, 158, 123, 46, 164, 61, 7, 115, 75, 133, 160, 105, 132, 179, 124, 48, 73, 93, 39, 95, 195, 29, 177, 185, 161]
This is for the BaseNet initialization.
I'm using ViT with adapters.
_IncompatibleKeys(missing_keys=['cur_adapter.0.down_proj.weight', 'cur_adapter.0.down_proj.bias', 'cur_adapter.0.up_proj.weight', 'cur_adapter.0.up_proj.bias', 'cur_adapter.1.down_proj.weight', 'cur_adapter.1.down_proj.bias', 'cur_adapter.1.up_proj.weight', 'cur_adapter.1.up_proj.bias', 'cur_adapter.2.down_proj.weight', 'cur_adapter.2.down_proj.bias', 'cur_adapter.2.up_proj.weight', 'cur_adapter.2.up_proj.bias', 'cur_adapter.3.down_proj.weight', 'cur_adapter.3.down_proj.bias', 'cur_adapter.3.up_proj.weight', 'cur_adapter.3.up_proj.bias', 'cur_adapter.4.down_proj.weight', 'cur_adapter.4.down_proj.bias', 'cur_adapter.4.up_proj.weight', 'cur_adapter.4.up_proj.bias', 'cur_adapter.5.down_proj.weight', 'cur_adapter.5.down_proj.bias', 'cur_adapter.5.up_proj.weight', 'cur_adapter.5.up_proj.bias', 'cur_adapter.6.down_proj.weight', 'cur_adapter.6.down_proj.bias', 'cur_adapter.6.up_proj.weight', 'cur_adapter.6.up_proj.bias', 'cur_adapter.7.down_proj.weight', 'cur_adapter.7.down_proj.bias', 'cur_adapter.7.up_proj.weight', 'cur_adapter.7.up_proj.bias', 'cur_adapter.8.down_proj.weight', 'cur_adapter.8.down_proj.bias', 'cur_adapter.8.up_proj.weight', 'cur_adapter.8.up_proj.bias', 'cur_adapter.9.down_proj.weight', 'cur_adapter.9.down_proj.bias', 'cur_adapter.9.up_proj.weight', 'cur_adapter.9.up_proj.bias', 'cur_adapter.10.down_proj.weight', 'cur_adapter.10.down_proj.bias', 'cur_adapter.10.up_proj.weight', 'cur_adapter.10.up_proj.bias', 'cur_adapter.11.down_proj.weight', 'cur_adapter.11.down_proj.bias', 'cur_adapter.11.up_proj.weight', 'cur_adapter.11.up_proj.bias'], unexpected_keys=[])
After BaseNet initialization.
2024-04-19 02:50:58,633 [trainer.py] => All params: 86988288
2024-04-19 02:50:58,634 [trainer.py] => Trainable params: 1189632
2024-04-19 02:50:58,644 [ease.py] => Learning on 0-40
  0%|          | 0/20 [00:00<?, ?it/s]Task 0, Epoch 1/20 => Loss 2.623, Train_accy 49.94:   0%|          | 0/20 [00:27<?, ?it/s]Task 0, Epoch 1/20 => Loss 2.623, Train_accy 49.94:   5%|▌         | 1/20 [00:27<08:50, 27.91s/it]Task 0, Epoch 2/20 => Loss 0.992, Train_accy 77.00:   5%|▌         | 1/20 [00:55<08:50, 27.91s/it]Task 0, Epoch 2/20 => Loss 0.992, Train_accy 77.00:  10%|█         | 2/20 [00:55<08:19, 27.72s/it]Task 0, Epoch 3/20 => Loss 0.848, Train_accy 78.77:  10%|█         | 2/20 [01:23<08:19, 27.72s/it]Task 0, Epoch 3/20 => Loss 0.848, Train_accy 78.77:  15%|█▌        | 3/20 [01:23<07:50, 27.70s/it]Task 0, Epoch 4/20 => Loss 0.784, Train_accy 81.29:  15%|█▌        | 3/20 [01:50<07:50, 27.70s/it]Task 0, Epoch 4/20 => Loss 0.784, Train_accy 81.29:  20%|██        | 4/20 [01:50<07:22, 27.66s/it]Task 0, Epoch 5/20 => Loss 0.776, Train_accy 80.69:  20%|██        | 4/20 [02:18<07:22, 27.66s/it]Task 0, Epoch 5/20 => Loss 0.776, Train_accy 80.69:  25%|██▌       | 5/20 [02:18<06:56, 27.76s/it]Task 0, Epoch 6/20 => Loss 0.759, Train_accy 81.53:  25%|██▌       | 5/20 [02:46<06:56, 27.76s/it]Task 0, Epoch 6/20 => Loss 0.759, Train_accy 81.53:  30%|███       | 6/20 [02:46<06:27, 27.71s/it]Task 0, Epoch 7/20 => Loss 0.750, Train_accy 81.72:  30%|███       | 6/20 [03:13<06:27, 27.71s/it]Task 0, Epoch 7/20 => Loss 0.750, Train_accy 81.72:  35%|███▌      | 7/20 [03:13<05:59, 27.69s/it]Task 0, Epoch 8/20 => Loss 0.753, Train_accy 81.85:  35%|███▌      | 7/20 [03:41<05:59, 27.69s/it]Task 0, Epoch 8/20 => Loss 0.753, Train_accy 81.85:  40%|████      | 8/20 [03:41<05:31, 27.63s/it]Task 0, Epoch 9/20 => Loss 0.726, Train_accy 82.26:  40%|████      | 8/20 [04:09<05:31, 27.63s/it]Task 0, Epoch 9/20 => Loss 0.726, Train_accy 82.26:  45%|████▌     | 9/20 [04:09<05:03, 27.62s/it]Task 0, Epoch 10/20 => Loss 0.723, Train_accy 82.22:  45%|████▌     | 9/20 [04:36<05:03, 27.62s/it]Task 0, Epoch 10/20 => Loss 0.723, Train_accy 82.22:  50%|█████     | 10/20 [04:36<04:36, 27.64s/it]Task 0, Epoch 11/20 => Loss 0.704, Train_accy 82.72:  50%|█████     | 10/20 [05:04<04:36, 27.64s/it]Task 0, Epoch 11/20 => Loss 0.704, Train_accy 82.72:  55%|█████▌    | 11/20 [05:04<04:09, 27.67s/it]Task 0, Epoch 12/20 => Loss 0.699, Train_accy 82.99:  55%|█████▌    | 11/20 [05:32<04:09, 27.67s/it]Task 0, Epoch 12/20 => Loss 0.699, Train_accy 82.99:  60%|██████    | 12/20 [05:32<03:42, 27.79s/it]Task 0, Epoch 13/20 => Loss 0.675, Train_accy 83.43:  60%|██████    | 12/20 [06:00<03:42, 27.79s/it]Task 0, Epoch 13/20 => Loss 0.675, Train_accy 83.43:  65%|██████▌   | 13/20 [06:00<03:14, 27.78s/it]Task 0, Epoch 14/20 => Loss 0.668, Train_accy 83.21:  65%|██████▌   | 13/20 [06:28<03:14, 27.78s/it]Task 0, Epoch 14/20 => Loss 0.668, Train_accy 83.21:  70%|███████   | 14/20 [06:28<02:46, 27.76s/it]Task 0, Epoch 15/20 => Loss 0.681, Train_accy 83.64:  70%|███████   | 14/20 [06:55<02:46, 27.76s/it]Task 0, Epoch 15/20 => Loss 0.681, Train_accy 83.64:  75%|███████▌  | 15/20 [06:55<02:18, 27.67s/it]Task 0, Epoch 16/20 => Loss 0.665, Train_accy 83.69:  75%|███████▌  | 15/20 [07:23<02:18, 27.67s/it]Task 0, Epoch 16/20 => Loss 0.665, Train_accy 83.69:  80%|████████  | 16/20 [07:23<01:50, 27.67s/it]Task 0, Epoch 17/20 => Loss 0.676, Train_accy 83.60:  80%|████████  | 16/20 [07:50<01:50, 27.67s/it]Task 0, Epoch 17/20 => Loss 0.676, Train_accy 83.60:  85%|████████▌ | 17/20 [07:50<01:22, 27.64s/it]Task 0, Epoch 18/20 => Loss 0.649, Train_accy 84.61:  85%|████████▌ | 17/20 [08:18<01:22, 27.64s/it]Task 0, Epoch 18/20 => Loss 0.649, Train_accy 84.61:  90%|█████████ | 18/20 [08:18<00:55, 27.61s/it]Task 0, Epoch 19/20 => Loss 0.647, Train_accy 84.36:  90%|█████████ | 18/20 [08:45<00:55, 27.61s/it]Task 0, Epoch 19/20 => Loss 0.647, Train_accy 84.36:  95%|█████████▌| 19/20 [08:45<00:27, 27.62s/it]Task 0, Epoch 20/20 => Loss 0.645, Train_accy 84.35:  95%|█████████▌| 19/20 [09:13<00:27, 27.62s/it]Task 0, Epoch 20/20 => Loss 0.645, Train_accy 84.35: 100%|██████████| 20/20 [09:13<00:00, 27.69s/it]Task 0, Epoch 20/20 => Loss 0.645, Train_accy 84.35: 100%|██████████| 20/20 [09:13<00:00, 27.69s/it]
2024-04-19 03:00:12,501 [ease.py] => Task 0, Epoch 20/20 => Loss 0.645, Train_accy 84.35
2024-04-19 03:00:31,624 [ease.py] => Task correct: 100.0
2024-04-19 03:00:31,624 [ease.py] => Task acc: 88.2664647993944
2024-04-19 03:00:31,667 [trainer.py] => No NME accuracy.
2024-04-19 03:00:31,667 [trainer.py] => CNN: {'total': 88.27, '00-39': 88.27, 'old': 0, 'new': 88.27}
2024-04-19 03:00:31,667 [trainer.py] => CNN top1 curve: [88.27]
2024-04-19 03:00:31,668 [trainer.py] => CNN top5 curve: [96.82]

Average Accuracy (CNN): 88.27
2024-04-19 03:00:31,668 [trainer.py] => Average Accuracy (CNN): 88.27 

2024-04-19 03:00:31,668 [trainer.py] => Train Time: 1107.63
2024-04-19 03:00:31,668 [trainer.py] => Test Time: 4.08 

2024-04-19 03:00:31,668 [trainer.py] => All params: 87049730
2024-04-19 03:00:31,669 [trainer.py] => Trainable params: 1189632
2024-04-19 03:00:31,671 [ease.py] => Learning on 40-80
  0%|          | 0/20 [00:00<?, ?it/s]Task 1, Epoch 1/20 => Loss 2.894, Train_accy 45.49:   0%|          | 0/20 [00:23<?, ?it/s]Task 1, Epoch 1/20 => Loss 2.894, Train_accy 45.49:   5%|▌         | 1/20 [00:23<07:34, 23.90s/it]Task 1, Epoch 2/20 => Loss 1.214, Train_accy 72.52:   5%|▌         | 1/20 [00:53<07:34, 23.90s/it]Task 1, Epoch 2/20 => Loss 1.214, Train_accy 72.52:  10%|█         | 2/20 [00:53<08:09, 27.20s/it]Task 1, Epoch 3/20 => Loss 0.979, Train_accy 76.34:  10%|█         | 2/20 [01:19<08:09, 27.20s/it]Task 1, Epoch 3/20 => Loss 0.979, Train_accy 76.34:  15%|█▌        | 3/20 [01:19<07:31, 26.58s/it]Task 1, Epoch 4/20 => Loss 0.887, Train_accy 78.77:  15%|█▌        | 3/20 [01:43<07:31, 26.58s/it]Task 1, Epoch 4/20 => Loss 0.887, Train_accy 78.77:  20%|██        | 4/20 [01:43<06:49, 25.58s/it]Task 1, Epoch 5/20 => Loss 0.845, Train_accy 79.85:  20%|██        | 4/20 [02:07<06:49, 25.58s/it]Task 1, Epoch 5/20 => Loss 0.845, Train_accy 79.85:  25%|██▌       | 5/20 [02:07<06:14, 24.97s/it]Task 1, Epoch 6/20 => Loss 0.839, Train_accy 79.85:  25%|██▌       | 5/20 [02:31<06:14, 24.97s/it]Task 1, Epoch 6/20 => Loss 0.839, Train_accy 79.85:  30%|███       | 6/20 [02:31<05:46, 24.72s/it]Task 1, Epoch 7/20 => Loss 0.817, Train_accy 80.46:  30%|███       | 6/20 [02:55<05:46, 24.72s/it]Task 1, Epoch 7/20 => Loss 0.817, Train_accy 80.46:  35%|███▌      | 7/20 [02:55<05:17, 24.45s/it]Task 1, Epoch 8/20 => Loss 0.796, Train_accy 81.06:  35%|███▌      | 7/20 [03:19<05:17, 24.45s/it]Task 1, Epoch 8/20 => Loss 0.796, Train_accy 81.06:  40%|████      | 8/20 [03:19<04:51, 24.29s/it]Task 1, Epoch 9/20 => Loss 0.779, Train_accy 81.04:  40%|████      | 8/20 [03:43<04:51, 24.29s/it]Task 1, Epoch 9/20 => Loss 0.779, Train_accy 81.04:  45%|████▌     | 9/20 [03:43<04:26, 24.21s/it]Task 1, Epoch 10/20 => Loss 0.777, Train_accy 81.10:  45%|████▌     | 9/20 [04:07<04:26, 24.21s/it]Task 1, Epoch 10/20 => Loss 0.777, Train_accy 81.10:  50%|█████     | 10/20 [04:07<04:01, 24.11s/it]Task 1, Epoch 11/20 => Loss 0.761, Train_accy 82.16:  50%|█████     | 10/20 [04:31<04:01, 24.11s/it]Task 1, Epoch 11/20 => Loss 0.761, Train_accy 82.16:  55%|█████▌    | 11/20 [04:31<03:36, 24.06s/it]Task 1, Epoch 12/20 => Loss 0.779, Train_accy 81.45:  55%|█████▌    | 11/20 [04:55<03:36, 24.06s/it]Task 1, Epoch 12/20 => Loss 0.779, Train_accy 81.45:  60%|██████    | 12/20 [04:55<03:12, 24.03s/it]Task 1, Epoch 13/20 => Loss 0.772, Train_accy 81.10:  60%|██████    | 12/20 [05:19<03:12, 24.03s/it]Task 1, Epoch 13/20 => Loss 0.772, Train_accy 81.10:  65%|██████▌   | 13/20 [05:19<02:47, 24.00s/it]Task 1, Epoch 14/20 => Loss 0.761, Train_accy 81.99:  65%|██████▌   | 13/20 [05:42<02:47, 24.00s/it]Task 1, Epoch 14/20 => Loss 0.761, Train_accy 81.99:  70%|███████   | 14/20 [05:42<02:23, 23.97s/it]Task 1, Epoch 15/20 => Loss 0.721, Train_accy 82.79:  70%|███████   | 14/20 [06:06<02:23, 23.97s/it]Task 1, Epoch 15/20 => Loss 0.721, Train_accy 82.79:  75%|███████▌  | 15/20 [06:06<01:59, 23.98s/it]Task 1, Epoch 16/20 => Loss 0.752, Train_accy 81.43:  75%|███████▌  | 15/20 [06:31<01:59, 23.98s/it]Task 1, Epoch 16/20 => Loss 0.752, Train_accy 81.43:  80%|████████  | 16/20 [06:31<01:36, 24.02s/it]Task 1, Epoch 17/20 => Loss 0.709, Train_accy 82.94:  80%|████████  | 16/20 [06:55<01:36, 24.02s/it]Task 1, Epoch 17/20 => Loss 0.709, Train_accy 82.94:  85%|████████▌ | 17/20 [06:55<01:12, 24.05s/it]Task 1, Epoch 18/20 => Loss 0.708, Train_accy 82.55:  85%|████████▌ | 17/20 [07:19<01:12, 24.05s/it]Task 1, Epoch 18/20 => Loss 0.708, Train_accy 82.55:  90%|█████████ | 18/20 [07:19<00:48, 24.04s/it]Task 1, Epoch 19/20 => Loss 0.700, Train_accy 82.96:  90%|█████████ | 18/20 [07:43<00:48, 24.04s/it]Task 1, Epoch 19/20 => Loss 0.700, Train_accy 82.96:  95%|█████████▌| 19/20 [07:43<00:24, 24.07s/it]Task 1, Epoch 20/20 => Loss 0.673, Train_accy 83.80:  95%|█████████▌| 19/20 [08:07<00:24, 24.07s/it]Task 1, Epoch 20/20 => Loss 0.673, Train_accy 83.80: 100%|██████████| 20/20 [08:07<00:00, 24.07s/it]Task 1, Epoch 20/20 => Loss 0.673, Train_accy 83.80: 100%|██████████| 20/20 [08:07<00:00, 24.37s/it]
2024-04-19 03:08:39,089 [ease.py] => Task 1, Epoch 20/20 => Loss 0.673, Train_accy 83.80
2024-04-19 03:09:18,328 [ease.py] => Task correct: 91.75340272217774
2024-04-19 03:09:18,329 [ease.py] => Task acc: 87.87029623698959
2024-04-19 03:09:18,466 [trainer.py] => No NME accuracy.
2024-04-19 03:09:18,466 [trainer.py] => CNN: {'total': 83.51, '00-39': 83.5, '40-79': 83.52, 'old': 83.5, 'new': 83.52}
2024-04-19 03:09:18,467 [trainer.py] => CNN top1 curve: [88.27, 83.51]
2024-04-19 03:09:18,467 [trainer.py] => CNN top5 curve: [96.82, 95.28]

Average Accuracy (CNN): 85.89
2024-04-19 03:09:18,467 [trainer.py] => Average Accuracy (CNN): 85.89 

2024-04-19 03:09:18,467 [trainer.py] => Train Time: 2082.4500000000003
2024-04-19 03:09:18,467 [trainer.py] => Test Time: 17.59 

2024-04-19 03:09:18,467 [trainer.py] => All params: 87141890
2024-04-19 03:09:18,468 [trainer.py] => Trainable params: 1189632
2024-04-19 03:09:18,470 [ease.py] => Learning on 80-120
  0%|          | 0/20 [00:00<?, ?it/s]Task 2, Epoch 1/20 => Loss 2.793, Train_accy 45.39:   0%|          | 0/20 [00:25<?, ?it/s]Task 2, Epoch 1/20 => Loss 2.793, Train_accy 45.39:   5%|▌         | 1/20 [00:25<07:57, 25.11s/it]Task 2, Epoch 2/20 => Loss 1.122, Train_accy 74.83:   5%|▌         | 1/20 [00:50<07:57, 25.11s/it]Task 2, Epoch 2/20 => Loss 1.122, Train_accy 74.83:  10%|█         | 2/20 [00:50<07:32, 25.12s/it]Task 2, Epoch 3/20 => Loss 0.901, Train_accy 78.12:  10%|█         | 2/20 [01:15<07:32, 25.12s/it]Task 2, Epoch 3/20 => Loss 0.901, Train_accy 78.12:  15%|█▌        | 3/20 [01:15<07:05, 25.04s/it]Task 2, Epoch 4/20 => Loss 0.856, Train_accy 79.40:  15%|█▌        | 3/20 [01:40<07:05, 25.04s/it]Task 2, Epoch 4/20 => Loss 0.856, Train_accy 79.40:  20%|██        | 4/20 [01:40<06:41, 25.09s/it]Task 2, Epoch 5/20 => Loss 0.830, Train_accy 79.77:  20%|██        | 4/20 [02:05<06:41, 25.09s/it]Task 2, Epoch 5/20 => Loss 0.830, Train_accy 79.77:  25%|██▌       | 5/20 [02:05<06:16, 25.09s/it]Task 2, Epoch 6/20 => Loss 0.827, Train_accy 79.73:  25%|██▌       | 5/20 [02:30<06:16, 25.09s/it]Task 2, Epoch 6/20 => Loss 0.827, Train_accy 79.73:  30%|███       | 6/20 [02:30<05:50, 25.06s/it]Task 2, Epoch 7/20 => Loss 0.815, Train_accy 80.14:  30%|███       | 6/20 [02:55<05:50, 25.06s/it]Task 2, Epoch 7/20 => Loss 0.815, Train_accy 80.14:  35%|███▌      | 7/20 [02:55<05:25, 25.05s/it]Task 2, Epoch 8/20 => Loss 0.759, Train_accy 82.00:  35%|███▌      | 7/20 [03:20<05:25, 25.05s/it]Task 2, Epoch 8/20 => Loss 0.759, Train_accy 82.00:  40%|████      | 8/20 [03:20<05:00, 25.05s/it]Task 2, Epoch 9/20 => Loss 0.786, Train_accy 80.23:  40%|████      | 8/20 [03:45<05:00, 25.05s/it]Task 2, Epoch 9/20 => Loss 0.786, Train_accy 80.23:  45%|████▌     | 9/20 [03:45<04:35, 25.02s/it]Task 2, Epoch 10/20 => Loss 0.778, Train_accy 80.39:  45%|████▌     | 9/20 [04:10<04:35, 25.02s/it]Task 2, Epoch 10/20 => Loss 0.778, Train_accy 80.39:  50%|█████     | 10/20 [04:10<04:10, 25.02s/it]Task 2, Epoch 11/20 => Loss 0.756, Train_accy 81.74:  50%|█████     | 10/20 [04:35<04:10, 25.02s/it]Task 2, Epoch 11/20 => Loss 0.756, Train_accy 81.74:  55%|█████▌    | 11/20 [04:35<03:45, 25.02s/it]Task 2, Epoch 12/20 => Loss 0.764, Train_accy 81.32:  55%|█████▌    | 11/20 [05:00<03:45, 25.02s/it]Task 2, Epoch 12/20 => Loss 0.764, Train_accy 81.32:  60%|██████    | 12/20 [05:00<03:20, 25.09s/it]Task 2, Epoch 13/20 => Loss 0.719, Train_accy 82.36:  60%|██████    | 12/20 [05:25<03:20, 25.09s/it]Task 2, Epoch 13/20 => Loss 0.719, Train_accy 82.36:  65%|██████▌   | 13/20 [05:25<02:55, 25.07s/it]Task 2, Epoch 14/20 => Loss 0.754, Train_accy 81.26:  65%|██████▌   | 13/20 [05:50<02:55, 25.07s/it]Task 2, Epoch 14/20 => Loss 0.754, Train_accy 81.26:  70%|███████   | 14/20 [05:50<02:30, 25.05s/it]Task 2, Epoch 15/20 => Loss 0.717, Train_accy 82.89:  70%|███████   | 14/20 [06:15<02:30, 25.05s/it]Task 2, Epoch 15/20 => Loss 0.717, Train_accy 82.89:  75%|███████▌  | 15/20 [06:15<02:05, 25.03s/it]Task 2, Epoch 16/20 => Loss 0.703, Train_accy 82.38:  75%|███████▌  | 15/20 [06:40<02:05, 25.03s/it]Task 2, Epoch 16/20 => Loss 0.703, Train_accy 82.38:  80%|████████  | 16/20 [06:40<01:40, 25.08s/it]Task 2, Epoch 17/20 => Loss 0.680, Train_accy 83.35:  80%|████████  | 16/20 [07:06<01:40, 25.08s/it]Task 2, Epoch 17/20 => Loss 0.680, Train_accy 83.35:  85%|████████▌ | 17/20 [07:06<01:15, 25.13s/it]Task 2, Epoch 18/20 => Loss 0.705, Train_accy 82.42:  85%|████████▌ | 17/20 [07:31<01:15, 25.13s/it]Task 2, Epoch 18/20 => Loss 0.705, Train_accy 82.42:  90%|█████████ | 18/20 [07:31<00:50, 25.12s/it]Task 2, Epoch 19/20 => Loss 0.686, Train_accy 83.64:  90%|█████████ | 18/20 [07:56<00:50, 25.12s/it]Task 2, Epoch 19/20 => Loss 0.686, Train_accy 83.64:  95%|█████████▌| 19/20 [07:56<00:25, 25.06s/it]Task 2, Epoch 20/20 => Loss 0.684, Train_accy 83.39:  95%|█████████▌| 19/20 [08:21<00:25, 25.06s/it]Task 2, Epoch 20/20 => Loss 0.684, Train_accy 83.39: 100%|██████████| 20/20 [08:21<00:00, 25.05s/it]Task 2, Epoch 20/20 => Loss 0.684, Train_accy 83.39: 100%|██████████| 20/20 [08:21<00:00, 25.06s/it]
2024-04-19 03:17:39,738 [ease.py] => Task 2, Epoch 20/20 => Loss 0.684, Train_accy 83.39
2024-04-19 03:18:48,245 [ease.py] => Task correct: 86.69410150891632
2024-04-19 03:18:48,245 [ease.py] => Task acc: 88.25788751714677
2024-04-19 03:18:48,282 [trainer.py] => No NME accuracy.
2024-04-19 03:18:48,282 [trainer.py] => CNN: {'total': 80.85, '00-39': 80.24, '40-79': 79.1, '80-119': 83.35, 'old': 79.7, 'new': 83.35}
2024-04-19 03:18:48,283 [trainer.py] => CNN top1 curve: [88.27, 83.51, 80.85]
2024-04-19 03:18:48,283 [trainer.py] => CNN top5 curve: [96.82, 95.28, 93.64]

Average Accuracy (CNN): 84.21
2024-04-19 03:18:48,283 [trainer.py] => Average Accuracy (CNN): 84.21 

2024-04-19 03:18:48,283 [trainer.py] => Train Time: 3084.96
2024-04-19 03:18:48,283 [trainer.py] => Test Time: 45.55 

2024-04-19 03:18:48,283 [trainer.py] => All params: 87295490
2024-04-19 03:18:48,284 [trainer.py] => Trainable params: 1189632
2024-04-19 03:18:48,290 [ease.py] => Learning on 120-160
  0%|          | 0/20 [00:00<?, ?it/s]Task 3, Epoch 1/20 => Loss 2.709, Train_accy 45.79:   0%|          | 0/20 [00:25<?, ?it/s]Task 3, Epoch 1/20 => Loss 2.709, Train_accy 45.79:   5%|▌         | 1/20 [00:25<08:04, 25.52s/it]Task 3, Epoch 2/20 => Loss 1.068, Train_accy 76.50:   5%|▌         | 1/20 [00:51<08:04, 25.52s/it]Task 3, Epoch 2/20 => Loss 1.068, Train_accy 76.50:  10%|█         | 2/20 [00:51<07:42, 25.68s/it]Task 3, Epoch 3/20 => Loss 0.890, Train_accy 79.45:  10%|█         | 2/20 [01:16<07:42, 25.68s/it]Task 3, Epoch 3/20 => Loss 0.890, Train_accy 79.45:  15%|█▌        | 3/20 [01:16<07:16, 25.67s/it]Task 3, Epoch 4/20 => Loss 0.806, Train_accy 81.01:  15%|█▌        | 3/20 [01:42<07:16, 25.67s/it]Task 3, Epoch 4/20 => Loss 0.806, Train_accy 81.01:  20%|██        | 4/20 [01:42<06:50, 25.63s/it]Task 3, Epoch 5/20 => Loss 0.812, Train_accy 80.77:  20%|██        | 4/20 [02:08<06:50, 25.63s/it]Task 3, Epoch 5/20 => Loss 0.812, Train_accy 80.77:  25%|██▌       | 5/20 [02:08<06:23, 25.59s/it]Task 3, Epoch 6/20 => Loss 0.774, Train_accy 81.40:  25%|██▌       | 5/20 [02:33<06:23, 25.59s/it]Task 3, Epoch 6/20 => Loss 0.774, Train_accy 81.40:  30%|███       | 6/20 [02:33<05:57, 25.51s/it]Task 3, Epoch 7/20 => Loss 0.748, Train_accy 82.04:  30%|███       | 6/20 [02:58<05:57, 25.51s/it]Task 3, Epoch 7/20 => Loss 0.748, Train_accy 82.04:  35%|███▌      | 7/20 [02:58<05:31, 25.51s/it]Task 3, Epoch 8/20 => Loss 0.767, Train_accy 81.56:  35%|███▌      | 7/20 [03:24<05:31, 25.51s/it]Task 3, Epoch 8/20 => Loss 0.767, Train_accy 81.56:  40%|████      | 8/20 [03:24<05:06, 25.54s/it]Task 3, Epoch 9/20 => Loss 0.763, Train_accy 81.56:  40%|████      | 8/20 [03:50<05:06, 25.54s/it]Task 3, Epoch 9/20 => Loss 0.763, Train_accy 81.56:  45%|████▌     | 9/20 [03:50<04:40, 25.53s/it]Task 3, Epoch 10/20 => Loss 0.753, Train_accy 81.80:  45%|████▌     | 9/20 [04:15<04:40, 25.53s/it]Task 3, Epoch 10/20 => Loss 0.753, Train_accy 81.80:  50%|█████     | 10/20 [04:15<04:16, 25.64s/it]Task 3, Epoch 11/20 => Loss 0.754, Train_accy 81.58:  50%|█████     | 10/20 [04:41<04:16, 25.64s/it]Task 3, Epoch 11/20 => Loss 0.754, Train_accy 81.58:  55%|█████▌    | 11/20 [04:41<03:50, 25.66s/it]Task 3, Epoch 12/20 => Loss 0.718, Train_accy 82.85:  55%|█████▌    | 11/20 [05:07<03:50, 25.66s/it]Task 3, Epoch 12/20 => Loss 0.718, Train_accy 82.85:  60%|██████    | 12/20 [05:07<03:25, 25.66s/it]Task 3, Epoch 13/20 => Loss 0.712, Train_accy 82.53:  60%|██████    | 12/20 [05:32<03:25, 25.66s/it]Task 3, Epoch 13/20 => Loss 0.712, Train_accy 82.53:  65%|██████▌   | 13/20 [05:32<02:59, 25.64s/it]Task 3, Epoch 14/20 => Loss 0.722, Train_accy 82.69:  65%|██████▌   | 13/20 [05:58<02:59, 25.64s/it]Task 3, Epoch 14/20 => Loss 0.722, Train_accy 82.69:  70%|███████   | 14/20 [05:58<02:34, 25.70s/it]Task 3, Epoch 15/20 => Loss 0.688, Train_accy 83.04:  70%|███████   | 14/20 [06:24<02:34, 25.70s/it]Task 3, Epoch 15/20 => Loss 0.688, Train_accy 83.04:  75%|███████▌  | 15/20 [06:24<02:08, 25.68s/it]Task 3, Epoch 16/20 => Loss 0.719, Train_accy 83.02:  75%|███████▌  | 15/20 [06:49<02:08, 25.68s/it]Task 3, Epoch 16/20 => Loss 0.719, Train_accy 83.02:  80%|████████  | 16/20 [06:49<01:42, 25.67s/it]Task 3, Epoch 17/20 => Loss 0.657, Train_accy 84.03:  80%|████████  | 16/20 [07:15<01:42, 25.67s/it]Task 3, Epoch 17/20 => Loss 0.657, Train_accy 84.03:  85%|████████▌ | 17/20 [07:15<01:16, 25.65s/it]Task 3, Epoch 18/20 => Loss 0.664, Train_accy 84.03:  85%|████████▌ | 17/20 [07:41<01:16, 25.65s/it]Task 3, Epoch 18/20 => Loss 0.664, Train_accy 84.03:  90%|█████████ | 18/20 [07:41<00:51, 25.66s/it]Task 3, Epoch 19/20 => Loss 0.642, Train_accy 84.86:  90%|█████████ | 18/20 [08:06<00:51, 25.66s/it]Task 3, Epoch 19/20 => Loss 0.642, Train_accy 84.86:  95%|█████████▌| 19/20 [08:06<00:25, 25.60s/it]Task 3, Epoch 20/20 => Loss 0.650, Train_accy 84.23:  95%|█████████▌| 19/20 [08:32<00:25, 25.60s/it]Task 3, Epoch 20/20 => Loss 0.650, Train_accy 84.23: 100%|██████████| 20/20 [08:32<00:00, 25.57s/it]Task 3, Epoch 20/20 => Loss 0.650, Train_accy 84.23: 100%|██████████| 20/20 [08:32<00:00, 25.61s/it]
2024-04-19 03:27:20,556 [ease.py] => Task 3, Epoch 20/20 => Loss 0.650, Train_accy 84.23
2024-04-19 03:29:06,386 [ease.py] => Task correct: 84.22010924539754
2024-04-19 03:29:06,386 [ease.py] => Task acc: 88.44831074246409
2024-04-19 03:29:06,637 [trainer.py] => No NME accuracy.
2024-04-19 03:29:06,637 [trainer.py] => CNN: {'total': 79.53, '00-39': 78.35, '40-79': 78.42, '80-119': 80.91, '120-159': 80.51, 'old': 79.18, 'new': 80.51}
2024-04-19 03:29:06,638 [trainer.py] => CNN top1 curve: [88.27, 83.51, 80.85, 79.53]
2024-04-19 03:29:06,638 [trainer.py] => CNN top5 curve: [96.82, 95.28, 93.64, 92.58]

Average Accuracy (CNN): 83.03999999999999
2024-04-19 03:29:06,638 [trainer.py] => Average Accuracy (CNN): 83.03999999999999 

2024-04-19 03:29:06,638 [trainer.py] => Train Time: 4109.47
2024-04-19 03:29:06,638 [trainer.py] => Test Time: 95.14 

2024-04-19 03:29:06,639 [trainer.py] => All params: 87510530
2024-04-19 03:29:06,639 [trainer.py] => Trainable params: 1189632
2024-04-19 03:29:06,648 [ease.py] => Learning on 160-200
  0%|          | 0/20 [00:00<?, ?it/s]Task 4, Epoch 1/20 => Loss 2.941, Train_accy 42.75:   0%|          | 0/20 [00:22<?, ?it/s]Task 4, Epoch 1/20 => Loss 2.941, Train_accy 42.75:   5%|▌         | 1/20 [00:22<06:59, 22.09s/it]Task 4, Epoch 2/20 => Loss 1.219, Train_accy 72.78:   5%|▌         | 1/20 [00:44<06:59, 22.09s/it]Task 4, Epoch 2/20 => Loss 1.219, Train_accy 72.78:  10%|█         | 2/20 [00:44<06:35, 22.00s/it]Task 4, Epoch 3/20 => Loss 0.944, Train_accy 77.83:  10%|█         | 2/20 [01:05<06:35, 22.00s/it]Task 4, Epoch 3/20 => Loss 0.944, Train_accy 77.83:  15%|█▌        | 3/20 [01:05<06:13, 21.96s/it]Task 4, Epoch 4/20 => Loss 0.854, Train_accy 79.40:  15%|█▌        | 3/20 [01:27<06:13, 21.96s/it]Task 4, Epoch 4/20 => Loss 0.854, Train_accy 79.40:  20%|██        | 4/20 [01:27<05:50, 21.93s/it]Task 4, Epoch 5/20 => Loss 0.867, Train_accy 79.11:  20%|██        | 4/20 [01:50<05:50, 21.93s/it]Task 4, Epoch 5/20 => Loss 0.867, Train_accy 79.11:  25%|██▌       | 5/20 [01:50<05:31, 22.07s/it]Task 4, Epoch 6/20 => Loss 0.834, Train_accy 79.56:  25%|██▌       | 5/20 [02:11<05:31, 22.07s/it]Task 4, Epoch 6/20 => Loss 0.834, Train_accy 79.56:  30%|███       | 6/20 [02:11<05:07, 21.97s/it]Task 4, Epoch 7/20 => Loss 0.844, Train_accy 79.80:  30%|███       | 6/20 [02:33<05:07, 21.97s/it]Task 4, Epoch 7/20 => Loss 0.844, Train_accy 79.80:  35%|███▌      | 7/20 [02:33<04:45, 21.98s/it]Task 4, Epoch 8/20 => Loss 0.837, Train_accy 79.56:  35%|███▌      | 7/20 [02:55<04:45, 21.98s/it]Task 4, Epoch 8/20 => Loss 0.837, Train_accy 79.56:  40%|████      | 8/20 [02:55<04:23, 21.98s/it]Task 4, Epoch 9/20 => Loss 0.796, Train_accy 81.22:  40%|████      | 8/20 [03:17<04:23, 21.98s/it]Task 4, Epoch 9/20 => Loss 0.796, Train_accy 81.22:  45%|████▌     | 9/20 [03:17<04:01, 21.93s/it]Task 4, Epoch 10/20 => Loss 0.799, Train_accy 80.37:  45%|████▌     | 9/20 [03:39<04:01, 21.93s/it]Task 4, Epoch 10/20 => Loss 0.799, Train_accy 80.37:  50%|█████     | 10/20 [03:39<03:39, 21.91s/it]Task 4, Epoch 11/20 => Loss 0.768, Train_accy 81.65:  50%|█████     | 10/20 [04:01<03:39, 21.91s/it]Task 4, Epoch 11/20 => Loss 0.768, Train_accy 81.65:  55%|█████▌    | 11/20 [04:01<03:17, 21.91s/it]Task 4, Epoch 12/20 => Loss 0.756, Train_accy 81.56:  55%|█████▌    | 11/20 [04:23<03:17, 21.91s/it]Task 4, Epoch 12/20 => Loss 0.756, Train_accy 81.56:  60%|██████    | 12/20 [04:23<02:54, 21.85s/it]Task 4, Epoch 13/20 => Loss 0.735, Train_accy 81.96:  60%|██████    | 12/20 [04:44<02:54, 21.85s/it]Task 4, Epoch 13/20 => Loss 0.735, Train_accy 81.96:  65%|██████▌   | 13/20 [04:44<02:32, 21.83s/it]Task 4, Epoch 14/20 => Loss 0.751, Train_accy 82.01:  65%|██████▌   | 13/20 [05:06<02:32, 21.83s/it]Task 4, Epoch 14/20 => Loss 0.751, Train_accy 82.01:  70%|███████   | 14/20 [05:06<02:11, 21.83s/it]Task 4, Epoch 15/20 => Loss 0.730, Train_accy 82.15:  70%|███████   | 14/20 [05:28<02:11, 21.83s/it]Task 4, Epoch 15/20 => Loss 0.730, Train_accy 82.15:  75%|███████▌  | 15/20 [05:28<01:49, 21.90s/it]Task 4, Epoch 16/20 => Loss 0.724, Train_accy 82.39:  75%|███████▌  | 15/20 [05:50<01:49, 21.90s/it]Task 4, Epoch 16/20 => Loss 0.724, Train_accy 82.39:  80%|████████  | 16/20 [05:50<01:27, 21.87s/it]Task 4, Epoch 17/20 => Loss 0.711, Train_accy 82.95:  80%|████████  | 16/20 [06:12<01:27, 21.87s/it]Task 4, Epoch 17/20 => Loss 0.711, Train_accy 82.95:  85%|████████▌ | 17/20 [06:12<01:05, 21.86s/it]Task 4, Epoch 18/20 => Loss 0.695, Train_accy 83.31:  85%|████████▌ | 17/20 [06:34<01:05, 21.86s/it]Task 4, Epoch 18/20 => Loss 0.695, Train_accy 83.31:  90%|█████████ | 18/20 [06:34<00:43, 21.88s/it]Task 4, Epoch 19/20 => Loss 0.709, Train_accy 83.05:  90%|█████████ | 18/20 [06:56<00:43, 21.88s/it]Task 4, Epoch 19/20 => Loss 0.709, Train_accy 83.05:  95%|█████████▌| 19/20 [06:56<00:21, 21.86s/it]Task 4, Epoch 20/20 => Loss 0.697, Train_accy 82.88:  95%|█████████▌| 19/20 [07:18<00:21, 21.86s/it]Task 4, Epoch 20/20 => Loss 0.697, Train_accy 82.88: 100%|██████████| 20/20 [07:18<00:00, 21.85s/it]Task 4, Epoch 20/20 => Loss 0.697, Train_accy 82.88: 100%|██████████| 20/20 [07:18<00:00, 21.90s/it]
2024-04-19 03:36:24,763 [ease.py] => Task 4, Epoch 20/20 => Loss 0.697, Train_accy 82.88
2024-04-19 03:38:41,256 [ease.py] => Task correct: 81.63333333333334
2024-04-19 03:38:41,257 [ease.py] => Task acc: 88.23333333333333
2024-04-19 03:38:41,460 [trainer.py] => No NME accuracy.
2024-04-19 03:38:41,460 [trainer.py] => CNN: {'total': 77.68, '00-39': 77.29, '40-79': 75.45, '80-119': 78.2, '120-159': 78.66, '160-199': 78.9, 'old': 77.42, 'new': 78.9}
2024-04-19 03:38:41,460 [trainer.py] => CNN top1 curve: [88.27, 83.51, 80.85, 79.53, 77.68]
2024-04-19 03:38:41,460 [trainer.py] => CNN top5 curve: [96.82, 95.28, 93.64, 92.58, 91.37]

Average Accuracy (CNN): 81.96799999999999
2024-04-19 03:38:41,460 [trainer.py] => Average Accuracy (CNN): 81.96799999999999 

2024-04-19 03:38:41,460 [trainer.py] => Train Time: 4985.670000000001
2024-04-19 03:38:41,461 [trainer.py] => Test Time: 170.06 

Accuracy Matrix (CNN):
[[88.27 83.5  80.24 78.35 77.29]
 [ 0.   83.52 79.1  78.42 75.45]
 [ 0.    0.   83.35 80.91 78.2 ]
 [ 0.    0.    0.   80.51 78.66]
 [ 0.    0.    0.    0.   78.9 ]]
2024-04-19 03:38:41,461 [trainer.py] => Forgetting (CNN): 6.512499999999996
