nohup: 忽略输入
2023-11-14 21:53:18,953 [trainer.py] => config: ./exps/coda_prompt.json
2023-11-14 21:53:18,954 [trainer.py] => prefix:  
2023-11-14 21:53:18,954 [trainer.py] => dataset: imagenetr
2023-11-14 21:53:18,954 [trainer.py] => memory_size: 0
2023-11-14 21:53:18,954 [trainer.py] => memory_per_class: 0
2023-11-14 21:53:18,954 [trainer.py] => fixed_memory: False
2023-11-14 21:53:18,954 [trainer.py] => shuffle: False
2023-11-14 21:53:18,954 [trainer.py] => init_cls: 40
2023-11-14 21:53:18,954 [trainer.py] => increment: 40
2023-11-14 21:53:18,954 [trainer.py] => model_name: coda_prompt
2023-11-14 21:53:18,954 [trainer.py] => backbone_type: vit_base_patch16_224_coda_prompt
2023-11-14 21:53:18,954 [trainer.py] => device: [device(type='cuda', index=2)]
2023-11-14 21:53:18,954 [trainer.py] => seed: 0
2023-11-14 21:53:18,954 [trainer.py] => tuned_epoch: 20
2023-11-14 21:53:18,954 [trainer.py] => init_lr: 0.001
2023-11-14 21:53:18,954 [trainer.py] => batch_size: 128
2023-11-14 21:53:18,954 [trainer.py] => weight_decay: 0
2023-11-14 21:53:18,954 [trainer.py] => min_lr: 1e-05
2023-11-14 21:53:18,954 [trainer.py] => optimizer: adam
2023-11-14 21:53:18,954 [trainer.py] => scheduler: cosine
2023-11-14 21:53:18,954 [trainer.py] => reinit_optimizer: True
2023-11-14 21:53:18,954 [trainer.py] => pretrained: True
2023-11-14 21:53:18,954 [trainer.py] => drop: 0.0
2023-11-14 21:53:18,954 [trainer.py] => drop_path: 0.0
2023-11-14 21:53:18,954 [trainer.py] => prompt_param: [100, 8.0, 0.0]
2023-11-14 21:53:19,086 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199]
2023-11-14 21:53:21,006 [coda_prompt.py] => 89,792,456 total parameters.
2023-11-14 21:53:21,006 [coda_prompt.py] => 3,993,800 fc and prompt training parameters.
2023-11-14 21:53:21,007 [trainer.py] => All params: 89792456
2023-11-14 21:53:21,007 [trainer.py] => Trainable params: 89792456
2023-11-14 21:53:21,007 [coda_prompt.py] => Learning on 0-40
/home/team/zhaohongwei/anaconda3/envs/l2p/lib/python3.8/site-packages/torchvision/transforms/transforms.py:332: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  warnings.warn(
  0%|          | 0/20 [00:00<?, ?it/s]Task 0, Epoch 1/20 => Loss 2.241, Train_accy 46.30:   0%|          | 0/20 [01:00<?, ?it/s]Task 0, Epoch 1/20 => Loss 2.241, Train_accy 46.30:   5%|▌         | 1/20 [01:00<19:18, 60.99s/it]Task 0, Epoch 2/20 => Loss 1.080, Train_accy 71.41:   5%|▌         | 1/20 [02:00<19:18, 60.99s/it]Task 0, Epoch 2/20 => Loss 1.080, Train_accy 71.41:  10%|█         | 2/20 [02:00<18:00, 60.01s/it]Task 0, Epoch 3/20 => Loss 0.858, Train_accy 76.77:  10%|█         | 2/20 [03:00<18:00, 60.01s/it]Task 0, Epoch 3/20 => Loss 0.858, Train_accy 76.77:  15%|█▌        | 3/20 [03:00<16:59, 59.99s/it]Task 0, Epoch 4/20 => Loss 0.753, Train_accy 79.39:  15%|█▌        | 3/20 [04:00<16:59, 59.99s/it]Task 0, Epoch 4/20 => Loss 0.753, Train_accy 79.39:  20%|██        | 4/20 [04:00<16:00, 60.02s/it]Task 0, Epoch 5/20 => Loss 0.667, Train_accy 81.64, Test_accy 83.89:  20%|██        | 4/20 [05:09<16:00, 60.02s/it]Task 0, Epoch 5/20 => Loss 0.667, Train_accy 81.64, Test_accy 83.89:  25%|██▌       | 5/20 [05:09<15:49, 63.30s/it]Task 0, Epoch 6/20 => Loss 0.593, Train_accy 84.00:  25%|██▌       | 5/20 [06:09<15:49, 63.30s/it]                 Task 0, Epoch 6/20 => Loss 0.593, Train_accy 84.00:  30%|███       | 6/20 [06:09<14:31, 62.28s/it]Task 0, Epoch 7/20 => Loss 0.537, Train_accy 84.69:  30%|███       | 6/20 [07:10<14:31, 62.28s/it]Task 0, Epoch 7/20 => Loss 0.537, Train_accy 84.69:  35%|███▌      | 7/20 [07:10<13:21, 61.62s/it]Task 0, Epoch 8/20 => Loss 0.530, Train_accy 85.64:  35%|███▌      | 7/20 [08:10<13:21, 61.62s/it]Task 0, Epoch 8/20 => Loss 0.530, Train_accy 85.64:  40%|████      | 8/20 [08:10<12:14, 61.20s/it]Task 0, Epoch 9/20 => Loss 0.477, Train_accy 86.83:  40%|████      | 8/20 [09:10<12:14, 61.20s/it]Task 0, Epoch 9/20 => Loss 0.477, Train_accy 86.83:  45%|████▌     | 9/20 [09:10<11:10, 60.94s/it]Task 0, Epoch 10/20 => Loss 0.452, Train_accy 87.44, Test_accy 84.41:  45%|████▌     | 9/20 [10:19<11:10, 60.94s/it]Task 0, Epoch 10/20 => Loss 0.452, Train_accy 87.44, Test_accy 84.41:  50%|█████     | 10/20 [10:19<10:35, 63.52s/it]Task 0, Epoch 11/20 => Loss 0.469, Train_accy 87.28:  50%|█████     | 10/20 [11:20<10:35, 63.52s/it]                 Task 0, Epoch 11/20 => Loss 0.469, Train_accy 87.28:  55%|█████▌    | 11/20 [11:20<09:22, 62.52s/it]Task 0, Epoch 12/20 => Loss 0.441, Train_accy 88.08:  55%|█████▌    | 11/20 [12:20<09:22, 62.52s/it]Task 0, Epoch 12/20 => Loss 0.441, Train_accy 88.08:  60%|██████    | 12/20 [12:20<08:14, 61.87s/it]Task 0, Epoch 13/20 => Loss 0.431, Train_accy 88.34:  60%|██████    | 12/20 [13:20<08:14, 61.87s/it]Task 0, Epoch 13/20 => Loss 0.431, Train_accy 88.34:  65%|██████▌   | 13/20 [13:20<07:09, 61.39s/it]Task 0, Epoch 14/20 => Loss 0.374, Train_accy 89.47:  65%|██████▌   | 13/20 [14:21<07:09, 61.39s/it]Task 0, Epoch 14/20 => Loss 0.374, Train_accy 89.47:  70%|███████   | 14/20 [14:21<06:06, 61.08s/it]Task 0, Epoch 15/20 => Loss 0.381, Train_accy 89.94, Test_accy 85.00:  70%|███████   | 14/20 [15:30<06:06, 61.08s/it]Task 0, Epoch 15/20 => Loss 0.381, Train_accy 89.94, Test_accy 85.00:  75%|███████▌  | 15/20 [15:30<05:17, 63.52s/it]Task 0, Epoch 16/20 => Loss 0.404, Train_accy 88.90:  75%|███████▌  | 15/20 [16:30<05:17, 63.52s/it]                 Task 0, Epoch 16/20 => Loss 0.404, Train_accy 88.90:  80%|████████  | 16/20 [16:30<04:10, 62.55s/it]Task 0, Epoch 17/20 => Loss 0.371, Train_accy 89.71:  80%|████████  | 16/20 [17:31<04:10, 62.55s/it]Task 0, Epoch 17/20 => Loss 0.371, Train_accy 89.71:  85%|████████▌ | 17/20 [17:31<03:05, 61.93s/it]Task 0, Epoch 18/20 => Loss 0.368, Train_accy 90.10:  85%|████████▌ | 17/20 [18:31<03:05, 61.93s/it]Task 0, Epoch 18/20 => Loss 0.368, Train_accy 90.10:  90%|█████████ | 18/20 [18:31<02:02, 61.47s/it]Task 0, Epoch 19/20 => Loss 0.348, Train_accy 90.59:  90%|█████████ | 18/20 [19:32<02:02, 61.47s/it]Task 0, Epoch 19/20 => Loss 0.348, Train_accy 90.59:  95%|█████████▌| 19/20 [19:32<01:01, 61.16s/it]Task 0, Epoch 20/20 => Loss 0.340, Train_accy 91.15, Test_accy 85.44:  95%|█████████▌| 19/20 [20:41<01:01, 61.16s/it]Task 0, Epoch 20/20 => Loss 0.340, Train_accy 91.15, Test_accy 85.44: 100%|██████████| 20/20 [20:41<00:00, 63.59s/it]Task 0, Epoch 20/20 => Loss 0.340, Train_accy 91.15, Test_accy 85.44: 100%|██████████| 20/20 [20:41<00:00, 62.07s/it]2023-11-14 22:14:04,037 [coda_prompt.py] => Task 0, Epoch 20/20 => Loss 0.340, Train_accy 91.15, Test_accy 85.44

2023-11-14 22:14:12,819 [trainer.py] => No NME accuracy.
2023-11-14 22:14:12,820 [trainer.py] => CNN: {'total': 85.44, '00-39': 85.44, 'old': 0, 'new': 85.44}
2023-11-14 22:14:12,820 [trainer.py] => CNN top1 curve: [85.44]
2023-11-14 22:14:12,820 [trainer.py] => CNN top5 curve: [95.57]

Average Accuracy (CNN): 85.44
2023-11-14 22:14:12,820 [trainer.py] => Average Accuracy (CNN): 85.44 

2023-11-14 22:14:12,821 [trainer.py] => All params: 89792456
2023-11-14 22:14:12,822 [trainer.py] => Trainable params: 89792456
2023-11-14 22:14:13,869 [coda_prompt.py] => Learning on 40-80
  0%|          | 0/20 [00:00<?, ?it/s]Task 1, Epoch 1/20 => Loss 2.049, Train_accy 49.58:   0%|          | 0/20 [00:46<?, ?it/s]Task 1, Epoch 1/20 => Loss 2.049, Train_accy 49.58:   5%|▌         | 1/20 [00:46<14:40, 46.36s/it]Task 1, Epoch 2/20 => Loss 0.958, Train_accy 73.93:   5%|▌         | 1/20 [01:32<14:40, 46.36s/it]Task 1, Epoch 2/20 => Loss 0.958, Train_accy 73.93:  10%|█         | 2/20 [01:32<13:55, 46.41s/it]Task 1, Epoch 3/20 => Loss 0.739, Train_accy 78.76:  10%|█         | 2/20 [02:19<13:55, 46.41s/it]Task 1, Epoch 3/20 => Loss 0.739, Train_accy 78.76:  15%|█▌        | 3/20 [02:19<13:08, 46.38s/it]Task 1, Epoch 4/20 => Loss 0.663, Train_accy 80.54:  15%|█▌        | 3/20 [03:05<13:08, 46.38s/it]Task 1, Epoch 4/20 => Loss 0.663, Train_accy 80.54:  20%|██        | 4/20 [03:05<12:21, 46.36s/it]Task 1, Epoch 5/20 => Loss 0.588, Train_accy 82.81, Test_accy 81.05:  20%|██        | 4/20 [04:06<12:21, 46.36s/it]Task 1, Epoch 5/20 => Loss 0.588, Train_accy 82.81, Test_accy 81.05:  25%|██▌       | 5/20 [04:06<12:52, 51.53s/it]Task 1, Epoch 6/20 => Loss 0.536, Train_accy 84.86:  25%|██▌       | 5/20 [04:52<12:52, 51.53s/it]                 Task 1, Epoch 6/20 => Loss 0.536, Train_accy 84.86:  30%|███       | 6/20 [04:52<11:37, 49.79s/it]Task 1, Epoch 7/20 => Loss 0.491, Train_accy 85.72:  30%|███       | 6/20 [05:38<11:37, 49.79s/it]Task 1, Epoch 7/20 => Loss 0.491, Train_accy 85.72:  35%|███▌      | 7/20 [05:38<10:32, 48.66s/it]Task 1, Epoch 8/20 => Loss 0.471, Train_accy 86.30:  35%|███▌      | 7/20 [06:25<10:32, 48.66s/it]Task 1, Epoch 8/20 => Loss 0.471, Train_accy 86.30:  40%|████      | 8/20 [06:25<09:34, 47.90s/it]Task 1, Epoch 9/20 => Loss 0.475, Train_accy 86.96:  40%|████      | 8/20 [07:11<09:34, 47.90s/it]Task 1, Epoch 9/20 => Loss 0.475, Train_accy 86.96:  45%|████▌     | 9/20 [07:11<08:41, 47.40s/it]Task 1, Epoch 10/20 => Loss 0.419, Train_accy 87.38, Test_accy 81.57:  45%|████▌     | 9/20 [08:12<08:41, 47.40s/it]Task 1, Epoch 10/20 => Loss 0.419, Train_accy 87.38, Test_accy 81.57:  50%|█████     | 10/20 [08:12<08:35, 51.50s/it]Task 1, Epoch 11/20 => Loss 0.398, Train_accy 88.62:  50%|█████     | 10/20 [08:58<08:35, 51.50s/it]                 Task 1, Epoch 11/20 => Loss 0.398, Train_accy 88.62:  55%|█████▌    | 11/20 [08:58<07:29, 49.91s/it]Task 1, Epoch 12/20 => Loss 0.398, Train_accy 89.01:  55%|█████▌    | 11/20 [09:44<07:29, 49.91s/it]Task 1, Epoch 12/20 => Loss 0.398, Train_accy 89.01:  60%|██████    | 12/20 [09:44<06:30, 48.83s/it]Task 1, Epoch 13/20 => Loss 0.352, Train_accy 90.26:  60%|██████    | 12/20 [10:31<06:30, 48.83s/it]Task 1, Epoch 13/20 => Loss 0.352, Train_accy 90.26:  65%|██████▌   | 13/20 [10:31<05:36, 48.09s/it]Task 1, Epoch 14/20 => Loss 0.354, Train_accy 90.38:  65%|██████▌   | 13/20 [11:17<05:36, 48.09s/it]Task 1, Epoch 14/20 => Loss 0.354, Train_accy 90.38:  70%|███████   | 14/20 [11:17<04:45, 47.56s/it]Task 1, Epoch 15/20 => Loss 0.348, Train_accy 90.45, Test_accy 81.86:  70%|███████   | 14/20 [12:18<04:45, 47.56s/it]Task 1, Epoch 15/20 => Loss 0.348, Train_accy 90.45, Test_accy 81.86:  75%|███████▌  | 15/20 [12:18<04:17, 51.51s/it]Task 1, Epoch 16/20 => Loss 0.357, Train_accy 90.48:  75%|███████▌  | 15/20 [13:04<04:17, 51.51s/it]                 Task 1, Epoch 16/20 => Loss 0.357, Train_accy 90.48:  80%|████████  | 16/20 [13:04<03:19, 49.98s/it]Task 1, Epoch 17/20 => Loss 0.340, Train_accy 90.82:  80%|████████  | 16/20 [13:51<03:19, 49.98s/it]Task 1, Epoch 17/20 => Loss 0.340, Train_accy 90.82:  85%|████████▌ | 17/20 [13:51<02:26, 48.93s/it]Task 1, Epoch 18/20 => Loss 0.306, Train_accy 91.72:  85%|████████▌ | 17/20 [14:37<02:26, 48.93s/it]Task 1, Epoch 18/20 => Loss 0.306, Train_accy 91.72:  90%|█████████ | 18/20 [14:37<01:36, 48.16s/it]Task 1, Epoch 19/20 => Loss 0.327, Train_accy 90.26:  90%|█████████ | 18/20 [15:23<01:36, 48.16s/it]Task 1, Epoch 19/20 => Loss 0.327, Train_accy 90.26:  95%|█████████▌| 19/20 [15:23<00:47, 47.63s/it]Task 1, Epoch 20/20 => Loss 0.296, Train_accy 91.89, Test_accy 81.86:  95%|█████████▌| 19/20 [16:24<00:47, 47.63s/it]Task 1, Epoch 20/20 => Loss 0.296, Train_accy 91.89, Test_accy 81.86: 100%|██████████| 20/20 [16:24<00:00, 51.54s/it]Task 1, Epoch 20/20 => Loss 0.296, Train_accy 91.89, Test_accy 81.86: 100%|██████████| 20/20 [16:24<00:00, 49.23s/it]2023-11-14 22:30:38,423 [coda_prompt.py] => Task 1, Epoch 20/20 => Loss 0.296, Train_accy 91.89, Test_accy 81.86

2023-11-14 22:30:52,709 [trainer.py] => No NME accuracy.
2023-11-14 22:30:52,710 [trainer.py] => CNN: {'total': 81.86, '00-39': 83.15, '40-79': 80.1, 'old': 83.15, 'new': 80.1}
2023-11-14 22:30:52,710 [trainer.py] => CNN top1 curve: [85.44, 81.86]
2023-11-14 22:30:52,710 [trainer.py] => CNN top5 curve: [95.57, 94.91]

Average Accuracy (CNN): 83.65
2023-11-14 22:30:52,710 [trainer.py] => Average Accuracy (CNN): 83.65 

2023-11-14 22:30:52,711 [trainer.py] => All params: 89792456
2023-11-14 22:30:52,713 [trainer.py] => Trainable params: 89792456
2023-11-14 22:30:54,437 [coda_prompt.py] => Learning on 80-120
  0%|          | 0/20 [00:00<?, ?it/s]Task 2, Epoch 1/20 => Loss 1.923, Train_accy 53.21:   0%|          | 0/20 [00:56<?, ?it/s]Task 2, Epoch 1/20 => Loss 1.923, Train_accy 53.21:   5%|▌         | 1/20 [00:56<17:47, 56.19s/it]Task 2, Epoch 2/20 => Loss 0.900, Train_accy 76.08:   5%|▌         | 1/20 [01:52<17:47, 56.19s/it]Task 2, Epoch 2/20 => Loss 0.900, Train_accy 76.08:  10%|█         | 2/20 [01:52<16:53, 56.33s/it]Task 2, Epoch 3/20 => Loss 0.756, Train_accy 79.41:  10%|█         | 2/20 [02:49<16:53, 56.33s/it]Task 2, Epoch 3/20 => Loss 0.756, Train_accy 79.41:  15%|█▌        | 3/20 [02:49<15:58, 56.38s/it]Task 2, Epoch 4/20 => Loss 0.671, Train_accy 81.91:  15%|█▌        | 3/20 [03:45<15:58, 56.38s/it]Task 2, Epoch 4/20 => Loss 0.671, Train_accy 81.91:  20%|██        | 4/20 [03:45<15:01, 56.35s/it]Task 2, Epoch 5/20 => Loss 0.555, Train_accy 84.64, Test_accy 78.73:  20%|██        | 4/20 [05:03<15:01, 56.35s/it]Task 2, Epoch 5/20 => Loss 0.555, Train_accy 84.64, Test_accy 78.73:  25%|██▌       | 5/20 [05:03<16:01, 64.11s/it]Task 2, Epoch 6/20 => Loss 0.537, Train_accy 85.24:  25%|██▌       | 5/20 [05:59<16:01, 64.11s/it]                 Task 2, Epoch 6/20 => Loss 0.537, Train_accy 85.24:  30%|███       | 6/20 [05:59<14:20, 61.46s/it]Task 2, Epoch 7/20 => Loss 0.511, Train_accy 85.98:  30%|███       | 6/20 [06:55<14:20, 61.46s/it]Task 2, Epoch 7/20 => Loss 0.511, Train_accy 85.98:  35%|███▌      | 7/20 [06:55<12:57, 59.80s/it]Task 2, Epoch 8/20 => Loss 0.463, Train_accy 87.34:  35%|███▌      | 7/20 [07:52<12:57, 59.80s/it]Task 2, Epoch 8/20 => Loss 0.463, Train_accy 87.34:  40%|████      | 8/20 [07:52<11:44, 58.71s/it]Task 2, Epoch 9/20 => Loss 0.447, Train_accy 87.60:  40%|████      | 8/20 [08:48<11:44, 58.71s/it]Task 2, Epoch 9/20 => Loss 0.447, Train_accy 87.60:  45%|████▌     | 9/20 [08:48<10:37, 57.93s/it]Task 2, Epoch 10/20 => Loss 0.419, Train_accy 89.00, Test_accy 79.42:  45%|████▌     | 9/20 [10:06<10:37, 57.93s/it]Task 2, Epoch 10/20 => Loss 0.419, Train_accy 89.00, Test_accy 79.42:  50%|█████     | 10/20 [10:06<10:40, 64.05s/it]Task 2, Epoch 11/20 => Loss 0.429, Train_accy 88.76:  50%|█████     | 10/20 [11:02<10:40, 64.05s/it]                 Task 2, Epoch 11/20 => Loss 0.429, Train_accy 88.76:  55%|█████▌    | 11/20 [11:02<09:15, 61.70s/it]Task 2, Epoch 12/20 => Loss 0.377, Train_accy 89.76:  55%|█████▌    | 11/20 [11:58<09:15, 61.70s/it]Task 2, Epoch 12/20 => Loss 0.377, Train_accy 89.76:  60%|██████    | 12/20 [11:58<08:00, 60.05s/it]Task 2, Epoch 13/20 => Loss 0.387, Train_accy 89.70:  60%|██████    | 12/20 [12:55<08:00, 60.05s/it]Task 2, Epoch 13/20 => Loss 0.387, Train_accy 89.70:  65%|██████▌   | 13/20 [12:55<06:52, 58.96s/it]Task 2, Epoch 14/20 => Loss 0.347, Train_accy 90.44:  65%|██████▌   | 13/20 [13:51<06:52, 58.96s/it]Task 2, Epoch 14/20 => Loss 0.347, Train_accy 90.44:  70%|███████   | 14/20 [13:51<05:48, 58.14s/it]Task 2, Epoch 15/20 => Loss 0.371, Train_accy 89.84, Test_accy 79.62:  70%|███████   | 14/20 [15:09<05:48, 58.14s/it]Task 2, Epoch 15/20 => Loss 0.371, Train_accy 89.84, Test_accy 79.62:  75%|███████▌  | 15/20 [15:09<05:20, 64.08s/it]Task 2, Epoch 16/20 => Loss 0.324, Train_accy 91.29:  75%|███████▌  | 15/20 [16:05<05:20, 64.08s/it]                 Task 2, Epoch 16/20 => Loss 0.324, Train_accy 91.29:  80%|████████  | 16/20 [16:05<04:06, 61.75s/it]Task 2, Epoch 17/20 => Loss 0.340, Train_accy 91.07:  80%|████████  | 16/20 [17:02<04:06, 61.75s/it]Task 2, Epoch 17/20 => Loss 0.340, Train_accy 91.07:  85%|████████▌ | 17/20 [17:02<03:00, 60.13s/it]Task 2, Epoch 18/20 => Loss 0.307, Train_accy 91.71:  85%|████████▌ | 17/20 [17:58<03:00, 60.13s/it]Task 2, Epoch 18/20 => Loss 0.307, Train_accy 91.71:  90%|█████████ | 18/20 [17:58<01:57, 58.99s/it]Task 2, Epoch 19/20 => Loss 0.318, Train_accy 91.75:  90%|█████████ | 18/20 [18:54<01:57, 58.99s/it]Task 2, Epoch 19/20 => Loss 0.318, Train_accy 91.75:  95%|█████████▌| 19/20 [18:54<00:58, 58.21s/it]Task 2, Epoch 20/20 => Loss 0.305, Train_accy 91.89, Test_accy 79.67:  95%|█████████▌| 19/20 [20:12<00:58, 58.21s/it]Task 2, Epoch 20/20 => Loss 0.305, Train_accy 91.89, Test_accy 79.67: 100%|██████████| 20/20 [20:12<00:00, 64.07s/it]Task 2, Epoch 20/20 => Loss 0.305, Train_accy 91.89, Test_accy 79.67: 100%|██████████| 20/20 [20:12<00:00, 60.63s/it]2023-11-14 22:51:07,075 [coda_prompt.py] => Task 2, Epoch 20/20 => Loss 0.305, Train_accy 91.89, Test_accy 79.67

2023-11-14 22:51:28,564 [trainer.py] => No NME accuracy.
2023-11-14 22:51:28,564 [trainer.py] => CNN: {'total': 79.67, '00-39': 81.82, '40-79': 79.7, '80-119': 77.39, 'old': 80.92, 'new': 77.39}
2023-11-14 22:51:28,565 [trainer.py] => CNN top1 curve: [85.44, 81.86, 79.67]
2023-11-14 22:51:28,565 [trainer.py] => CNN top5 curve: [95.57, 94.91, 92.64]

Average Accuracy (CNN): 82.32333333333334
2023-11-14 22:51:28,565 [trainer.py] => Average Accuracy (CNN): 82.32333333333334 

2023-11-14 22:51:28,566 [trainer.py] => All params: 89792456
2023-11-14 22:51:28,567 [trainer.py] => Trainable params: 89792456
2023-11-14 22:51:31,034 [coda_prompt.py] => Learning on 120-160
  0%|          | 0/20 [00:00<?, ?it/s]Task 3, Epoch 1/20 => Loss 2.253, Train_accy 46.75:   0%|          | 0/20 [00:44<?, ?it/s]Task 3, Epoch 1/20 => Loss 2.253, Train_accy 46.75:   5%|▌         | 1/20 [00:44<14:13, 44.91s/it]Task 3, Epoch 2/20 => Loss 1.058, Train_accy 72.81:   5%|▌         | 1/20 [01:29<14:13, 44.91s/it]Task 3, Epoch 2/20 => Loss 1.058, Train_accy 72.81:  10%|█         | 2/20 [01:29<13:28, 44.93s/it]Task 3, Epoch 3/20 => Loss 0.900, Train_accy 75.58:  10%|█         | 2/20 [02:14<13:28, 44.93s/it]Task 3, Epoch 3/20 => Loss 0.900, Train_accy 75.58:  15%|█▌        | 3/20 [02:14<12:44, 44.97s/it]Task 3, Epoch 4/20 => Loss 0.778, Train_accy 78.93:  15%|█▌        | 3/20 [02:59<12:44, 44.97s/it]Task 3, Epoch 4/20 => Loss 0.778, Train_accy 78.93:  20%|██        | 4/20 [02:59<11:59, 44.99s/it]Task 3, Epoch 5/20 => Loss 0.706, Train_accy 81.15, Test_accy 76.98:  20%|██        | 4/20 [04:12<11:59, 44.99s/it]Task 3, Epoch 5/20 => Loss 0.706, Train_accy 81.15, Test_accy 76.98:  25%|██▌       | 5/20 [04:12<13:44, 54.98s/it]Task 3, Epoch 6/20 => Loss 0.638, Train_accy 82.21:  25%|██▌       | 5/20 [04:57<13:44, 54.98s/it]                 Task 3, Epoch 6/20 => Loss 0.638, Train_accy 82.21:  30%|███       | 6/20 [04:57<12:02, 51.60s/it]Task 3, Epoch 7/20 => Loss 0.605, Train_accy 83.29:  30%|███       | 6/20 [05:42<12:02, 51.60s/it]Task 3, Epoch 7/20 => Loss 0.605, Train_accy 83.29:  35%|███▌      | 7/20 [05:42<10:42, 49.44s/it]Task 3, Epoch 8/20 => Loss 0.605, Train_accy 83.32:  35%|███▌      | 7/20 [06:27<10:42, 49.44s/it]Task 3, Epoch 8/20 => Loss 0.605, Train_accy 83.32:  40%|████      | 8/20 [06:27<09:37, 48.08s/it]Task 3, Epoch 9/20 => Loss 0.523, Train_accy 85.31:  40%|████      | 8/20 [07:12<09:37, 48.08s/it]Task 3, Epoch 9/20 => Loss 0.523, Train_accy 85.31:  45%|████▌     | 9/20 [07:12<08:38, 47.12s/it]Task 3, Epoch 10/20 => Loss 0.528, Train_accy 85.51, Test_accy 77.19:  45%|████▌     | 9/20 [08:25<08:38, 47.12s/it]Task 3, Epoch 10/20 => Loss 0.528, Train_accy 85.51, Test_accy 77.19:  50%|█████     | 10/20 [08:25<09:11, 55.10s/it]Task 3, Epoch 11/20 => Loss 0.484, Train_accy 86.84:  50%|█████     | 10/20 [09:10<09:11, 55.10s/it]                 Task 3, Epoch 11/20 => Loss 0.484, Train_accy 86.84:  55%|█████▌    | 11/20 [09:10<07:48, 52.04s/it]Task 3, Epoch 12/20 => Loss 0.478, Train_accy 86.27:  55%|█████▌    | 11/20 [09:55<07:48, 52.04s/it]Task 3, Epoch 12/20 => Loss 0.478, Train_accy 86.27:  60%|██████    | 12/20 [09:55<06:39, 49.91s/it]Task 3, Epoch 13/20 => Loss 0.449, Train_accy 87.25:  60%|██████    | 12/20 [10:41<06:39, 49.91s/it]Task 3, Epoch 13/20 => Loss 0.449, Train_accy 87.25:  65%|██████▌   | 13/20 [10:41<05:39, 48.45s/it]Task 3, Epoch 14/20 => Loss 0.437, Train_accy 88.10:  65%|██████▌   | 13/20 [11:26<05:39, 48.45s/it]Task 3, Epoch 14/20 => Loss 0.437, Train_accy 88.10:  70%|███████   | 14/20 [11:26<04:44, 47.50s/it]Task 3, Epoch 15/20 => Loss 0.403, Train_accy 88.84, Test_accy 77.04:  70%|███████   | 14/20 [12:38<04:44, 47.50s/it]Task 3, Epoch 15/20 => Loss 0.403, Train_accy 88.84, Test_accy 77.04:  75%|███████▌  | 15/20 [12:38<04:35, 55.05s/it]Task 3, Epoch 16/20 => Loss 0.411, Train_accy 88.48:  75%|███████▌  | 15/20 [13:23<04:35, 55.05s/it]                 Task 3, Epoch 16/20 => Loss 0.411, Train_accy 88.48:  80%|████████  | 16/20 [13:23<03:28, 52.05s/it]Task 3, Epoch 17/20 => Loss 0.421, Train_accy 88.56:  80%|████████  | 16/20 [14:08<03:28, 52.05s/it]Task 3, Epoch 17/20 => Loss 0.421, Train_accy 88.56:  85%|████████▌ | 17/20 [14:08<02:29, 49.90s/it]Task 3, Epoch 18/20 => Loss 0.401, Train_accy 89.11:  85%|████████▌ | 17/20 [14:53<02:29, 49.90s/it]Task 3, Epoch 18/20 => Loss 0.401, Train_accy 89.11:  90%|█████████ | 18/20 [14:53<01:36, 48.47s/it]Task 3, Epoch 19/20 => Loss 0.373, Train_accy 89.67:  90%|█████████ | 18/20 [15:38<01:36, 48.47s/it]Task 3, Epoch 19/20 => Loss 0.373, Train_accy 89.67:  95%|█████████▌| 19/20 [15:38<00:47, 47.43s/it]Task 3, Epoch 20/20 => Loss 0.401, Train_accy 89.26, Test_accy 77.06:  95%|█████████▌| 19/20 [16:51<00:47, 47.43s/it]Task 3, Epoch 20/20 => Loss 0.401, Train_accy 89.26, Test_accy 77.06: 100%|██████████| 20/20 [16:51<00:00, 54.99s/it]Task 3, Epoch 20/20 => Loss 0.401, Train_accy 89.26, Test_accy 77.06: 100%|██████████| 20/20 [16:51<00:00, 50.58s/it]2023-11-14 23:08:22,624 [coda_prompt.py] => Task 3, Epoch 20/20 => Loss 0.401, Train_accy 89.26, Test_accy 77.06

2023-11-14 23:08:50,153 [trainer.py] => No NME accuracy.
2023-11-14 23:08:50,154 [trainer.py] => CNN: {'total': 77.06, '00-39': 81.3, '40-79': 78.38, '80-119': 76.68, '120-159': 70.99, 'old': 78.87, 'new': 70.99}
2023-11-14 23:08:50,154 [trainer.py] => CNN top1 curve: [85.44, 81.86, 79.67, 77.06]
2023-11-14 23:08:50,154 [trainer.py] => CNN top5 curve: [95.57, 94.91, 92.64, 90.33]

Average Accuracy (CNN): 81.00750000000001
2023-11-14 23:08:50,154 [trainer.py] => Average Accuracy (CNN): 81.00750000000001 

2023-11-14 23:08:50,155 [trainer.py] => All params: 89792456
2023-11-14 23:08:50,156 [trainer.py] => Trainable params: 89792456
2023-11-14 23:08:53,290 [coda_prompt.py] => Learning on 160-200
  0%|          | 0/20 [00:00<?, ?it/s]Task 4, Epoch 1/20 => Loss 1.800, Train_accy 56.54:   0%|          | 0/20 [00:59<?, ?it/s]Task 4, Epoch 1/20 => Loss 1.800, Train_accy 56.54:   5%|▌         | 1/20 [00:59<18:42, 59.06s/it]Task 4, Epoch 2/20 => Loss 0.812, Train_accy 78.87:   5%|▌         | 1/20 [01:58<18:42, 59.06s/it]Task 4, Epoch 2/20 => Loss 0.812, Train_accy 78.87:  10%|█         | 2/20 [01:58<17:44, 59.11s/it]Task 4, Epoch 3/20 => Loss 0.627, Train_accy 83.10:  10%|█         | 2/20 [02:57<17:44, 59.11s/it]Task 4, Epoch 3/20 => Loss 0.627, Train_accy 83.10:  15%|█▌        | 3/20 [02:57<16:47, 59.28s/it]Task 4, Epoch 4/20 => Loss 0.555, Train_accy 84.91:  15%|█▌        | 3/20 [03:56<16:47, 59.28s/it]Task 4, Epoch 4/20 => Loss 0.555, Train_accy 84.91:  20%|██        | 4/20 [03:56<15:48, 59.29s/it]Task 4, Epoch 5/20 => Loss 0.511, Train_accy 86.09, Test_accy 76.25:  20%|██        | 4/20 [05:31<15:48, 59.29s/it]Task 4, Epoch 5/20 => Loss 0.511, Train_accy 86.09, Test_accy 76.25:  25%|██▌       | 5/20 [05:31<17:58, 71.88s/it]Task 4, Epoch 6/20 => Loss 0.440, Train_accy 88.09:  25%|██▌       | 5/20 [06:30<17:58, 71.88s/it]                 Task 4, Epoch 6/20 => Loss 0.440, Train_accy 88.09:  30%|███       | 6/20 [06:30<15:46, 67.58s/it]Task 4, Epoch 7/20 => Loss 0.435, Train_accy 88.53:  30%|███       | 6/20 [07:29<15:46, 67.58s/it]Task 4, Epoch 7/20 => Loss 0.435, Train_accy 88.53:  35%|███▌      | 7/20 [07:29<14:01, 64.75s/it]Task 4, Epoch 8/20 => Loss 0.392, Train_accy 89.48:  35%|███▌      | 7/20 [08:28<14:01, 64.75s/it]Task 4, Epoch 8/20 => Loss 0.392, Train_accy 89.48:  40%|████      | 8/20 [08:28<12:35, 62.96s/it]Task 4, Epoch 9/20 => Loss 0.372, Train_accy 90.38:  40%|████      | 8/20 [09:27<12:35, 62.96s/it]Task 4, Epoch 9/20 => Loss 0.372, Train_accy 90.38:  45%|████▌     | 9/20 [09:27<11:19, 61.79s/it]Task 4, Epoch 10/20 => Loss 0.355, Train_accy 90.93, Test_accy 76.55:  45%|████▌     | 9/20 [11:02<11:19, 61.79s/it]Task 4, Epoch 10/20 => Loss 0.355, Train_accy 90.93, Test_accy 76.55:  50%|█████     | 10/20 [11:02<11:58, 71.83s/it]Task 4, Epoch 11/20 => Loss 0.352, Train_accy 90.91:  50%|█████     | 10/20 [12:01<11:58, 71.83s/it]                 Task 4, Epoch 11/20 => Loss 0.352, Train_accy 90.91:  55%|█████▌    | 11/20 [12:01<10:11, 68.00s/it]Task 4, Epoch 12/20 => Loss 0.336, Train_accy 91.12:  55%|█████▌    | 11/20 [13:00<10:11, 68.00s/it]Task 4, Epoch 12/20 => Loss 0.336, Train_accy 91.12:  60%|██████    | 12/20 [13:00<08:42, 65.36s/it]Task 4, Epoch 13/20 => Loss 0.321, Train_accy 91.48:  60%|██████    | 12/20 [13:59<08:42, 65.36s/it]Task 4, Epoch 13/20 => Loss 0.321, Train_accy 91.48:  65%|██████▌   | 13/20 [13:59<07:24, 63.52s/it]Task 4, Epoch 14/20 => Loss 0.309, Train_accy 91.75:  65%|██████▌   | 13/20 [14:59<07:24, 63.52s/it]Task 4, Epoch 14/20 => Loss 0.309, Train_accy 91.75:  70%|███████   | 14/20 [14:59<06:13, 62.24s/it]Task 4, Epoch 15/20 => Loss 0.280, Train_accy 92.51, Test_accy 76.57:  70%|███████   | 14/20 [16:33<06:13, 62.24s/it]Task 4, Epoch 15/20 => Loss 0.280, Train_accy 92.51, Test_accy 76.57:  75%|███████▌  | 15/20 [16:33<05:59, 71.89s/it]Task 4, Epoch 16/20 => Loss 0.289, Train_accy 92.19:  75%|███████▌  | 15/20 [17:32<05:59, 71.89s/it]                 Task 4, Epoch 16/20 => Loss 0.289, Train_accy 92.19:  80%|████████  | 16/20 [17:32<04:32, 68.14s/it]Task 4, Epoch 17/20 => Loss 0.298, Train_accy 92.47:  80%|████████  | 16/20 [18:32<04:32, 68.14s/it]Task 4, Epoch 17/20 => Loss 0.298, Train_accy 92.47:  85%|████████▌ | 17/20 [18:32<03:16, 65.51s/it]Task 4, Epoch 18/20 => Loss 0.249, Train_accy 93.56:  85%|████████▌ | 17/20 [19:31<03:16, 65.51s/it]Task 4, Epoch 18/20 => Loss 0.249, Train_accy 93.56:  90%|█████████ | 18/20 [19:31<02:07, 63.67s/it]Task 4, Epoch 19/20 => Loss 0.296, Train_accy 92.49:  90%|█████████ | 18/20 [20:31<02:07, 63.67s/it]Task 4, Epoch 19/20 => Loss 0.296, Train_accy 92.49:  95%|█████████▌| 19/20 [20:31<01:02, 62.38s/it]Task 4, Epoch 20/20 => Loss 0.266, Train_accy 92.95, Test_accy 76.38:  95%|█████████▌| 19/20 [22:05<01:02, 62.38s/it]Task 4, Epoch 20/20 => Loss 0.266, Train_accy 92.95, Test_accy 76.38: 100%|██████████| 20/20 [22:05<00:00, 72.00s/it]Task 4, Epoch 20/20 => Loss 0.266, Train_accy 92.95, Test_accy 76.38: 100%|██████████| 20/20 [22:05<00:00, 66.27s/it]2023-11-14 23:30:58,784 [coda_prompt.py] => Task 4, Epoch 20/20 => Loss 0.266, Train_accy 92.95, Test_accy 76.38

2023-11-14 23:31:33,743 [trainer.py] => No NME accuracy.
2023-11-14 23:31:33,743 [trainer.py] => CNN: {'total': 76.38, '00-39': 79.82, '40-79': 76.95, '80-119': 75.2, '120-159': 67.75, '160-199': 80.69, 'old': 75.19, 'new': 80.69}
2023-11-14 23:31:33,743 [trainer.py] => CNN top1 curve: [85.44, 81.86, 79.67, 77.06, 76.38]
2023-11-14 23:31:33,743 [trainer.py] => CNN top5 curve: [95.57, 94.91, 92.64, 90.33, 89.38]

Average Accuracy (CNN): 80.08200000000001
2023-11-14 23:31:33,743 [trainer.py] => Average Accuracy (CNN): 80.08200000000001 

