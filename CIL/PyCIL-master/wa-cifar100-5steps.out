2022-11-29 11:08:51,144 [trainer.py] => config: ./exps/wa.json
2022-11-29 11:08:51,145 [trainer.py] => prefix: reproduce
2022-11-29 11:08:51,146 [trainer.py] => dataset: cifar100
2022-11-29 11:08:51,146 [trainer.py] => memory_size: 2000
2022-11-29 11:08:51,146 [trainer.py] => memory_per_class: 20
2022-11-29 11:08:51,146 [trainer.py] => fixed_memory: False
2022-11-29 11:08:51,146 [trainer.py] => shuffle: True
2022-11-29 11:08:51,146 [trainer.py] => init_cls: 20
2022-11-29 11:08:51,146 [trainer.py] => increment: 20
2022-11-29 11:08:51,146 [trainer.py] => model_name: wa
2022-11-29 11:08:51,147 [trainer.py] => convnet_type: resnet32
2022-11-29 11:08:51,147 [trainer.py] => device: [device(type='cuda', index=0), device(type='cuda', index=1), device(type='cuda', index=2), device(type='cuda', index=3)]
2022-11-29 11:08:51,147 [trainer.py] => seed: 1993
Files already downloaded and verified
Files already downloaded and verified
2022-11-29 11:08:54,518 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2022-11-29 11:08:54,823 [trainer.py] => All params: 464154
2022-11-29 11:08:54,824 [trainer.py] => Trainable params: 464154
2022-11-29 11:08:54,824 [wa.py] => Learning on 0-20
2022-11-29 11:35:44,020 [wa.py] => Task 0, Epoch 200/200 => Loss 0.030, Train_accy 99.59, Test_accy 82.65
2022-11-29 11:35:44,022 [base.py] => Reducing exemplars...(100 per classes)
2022-11-29 11:35:44,022 [base.py] => Constructing exemplars...(100 per classes)
2022-11-29 11:36:09,691 [wa.py] => Exemplar size: 2000
2022-11-29 11:36:09,692 [trainer.py] => CNN: {'total': 82.65, '00-09': 86.4, '10-19': 78.9, 'old': 0, 'new': 82.65}
2022-11-29 11:36:09,692 [trainer.py] => NME: {'total': 82.25, '00-09': 85.5, '10-19': 79.0, 'old': 0, 'new': 82.25}
2022-11-29 11:36:09,692 [trainer.py] => CNN top1 curve: [82.65]
2022-11-29 11:36:09,692 [trainer.py] => CNN top5 curve: [96.7]
2022-11-29 11:36:09,692 [trainer.py] => NME top1 curve: [82.25]
2022-11-29 11:36:09,692 [trainer.py] => NME top5 curve: [96.45]

2022-11-29 11:36:09,692 [trainer.py] => All params: 465454
2022-11-29 11:36:09,693 [trainer.py] => Trainable params: 465454
2022-11-29 11:36:09,694 [wa.py] => Learning on 20-40
2022-11-29 12:01:08,853 [wa.py] => Task 1, Epoch 170/170 => Loss 3.112, Train_accy 98.82
alignweights,gamma= tensor(0.7280, device='cuda:0')
2022-11-29 12:01:08,989 [base.py] => Reducing exemplars...(50 per classes)
2022-11-29 12:01:18,974 [base.py] => Constructing exemplars...(50 per classes)
alignweights,gamma= tensor(1., device='cuda:0')
2022-11-29 12:01:44,044 [wa.py] => Exemplar size: 2000
2022-11-29 12:01:44,044 [trainer.py] => CNN: {'total': 73.2, '00-09': 79.1, '10-19': 69.2, '20-29': 73.7, '30-39': 70.8, 'old': 74.15, 'new': 72.25}
2022-11-29 12:01:44,044 [trainer.py] => NME: {'total': 72.88, '00-09': 75.7, '10-19': 66.5, '20-29': 77.5, '30-39': 71.8, 'old': 71.1, 'new': 74.65}
2022-11-29 12:01:44,044 [trainer.py] => CNN top1 curve: [82.65, 73.2]
2022-11-29 12:01:44,044 [trainer.py] => CNN top5 curve: [96.7, 94.1]
2022-11-29 12:01:44,045 [trainer.py] => NME top1 curve: [82.25, 72.88]
2022-11-29 12:01:44,045 [trainer.py] => NME top5 curve: [96.45, 93.45]

2022-11-29 12:01:44,045 [trainer.py] => All params: 466754
2022-11-29 12:01:44,045 [trainer.py] => Trainable params: 466754
2022-11-29 12:01:44,046 [wa.py] => Learning on 40-60
2022-11-29 12:27:18,571 [wa.py] => Task 2, Epoch 170/170 => Loss 4.552, Train_accy 98.99
alignweights,gamma= tensor(0.6596, device='cuda:0')
2022-11-29 12:27:18,573 [base.py] => Reducing exemplars...(33 per classes)
2022-11-29 12:27:38,019 [base.py] => Constructing exemplars...(33 per classes)
alignweights,gamma= tensor(1., device='cuda:0')
2022-11-29 12:28:01,934 [wa.py] => Exemplar size: 1980
2022-11-29 12:28:01,934 [trainer.py] => CNN: {'total': 66.97, '00-09': 76.3, '10-19': 65.1, '20-29': 68.3, '30-39': 62.3, '40-49': 65.2, '50-59': 64.6, 'old': 68.0, 'new': 64.9}
2022-11-29 12:28:01,942 [trainer.py] => NME: {'total': 65.57, '00-09': 68.5, '10-19': 55.1, '20-29': 68.7, '30-39': 59.5, '40-49': 72.3, '50-59': 69.3, 'old': 62.95, 'new': 70.8}
2022-11-29 12:28:01,942 [trainer.py] => CNN top1 curve: [82.65, 73.2, 66.97]
2022-11-29 12:28:01,942 [trainer.py] => CNN top5 curve: [96.7, 94.1, 90.92]
2022-11-29 12:28:01,942 [trainer.py] => NME top1 curve: [82.25, 72.88, 65.57]
2022-11-29 12:28:01,942 [trainer.py] => NME top5 curve: [96.45, 93.45, 89.77]

2022-11-29 12:28:01,942 [trainer.py] => All params: 468054
2022-11-29 12:28:01,943 [trainer.py] => Trainable params: 468054
2022-11-29 12:28:01,943 [wa.py] => Learning on 60-80
2022-11-29 12:53:48,406 [wa.py] => Task 3, Epoch 170/170 => Loss 5.429, Train_accy 99.02
alignweights,gamma= tensor(0.6249, device='cuda:0')
2022-11-29 12:53:48,410 [base.py] => Reducing exemplars...(25 per classes)
2022-11-29 12:54:18,666 [base.py] => Constructing exemplars...(25 per classes)
alignweights,gamma= tensor(1.0000, device='cuda:0')
2022-11-29 12:54:42,618 [wa.py] => Exemplar size: 2000
2022-11-29 12:54:42,618 [trainer.py] => CNN: {'total': 62.11, '00-09': 72.6, '10-19': 58.7, '20-29': 67.7, '30-39': 59.7, '40-49': 60.6, '50-59': 58.4, '60-69': 64.2, '70-79': 55.0, 'old': 62.95, 'new': 59.6}
2022-11-29 12:54:42,619 [trainer.py] => NME: {'total': 60.45, '00-09': 62.3, '10-19': 46.5, '20-29': 65.8, '30-39': 53.5, '40-49': 63.1, '50-59': 50.4, '60-69': 74.0, '70-79': 68.0, 'old': 56.93, 'new': 71.0}
2022-11-29 12:54:42,619 [trainer.py] => CNN top1 curve: [82.65, 73.2, 66.97, 62.11]
2022-11-29 12:54:42,619 [trainer.py] => CNN top5 curve: [96.7, 94.1, 90.92, 88.66]
2022-11-29 12:54:42,619 [trainer.py] => NME top1 curve: [82.25, 72.88, 65.57, 60.45]
2022-11-29 12:54:42,619 [trainer.py] => NME top5 curve: [96.45, 93.45, 89.77, 87.04]

2022-11-29 12:54:42,619 [trainer.py] => All params: 469354
2022-11-29 12:54:42,619 [trainer.py] => Trainable params: 469354
2022-11-29 12:54:42,620 [wa.py] => Learning on 80-100
2022-11-29 13:21:00,868 [wa.py] => Task 4, Epoch 170/170 => Loss 6.208, Train_accy 99.17
alignweights,gamma= tensor(0.5808, device='cuda:0')
2022-11-29 13:21:00,870 [base.py] => Reducing exemplars...(20 per classes)
2022-11-29 13:21:40,495 [base.py] => Constructing exemplars...(20 per classes)
alignweights,gamma= tensor(1.0000, device='cuda:0')
2022-11-29 13:22:05,135 [wa.py] => Exemplar size: 2000
2022-11-29 13:22:05,136 [trainer.py] => CNN: {'total': 57.68, '00-09': 70.1, '10-19': 54.6, '20-29': 66.3, '30-39': 57.8, '40-49': 59.7, '50-59': 55.0, '60-69': 57.1, '70-79': 48.1, '80-89': 51.2, '90-99': 56.9, 'old': 58.59, 'new': 54.05}
2022-11-29 13:22:05,136 [trainer.py] => NME: {'total': 56.28, '00-09': 59.0, '10-19': 41.5, '20-29': 60.7, '30-39': 49.9, '40-49': 57.6, '50-59': 47.3, '60-69': 59.5, '70-79': 53.8, '80-89': 67.9, '90-99': 65.6, 'old': 53.66, 'new': 66.75}
2022-11-29 13:22:05,136 [trainer.py] => CNN top1 curve: [82.65, 73.2, 66.97, 62.11, 57.68]
2022-11-29 13:22:05,136 [trainer.py] => CNN top5 curve: [96.7, 94.1, 90.92, 88.66, 86.29]
2022-11-29 13:22:05,136 [trainer.py] => NME top1 curve: [82.25, 72.88, 65.57, 60.45, 56.28]
2022-11-29 13:22:05,136 [trainer.py] => NME top5 curve: [96.45, 93.45, 89.77, 87.04, 83.98]

