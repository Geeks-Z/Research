nohup: 忽略输入
2023-11-22 16:21:58,972 [trainer.py] => config: ./exps/foster.json
2023-11-22 16:21:58,972 [trainer.py] => prefix: cil
2023-11-22 16:21:58,972 [trainer.py] => dataset: cifar224
2023-11-22 16:21:58,972 [trainer.py] => memory_size: 2000
2023-11-22 16:21:58,972 [trainer.py] => memory_per_class: 20
2023-11-22 16:21:58,972 [trainer.py] => fixed_memory: True
2023-11-22 16:21:58,972 [trainer.py] => shuffle: True
2023-11-22 16:21:58,972 [trainer.py] => init_cls: 10
2023-11-22 16:21:58,972 [trainer.py] => increment: 10
2023-11-22 16:21:58,972 [trainer.py] => model_name: foster
2023-11-22 16:21:58,972 [trainer.py] => backbone_type: vit_base_patch16_224
2023-11-22 16:21:58,972 [trainer.py] => device: [device(type='cuda', index=1)]
2023-11-22 16:21:58,972 [trainer.py] => seed: 1993
2023-11-22 16:21:58,972 [trainer.py] => beta1: 0.96
2023-11-22 16:21:58,972 [trainer.py] => beta2: 0.97
2023-11-22 16:21:58,972 [trainer.py] => oofc: ft
2023-11-22 16:21:58,972 [trainer.py] => is_teacher_wa: False
2023-11-22 16:21:58,972 [trainer.py] => is_student_wa: False
2023-11-22 16:21:58,972 [trainer.py] => lambda_okd: 1
2023-11-22 16:21:58,972 [trainer.py] => wa_value: 1
2023-11-22 16:21:58,972 [trainer.py] => init_epochs: 20
2023-11-22 16:21:58,973 [trainer.py] => init_lr: 0.001
2023-11-22 16:21:58,973 [trainer.py] => init_weight_decay: 0.0005
2023-11-22 16:21:58,973 [trainer.py] => boosting_epochs: 20
2023-11-22 16:21:58,973 [trainer.py] => compression_epochs: 20
2023-11-22 16:21:58,973 [trainer.py] => lr: 0.001
2023-11-22 16:21:58,973 [trainer.py] => batch_size: 32
2023-11-22 16:21:58,973 [trainer.py] => weight_decay: 0.0005
2023-11-22 16:21:58,973 [trainer.py] => num_workers: 8
2023-11-22 16:21:58,973 [trainer.py] => T: 2
Files already downloaded and verified
Files already downloaded and verified
2023-11-22 16:22:00,784 [data_manager.py] => [68, 56, 78, 8, 23, 84, 90, 65, 74, 76, 40, 89, 3, 92, 55, 9, 26, 80, 43, 38, 58, 70, 77, 1, 85, 19, 17, 50, 28, 53, 13, 81, 45, 82, 6, 59, 83, 16, 15, 44, 91, 41, 72, 60, 79, 52, 20, 10, 31, 54, 37, 95, 14, 71, 96, 98, 97, 2, 64, 66, 42, 22, 35, 86, 24, 34, 87, 21, 99, 0, 88, 27, 18, 94, 11, 12, 47, 25, 30, 46, 62, 69, 36, 61, 7, 63, 75, 5, 32, 4, 51, 48, 73, 93, 39, 67, 29, 49, 57, 33]
2023-11-22 16:22:01,161 [trainer.py] => All params: 0
2023-11-22 16:22:01,161 [trainer.py] => Trainable params: 0
2023-11-22 16:22:03,783 [foster.py] => Learning on 0-10
2023-11-22 16:22:03,784 [foster.py] => All params: 85814036
2023-11-22 16:22:03,785 [foster.py] => Trainable params: 85814036
/home/team/zhaohongwei/anaconda3/envs/l2p/lib/python3.8/site-packages/torchvision/transforms/transforms.py:332: UserWarning: Argument 'interpolation' of type int is deprecated since 0.13 and will be removed in 0.15. Please use InterpolationMode enum.
  warnings.warn(
  0%|          | 0/20 [00:00<?, ?it/s]Task 0, Epoch 1/20 => Loss 0.787, Train_accy 76.42, Test_accy 96.60:   0%|          | 0/20 [00:47<?, ?it/s]Task 0, Epoch 1/20 => Loss 0.787, Train_accy 76.42, Test_accy 96.60:   5%|▌         | 1/20 [00:47<14:58, 47.29s/it]Task 0, Epoch 2/20 => Loss 0.386, Train_accy 87.50:   5%|▌         | 1/20 [01:28<14:58, 47.29s/it]                 Task 0, Epoch 2/20 => Loss 0.386, Train_accy 87.50:  10%|█         | 2/20 [01:28<13:04, 43.57s/it]Task 0, Epoch 3/20 => Loss 0.325, Train_accy 89.08:  10%|█         | 2/20 [02:09<13:04, 43.57s/it]Task 0, Epoch 3/20 => Loss 0.325, Train_accy 89.08:  15%|█▌        | 3/20 [02:09<12:01, 42.43s/it]Task 0, Epoch 4/20 => Loss 0.311, Train_accy 89.80:  15%|█▌        | 3/20 [02:50<12:01, 42.43s/it]Task 0, Epoch 4/20 => Loss 0.311, Train_accy 89.80:  20%|██        | 4/20 [02:50<11:10, 41.88s/it]Task 0, Epoch 5/20 => Loss 0.257, Train_accy 91.76:  20%|██        | 4/20 [03:31<11:10, 41.88s/it]Task 0, Epoch 5/20 => Loss 0.257, Train_accy 91.76:  25%|██▌       | 5/20 [03:31<10:24, 41.61s/it]Task 0, Epoch 6/20 => Loss 0.268, Train_accy 91.42, Test_accy 97.90:  25%|██▌       | 5/20 [04:15<10:24, 41.61s/it]Task 0, Epoch 6/20 => Loss 0.268, Train_accy 91.42, Test_accy 97.90:  30%|███       | 6/20 [04:15<09:56, 42.57s/it]Task 0, Epoch 7/20 => Loss 0.232, Train_accy 92.36:  30%|███       | 6/20 [04:57<09:56, 42.57s/it]                 Task 0, Epoch 7/20 => Loss 0.232, Train_accy 92.36:  35%|███▌      | 7/20 [04:57<09:07, 42.10s/it]Task 0, Epoch 8/20 => Loss 0.198, Train_accy 93.56:  35%|███▌      | 7/20 [05:38<09:07, 42.10s/it]Task 0, Epoch 8/20 => Loss 0.198, Train_accy 93.56:  40%|████      | 8/20 [05:38<08:21, 41.79s/it]Task 0, Epoch 9/20 => Loss 0.219, Train_accy 92.70:  40%|████      | 8/20 [06:19<08:21, 41.79s/it]Task 0, Epoch 9/20 => Loss 0.219, Train_accy 92.70:  45%|████▌     | 9/20 [06:19<07:37, 41.55s/it]Task 0, Epoch 10/20 => Loss 0.191, Train_accy 94.00:  45%|████▌     | 9/20 [07:00<07:37, 41.55s/it]Task 0, Epoch 10/20 => Loss 0.191, Train_accy 94.00:  50%|█████     | 10/20 [07:00<06:54, 41.41s/it]Task 0, Epoch 11/20 => Loss 0.188, Train_accy 93.82, Test_accy 98.20:  50%|█████     | 10/20 [07:44<06:54, 41.41s/it]Task 0, Epoch 11/20 => Loss 0.188, Train_accy 93.82, Test_accy 98.20:  55%|█████▌    | 11/20 [07:44<06:21, 42.36s/it]Task 0, Epoch 12/20 => Loss 0.173, Train_accy 94.52:  55%|█████▌    | 11/20 [08:25<06:21, 42.36s/it]                 Task 0, Epoch 12/20 => Loss 0.173, Train_accy 94.52:  60%|██████    | 12/20 [08:25<05:35, 41.94s/it]Task 0, Epoch 13/20 => Loss 0.155, Train_accy 94.90:  60%|██████    | 12/20 [09:06<05:35, 41.94s/it]Task 0, Epoch 13/20 => Loss 0.155, Train_accy 94.90:  65%|██████▌   | 13/20 [09:06<04:51, 41.67s/it]Task 0, Epoch 14/20 => Loss 0.148, Train_accy 95.24:  65%|██████▌   | 13/20 [09:47<04:51, 41.67s/it]Task 0, Epoch 14/20 => Loss 0.148, Train_accy 95.24:  70%|███████   | 14/20 [09:47<04:08, 41.48s/it]Task 0, Epoch 15/20 => Loss 0.145, Train_accy 95.36:  70%|███████   | 14/20 [10:28<04:08, 41.48s/it]Task 0, Epoch 15/20 => Loss 0.145, Train_accy 95.36:  75%|███████▌  | 15/20 [10:28<03:26, 41.33s/it]Task 0, Epoch 16/20 => Loss 0.146, Train_accy 95.22, Test_accy 99.30:  75%|███████▌  | 15/20 [11:13<03:26, 41.33s/it]Task 0, Epoch 16/20 => Loss 0.146, Train_accy 95.22, Test_accy 99.30:  80%|████████  | 16/20 [11:13<02:49, 42.28s/it]Task 0, Epoch 17/20 => Loss 0.126, Train_accy 95.50:  80%|████████  | 16/20 [11:54<02:49, 42.28s/it]                 Task 0, Epoch 17/20 => Loss 0.126, Train_accy 95.50:  85%|████████▌ | 17/20 [11:54<02:05, 41.89s/it]Task 0, Epoch 18/20 => Loss 0.117, Train_accy 96.06:  85%|████████▌ | 17/20 [12:35<02:05, 41.89s/it]Task 0, Epoch 18/20 => Loss 0.117, Train_accy 96.06:  90%|█████████ | 18/20 [12:35<01:23, 41.64s/it]Task 0, Epoch 19/20 => Loss 0.132, Train_accy 95.84:  90%|█████████ | 18/20 [13:16<01:23, 41.64s/it]Task 0, Epoch 19/20 => Loss 0.132, Train_accy 95.84:  95%|█████████▌| 19/20 [13:16<00:41, 41.46s/it]Task 0, Epoch 20/20 => Loss 0.126, Train_accy 96.04:  95%|█████████▌| 19/20 [13:57<00:41, 41.46s/it]Task 0, Epoch 20/20 => Loss 0.126, Train_accy 96.04: 100%|██████████| 20/20 [13:57<00:00, 41.33s/it]Task 0, Epoch 20/20 => Loss 0.126, Train_accy 96.04: 100%|██████████| 20/20 [13:57<00:00, 41.87s/it]2023-11-22 16:36:03,157 [foster.py] => Task 0, Epoch 20/20 => Loss 0.126, Train_accy 96.04
2023-11-22 16:36:03,158 [base.py] => Constructing exemplars for new classes...(20 per classes)

2023-11-22 16:36:31,970 [foster.py] => Exemplar size: 200
2023-11-22 16:36:31,970 [trainer.py] => CNN: {'total': 99.3, '00-09': 99.3, 'old': 0, 'new': 99.3}
2023-11-22 16:36:31,971 [trainer.py] => NME: {'total': 99.3, '00-09': 99.3, 'old': 0, 'new': 99.3}
2023-11-22 16:36:31,971 [trainer.py] => CNN top1 curve: [99.3]
2023-11-22 16:36:31,971 [trainer.py] => CNN top5 curve: [100.0]
2023-11-22 16:36:31,971 [trainer.py] => NME top1 curve: [99.3]
2023-11-22 16:36:31,971 [trainer.py] => NME top5 curve: [100.0]

Average Accuracy (CNN): 99.3
Average Accuracy (NME): 99.3
2023-11-22 16:36:31,971 [trainer.py] => Average Accuracy (CNN): 99.3
2023-11-22 16:36:31,971 [trainer.py] => Average Accuracy (NME): 99.3
2023-11-22 16:36:31,972 [trainer.py] => All params: 85814036
2023-11-22 16:36:31,973 [trainer.py] => Trainable params: 85814036
2023-11-22 16:36:33,810 [foster.py] => Learning on 10-20
2023-11-22 16:36:33,811 [foster.py] => All params: 171651122
2023-11-22 16:36:33,812 [foster.py] => Trainable params: 85844776
2023-11-22 16:36:33,908 [foster.py] => per cls weights : [1.28369905 1.28369905 1.28369905 1.28369905 1.28369905 1.28369905
 1.28369905 1.28369905 1.28369905 1.28369905 0.71630095 0.71630095
 0.71630095 0.71630095 0.71630095 0.71630095 0.71630095 0.71630095
 0.71630095 0.71630095]
  0%|          | 0/20 [00:00<?, ?it/s]Task 1, Epoch 1/20 => Loss 2.898, Loss_clf 0.720, Loss_fe 0.902, Loss_kd 0.638, Train_accy 75.10, Test_accy 94.75:   0%|          | 0/20 [01:08<?, ?it/s]Task 1, Epoch 1/20 => Loss 2.898, Loss_clf 0.720, Loss_fe 0.902, Loss_kd 0.638, Train_accy 75.10, Test_accy 94.75:   5%|▌         | 1/20 [01:08<21:45, 68.71s/it]Task 1, Epoch 2/20 => Loss 2.200, Loss_clf 0.402, Loss_fe 0.540, Loss_kd 0.629, Train_accy 81.87:   5%|▌         | 1/20 [02:05<21:45, 68.71s/it]                 Task 1, Epoch 2/20 => Loss 2.200, Loss_clf 0.402, Loss_fe 0.540, Loss_kd 0.629, Train_accy 81.87:  10%|█         | 2/20 [02:05<18:32, 61.83s/it]Task 1, Epoch 3/20 => Loss 2.084, Loss_clf 0.356, Loss_fe 0.471, Loss_kd 0.629, Train_accy 84.02:  10%|█         | 2/20 [03:02<18:32, 61.83s/it]Task 1, Epoch 3/20 => Loss 2.084, Loss_clf 0.356, Loss_fe 0.471, Loss_kd 0.629, Train_accy 84.02:  15%|█▌        | 3/20 [03:02<16:54, 59.68s/it]Task 1, Epoch 4/20 => Loss 1.986, Loss_clf 0.319, Loss_fe 0.409, Loss_kd 0.629, Train_accy 85.75:  15%|█▌        | 3/20 [03:59<16:54, 59.68s/it]Task 1, Epoch 4/20 => Loss 1.986, Loss_clf 0.319, Loss_fe 0.409, Loss_kd 0.629, Train_accy 85.75:  20%|██        | 4/20 [03:59<15:38, 58.67s/it]Task 1, Epoch 5/20 => Loss 1.959, Loss_clf 0.309, Loss_fe 0.391, Loss_kd 0.630, Train_accy 85.85:  20%|██        | 4/20 [04:57<15:38, 58.67s/it]Task 1, Epoch 5/20 => Loss 1.959, Loss_clf 0.309, Loss_fe 0.391, Loss_kd 0.630, Train_accy 85.85:  25%|██▌       | 5/20 [04:57<14:31, 58.09s/it]Task 1, Epoch 6/20 => Loss 1.946, Loss_clf 0.303, Loss_fe 0.375, Loss_kd 0.634, Train_accy 86.31, Test_accy 95.55:  25%|██▌       | 5/20 [06:05<14:31, 58.09s/it]Task 1, Epoch 6/20 => Loss 1.946, Loss_clf 0.303, Loss_fe 0.375, Loss_kd 0.634, Train_accy 86.31, Test_accy 95.55:  30%|███       | 6/20 [06:05<14:24, 61.77s/it]Task 1, Epoch 7/20 => Loss 1.886, Loss_clf 0.280, Loss_fe 0.342, Loss_kd 0.632, Train_accy 87.75:  30%|███       | 6/20 [07:03<14:24, 61.77s/it]                 Task 1, Epoch 7/20 => Loss 1.886, Loss_clf 0.280, Loss_fe 0.342, Loss_kd 0.632, Train_accy 87.75:  35%|███▌      | 7/20 [07:03<13:03, 60.23s/it]Task 1, Epoch 8/20 => Loss 1.806, Loss_clf 0.253, Loss_fe 0.296, Loss_kd 0.629, Train_accy 88.79:  35%|███▌      | 7/20 [08:00<13:03, 60.23s/it]Task 1, Epoch 8/20 => Loss 1.806, Loss_clf 0.253, Loss_fe 0.296, Loss_kd 0.629, Train_accy 88.79:  40%|████      | 8/20 [08:00<11:50, 59.22s/it]Task 1, Epoch 9/20 => Loss 1.787, Loss_clf 0.248, Loss_fe 0.276, Loss_kd 0.631, Train_accy 88.75:  40%|████      | 8/20 [08:57<11:50, 59.22s/it]Task 1, Epoch 9/20 => Loss 1.787, Loss_clf 0.248, Loss_fe 0.276, Loss_kd 0.631, Train_accy 88.75:  45%|████▌     | 9/20 [08:57<10:43, 58.54s/it]Task 1, Epoch 10/20 => Loss 1.792, Loss_clf 0.247, Loss_fe 0.279, Loss_kd 0.633, Train_accy 89.17:  45%|████▌     | 9/20 [09:54<10:43, 58.54s/it]Task 1, Epoch 10/20 => Loss 1.792, Loss_clf 0.247, Loss_fe 0.279, Loss_kd 0.633, Train_accy 89.17:  50%|█████     | 10/20 [09:54<09:40, 58.07s/it]Task 1, Epoch 11/20 => Loss 1.733, Loss_clf 0.227, Loss_fe 0.250, Loss_kd 0.628, Train_accy 90.02, Test_accy 96.55:  50%|█████     | 10/20 [11:03<09:40, 58.07s/it]Task 1, Epoch 11/20 => Loss 1.733, Loss_clf 0.227, Loss_fe 0.250, Loss_kd 0.628, Train_accy 90.02, Test_accy 96.55:  55%|█████▌    | 11/20 [11:03<09:12, 61.39s/it]Task 1, Epoch 12/20 => Loss 1.665, Loss_clf 0.200, Loss_fe 0.214, Loss_kd 0.625, Train_accy 91.19:  55%|█████▌    | 11/20 [12:00<09:12, 61.39s/it]                 Task 1, Epoch 12/20 => Loss 1.665, Loss_clf 0.200, Loss_fe 0.214, Loss_kd 0.625, Train_accy 91.19:  60%|██████    | 12/20 [12:00<08:00, 60.09s/it]Task 1, Epoch 13/20 => Loss 1.701, Loss_clf 0.217, Loss_fe 0.223, Loss_kd 0.631, Train_accy 90.77:  60%|██████    | 12/20 [12:57<08:00, 60.09s/it]Task 1, Epoch 13/20 => Loss 1.701, Loss_clf 0.217, Loss_fe 0.223, Loss_kd 0.631, Train_accy 90.77:  65%|██████▌   | 13/20 [12:57<06:54, 59.15s/it]Task 1, Epoch 14/20 => Loss 1.641, Loss_clf 0.188, Loss_fe 0.201, Loss_kd 0.626, Train_accy 92.38:  65%|██████▌   | 13/20 [13:54<06:54, 59.15s/it]Task 1, Epoch 14/20 => Loss 1.641, Loss_clf 0.188, Loss_fe 0.201, Loss_kd 0.626, Train_accy 92.38:  70%|███████   | 14/20 [13:54<05:51, 58.51s/it]Task 1, Epoch 15/20 => Loss 1.640, Loss_clf 0.189, Loss_fe 0.192, Loss_kd 0.629, Train_accy 91.65:  70%|███████   | 14/20 [14:51<05:51, 58.51s/it]Task 1, Epoch 15/20 => Loss 1.640, Loss_clf 0.189, Loss_fe 0.192, Loss_kd 0.629, Train_accy 91.65:  75%|███████▌  | 15/20 [14:51<04:50, 58.08s/it]Task 1, Epoch 16/20 => Loss 1.629, Loss_clf 0.182, Loss_fe 0.188, Loss_kd 0.629, Train_accy 92.44, Test_accy 96.40:  75%|███████▌  | 15/20 [16:00<04:50, 58.08s/it]Task 1, Epoch 16/20 => Loss 1.629, Loss_clf 0.182, Loss_fe 0.188, Loss_kd 0.629, Train_accy 92.44, Test_accy 96.40:  80%|████████  | 16/20 [16:00<04:05, 61.40s/it]Task 1, Epoch 17/20 => Loss 1.646, Loss_clf 0.190, Loss_fe 0.189, Loss_kd 0.633, Train_accy 91.96:  80%|████████  | 16/20 [16:57<04:05, 61.40s/it]                 Task 1, Epoch 17/20 => Loss 1.646, Loss_clf 0.190, Loss_fe 0.189, Loss_kd 0.633, Train_accy 91.96:  85%|████████▌ | 17/20 [16:57<03:00, 60.07s/it]Task 1, Epoch 18/20 => Loss 1.610, Loss_clf 0.174, Loss_fe 0.169, Loss_kd 0.633, Train_accy 92.48:  85%|████████▌ | 17/20 [17:54<03:00, 60.07s/it]Task 1, Epoch 18/20 => Loss 1.610, Loss_clf 0.174, Loss_fe 0.169, Loss_kd 0.633, Train_accy 92.48:  90%|█████████ | 18/20 [17:54<01:58, 59.18s/it]Task 1, Epoch 19/20 => Loss 1.577, Loss_clf 0.159, Loss_fe 0.154, Loss_kd 0.632, Train_accy 92.96:  90%|█████████ | 18/20 [18:51<01:58, 59.18s/it]Task 1, Epoch 19/20 => Loss 1.577, Loss_clf 0.159, Loss_fe 0.154, Loss_kd 0.632, Train_accy 92.96:  95%|█████████▌| 19/20 [18:51<00:58, 58.58s/it]Task 1, Epoch 20/20 => Loss 1.606, Loss_clf 0.176, Loss_fe 0.174, Loss_kd 0.628, Train_accy 92.92:  95%|█████████▌| 19/20 [19:48<00:58, 58.58s/it]Task 1, Epoch 20/20 => Loss 1.606, Loss_clf 0.176, Loss_fe 0.174, Loss_kd 0.628, Train_accy 92.92: 100%|██████████| 20/20 [19:48<00:00, 58.12s/it]Task 1, Epoch 20/20 => Loss 1.606, Loss_clf 0.176, Loss_fe 0.174, Loss_kd 0.628, Train_accy 92.92: 100%|██████████| 20/20 [19:48<00:00, 59.44s/it]2023-11-22 16:56:22,620 [foster.py] => Task 1, Epoch 20/20 => Loss 1.606, Loss_clf 0.176, Loss_fe 0.174, Loss_kd 0.628, Train_accy 92.92
2023-11-22 16:56:22,621 [foster.py] => do not weight align teacher!
2023-11-22 16:56:22,623 [foster.py] => per cls weights : [1.37343238 1.37343238 1.37343238 1.37343238 1.37343238 1.37343238
 1.37343238 1.37343238 1.37343238 1.37343238 0.62656762 0.62656762
 0.62656762 0.62656762 0.62656762 0.62656762 0.62656762 0.62656762
 0.62656762 0.62656762]

  0%|          | 0/20 [00:00<?, ?it/s]SNet: Task 1, Epoch 1/20 => Loss 1.169,  Train_accy 75.25, Test_accy 95.10:   0%|          | 0/20 [01:17<?, ?it/s]SNet: Task 1, Epoch 1/20 => Loss 1.169,  Train_accy 75.25, Test_accy 95.10:   5%|▌         | 1/20 [01:17<24:32, 77.52s/it]SNet: Task 1, Epoch 2/20 => Loss 0.910,  Train_accy 85.92:   5%|▌         | 1/20 [02:28<24:32, 77.52s/it]                 SNet: Task 1, Epoch 2/20 => Loss 0.910,  Train_accy 85.92:  10%|█         | 2/20 [02:28<22:05, 73.66s/it]SNet: Task 1, Epoch 3/20 => Loss 0.887,  Train_accy 86.19:  10%|█         | 2/20 [03:39<22:05, 73.66s/it]SNet: Task 1, Epoch 3/20 => Loss 0.887,  Train_accy 86.19:  15%|█▌        | 3/20 [03:39<20:31, 72.47s/it]SNet: Task 1, Epoch 4/20 => Loss 0.879,  Train_accy 87.00:  15%|█▌        | 3/20 [04:50<20:31, 72.47s/it]SNet: Task 1, Epoch 4/20 => Loss 0.879,  Train_accy 87.00:  20%|██        | 4/20 [04:50<19:09, 71.87s/it]SNet: Task 1, Epoch 5/20 => Loss 0.870,  Train_accy 87.75:  20%|██        | 4/20 [06:01<19:09, 71.87s/it]SNet: Task 1, Epoch 5/20 => Loss 0.870,  Train_accy 87.75:  25%|██▌       | 5/20 [06:01<17:53, 71.56s/it]SNet: Task 1, Epoch 6/20 => Loss 0.883,  Train_accy 86.69, Test_accy 96.45:  25%|██▌       | 5/20 [07:19<17:53, 71.56s/it]SNet: Task 1, Epoch 6/20 => Loss 0.883,  Train_accy 86.69, Test_accy 96.45:  30%|███       | 6/20 [07:19<17:11, 73.67s/it]SNet: Task 1, Epoch 7/20 => Loss 0.874,  Train_accy 87.08:  30%|███       | 6/20 [08:30<17:11, 73.67s/it]                 SNet: Task 1, Epoch 7/20 => Loss 0.874,  Train_accy 87.08:  35%|███▌      | 7/20 [08:30<15:46, 72.78s/it]SNet: Task 1, Epoch 8/20 => Loss 0.871,  Train_accy 87.54:  35%|███▌      | 7/20 [09:41<15:46, 72.78s/it]SNet: Task 1, Epoch 8/20 => Loss 0.871,  Train_accy 87.54:  40%|████      | 8/20 [09:41<14:26, 72.23s/it]SNet: Task 1, Epoch 9/20 => Loss 0.838,  Train_accy 88.50:  40%|████      | 8/20 [10:52<14:26, 72.23s/it]SNet: Task 1, Epoch 9/20 => Loss 0.838,  Train_accy 88.50:  45%|████▌     | 9/20 [10:52<13:10, 71.86s/it]SNet: Task 1, Epoch 10/20 => Loss 0.861,  Train_accy 88.04:  45%|████▌     | 9/20 [12:03<13:10, 71.86s/it]SNet: Task 1, Epoch 10/20 => Loss 0.861,  Train_accy 88.04:  50%|█████     | 10/20 [12:03<11:56, 71.61s/it]SNet: Task 1, Epoch 11/20 => Loss 0.864,  Train_accy 88.19, Test_accy 96.70:  50%|█████     | 10/20 [13:20<11:56, 71.61s/it]SNet: Task 1, Epoch 11/20 => Loss 0.864,  Train_accy 88.19, Test_accy 96.70:  55%|█████▌    | 11/20 [13:20<11:00, 73.43s/it]SNet: Task 1, Epoch 12/20 => Loss 0.853,  Train_accy 88.40:  55%|█████▌    | 11/20 [14:32<11:00, 73.43s/it]                 SNet: Task 1, Epoch 12/20 => Loss 0.853,  Train_accy 88.40:  60%|██████    | 12/20 [14:32<09:41, 72.72s/it]SNet: Task 1, Epoch 13/20 => Loss 0.855,  Train_accy 87.90:  60%|██████    | 12/20 [15:42<09:41, 72.72s/it]SNet: Task 1, Epoch 13/20 => Loss 0.855,  Train_accy 87.90:  65%|██████▌   | 13/20 [15:42<08:25, 72.20s/it]SNet: Task 1, Epoch 14/20 => Loss 0.852,  Train_accy 88.08:  65%|██████▌   | 13/20 [16:53<08:25, 72.20s/it]SNet: Task 1, Epoch 14/20 => Loss 0.852,  Train_accy 88.08:  70%|███████   | 14/20 [16:53<07:10, 71.83s/it]SNet: Task 1, Epoch 15/20 => Loss 0.876,  Train_accy 87.52:  70%|███████   | 14/20 [18:05<07:10, 71.83s/it]SNet: Task 1, Epoch 15/20 => Loss 0.876,  Train_accy 87.52:  75%|███████▌  | 15/20 [18:05<05:58, 71.61s/it]SNet: Task 1, Epoch 16/20 => Loss 0.860,  Train_accy 88.63, Test_accy 96.70:  75%|███████▌  | 15/20 [19:23<05:58, 71.61s/it]SNet: Task 1, Epoch 16/20 => Loss 0.860,  Train_accy 88.63, Test_accy 96.70:  80%|████████  | 16/20 [19:23<04:54, 73.52s/it]SNet: Task 1, Epoch 17/20 => Loss 0.868,  Train_accy 88.33:  80%|████████  | 16/20 [20:34<04:54, 73.52s/it]                 SNet: Task 1, Epoch 17/20 => Loss 0.868,  Train_accy 88.33:  85%|████████▌ | 17/20 [20:34<03:38, 72.80s/it]SNet: Task 1, Epoch 18/20 => Loss 0.871,  Train_accy 87.75:  85%|████████▌ | 17/20 [21:45<03:38, 72.80s/it]SNet: Task 1, Epoch 18/20 => Loss 0.871,  Train_accy 87.75:  90%|█████████ | 18/20 [21:45<02:24, 72.30s/it]SNet: Task 1, Epoch 19/20 => Loss 0.861,  Train_accy 88.38:  90%|█████████ | 18/20 [22:56<02:24, 72.30s/it]SNet: Task 1, Epoch 19/20 => Loss 0.861,  Train_accy 88.38:  95%|█████████▌| 19/20 [22:56<01:11, 71.91s/it]SNet: Task 1, Epoch 20/20 => Loss 0.839,  Train_accy 88.98:  95%|█████████▌| 19/20 [24:07<01:11, 71.91s/it]SNet: Task 1, Epoch 20/20 => Loss 0.839,  Train_accy 88.98: 100%|██████████| 20/20 [24:07<00:00, 71.70s/it]SNet: Task 1, Epoch 20/20 => Loss 0.839,  Train_accy 88.98: 100%|██████████| 20/20 [24:07<00:00, 72.38s/it]2023-11-22 17:20:32,417 [foster.py] => SNet: Task 1, Epoch 20/20 => Loss 0.839,  Train_accy 88.98
2023-11-22 17:20:32,418 [foster.py] => do not weight align student!

2023-11-22 17:20:39,024 [foster.py] => darknet eval: 
2023-11-22 17:20:39,024 [foster.py] => CNN top1 curve: 96.7
2023-11-22 17:20:39,025 [foster.py] => CNN top5 curve: 99.95
2023-11-22 17:20:39,026 [base.py] => Constructing exemplars for new classes...(20 per classes)
2023-11-22 17:21:46,956 [foster.py] => Exemplar size: 400
2023-11-22 17:21:46,956 [trainer.py] => CNN: {'total': 96.8, '00-09': 97.7, '10-19': 95.9, 'old': 97.7, 'new': 95.9}
2023-11-22 17:21:46,956 [trainer.py] => NME: {'total': 96.55, '00-09': 97.3, '10-19': 95.8, 'old': 97.3, 'new': 95.8}
2023-11-22 17:21:46,956 [trainer.py] => CNN top1 curve: [99.3, 96.8]
2023-11-22 17:21:46,956 [trainer.py] => CNN top5 curve: [100.0, 99.75]
2023-11-22 17:21:46,956 [trainer.py] => NME top1 curve: [99.3, 96.55]
2023-11-22 17:21:46,956 [trainer.py] => NME top5 curve: [100.0, 99.85]

Average Accuracy (CNN): 98.05
Average Accuracy (NME): 97.925
2023-11-22 17:21:46,956 [trainer.py] => Average Accuracy (CNN): 98.05
2023-11-22 17:21:46,956 [trainer.py] => Average Accuracy (NME): 97.925
2023-11-22 17:21:46,958 [trainer.py] => All params: 171651122
2023-11-22 17:21:46,959 [trainer.py] => Trainable params: 85844776
2023-11-22 17:21:49,100 [foster.py] => Learning on 20-30
2023-11-22 17:21:49,102 [foster.py] => All params: 171681872
2023-11-22 17:21:49,103 [foster.py] => Trainable params: 85867836
2023-11-22 17:21:49,223 [foster.py] => per cls weights : [1.17279236 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236
 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236
 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236 1.17279236
 1.17279236 1.17279236 0.65441528 0.65441528 0.65441528 0.65441528
 0.65441528 0.65441528 0.65441528 0.65441528 0.65441528 0.65441528]
  0%|          | 0/20 [00:00<?, ?it/s]Task 2, Epoch 1/20 => Loss 3.062, Loss_clf 0.544, Loss_fe 0.782, Loss_kd 1.158, Train_accy 72.93, Test_accy 89.27:   0%|          | 0/20 [01:16<?, ?it/s]Task 2, Epoch 1/20 => Loss 3.062, Loss_clf 0.544, Loss_fe 0.782, Loss_kd 1.158, Train_accy 72.93, Test_accy 89.27:   5%|▌         | 1/20 [01:16<24:22, 77.00s/it]Task 2, Epoch 2/20 => Loss 2.469, Loss_clf 0.301, Loss_fe 0.455, Loss_kd 1.142, Train_accy 77.15:   5%|▌         | 1/20 [02:16<24:22, 77.00s/it]                 Task 2, Epoch 2/20 => Loss 2.469, Loss_clf 0.301, Loss_fe 0.455, Loss_kd 1.142, Train_accy 77.15:  10%|█         | 2/20 [02:16<19:58, 66.56s/it]Task 2, Epoch 3/20 => Loss 2.401, Loss_clf 0.282, Loss_fe 0.404, Loss_kd 1.143, Train_accy 78.78:  10%|█         | 2/20 [03:15<19:58, 66.56s/it]Task 2, Epoch 3/20 => Loss 2.401, Loss_clf 0.282, Loss_fe 0.404, Loss_kd 1.143, Train_accy 78.78:  15%|█▌        | 3/20 [03:15<17:55, 63.24s/it]Task 2, Epoch 4/20 => Loss 2.289, Loss_clf 0.239, Loss_fe 0.333, Loss_kd 1.144, Train_accy 81.80:  15%|█▌        | 3/20 [04:14<17:55, 63.24s/it]Task 2, Epoch 4/20 => Loss 2.289, Loss_clf 0.239, Loss_fe 0.333, Loss_kd 1.144, Train_accy 81.80:  20%|██        | 4/20 [04:14<16:27, 61.70s/it]Task 2, Epoch 5/20 => Loss 2.240, Loss_clf 0.241, Loss_fe 0.306, Loss_kd 1.128, Train_accy 81.44:  20%|██        | 4/20 [05:14<16:27, 61.70s/it]Task 2, Epoch 5/20 => Loss 2.240, Loss_clf 0.241, Loss_fe 0.306, Loss_kd 1.128, Train_accy 81.44:  25%|██▌       | 5/20 [05:14<15:12, 60.85s/it]Task 2, Epoch 6/20 => Loss 2.212, Loss_clf 0.220, Loss_fe 0.283, Loss_kd 1.140, Train_accy 83.61, Test_accy 92.00:  25%|██▌       | 5/20 [06:31<15:12, 60.85s/it]Task 2, Epoch 6/20 => Loss 2.212, Loss_clf 0.220, Loss_fe 0.283, Loss_kd 1.140, Train_accy 83.61, Test_accy 92.00:  30%|███       | 6/20 [06:31<15:30, 66.43s/it]Task 2, Epoch 7/20 => Loss 2.145, Loss_clf 0.200, Loss_fe 0.249, Loss_kd 1.130, Train_accy 83.87:  30%|███       | 6/20 [07:30<15:30, 66.43s/it]                 Task 2, Epoch 7/20 => Loss 2.145, Loss_clf 0.200, Loss_fe 0.249, Loss_kd 1.130, Train_accy 83.87:  35%|███▌      | 7/20 [07:30<13:53, 64.13s/it]Task 2, Epoch 8/20 => Loss 2.106, Loss_clf 0.182, Loss_fe 0.229, Loss_kd 1.131, Train_accy 85.93:  35%|███▌      | 7/20 [08:30<13:53, 64.13s/it]Task 2, Epoch 8/20 => Loss 2.106, Loss_clf 0.182, Loss_fe 0.229, Loss_kd 1.131, Train_accy 85.93:  40%|████      | 8/20 [08:30<12:31, 62.59s/it]Task 2, Epoch 9/20 => Loss 2.103, Loss_clf 0.183, Loss_fe 0.219, Loss_kd 1.134, Train_accy 86.83:  40%|████      | 8/20 [09:29<12:31, 62.59s/it]Task 2, Epoch 9/20 => Loss 2.103, Loss_clf 0.183, Loss_fe 0.219, Loss_kd 1.134, Train_accy 86.83:  45%|████▌     | 9/20 [09:29<11:17, 61.58s/it]Task 2, Epoch 10/20 => Loss 2.115, Loss_clf 0.189, Loss_fe 0.223, Loss_kd 1.135, Train_accy 87.33:  45%|████▌     | 9/20 [10:28<11:17, 61.58s/it]Task 2, Epoch 10/20 => Loss 2.115, Loss_clf 0.189, Loss_fe 0.223, Loss_kd 1.135, Train_accy 87.33:  50%|█████     | 10/20 [10:28<10:08, 60.88s/it]Task 2, Epoch 11/20 => Loss 2.098, Loss_clf 0.187, Loss_fe 0.202, Loss_kd 1.140, Train_accy 87.48, Test_accy 95.57:  50%|█████     | 10/20 [11:46<10:08, 60.88s/it]Task 2, Epoch 11/20 => Loss 2.098, Loss_clf 0.187, Loss_fe 0.202, Loss_kd 1.140, Train_accy 87.48, Test_accy 95.57:  55%|█████▌    | 11/20 [11:46<09:52, 65.87s/it]Task 2, Epoch 12/20 => Loss 2.084, Loss_clf 0.176, Loss_fe 0.192, Loss_kd 1.144, Train_accy 88.02:  55%|█████▌    | 11/20 [12:45<09:52, 65.87s/it]                 Task 2, Epoch 12/20 => Loss 2.084, Loss_clf 0.176, Loss_fe 0.192, Loss_kd 1.144, Train_accy 88.02:  60%|██████    | 12/20 [12:45<08:31, 63.89s/it]Task 2, Epoch 13/20 => Loss 2.078, Loss_clf 0.184, Loss_fe 0.189, Loss_kd 1.137, Train_accy 88.04:  60%|██████    | 12/20 [13:44<08:31, 63.89s/it]Task 2, Epoch 13/20 => Loss 2.078, Loss_clf 0.184, Loss_fe 0.189, Loss_kd 1.137, Train_accy 88.04:  65%|██████▌   | 13/20 [13:44<07:17, 62.51s/it]Task 2, Epoch 14/20 => Loss 2.024, Loss_clf 0.157, Loss_fe 0.166, Loss_kd 1.134, Train_accy 88.74:  65%|██████▌   | 13/20 [14:44<07:17, 62.51s/it]Task 2, Epoch 14/20 => Loss 2.024, Loss_clf 0.157, Loss_fe 0.166, Loss_kd 1.134, Train_accy 88.74:  70%|███████   | 14/20 [14:44<06:09, 61.54s/it]Task 2, Epoch 15/20 => Loss 2.045, Loss_clf 0.170, Loss_fe 0.176, Loss_kd 1.133, Train_accy 87.89:  70%|███████   | 14/20 [15:43<06:09, 61.54s/it]Task 2, Epoch 15/20 => Loss 2.045, Loss_clf 0.170, Loss_fe 0.176, Loss_kd 1.133, Train_accy 87.89:  75%|███████▌  | 15/20 [15:43<05:04, 60.91s/it]Task 2, Epoch 16/20 => Loss 2.000, Loss_clf 0.145, Loss_fe 0.148, Loss_kd 1.138, Train_accy 89.20, Test_accy 95.20:  75%|███████▌  | 15/20 [17:00<05:04, 60.91s/it]Task 2, Epoch 16/20 => Loss 2.000, Loss_clf 0.145, Loss_fe 0.148, Loss_kd 1.138, Train_accy 89.20, Test_accy 95.20:  80%|████████  | 16/20 [17:00<04:23, 65.82s/it]Task 2, Epoch 17/20 => Loss 1.962, Loss_clf 0.137, Loss_fe 0.131, Loss_kd 1.129, Train_accy 89.26:  80%|████████  | 16/20 [18:00<04:23, 65.82s/it]                 Task 2, Epoch 17/20 => Loss 1.962, Loss_clf 0.137, Loss_fe 0.131, Loss_kd 1.129, Train_accy 89.26:  85%|████████▌ | 17/20 [18:00<03:11, 63.90s/it]Task 2, Epoch 18/20 => Loss 1.963, Loss_clf 0.133, Loss_fe 0.132, Loss_kd 1.132, Train_accy 89.56:  85%|████████▌ | 17/20 [18:59<03:11, 63.90s/it]Task 2, Epoch 18/20 => Loss 1.963, Loss_clf 0.133, Loss_fe 0.132, Loss_kd 1.132, Train_accy 89.56:  90%|█████████ | 18/20 [18:59<02:05, 62.56s/it]Task 2, Epoch 19/20 => Loss 2.007, Loss_clf 0.151, Loss_fe 0.148, Loss_kd 1.138, Train_accy 89.43:  90%|█████████ | 18/20 [19:59<02:05, 62.56s/it]Task 2, Epoch 19/20 => Loss 2.007, Loss_clf 0.151, Loss_fe 0.148, Loss_kd 1.138, Train_accy 89.43:  95%|█████████▌| 19/20 [19:59<01:01, 61.64s/it]Task 2, Epoch 20/20 => Loss 1.971, Loss_clf 0.136, Loss_fe 0.131, Loss_kd 1.136, Train_accy 89.87:  95%|█████████▌| 19/20 [20:58<01:01, 61.64s/it]Task 2, Epoch 20/20 => Loss 1.971, Loss_clf 0.136, Loss_fe 0.131, Loss_kd 1.136, Train_accy 89.87: 100%|██████████| 20/20 [20:58<00:00, 60.99s/it]Task 2, Epoch 20/20 => Loss 1.971, Loss_clf 0.136, Loss_fe 0.131, Loss_kd 1.136, Train_accy 89.87: 100%|██████████| 20/20 [20:58<00:00, 62.93s/it]2023-11-22 17:42:47,785 [foster.py] => Task 2, Epoch 20/20 => Loss 1.971, Loss_clf 0.136, Loss_fe 0.131, Loss_kd 1.136, Train_accy 89.87
2023-11-22 17:42:47,787 [foster.py] => do not weight align teacher!
2023-11-22 17:42:47,790 [foster.py] => per cls weights : [1.2213961  1.2213961  1.2213961  1.2213961  1.2213961  1.2213961
 1.2213961  1.2213961  1.2213961  1.2213961  1.2213961  1.2213961
 1.2213961  1.2213961  1.2213961  1.2213961  1.2213961  1.2213961
 1.2213961  1.2213961  0.55720781 0.55720781 0.55720781 0.55720781
 0.55720781 0.55720781 0.55720781 0.55720781 0.55720781 0.55720781]

  0%|          | 0/20 [00:00<?, ?it/s]SNet: Task 2, Epoch 1/20 => Loss 1.375,  Train_accy 71.63, Test_accy 92.93:   0%|          | 0/20 [01:23<?, ?it/s]SNet: Task 2, Epoch 1/20 => Loss 1.375,  Train_accy 71.63, Test_accy 92.93:   5%|▌         | 1/20 [01:23<26:29, 83.65s/it]SNet: Task 2, Epoch 2/20 => Loss 1.185,  Train_accy 77.85:   5%|▌         | 1/20 [02:37<26:29, 83.65s/it]                 SNet: Task 2, Epoch 2/20 => Loss 1.185,  Train_accy 77.85:  10%|█         | 2/20 [02:37<23:20, 77.81s/it]SNet: Task 2, Epoch 3/20 => Loss 1.190,  Train_accy 78.59:  10%|█         | 2/20 [03:51<23:20, 77.81s/it]SNet: Task 2, Epoch 3/20 => Loss 1.190,  Train_accy 78.59:  15%|█▌        | 3/20 [03:51<21:31, 75.94s/it]SNet: Task 2, Epoch 4/20 => Loss 1.184,  Train_accy 78.63:  15%|█▌        | 3/20 [05:04<21:31, 75.94s/it]SNet: Task 2, Epoch 4/20 => Loss 1.184,  Train_accy 78.63:  20%|██        | 4/20 [05:04<20:01, 75.08s/it]SNet: Task 2, Epoch 5/20 => Loss 1.182,  Train_accy 78.83:  20%|██        | 4/20 [06:18<20:01, 75.08s/it]SNet: Task 2, Epoch 5/20 => Loss 1.182,  Train_accy 78.83:  25%|██▌       | 5/20 [06:18<18:39, 74.65s/it]SNet: Task 2, Epoch 6/20 => Loss 1.161,  Train_accy 78.74, Test_accy 92.83:  25%|██▌       | 5/20 [07:42<18:39, 74.65s/it]SNet: Task 2, Epoch 6/20 => Loss 1.161,  Train_accy 78.74, Test_accy 92.83:  30%|███       | 6/20 [07:42<18:07, 77.65s/it]SNet: Task 2, Epoch 7/20 => Loss 1.160,  Train_accy 78.87:  30%|███       | 6/20 [08:55<18:07, 77.65s/it]                 SNet: Task 2, Epoch 7/20 => Loss 1.160,  Train_accy 78.87:  35%|███▌      | 7/20 [08:55<16:32, 76.34s/it]SNet: Task 2, Epoch 8/20 => Loss 1.163,  Train_accy 79.22:  35%|███▌      | 7/20 [10:09<16:32, 76.34s/it]SNet: Task 2, Epoch 8/20 => Loss 1.163,  Train_accy 79.22:  40%|████      | 8/20 [10:09<15:06, 75.54s/it]SNet: Task 2, Epoch 9/20 => Loss 1.176,  Train_accy 79.65:  40%|████      | 8/20 [11:23<15:06, 75.54s/it]SNet: Task 2, Epoch 9/20 => Loss 1.176,  Train_accy 79.65:  45%|████▌     | 9/20 [11:23<13:45, 75.00s/it]SNet: Task 2, Epoch 10/20 => Loss 1.189,  Train_accy 78.50:  45%|████▌     | 9/20 [12:37<13:45, 75.00s/it]SNet: Task 2, Epoch 10/20 => Loss 1.189,  Train_accy 78.50:  50%|█████     | 10/20 [12:37<12:26, 74.65s/it]SNet: Task 2, Epoch 11/20 => Loss 1.180,  Train_accy 78.74, Test_accy 92.60:  50%|█████     | 10/20 [14:00<12:26, 74.65s/it]SNet: Task 2, Epoch 11/20 => Loss 1.180,  Train_accy 78.74, Test_accy 92.60:  55%|█████▌    | 11/20 [14:00<11:36, 77.35s/it]SNet: Task 2, Epoch 12/20 => Loss 1.176,  Train_accy 78.98:  55%|█████▌    | 11/20 [15:14<11:36, 77.35s/it]                 SNet: Task 2, Epoch 12/20 => Loss 1.176,  Train_accy 78.98:  60%|██████    | 12/20 [15:14<10:10, 76.28s/it]SNet: Task 2, Epoch 13/20 => Loss 1.181,  Train_accy 78.17:  60%|██████    | 12/20 [16:28<10:10, 76.28s/it]SNet: Task 2, Epoch 13/20 => Loss 1.181,  Train_accy 78.17:  65%|██████▌   | 13/20 [16:28<08:48, 75.54s/it]SNet: Task 2, Epoch 14/20 => Loss 1.160,  Train_accy 79.44:  65%|██████▌   | 13/20 [17:42<08:48, 75.54s/it]SNet: Task 2, Epoch 14/20 => Loss 1.160,  Train_accy 79.44:  70%|███████   | 14/20 [17:42<07:30, 75.04s/it]SNet: Task 2, Epoch 15/20 => Loss 1.161,  Train_accy 79.94:  70%|███████   | 14/20 [18:56<07:30, 75.04s/it]SNet: Task 2, Epoch 15/20 => Loss 1.161,  Train_accy 79.94:  75%|███████▌  | 15/20 [18:56<06:13, 74.73s/it]SNet: Task 2, Epoch 16/20 => Loss 1.173,  Train_accy 79.74, Test_accy 92.33:  75%|███████▌  | 15/20 [20:19<06:13, 74.73s/it]SNet: Task 2, Epoch 16/20 => Loss 1.173,  Train_accy 79.74, Test_accy 92.33:  80%|████████  | 16/20 [20:19<05:09, 77.38s/it]SNet: Task 2, Epoch 17/20 => Loss 1.162,  Train_accy 79.20:  80%|████████  | 16/20 [21:33<05:09, 77.38s/it]                 SNet: Task 2, Epoch 17/20 => Loss 1.162,  Train_accy 79.20:  85%|████████▌ | 17/20 [21:33<03:48, 76.30s/it]SNet: Task 2, Epoch 18/20 => Loss 1.170,  Train_accy 79.24:  85%|████████▌ | 17/20 [22:47<03:48, 76.30s/it]SNet: Task 2, Epoch 18/20 => Loss 1.170,  Train_accy 79.24:  90%|█████████ | 18/20 [22:47<02:31, 75.57s/it]SNet: Task 2, Epoch 19/20 => Loss 1.174,  Train_accy 79.15:  90%|█████████ | 18/20 [24:01<02:31, 75.57s/it]SNet: Task 2, Epoch 19/20 => Loss 1.174,  Train_accy 79.15:  95%|█████████▌| 19/20 [24:01<01:15, 75.07s/it]SNet: Task 2, Epoch 20/20 => Loss 1.183,  Train_accy 78.67:  95%|█████████▌| 19/20 [25:15<01:15, 75.07s/it]SNet: Task 2, Epoch 20/20 => Loss 1.183,  Train_accy 78.67: 100%|██████████| 20/20 [25:15<00:00, 74.70s/it]SNet: Task 2, Epoch 20/20 => Loss 1.183,  Train_accy 78.67: 100%|██████████| 20/20 [25:15<00:00, 75.77s/it]2023-11-22 18:08:06,182 [foster.py] => SNet: Task 2, Epoch 20/20 => Loss 1.183,  Train_accy 78.67
2023-11-22 18:08:06,183 [foster.py] => do not weight align student!

2023-11-22 18:08:15,958 [foster.py] => darknet eval: 
2023-11-22 18:08:15,959 [foster.py] => CNN top1 curve: 92.43
2023-11-22 18:08:15,959 [foster.py] => CNN top5 curve: 99.77
2023-11-22 18:08:15,960 [base.py] => Constructing exemplars for new classes...(20 per classes)
2023-11-22 18:09:43,087 [foster.py] => Exemplar size: 600
2023-11-22 18:09:43,087 [trainer.py] => CNN: {'total': 95.1, '00-09': 97.9, '10-19': 95.1, '20-29': 92.3, 'old': 96.5, 'new': 92.3}
2023-11-22 18:09:43,087 [trainer.py] => NME: {'total': 95.7, '00-09': 95.5, '10-19': 93.5, '20-29': 98.1, 'old': 94.5, 'new': 98.1}
2023-11-22 18:09:43,087 [trainer.py] => CNN top1 curve: [99.3, 96.8, 95.1]
2023-11-22 18:09:43,087 [trainer.py] => CNN top5 curve: [100.0, 99.75, 99.6]
2023-11-22 18:09:43,087 [trainer.py] => NME top1 curve: [99.3, 96.55, 95.7]
2023-11-22 18:09:43,087 [trainer.py] => NME top5 curve: [100.0, 99.85, 99.6]

Average Accuracy (CNN): 97.06666666666666
Average Accuracy (NME): 97.18333333333334
2023-11-22 18:09:43,087 [trainer.py] => Average Accuracy (CNN): 97.06666666666666
2023-11-22 18:09:43,087 [trainer.py] => Average Accuracy (NME): 97.18333333333334
2023-11-22 18:09:43,089 [trainer.py] => All params: 171681872
2023-11-22 18:09:43,090 [trainer.py] => Trainable params: 85867836
2023-11-22 18:09:46,229 [foster.py] => Learning on 30-40
2023-11-22 18:09:46,231 [foster.py] => All params: 171712622
2023-11-22 18:09:46,232 [foster.py] => Trainable params: 85890896
2023-11-22 18:09:46,352 [foster.py] => per cls weights : [1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786 1.12422786
 0.62731641 0.62731641 0.62731641 0.62731641 0.62731641 0.62731641
 0.62731641 0.62731641 0.62731641 0.62731641]
  0%|          | 0/20 [00:00<?, ?it/s]Task 3, Epoch 1/20 => Loss 3.535, Loss_clf 0.727, Loss_fe 1.023, Loss_kd 1.339, Train_accy 61.48, Test_accy 88.92:   0%|          | 0/20 [01:25<?, ?it/s]Task 3, Epoch 1/20 => Loss 3.535, Loss_clf 0.727, Loss_fe 1.023, Loss_kd 1.339, Train_accy 61.48, Test_accy 88.92:   5%|▌         | 1/20 [01:25<26:58, 85.16s/it]Task 3, Epoch 2/20 => Loss 2.826, Loss_clf 0.425, Loss_fe 0.621, Loss_kd 1.336, Train_accy 64.96:   5%|▌         | 1/20 [02:26<26:58, 85.16s/it]                 Task 3, Epoch 2/20 => Loss 2.826, Loss_clf 0.425, Loss_fe 0.621, Loss_kd 1.336, Train_accy 64.96:  10%|█         | 2/20 [02:26<21:23, 71.29s/it]Task 3, Epoch 3/20 => Loss 2.673, Loss_clf 0.381, Loss_fe 0.513, Loss_kd 1.334, Train_accy 69.04:  10%|█         | 2/20 [03:28<21:23, 71.29s/it]Task 3, Epoch 3/20 => Loss 2.673, Loss_clf 0.381, Loss_fe 0.513, Loss_kd 1.334, Train_accy 69.04:  15%|█▌        | 3/20 [03:28<18:56, 66.86s/it]Task 3, Epoch 4/20 => Loss 2.538, Loss_clf 0.341, Loss_fe 0.434, Loss_kd 1.323, Train_accy 71.48:  15%|█▌        | 3/20 [04:29<18:56, 66.86s/it]Task 3, Epoch 4/20 => Loss 2.538, Loss_clf 0.341, Loss_fe 0.434, Loss_kd 1.323, Train_accy 71.48:  20%|██        | 4/20 [04:29<17:15, 64.75s/it]Task 3, Epoch 5/20 => Loss 2.490, Loss_clf 0.306, Loss_fe 0.406, Loss_kd 1.334, Train_accy 72.59:  20%|██        | 4/20 [05:31<17:15, 64.75s/it]Task 3, Epoch 5/20 => Loss 2.490, Loss_clf 0.306, Loss_fe 0.406, Loss_kd 1.334, Train_accy 72.59:  25%|██▌       | 5/20 [05:31<15:53, 63.58s/it]Task 3, Epoch 6/20 => Loss 2.428, Loss_clf 0.297, Loss_fe 0.365, Loss_kd 1.325, Train_accy 73.32, Test_accy 90.58:  25%|██▌       | 5/20 [06:56<15:53, 63.58s/it]Task 3, Epoch 6/20 => Loss 2.428, Loss_clf 0.297, Loss_fe 0.365, Loss_kd 1.325, Train_accy 73.32, Test_accy 90.58:  30%|███       | 6/20 [06:56<16:33, 70.98s/it]Task 3, Epoch 7/20 => Loss 2.348, Loss_clf 0.263, Loss_fe 0.316, Loss_kd 1.327, Train_accy 76.14:  30%|███       | 6/20 [07:58<16:33, 70.98s/it]                 Task 3, Epoch 7/20 => Loss 2.348, Loss_clf 0.263, Loss_fe 0.316, Loss_kd 1.327, Train_accy 76.14:  35%|███▌      | 7/20 [07:58<14:42, 67.91s/it]Task 3, Epoch 8/20 => Loss 2.338, Loss_clf 0.263, Loss_fe 0.318, Loss_kd 1.317, Train_accy 76.50:  35%|███▌      | 7/20 [08:59<14:42, 67.91s/it]Task 3, Epoch 8/20 => Loss 2.338, Loss_clf 0.263, Loss_fe 0.318, Loss_kd 1.317, Train_accy 76.50:  40%|████      | 8/20 [08:59<13:10, 65.88s/it]Task 3, Epoch 9/20 => Loss 2.273, Loss_clf 0.250, Loss_fe 0.280, Loss_kd 1.307, Train_accy 78.02:  40%|████      | 8/20 [10:01<13:10, 65.88s/it]Task 3, Epoch 9/20 => Loss 2.273, Loss_clf 0.250, Loss_fe 0.280, Loss_kd 1.307, Train_accy 78.02:  45%|████▌     | 9/20 [10:01<11:49, 64.49s/it]Task 3, Epoch 10/20 => Loss 2.280, Loss_clf 0.244, Loss_fe 0.266, Loss_kd 1.328, Train_accy 78.50:  45%|████▌     | 9/20 [11:02<11:49, 64.49s/it]Task 3, Epoch 10/20 => Loss 2.280, Loss_clf 0.244, Loss_fe 0.266, Loss_kd 1.328, Train_accy 78.50:  50%|█████     | 10/20 [11:02<10:35, 63.58s/it]Task 3, Epoch 11/20 => Loss 2.240, Loss_clf 0.220, Loss_fe 0.243, Loss_kd 1.333, Train_accy 80.29, Test_accy 92.02:  50%|█████     | 10/20 [12:28<10:35, 63.58s/it]Task 3, Epoch 11/20 => Loss 2.240, Loss_clf 0.220, Loss_fe 0.243, Loss_kd 1.333, Train_accy 80.29, Test_accy 92.02:  55%|█████▌    | 11/20 [12:28<10:32, 70.25s/it]Task 3, Epoch 12/20 => Loss 2.214, Loss_clf 0.216, Loss_fe 0.229, Loss_kd 1.326, Train_accy 81.41:  55%|█████▌    | 11/20 [13:29<10:32, 70.25s/it]                 Task 3, Epoch 12/20 => Loss 2.214, Loss_clf 0.216, Loss_fe 0.229, Loss_kd 1.326, Train_accy 81.41:  60%|██████    | 12/20 [13:29<09:00, 67.60s/it]Task 3, Epoch 13/20 => Loss 2.159, Loss_clf 0.197, Loss_fe 0.203, Loss_kd 1.319, Train_accy 82.30:  60%|██████    | 12/20 [14:31<09:00, 67.60s/it]Task 3, Epoch 13/20 => Loss 2.159, Loss_clf 0.197, Loss_fe 0.203, Loss_kd 1.319, Train_accy 82.30:  65%|██████▌   | 13/20 [14:31<07:40, 65.74s/it]Task 3, Epoch 14/20 => Loss 2.205, Loss_clf 0.220, Loss_fe 0.219, Loss_kd 1.325, Train_accy 81.38:  65%|██████▌   | 13/20 [15:32<07:40, 65.74s/it]Task 3, Epoch 14/20 => Loss 2.205, Loss_clf 0.220, Loss_fe 0.219, Loss_kd 1.325, Train_accy 81.38:  70%|███████   | 14/20 [15:32<06:26, 64.45s/it]Task 3, Epoch 15/20 => Loss 2.130, Loss_clf 0.191, Loss_fe 0.187, Loss_kd 1.314, Train_accy 82.36:  70%|███████   | 14/20 [16:34<06:26, 64.45s/it]Task 3, Epoch 15/20 => Loss 2.130, Loss_clf 0.191, Loss_fe 0.187, Loss_kd 1.314, Train_accy 82.36:  75%|███████▌  | 15/20 [16:34<05:17, 63.55s/it]Task 3, Epoch 16/20 => Loss 2.124, Loss_clf 0.187, Loss_fe 0.175, Loss_kd 1.321, Train_accy 83.52, Test_accy 92.48:  75%|███████▌  | 15/20 [17:59<05:17, 63.55s/it]Task 3, Epoch 16/20 => Loss 2.124, Loss_clf 0.187, Loss_fe 0.175, Loss_kd 1.321, Train_accy 83.52, Test_accy 92.48:  80%|████████  | 16/20 [17:59<04:39, 69.98s/it]Task 3, Epoch 17/20 => Loss 2.081, Loss_clf 0.166, Loss_fe 0.158, Loss_kd 1.317, Train_accy 85.07:  80%|████████  | 16/20 [19:00<04:39, 69.98s/it]                 Task 3, Epoch 17/20 => Loss 2.081, Loss_clf 0.166, Loss_fe 0.158, Loss_kd 1.317, Train_accy 85.07:  85%|████████▌ | 17/20 [19:00<03:22, 67.43s/it]Task 3, Epoch 18/20 => Loss 2.112, Loss_clf 0.180, Loss_fe 0.172, Loss_kd 1.320, Train_accy 83.54:  85%|████████▌ | 17/20 [20:02<03:22, 67.43s/it]Task 3, Epoch 18/20 => Loss 2.112, Loss_clf 0.180, Loss_fe 0.172, Loss_kd 1.320, Train_accy 83.54:  90%|█████████ | 18/20 [20:02<02:11, 65.66s/it]Task 3, Epoch 19/20 => Loss 2.086, Loss_clf 0.173, Loss_fe 0.159, Loss_kd 1.316, Train_accy 84.09:  90%|█████████ | 18/20 [21:03<02:11, 65.66s/it]Task 3, Epoch 19/20 => Loss 2.086, Loss_clf 0.173, Loss_fe 0.159, Loss_kd 1.316, Train_accy 84.09:  95%|█████████▌| 19/20 [21:03<01:04, 64.41s/it]Task 3, Epoch 20/20 => Loss 2.082, Loss_clf 0.171, Loss_fe 0.155, Loss_kd 1.316, Train_accy 84.43:  95%|█████████▌| 19/20 [22:05<01:04, 64.41s/it]Task 3, Epoch 20/20 => Loss 2.082, Loss_clf 0.171, Loss_fe 0.155, Loss_kd 1.316, Train_accy 84.43: 100%|██████████| 20/20 [22:05<00:00, 63.54s/it]Task 3, Epoch 20/20 => Loss 2.082, Loss_clf 0.171, Loss_fe 0.155, Loss_kd 1.316, Train_accy 84.43: 100%|██████████| 20/20 [22:05<00:00, 66.25s/it]2023-11-22 18:31:51,407 [foster.py] => Task 3, Epoch 20/20 => Loss 2.082, Loss_clf 0.171, Loss_fe 0.155, Loss_kd 1.316, Train_accy 84.43
2023-11-22 18:31:51,408 [foster.py] => do not weight align teacher!
2023-11-22 18:31:51,410 [foster.py] => per cls weights : [1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854 1.15733854
 0.52798439 0.52798439 0.52798439 0.52798439 0.52798439 0.52798439
 0.52798439 0.52798439 0.52798439 0.52798439]

  0%|          | 0/20 [00:00<?, ?it/s]SNet: Task 3, Epoch 1/20 => Loss 1.679,  Train_accy 61.18, Test_accy 89.85:   0%|          | 0/20 [01:28<?, ?it/s]SNet: Task 3, Epoch 1/20 => Loss 1.679,  Train_accy 61.18, Test_accy 89.85:   5%|▌         | 1/20 [01:28<28:10, 89.00s/it]SNet: Task 3, Epoch 2/20 => Loss 1.475,  Train_accy 69.04:   5%|▌         | 1/20 [02:45<28:10, 89.00s/it]                 SNet: Task 3, Epoch 2/20 => Loss 1.475,  Train_accy 69.04:  10%|█         | 2/20 [02:45<24:28, 81.60s/it]SNet: Task 3, Epoch 3/20 => Loss 1.477,  Train_accy 69.62:  10%|█         | 2/20 [04:01<24:28, 81.60s/it]SNet: Task 3, Epoch 3/20 => Loss 1.477,  Train_accy 69.62:  15%|█▌        | 3/20 [04:01<22:27, 79.29s/it]SNet: Task 3, Epoch 4/20 => Loss 1.453,  Train_accy 70.27:  15%|█▌        | 3/20 [05:18<22:27, 79.29s/it]SNet: Task 3, Epoch 4/20 => Loss 1.453,  Train_accy 70.27:  20%|██        | 4/20 [05:18<20:51, 78.19s/it]SNet: Task 3, Epoch 5/20 => Loss 1.439,  Train_accy 70.73:  20%|██        | 4/20 [06:35<20:51, 78.19s/it]SNet: Task 3, Epoch 5/20 => Loss 1.439,  Train_accy 70.73:  25%|██▌       | 5/20 [06:35<19:24, 77.62s/it]SNet: Task 3, Epoch 6/20 => Loss 1.442,  Train_accy 70.54, Test_accy 90.40:  25%|██▌       | 5/20 [08:03<19:24, 77.62s/it]SNet: Task 3, Epoch 6/20 => Loss 1.442,  Train_accy 70.54, Test_accy 90.40:  30%|███       | 6/20 [08:03<19:00, 81.44s/it]SNet: Task 3, Epoch 7/20 => Loss 1.442,  Train_accy 70.66:  30%|███       | 6/20 [09:20<19:00, 81.44s/it]                 SNet: Task 3, Epoch 7/20 => Loss 1.442,  Train_accy 70.66:  35%|███▌      | 7/20 [09:20<17:17, 79.80s/it]SNet: Task 3, Epoch 8/20 => Loss 1.436,  Train_accy 70.57:  35%|███▌      | 7/20 [10:36<17:17, 79.80s/it]SNet: Task 3, Epoch 8/20 => Loss 1.436,  Train_accy 70.57:  40%|████      | 8/20 [10:36<15:44, 78.74s/it]SNet: Task 3, Epoch 9/20 => Loss 1.439,  Train_accy 71.70:  40%|████      | 8/20 [11:53<15:44, 78.74s/it]SNet: Task 3, Epoch 9/20 => Loss 1.439,  Train_accy 71.70:  45%|████▌     | 9/20 [11:53<14:19, 78.13s/it]SNet: Task 3, Epoch 10/20 => Loss 1.444,  Train_accy 71.77:  45%|████▌     | 9/20 [13:10<14:19, 78.13s/it]SNet: Task 3, Epoch 10/20 => Loss 1.444,  Train_accy 71.77:  50%|█████     | 10/20 [13:10<12:56, 77.67s/it]SNet: Task 3, Epoch 11/20 => Loss 1.429,  Train_accy 71.62, Test_accy 90.52:  50%|█████     | 10/20 [14:39<12:56, 77.67s/it]SNet: Task 3, Epoch 11/20 => Loss 1.429,  Train_accy 71.62, Test_accy 90.52:  55%|█████▌    | 11/20 [14:39<12:10, 81.15s/it]SNet: Task 3, Epoch 12/20 => Loss 1.434,  Train_accy 72.09:  55%|█████▌    | 11/20 [15:55<12:10, 81.15s/it]                 SNet: Task 3, Epoch 12/20 => Loss 1.434,  Train_accy 72.09:  60%|██████    | 12/20 [15:55<10:38, 79.75s/it]SNet: Task 3, Epoch 13/20 => Loss 1.428,  Train_accy 71.43:  60%|██████    | 12/20 [17:12<10:38, 79.75s/it]SNet: Task 3, Epoch 13/20 => Loss 1.428,  Train_accy 71.43:  65%|██████▌   | 13/20 [17:12<09:11, 78.83s/it]SNet: Task 3, Epoch 14/20 => Loss 1.435,  Train_accy 71.71:  65%|██████▌   | 13/20 [18:29<09:11, 78.83s/it]SNet: Task 3, Epoch 14/20 => Loss 1.435,  Train_accy 71.71:  70%|███████   | 14/20 [18:29<07:48, 78.14s/it]SNet: Task 3, Epoch 15/20 => Loss 1.436,  Train_accy 71.98:  70%|███████   | 14/20 [19:45<07:48, 78.14s/it]SNet: Task 3, Epoch 15/20 => Loss 1.436,  Train_accy 71.98:  75%|███████▌  | 15/20 [19:45<06:28, 77.67s/it]SNet: Task 3, Epoch 16/20 => Loss 1.426,  Train_accy 71.38, Test_accy 90.62:  75%|███████▌  | 15/20 [21:14<06:28, 77.67s/it]SNet: Task 3, Epoch 16/20 => Loss 1.426,  Train_accy 71.38, Test_accy 90.62:  80%|████████  | 16/20 [21:14<05:24, 81.10s/it]SNet: Task 3, Epoch 17/20 => Loss 1.426,  Train_accy 72.02:  80%|████████  | 16/20 [22:31<05:24, 81.10s/it]                 SNet: Task 3, Epoch 17/20 => Loss 1.426,  Train_accy 72.02:  85%|████████▌ | 17/20 [22:31<03:59, 79.70s/it]SNet: Task 3, Epoch 18/20 => Loss 1.444,  Train_accy 71.54:  85%|████████▌ | 17/20 [23:47<03:59, 79.70s/it]SNet: Task 3, Epoch 18/20 => Loss 1.444,  Train_accy 71.54:  90%|█████████ | 18/20 [23:47<02:37, 78.73s/it]SNet: Task 3, Epoch 19/20 => Loss 1.425,  Train_accy 72.55:  90%|█████████ | 18/20 [25:04<02:37, 78.73s/it]SNet: Task 3, Epoch 19/20 => Loss 1.425,  Train_accy 72.55:  95%|█████████▌| 19/20 [25:04<01:18, 78.06s/it]SNet: Task 3, Epoch 20/20 => Loss 1.430,  Train_accy 71.32:  95%|█████████▌| 19/20 [26:20<01:18, 78.06s/it]SNet: Task 3, Epoch 20/20 => Loss 1.430,  Train_accy 71.32: 100%|██████████| 20/20 [26:20<00:00, 77.59s/it]SNet: Task 3, Epoch 20/20 => Loss 1.430,  Train_accy 71.32: 100%|██████████| 20/20 [26:20<00:00, 79.03s/it]2023-11-22 18:58:14,340 [foster.py] => SNet: Task 3, Epoch 20/20 => Loss 1.430,  Train_accy 71.32
2023-11-22 18:58:14,340 [foster.py] => do not weight align student!

2023-11-22 18:58:26,905 [foster.py] => darknet eval: 
2023-11-22 18:58:26,906 [foster.py] => CNN top1 curve: 90.38
2023-11-22 18:58:26,906 [foster.py] => CNN top5 curve: 99.7
2023-11-22 18:58:26,908 [base.py] => Constructing exemplars for new classes...(20 per classes)
2023-11-22 19:00:08,441 [foster.py] => Exemplar size: 800
2023-11-22 19:00:08,441 [trainer.py] => CNN: {'total': 92.2, '00-09': 96.9, '10-19': 95.4, '20-29': 92.5, '30-39': 84.0, 'old': 94.93, 'new': 84.0}
2023-11-22 19:00:08,441 [trainer.py] => NME: {'total': 94.12, '00-09': 93.6, '10-19': 92.6, '20-29': 94.6, '30-39': 95.7, 'old': 93.6, 'new': 95.7}
2023-11-22 19:00:08,441 [trainer.py] => CNN top1 curve: [99.3, 96.8, 95.1, 92.2]
2023-11-22 19:00:08,441 [trainer.py] => CNN top5 curve: [100.0, 99.75, 99.6, 99.6]
2023-11-22 19:00:08,441 [trainer.py] => NME top1 curve: [99.3, 96.55, 95.7, 94.12]
2023-11-22 19:00:08,441 [trainer.py] => NME top5 curve: [100.0, 99.85, 99.6, 99.48]

Average Accuracy (CNN): 95.85
Average Accuracy (NME): 96.4175
2023-11-22 19:00:08,441 [trainer.py] => Average Accuracy (CNN): 95.85
2023-11-22 19:00:08,441 [trainer.py] => Average Accuracy (NME): 96.4175
2023-11-22 19:00:08,443 [trainer.py] => All params: 171712622
2023-11-22 19:00:08,444 [trainer.py] => Trainable params: 85890896
2023-11-22 19:00:10,115 [foster.py] => Learning on 40-50
2023-11-22 19:00:10,117 [foster.py] => All params: 171743372
2023-11-22 19:00:10,118 [foster.py] => Trainable params: 85913956
2023-11-22 19:00:10,216 [foster.py] => per cls weights : [1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294 1.09697294
 1.09697294 1.09697294 1.09697294 1.09697294 0.61210823 0.61210823
 0.61210823 0.61210823 0.61210823 0.61210823 0.61210823 0.61210823
 0.61210823 0.61210823]
  0%|          | 0/20 [00:00<?, ?it/s]Task 4, Epoch 1/20 => Loss 3.595, Loss_clf 0.610, Loss_fe 1.084, Loss_kd 1.521, Train_accy 60.29, Test_accy 87.92:   0%|          | 0/20 [01:32<?, ?it/s]Task 4, Epoch 1/20 => Loss 3.595, Loss_clf 0.610, Loss_fe 1.084, Loss_kd 1.521, Train_accy 60.29, Test_accy 87.92:   5%|▌         | 1/20 [01:32<29:19, 92.59s/it]Task 4, Epoch 2/20 => Loss 2.861, Loss_clf 0.372, Loss_fe 0.575, Loss_kd 1.532, Train_accy 65.29:   5%|▌         | 1/20 [02:36<29:19, 92.59s/it]                 Task 4, Epoch 2/20 => Loss 2.861, Loss_clf 0.372, Loss_fe 0.575, Loss_kd 1.532, Train_accy 65.29:  10%|█         | 2/20 [02:36<22:39, 75.52s/it]Task 4, Epoch 3/20 => Loss 2.687, Loss_clf 0.331, Loss_fe 0.463, Loss_kd 1.515, Train_accy 67.78:  10%|█         | 2/20 [03:39<22:39, 75.52s/it]Task 4, Epoch 3/20 => Loss 2.687, Loss_clf 0.331, Loss_fe 0.463, Loss_kd 1.515, Train_accy 67.78:  15%|█▌        | 3/20 [03:39<19:52, 70.15s/it]Task 4, Epoch 4/20 => Loss 2.715, Loss_clf 0.332, Loss_fe 0.472, Loss_kd 1.529, Train_accy 68.40:  15%|█▌        | 3/20 [04:43<19:52, 70.15s/it]Task 4, Epoch 4/20 => Loss 2.715, Loss_clf 0.332, Loss_fe 0.472, Loss_kd 1.529, Train_accy 68.40:  20%|██        | 4/20 [04:43<18:01, 67.59s/it]Task 4, Epoch 5/20 => Loss 2.545, Loss_clf 0.281, Loss_fe 0.372, Loss_kd 1.514, Train_accy 72.66:  20%|██        | 4/20 [05:47<18:01, 67.59s/it]Task 4, Epoch 5/20 => Loss 2.545, Loss_clf 0.281, Loss_fe 0.372, Loss_kd 1.514, Train_accy 72.66:  25%|██▌       | 5/20 [05:47<16:33, 66.20s/it]Task 4, Epoch 6/20 => Loss 2.590, Loss_clf 0.290, Loss_fe 0.379, Loss_kd 1.537, Train_accy 72.60, Test_accy 90.52:  25%|██▌       | 5/20 [07:20<16:33, 66.20s/it]Task 4, Epoch 6/20 => Loss 2.590, Loss_clf 0.290, Loss_fe 0.379, Loss_kd 1.537, Train_accy 72.60, Test_accy 90.52:  30%|███       | 6/20 [07:20<17:32, 75.21s/it]Task 4, Epoch 7/20 => Loss 2.453, Loss_clf 0.249, Loss_fe 0.302, Loss_kd 1.521, Train_accy 74.57:  30%|███       | 6/20 [08:23<17:32, 75.21s/it]                 Task 4, Epoch 7/20 => Loss 2.453, Loss_clf 0.249, Loss_fe 0.302, Loss_kd 1.521, Train_accy 74.57:  35%|███▌      | 7/20 [08:23<15:28, 71.44s/it]Task 4, Epoch 8/20 => Loss 2.445, Loss_clf 0.244, Loss_fe 0.300, Loss_kd 1.521, Train_accy 74.69:  35%|███▌      | 7/20 [09:27<15:28, 71.44s/it]Task 4, Epoch 8/20 => Loss 2.445, Loss_clf 0.244, Loss_fe 0.300, Loss_kd 1.521, Train_accy 74.69:  40%|████      | 8/20 [09:27<13:47, 68.97s/it]Task 4, Epoch 9/20 => Loss 2.434, Loss_clf 0.249, Loss_fe 0.287, Loss_kd 1.519, Train_accy 76.41:  40%|████      | 8/20 [10:31<13:47, 68.97s/it]Task 4, Epoch 9/20 => Loss 2.434, Loss_clf 0.249, Loss_fe 0.287, Loss_kd 1.519, Train_accy 76.41:  45%|████▌     | 9/20 [10:31<12:20, 67.33s/it]Task 4, Epoch 10/20 => Loss 2.385, Loss_clf 0.231, Loss_fe 0.265, Loss_kd 1.511, Train_accy 76.81:  45%|████▌     | 9/20 [11:34<12:20, 67.33s/it]Task 4, Epoch 10/20 => Loss 2.385, Loss_clf 0.231, Loss_fe 0.265, Loss_kd 1.511, Train_accy 76.81:  50%|█████     | 10/20 [11:34<11:01, 66.17s/it]Task 4, Epoch 11/20 => Loss 2.378, Loss_clf 0.226, Loss_fe 0.247, Loss_kd 1.524, Train_accy 78.71, Test_accy 90.84:  50%|█████     | 10/20 [13:07<11:01, 66.17s/it]Task 4, Epoch 11/20 => Loss 2.378, Loss_clf 0.226, Loss_fe 0.247, Loss_kd 1.524, Train_accy 78.71, Test_accy 90.84:  55%|█████▌    | 11/20 [13:07<11:08, 74.32s/it]Task 4, Epoch 12/20 => Loss 2.358, Loss_clf 0.219, Loss_fe 0.236, Loss_kd 1.523, Train_accy 79.16:  55%|█████▌    | 11/20 [14:11<11:08, 74.32s/it]                 Task 4, Epoch 12/20 => Loss 2.358, Loss_clf 0.219, Loss_fe 0.236, Loss_kd 1.523, Train_accy 79.16:  60%|██████    | 12/20 [14:11<09:28, 71.07s/it]Task 4, Epoch 13/20 => Loss 2.329, Loss_clf 0.212, Loss_fe 0.213, Loss_kd 1.523, Train_accy 80.12:  60%|██████    | 12/20 [15:14<09:28, 71.07s/it]Task 4, Epoch 13/20 => Loss 2.329, Loss_clf 0.212, Loss_fe 0.213, Loss_kd 1.523, Train_accy 80.12:  65%|██████▌   | 13/20 [15:14<08:01, 68.80s/it]Task 4, Epoch 14/20 => Loss 2.284, Loss_clf 0.197, Loss_fe 0.197, Loss_kd 1.511, Train_accy 81.38:  65%|██████▌   | 13/20 [16:18<08:01, 68.80s/it]Task 4, Epoch 14/20 => Loss 2.284, Loss_clf 0.197, Loss_fe 0.197, Loss_kd 1.511, Train_accy 81.38:  70%|███████   | 14/20 [16:18<06:43, 67.20s/it]Task 4, Epoch 15/20 => Loss 2.275, Loss_clf 0.190, Loss_fe 0.194, Loss_kd 1.513, Train_accy 79.62:  70%|███████   | 14/20 [17:21<06:43, 67.20s/it]Task 4, Epoch 15/20 => Loss 2.275, Loss_clf 0.190, Loss_fe 0.194, Loss_kd 1.513, Train_accy 79.62:  75%|███████▌  | 15/20 [17:21<05:30, 66.13s/it]Task 4, Epoch 16/20 => Loss 2.309, Loss_clf 0.205, Loss_fe 0.203, Loss_kd 1.521, Train_accy 80.98, Test_accy 91.04:  75%|███████▌  | 15/20 [18:54<05:30, 66.13s/it]Task 4, Epoch 16/20 => Loss 2.309, Loss_clf 0.205, Loss_fe 0.203, Loss_kd 1.521, Train_accy 80.98, Test_accy 91.04:  80%|████████  | 16/20 [18:54<04:56, 74.09s/it]Task 4, Epoch 17/20 => Loss 2.255, Loss_clf 0.189, Loss_fe 0.177, Loss_kd 1.511, Train_accy 82.05:  80%|████████  | 16/20 [19:57<04:56, 74.09s/it]                 Task 4, Epoch 17/20 => Loss 2.255, Loss_clf 0.189, Loss_fe 0.177, Loss_kd 1.511, Train_accy 82.05:  85%|████████▌ | 17/20 [19:57<03:32, 70.90s/it]Task 4, Epoch 18/20 => Loss 2.219, Loss_clf 0.164, Loss_fe 0.154, Loss_kd 1.521, Train_accy 82.60:  85%|████████▌ | 17/20 [21:01<03:32, 70.90s/it]Task 4, Epoch 18/20 => Loss 2.219, Loss_clf 0.164, Loss_fe 0.154, Loss_kd 1.521, Train_accy 82.60:  90%|█████████ | 18/20 [21:01<02:17, 68.73s/it]Task 4, Epoch 19/20 => Loss 2.297, Loss_clf 0.196, Loss_fe 0.183, Loss_kd 1.534, Train_accy 82.14:  90%|█████████ | 18/20 [22:05<02:17, 68.73s/it]Task 4, Epoch 19/20 => Loss 2.297, Loss_clf 0.196, Loss_fe 0.183, Loss_kd 1.534, Train_accy 82.14:  95%|█████████▌| 19/20 [22:05<01:07, 67.31s/it]Task 4, Epoch 20/20 => Loss 2.237, Loss_clf 0.176, Loss_fe 0.164, Loss_kd 1.517, Train_accy 82.71:  95%|█████████▌| 19/20 [23:09<01:07, 67.31s/it]Task 4, Epoch 20/20 => Loss 2.237, Loss_clf 0.176, Loss_fe 0.164, Loss_kd 1.517, Train_accy 82.71: 100%|██████████| 20/20 [23:09<00:00, 66.32s/it]Task 4, Epoch 20/20 => Loss 2.237, Loss_clf 0.176, Loss_fe 0.164, Loss_kd 1.517, Train_accy 82.71: 100%|██████████| 20/20 [23:09<00:00, 69.48s/it]2023-11-22 19:23:19,788 [foster.py] => Task 4, Epoch 20/20 => Loss 2.237, Loss_clf 0.176, Loss_fe 0.164, Loss_kd 1.517, Train_accy 82.71
2023-11-22 19:23:19,789 [foster.py] => do not weight align teacher!
2023-11-22 19:23:19,793 [foster.py] => per cls weights : [1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308
 1.1220308 1.1220308 1.1220308 1.1220308 1.1220308 0.5118768 0.5118768
 0.5118768 0.5118768 0.5118768 0.5118768 0.5118768 0.5118768 0.5118768
 0.5118768]

  0%|          | 0/20 [00:00<?, ?it/s]SNet: Task 4, Epoch 1/20 => Loss 1.846,  Train_accy 59.93, Test_accy 89.06:   0%|          | 0/20 [01:34<?, ?it/s]SNet: Task 4, Epoch 1/20 => Loss 1.846,  Train_accy 59.93, Test_accy 89.06:   5%|▌         | 1/20 [01:34<29:57, 94.63s/it]SNet: Task 4, Epoch 2/20 => Loss 1.665,  Train_accy 65.93:   5%|▌         | 1/20 [02:53<29:57, 94.63s/it]                 SNet: Task 4, Epoch 2/20 => Loss 1.665,  Train_accy 65.93:  10%|█         | 2/20 [02:53<25:39, 85.53s/it]SNet: Task 4, Epoch 3/20 => Loss 1.642,  Train_accy 67.79:  10%|█         | 2/20 [04:13<25:39, 85.53s/it]SNet: Task 4, Epoch 3/20 => Loss 1.642,  Train_accy 67.79:  15%|█▌        | 3/20 [04:13<23:25, 82.69s/it]SNet: Task 4, Epoch 4/20 => Loss 1.666,  Train_accy 66.41:  15%|█▌        | 3/20 [05:32<23:25, 82.69s/it]SNet: Task 4, Epoch 4/20 => Loss 1.666,  Train_accy 66.41:  20%|██        | 4/20 [05:32<21:40, 81.30s/it]SNet: Task 4, Epoch 5/20 => Loss 1.654,  Train_accy 67.31:  20%|██        | 4/20 [06:51<21:40, 81.30s/it]SNet: Task 4, Epoch 5/20 => Loss 1.654,  Train_accy 67.31:  25%|██▌       | 5/20 [06:51<20:07, 80.50s/it]SNet: Task 4, Epoch 6/20 => Loss 1.648,  Train_accy 68.07, Test_accy 89.88:  25%|██▌       | 5/20 [08:25<20:07, 80.50s/it]SNet: Task 4, Epoch 6/20 => Loss 1.648,  Train_accy 68.07, Test_accy 89.88:  30%|███       | 6/20 [08:25<19:53, 85.24s/it]SNet: Task 4, Epoch 7/20 => Loss 1.624,  Train_accy 68.33:  30%|███       | 6/20 [09:45<19:53, 85.24s/it]                 SNet: Task 4, Epoch 7/20 => Loss 1.624,  Train_accy 68.33:  35%|███▌      | 7/20 [09:45<18:03, 83.31s/it]SNet: Task 4, Epoch 8/20 => Loss 1.675,  Train_accy 67.69:  35%|███▌      | 7/20 [11:04<18:03, 83.31s/it]SNet: Task 4, Epoch 8/20 => Loss 1.675,  Train_accy 67.69:  40%|████      | 8/20 [11:04<16:24, 82.02s/it]SNet: Task 4, Epoch 9/20 => Loss 1.652,  Train_accy 67.52:  40%|████      | 8/20 [12:23<16:24, 82.02s/it]SNet: Task 4, Epoch 9/20 => Loss 1.652,  Train_accy 67.52:  45%|████▌     | 9/20 [12:23<14:52, 81.11s/it]SNet: Task 4, Epoch 10/20 => Loss 1.648,  Train_accy 67.12:  45%|████▌     | 9/20 [13:42<14:52, 81.11s/it]SNet: Task 4, Epoch 10/20 => Loss 1.648,  Train_accy 67.12:  50%|█████     | 10/20 [13:42<13:25, 80.52s/it]SNet: Task 4, Epoch 11/20 => Loss 1.631,  Train_accy 67.64, Test_accy 89.14:  50%|█████     | 10/20 [15:17<13:25, 80.52s/it]SNet: Task 4, Epoch 11/20 => Loss 1.631,  Train_accy 67.64, Test_accy 89.14:  55%|█████▌    | 11/20 [15:17<12:43, 84.83s/it]SNet: Task 4, Epoch 12/20 => Loss 1.641,  Train_accy 67.62:  55%|█████▌    | 11/20 [16:36<12:43, 84.83s/it]                 SNet: Task 4, Epoch 12/20 => Loss 1.641,  Train_accy 67.62:  60%|██████    | 12/20 [16:36<11:04, 83.11s/it]SNet: Task 4, Epoch 13/20 => Loss 1.640,  Train_accy 67.47:  60%|██████    | 12/20 [17:55<11:04, 83.11s/it]SNet: Task 4, Epoch 13/20 => Loss 1.640,  Train_accy 67.47:  65%|██████▌   | 13/20 [17:55<09:33, 81.92s/it]SNet: Task 4, Epoch 14/20 => Loss 1.667,  Train_accy 67.71:  65%|██████▌   | 13/20 [19:14<09:33, 81.92s/it]SNet: Task 4, Epoch 14/20 => Loss 1.667,  Train_accy 67.71:  70%|███████   | 14/20 [19:14<08:06, 81.11s/it]SNet: Task 4, Epoch 15/20 => Loss 1.641,  Train_accy 67.53:  70%|███████   | 14/20 [20:34<08:06, 81.11s/it]SNet: Task 4, Epoch 15/20 => Loss 1.641,  Train_accy 67.53:  75%|███████▌  | 15/20 [20:34<06:42, 80.53s/it]SNet: Task 4, Epoch 16/20 => Loss 1.652,  Train_accy 66.78, Test_accy 89.26:  75%|███████▌  | 15/20 [22:08<06:42, 80.53s/it]SNet: Task 4, Epoch 16/20 => Loss 1.652,  Train_accy 66.78, Test_accy 89.26:  80%|████████  | 16/20 [22:08<05:38, 84.74s/it]SNet: Task 4, Epoch 17/20 => Loss 1.637,  Train_accy 67.33:  80%|████████  | 16/20 [23:27<05:38, 84.74s/it]                 SNet: Task 4, Epoch 17/20 => Loss 1.637,  Train_accy 67.33:  85%|████████▌ | 17/20 [23:27<04:09, 83.09s/it]SNet: Task 4, Epoch 18/20 => Loss 1.658,  Train_accy 67.67:  85%|████████▌ | 17/20 [24:47<04:09, 83.09s/it]SNet: Task 4, Epoch 18/20 => Loss 1.658,  Train_accy 67.67:  90%|█████████ | 18/20 [24:47<02:43, 81.93s/it]SNet: Task 4, Epoch 19/20 => Loss 1.660,  Train_accy 67.22:  90%|█████████ | 18/20 [26:06<02:43, 81.93s/it]SNet: Task 4, Epoch 19/20 => Loss 1.660,  Train_accy 67.22:  95%|█████████▌| 19/20 [26:06<01:21, 81.09s/it]SNet: Task 4, Epoch 20/20 => Loss 1.660,  Train_accy 68.05:  95%|█████████▌| 19/20 [27:25<01:21, 81.09s/it]SNet: Task 4, Epoch 20/20 => Loss 1.660,  Train_accy 68.05: 100%|██████████| 20/20 [27:25<00:00, 80.52s/it]SNet: Task 4, Epoch 20/20 => Loss 1.660,  Train_accy 68.05: 100%|██████████| 20/20 [27:25<00:00, 82.27s/it]2023-11-22 19:50:46,850 [foster.py] => SNet: Task 4, Epoch 20/20 => Loss 1.660,  Train_accy 68.05
2023-11-22 19:50:46,851 [foster.py] => do not weight align student!

2023-11-22 19:51:02,122 [foster.py] => darknet eval: 
2023-11-22 19:51:02,123 [foster.py] => CNN top1 curve: 89.22
2023-11-22 19:51:02,123 [foster.py] => CNN top5 curve: 99.56
2023-11-22 19:51:02,125 [base.py] => Constructing exemplars for new classes...(20 per classes)
2023-11-22 19:52:59,186 [foster.py] => Exemplar size: 1000
2023-11-22 19:52:59,187 [trainer.py] => CNN: {'total': 91.38, '00-09': 96.5, '10-19': 95.3, '20-29': 93.8, '30-39': 86.6, '40-49': 84.7, 'old': 93.05, 'new': 84.7}
2023-11-22 19:52:59,187 [trainer.py] => NME: {'total': 92.5, '00-09': 94.1, '10-19': 89.8, '20-29': 93.9, '30-39': 88.8, '40-49': 95.9, 'old': 91.65, 'new': 95.9}
2023-11-22 19:52:59,187 [trainer.py] => CNN top1 curve: [99.3, 96.8, 95.1, 92.2, 91.38]
2023-11-22 19:52:59,187 [trainer.py] => CNN top5 curve: [100.0, 99.75, 99.6, 99.6, 99.54]
2023-11-22 19:52:59,187 [trainer.py] => NME top1 curve: [99.3, 96.55, 95.7, 94.12, 92.5]
2023-11-22 19:52:59,187 [trainer.py] => NME top5 curve: [100.0, 99.85, 99.6, 99.48, 99.54]

Average Accuracy (CNN): 94.95599999999999
Average Accuracy (NME): 95.634
2023-11-22 19:52:59,187 [trainer.py] => Average Accuracy (CNN): 94.95599999999999
2023-11-22 19:52:59,187 [trainer.py] => Average Accuracy (NME): 95.634
2023-11-22 19:52:59,188 [trainer.py] => All params: 171743372
2023-11-22 19:52:59,189 [trainer.py] => Trainable params: 85913956
2023-11-22 19:53:00,772 [foster.py] => Learning on 50-60
2023-11-22 19:53:00,774 [foster.py] => All params: 171774122
2023-11-22 19:53:00,775 [foster.py] => Trainable params: 85937016
2023-11-22 19:53:00,880 [foster.py] => per cls weights : [1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548 1.07952548
 1.07952548 1.07952548 0.60237259 0.60237259 0.60237259 0.60237259
 0.60237259 0.60237259 0.60237259 0.60237259 0.60237259 0.60237259]
  0%|          | 0/20 [00:00<?, ?it/s]Task 5, Epoch 1/20 => Loss 4.387, Loss_clf 0.720, Loss_fe 1.233, Loss_kd 2.028, Train_accy 64.73, Test_accy 87.13:   0%|          | 0/20 [01:40<?, ?it/s]Task 5, Epoch 1/20 => Loss 4.387, Loss_clf 0.720, Loss_fe 1.233, Loss_kd 2.028, Train_accy 64.73, Test_accy 87.13:   5%|▌         | 1/20 [01:40<31:46, 100.37s/it]Task 5, Epoch 2/20 => Loss 3.573, Loss_clf 0.461, Loss_fe 0.695, Loss_kd 2.014, Train_accy 69.03:   5%|▌         | 1/20 [02:46<31:46, 100.37s/it]                 Task 5, Epoch 2/20 => Loss 3.573, Loss_clf 0.461, Loss_fe 0.695, Loss_kd 2.014, Train_accy 69.03:  10%|█         | 2/20 [02:46<24:00, 80.04s/it] Task 5, Epoch 3/20 => Loss 3.354, Loss_clf 0.397, Loss_fe 0.551, Loss_kd 2.004, Train_accy 71.77:  10%|█         | 2/20 [03:51<24:00, 80.04s/it]Task 5, Epoch 3/20 => Loss 3.354, Loss_clf 0.397, Loss_fe 0.551, Loss_kd 2.004, Train_accy 71.77:  15%|█▌        | 3/20 [03:51<20:50, 73.54s/it]Task 5, Epoch 4/20 => Loss 3.315, Loss_clf 0.382, Loss_fe 0.512, Loss_kd 2.018, Train_accy 73.17:  15%|█▌        | 3/20 [04:57<20:50, 73.54s/it]Task 5, Epoch 4/20 => Loss 3.315, Loss_clf 0.382, Loss_fe 0.512, Loss_kd 2.018, Train_accy 73.17:  20%|██        | 4/20 [04:57<18:47, 70.48s/it]Task 5, Epoch 5/20 => Loss 3.213, Loss_clf 0.349, Loss_fe 0.454, Loss_kd 2.008, Train_accy 74.82:  20%|██        | 4/20 [06:03<18:47, 70.48s/it]Task 5, Epoch 5/20 => Loss 3.213, Loss_clf 0.349, Loss_fe 0.454, Loss_kd 2.008, Train_accy 74.82:  25%|██▌       | 5/20 [06:03<17:11, 68.80s/it]Task 5, Epoch 6/20 => Loss 3.152, Loss_clf 0.326, Loss_fe 0.419, Loss_kd 2.006, Train_accy 75.58, Test_accy 90.12:  25%|██▌       | 5/20 [07:44<17:11, 68.80s/it]Task 5, Epoch 6/20 => Loss 3.152, Loss_clf 0.326, Loss_fe 0.419, Loss_kd 2.006, Train_accy 75.58, Test_accy 90.12:  30%|███       | 6/20 [07:44<18:34, 79.61s/it]Task 5, Epoch 7/20 => Loss 3.151, Loss_clf 0.331, Loss_fe 0.399, Loss_kd 2.018, Train_accy 76.82:  30%|███       | 6/20 [08:49<18:34, 79.61s/it]                 Task 5, Epoch 7/20 => Loss 3.151, Loss_clf 0.331, Loss_fe 0.399, Loss_kd 2.018, Train_accy 76.82:  35%|███▌      | 7/20 [08:49<16:16, 75.09s/it]Task 5, Epoch 8/20 => Loss 3.095, Loss_clf 0.313, Loss_fe 0.368, Loss_kd 2.012, Train_accy 77.87:  35%|███▌      | 7/20 [09:55<16:16, 75.09s/it]Task 5, Epoch 8/20 => Loss 3.095, Loss_clf 0.313, Loss_fe 0.368, Loss_kd 2.012, Train_accy 77.87:  40%|████      | 8/20 [09:55<14:25, 72.12s/it]Task 5, Epoch 9/20 => Loss 3.023, Loss_clf 0.286, Loss_fe 0.325, Loss_kd 2.010, Train_accy 79.62:  40%|████      | 8/20 [11:01<14:25, 72.12s/it]Task 5, Epoch 9/20 => Loss 3.023, Loss_clf 0.286, Loss_fe 0.325, Loss_kd 2.010, Train_accy 79.62:  45%|████▌     | 9/20 [11:01<12:51, 70.16s/it]Task 5, Epoch 10/20 => Loss 3.004, Loss_clf 0.275, Loss_fe 0.320, Loss_kd 2.008, Train_accy 80.58:  45%|████▌     | 9/20 [12:07<12:51, 70.16s/it]Task 5, Epoch 10/20 => Loss 3.004, Loss_clf 0.275, Loss_fe 0.320, Loss_kd 2.008, Train_accy 80.58:  50%|█████     | 10/20 [12:07<11:28, 68.80s/it]Task 5, Epoch 11/20 => Loss 3.019, Loss_clf 0.282, Loss_fe 0.319, Loss_kd 2.015, Train_accy 80.45, Test_accy 90.92:  50%|█████     | 10/20 [13:48<11:28, 68.80s/it]Task 5, Epoch 11/20 => Loss 3.019, Loss_clf 0.282, Loss_fe 0.319, Loss_kd 2.015, Train_accy 80.45, Test_accy 90.92:  55%|█████▌    | 11/20 [13:48<11:47, 78.59s/it]Task 5, Epoch 12/20 => Loss 2.917, Loss_clf 0.250, Loss_fe 0.267, Loss_kd 1.999, Train_accy 81.65:  55%|█████▌    | 11/20 [14:54<11:47, 78.59s/it]                 Task 5, Epoch 12/20 => Loss 2.917, Loss_clf 0.250, Loss_fe 0.267, Loss_kd 1.999, Train_accy 81.65:  60%|██████    | 12/20 [14:54<09:58, 74.85s/it]Task 5, Epoch 13/20 => Loss 2.955, Loss_clf 0.262, Loss_fe 0.271, Loss_kd 2.018, Train_accy 81.78:  60%|██████    | 12/20 [16:00<09:58, 74.85s/it]Task 5, Epoch 13/20 => Loss 2.955, Loss_clf 0.262, Loss_fe 0.271, Loss_kd 2.018, Train_accy 81.78:  65%|██████▌   | 13/20 [16:00<08:24, 72.14s/it]Task 5, Epoch 14/20 => Loss 2.873, Loss_clf 0.234, Loss_fe 0.232, Loss_kd 2.006, Train_accy 83.70:  65%|██████▌   | 13/20 [17:06<08:24, 72.14s/it]Task 5, Epoch 14/20 => Loss 2.873, Loss_clf 0.234, Loss_fe 0.232, Loss_kd 2.006, Train_accy 83.70:  70%|███████   | 14/20 [17:06<07:01, 70.27s/it]Task 5, Epoch 15/20 => Loss 2.867, Loss_clf 0.234, Loss_fe 0.229, Loss_kd 2.004, Train_accy 83.78:  70%|███████   | 14/20 [18:12<07:01, 70.27s/it]Task 5, Epoch 15/20 => Loss 2.867, Loss_clf 0.234, Loss_fe 0.229, Loss_kd 2.004, Train_accy 83.78:  75%|███████▌  | 15/20 [18:12<05:44, 68.92s/it]Task 5, Epoch 16/20 => Loss 2.834, Loss_clf 0.218, Loss_fe 0.211, Loss_kd 2.005, Train_accy 84.47, Test_accy 91.02:  75%|███████▌  | 15/20 [19:52<05:44, 68.92s/it]Task 5, Epoch 16/20 => Loss 2.834, Loss_clf 0.218, Loss_fe 0.211, Loss_kd 2.005, Train_accy 84.47, Test_accy 91.02:  80%|████████  | 16/20 [19:52<05:13, 78.43s/it]Task 5, Epoch 17/20 => Loss 2.810, Loss_clf 0.207, Loss_fe 0.195, Loss_kd 2.006, Train_accy 85.27:  80%|████████  | 16/20 [20:58<05:13, 78.43s/it]                 Task 5, Epoch 17/20 => Loss 2.810, Loss_clf 0.207, Loss_fe 0.195, Loss_kd 2.006, Train_accy 85.27:  85%|████████▌ | 17/20 [20:58<03:43, 74.62s/it]Task 5, Epoch 18/20 => Loss 2.805, Loss_clf 0.206, Loss_fe 0.194, Loss_kd 2.004, Train_accy 85.22:  85%|████████▌ | 17/20 [22:04<03:43, 74.62s/it]Task 5, Epoch 18/20 => Loss 2.805, Loss_clf 0.206, Loss_fe 0.194, Loss_kd 2.004, Train_accy 85.22:  90%|█████████ | 18/20 [22:04<02:23, 71.95s/it]Task 5, Epoch 19/20 => Loss 2.790, Loss_clf 0.201, Loss_fe 0.190, Loss_kd 1.999, Train_accy 85.33:  90%|█████████ | 18/20 [23:09<02:23, 71.95s/it]Task 5, Epoch 19/20 => Loss 2.790, Loss_clf 0.201, Loss_fe 0.190, Loss_kd 1.999, Train_accy 85.33:  95%|█████████▌| 19/20 [23:09<01:10, 70.12s/it]Task 5, Epoch 20/20 => Loss 2.811, Loss_clf 0.211, Loss_fe 0.196, Loss_kd 2.004, Train_accy 85.70:  95%|█████████▌| 19/20 [24:15<01:10, 70.12s/it]Task 5, Epoch 20/20 => Loss 2.811, Loss_clf 0.211, Loss_fe 0.196, Loss_kd 2.004, Train_accy 85.70: 100%|██████████| 20/20 [24:15<00:00, 68.85s/it]Task 5, Epoch 20/20 => Loss 2.811, Loss_clf 0.211, Loss_fe 0.196, Loss_kd 2.004, Train_accy 85.70: 100%|██████████| 20/20 [24:15<00:00, 72.79s/it]2023-11-22 20:17:16,709 [foster.py] => Task 5, Epoch 20/20 => Loss 2.811, Loss_clf 0.211, Loss_fe 0.196, Loss_kd 2.004, Train_accy 85.70
2023-11-22 20:17:16,710 [foster.py] => do not weight align teacher!
2023-11-22 20:17:16,714 [foster.py] => per cls weights : [1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529 1.09966529
 1.09966529 1.09966529 0.50167353 0.50167353 0.50167353 0.50167353
 0.50167353 0.50167353 0.50167353 0.50167353 0.50167353 0.50167353]

  0%|          | 0/20 [00:00<?, ?it/s]SNet: Task 5, Epoch 1/20 => Loss 2.054,  Train_accy 63.47, Test_accy 89.88:   0%|          | 0/20 [01:40<?, ?it/s]SNet: Task 5, Epoch 1/20 => Loss 2.054,  Train_accy 63.47, Test_accy 89.88:   5%|▌         | 1/20 [01:40<31:43, 100.19s/it]SNet: Task 5, Epoch 2/20 => Loss 1.891,  Train_accy 70.22:   5%|▌         | 1/20 [03:02<31:43, 100.19s/it]                 SNet: Task 5, Epoch 2/20 => Loss 1.891,  Train_accy 70.22:  10%|█         | 2/20 [03:02<26:49, 89.42s/it] SNet: Task 5, Epoch 3/20 => Loss 1.862,  Train_accy 71.12:  10%|█         | 2/20 [04:23<26:49, 89.42s/it]SNet: Task 5, Epoch 3/20 => Loss 1.862,  Train_accy 71.12:  15%|█▌        | 3/20 [04:23<24:21, 85.95s/it]SNet: Task 5, Epoch 4/20 => Loss 1.857,  Train_accy 72.17:  15%|█▌        | 3/20 [05:45<24:21, 85.95s/it]SNet: Task 5, Epoch 4/20 => Loss 1.857,  Train_accy 72.17:  20%|██        | 4/20 [05:45<22:29, 84.36s/it]SNet: Task 5, Epoch 5/20 => Loss 1.854,  Train_accy 71.90:  20%|██        | 4/20 [07:07<22:29, 84.36s/it]SNet: Task 5, Epoch 5/20 => Loss 1.854,  Train_accy 71.90:  25%|██▌       | 5/20 [07:07<20:52, 83.47s/it]SNet: Task 5, Epoch 6/20 => Loss 1.853,  Train_accy 72.08, Test_accy 90.13:  25%|██▌       | 5/20 [08:47<20:52, 83.47s/it]SNet: Task 5, Epoch 6/20 => Loss 1.853,  Train_accy 72.08, Test_accy 90.13:  30%|███       | 6/20 [08:47<20:48, 89.17s/it]SNet: Task 5, Epoch 7/20 => Loss 1.874,  Train_accy 72.47:  30%|███       | 6/20 [10:09<20:48, 89.17s/it]                 SNet: Task 5, Epoch 7/20 => Loss 1.874,  Train_accy 72.47:  35%|███▌      | 7/20 [10:09<18:48, 86.80s/it]SNet: Task 5, Epoch 8/20 => Loss 1.867,  Train_accy 72.77:  35%|███▌      | 7/20 [11:31<18:48, 86.80s/it]SNet: Task 5, Epoch 8/20 => Loss 1.867,  Train_accy 72.77:  40%|████      | 8/20 [11:31<17:02, 85.22s/it]SNet: Task 5, Epoch 9/20 => Loss 1.864,  Train_accy 72.65:  40%|████      | 8/20 [12:53<17:02, 85.22s/it]SNet: Task 5, Epoch 9/20 => Loss 1.864,  Train_accy 72.65:  45%|████▌     | 9/20 [12:53<15:26, 84.18s/it]SNet: Task 5, Epoch 10/20 => Loss 1.837,  Train_accy 72.42:  45%|████▌     | 9/20 [14:15<15:26, 84.18s/it]SNet: Task 5, Epoch 10/20 => Loss 1.837,  Train_accy 72.42:  50%|█████     | 10/20 [14:15<13:54, 83.45s/it]SNet: Task 5, Epoch 11/20 => Loss 1.873,  Train_accy 72.28, Test_accy 90.15:  50%|█████     | 10/20 [15:55<13:54, 83.45s/it]SNet: Task 5, Epoch 11/20 => Loss 1.873,  Train_accy 72.28, Test_accy 90.15:  55%|█████▌    | 11/20 [15:55<13:16, 88.54s/it]SNet: Task 5, Epoch 12/20 => Loss 1.852,  Train_accy 71.80:  55%|█████▌    | 11/20 [17:17<13:16, 88.54s/it]                 SNet: Task 5, Epoch 12/20 => Loss 1.852,  Train_accy 71.80:  60%|██████    | 12/20 [17:17<11:32, 86.50s/it]SNet: Task 5, Epoch 13/20 => Loss 1.867,  Train_accy 71.87:  60%|██████    | 12/20 [18:39<11:32, 86.50s/it]SNet: Task 5, Epoch 13/20 => Loss 1.867,  Train_accy 71.87:  65%|██████▌   | 13/20 [18:39<09:55, 85.11s/it]SNet: Task 5, Epoch 14/20 => Loss 1.834,  Train_accy 74.07:  65%|██████▌   | 13/20 [20:01<09:55, 85.11s/it]SNet: Task 5, Epoch 14/20 => Loss 1.834,  Train_accy 74.07:  70%|███████   | 14/20 [20:01<08:24, 84.13s/it]SNet: Task 5, Epoch 15/20 => Loss 1.844,  Train_accy 72.78:  70%|███████   | 14/20 [21:23<08:24, 84.13s/it]SNet: Task 5, Epoch 15/20 => Loss 1.844,  Train_accy 72.78:  75%|███████▌  | 15/20 [21:23<06:57, 83.46s/it]SNet: Task 5, Epoch 16/20 => Loss 1.839,  Train_accy 72.67, Test_accy 90.07:  75%|███████▌  | 15/20 [23:03<06:57, 83.46s/it]SNet: Task 5, Epoch 16/20 => Loss 1.839,  Train_accy 72.67, Test_accy 90.07:  80%|████████  | 16/20 [23:03<05:54, 88.56s/it]SNet: Task 5, Epoch 17/20 => Loss 1.841,  Train_accy 73.03:  80%|████████  | 16/20 [24:25<05:54, 88.56s/it]                 SNet: Task 5, Epoch 17/20 => Loss 1.841,  Train_accy 73.03:  85%|████████▌ | 17/20 [24:25<04:19, 86.56s/it]SNet: Task 5, Epoch 18/20 => Loss 1.842,  Train_accy 73.08:  85%|████████▌ | 17/20 [25:47<04:19, 86.56s/it]SNet: Task 5, Epoch 18/20 => Loss 1.842,  Train_accy 73.08:  90%|█████████ | 18/20 [25:47<02:50, 85.17s/it]SNet: Task 5, Epoch 19/20 => Loss 1.852,  Train_accy 72.47:  90%|█████████ | 18/20 [27:09<02:50, 85.17s/it]SNet: Task 5, Epoch 19/20 => Loss 1.852,  Train_accy 72.47:  95%|█████████▌| 19/20 [27:09<01:24, 84.17s/it]SNet: Task 5, Epoch 20/20 => Loss 1.873,  Train_accy 71.78:  95%|█████████▌| 19/20 [28:30<01:24, 84.17s/it]SNet: Task 5, Epoch 20/20 => Loss 1.873,  Train_accy 71.78: 100%|██████████| 20/20 [28:30<00:00, 83.47s/it]SNet: Task 5, Epoch 20/20 => Loss 1.873,  Train_accy 71.78: 100%|██████████| 20/20 [28:30<00:00, 85.55s/it]2023-11-22 20:45:49,467 [foster.py] => SNet: Task 5, Epoch 20/20 => Loss 1.873,  Train_accy 71.78
2023-11-22 20:45:49,467 [foster.py] => do not weight align student!

2023-11-22 20:46:07,669 [foster.py] => darknet eval: 
2023-11-22 20:46:07,670 [foster.py] => CNN top1 curve: 90.07
2023-11-22 20:46:07,670 [foster.py] => CNN top5 curve: 99.38
2023-11-22 20:46:07,672 [base.py] => Constructing exemplars for new classes...(20 per classes)
2023-11-22 20:48:20,965 [foster.py] => Exemplar size: 1200
2023-11-22 20:48:20,965 [trainer.py] => CNN: {'total': 91.28, '00-09': 96.2, '10-19': 94.5, '20-29': 94.7, '30-39': 90.6, '40-49': 85.2, '50-59': 86.5, 'old': 92.24, 'new': 86.5}
2023-11-22 20:48:20,965 [trainer.py] => NME: {'total': 92.42, '00-09': 93.3, '10-19': 92.1, '20-29': 94.1, '30-39': 91.2, '40-49': 89.4, '50-59': 94.4, 'old': 92.02, 'new': 94.4}
2023-11-22 20:48:20,965 [trainer.py] => CNN top1 curve: [99.3, 96.8, 95.1, 92.2, 91.38, 91.28]
2023-11-22 20:48:20,966 [trainer.py] => CNN top5 curve: [100.0, 99.75, 99.6, 99.6, 99.54, 99.35]
2023-11-22 20:48:20,966 [trainer.py] => NME top1 curve: [99.3, 96.55, 95.7, 94.12, 92.5, 92.42]
2023-11-22 20:48:20,966 [trainer.py] => NME top5 curve: [100.0, 99.85, 99.6, 99.48, 99.54, 99.38]

Average Accuracy (CNN): 94.34333333333332
Average Accuracy (NME): 95.09833333333334
2023-11-22 20:48:20,966 [trainer.py] => Average Accuracy (CNN): 94.34333333333332
2023-11-22 20:48:20,966 [trainer.py] => Average Accuracy (NME): 95.09833333333334
2023-11-22 20:48:20,967 [trainer.py] => All params: 171774122
2023-11-22 20:48:20,968 [trainer.py] => Trainable params: 85937016
2023-11-22 20:48:22,580 [foster.py] => Learning on 60-70
2023-11-22 20:48:22,582 [foster.py] => All params: 171804872
2023-11-22 20:48:22,583 [foster.py] => Trainable params: 85960076
2023-11-22 20:48:22,721 [foster.py] => per cls weights : [1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899 1.06739899
 0.59560604 0.59560604 0.59560604 0.59560604 0.59560604 0.59560604
 0.59560604 0.59560604 0.59560604 0.59560604]
  0%|          | 0/20 [00:00<?, ?it/s]Task 6, Epoch 1/20 => Loss 4.234, Loss_clf 0.694, Loss_fe 1.276, Loss_kd 1.941, Train_accy 67.66, Test_accy 88.21:   0%|          | 0/20 [01:48<?, ?it/s]Task 6, Epoch 1/20 => Loss 4.234, Loss_clf 0.694, Loss_fe 1.276, Loss_kd 1.941, Train_accy 67.66, Test_accy 88.21:   5%|▌         | 1/20 [01:48<34:15, 108.20s/it]Task 6, Epoch 2/20 => Loss 3.343, Loss_clf 0.422, Loss_fe 0.683, Loss_kd 1.919, Train_accy 69.56:   5%|▌         | 1/20 [02:56<34:15, 108.20s/it]                 Task 6, Epoch 2/20 => Loss 3.343, Loss_clf 0.422, Loss_fe 0.683, Loss_kd 1.919, Train_accy 69.56:  10%|█         | 2/20 [02:56<25:21, 84.55s/it] Task 6, Epoch 3/20 => Loss 3.156, Loss_clf 0.360, Loss_fe 0.560, Loss_kd 1.917, Train_accy 72.13:  10%|█         | 2/20 [04:04<25:21, 84.55s/it]Task 6, Epoch 3/20 => Loss 3.156, Loss_clf 0.360, Loss_fe 0.560, Loss_kd 1.917, Train_accy 72.13:  15%|█▌        | 3/20 [04:04<21:48, 76.98s/it]Task 6, Epoch 4/20 => Loss 3.022, Loss_clf 0.324, Loss_fe 0.470, Loss_kd 1.911, Train_accy 73.50:  15%|█▌        | 3/20 [05:12<21:48, 76.98s/it]Task 6, Epoch 4/20 => Loss 3.022, Loss_clf 0.324, Loss_fe 0.470, Loss_kd 1.911, Train_accy 73.50:  20%|██        | 4/20 [05:12<19:34, 73.42s/it]Task 6, Epoch 5/20 => Loss 2.942, Loss_clf 0.307, Loss_fe 0.413, Loss_kd 1.905, Train_accy 75.92:  20%|██        | 4/20 [06:20<19:34, 73.42s/it]Task 6, Epoch 5/20 => Loss 2.942, Loss_clf 0.307, Loss_fe 0.413, Loss_kd 1.905, Train_accy 75.92:  25%|██▌       | 5/20 [06:20<17:51, 71.44s/it]Task 6, Epoch 6/20 => Loss 2.951, Loss_clf 0.310, Loss_fe 0.409, Loss_kd 1.913, Train_accy 75.31, Test_accy 89.54:  25%|██▌       | 5/20 [08:08<17:51, 71.44s/it]Task 6, Epoch 6/20 => Loss 2.951, Loss_clf 0.310, Loss_fe 0.409, Loss_kd 1.913, Train_accy 75.31, Test_accy 89.54:  30%|███       | 6/20 [08:08<19:35, 83.95s/it]Task 6, Epoch 7/20 => Loss 2.896, Loss_clf 0.296, Loss_fe 0.374, Loss_kd 1.908, Train_accy 77.40:  30%|███       | 6/20 [09:16<19:35, 83.95s/it]                 Task 6, Epoch 7/20 => Loss 2.896, Loss_clf 0.296, Loss_fe 0.374, Loss_kd 1.908, Train_accy 77.40:  35%|███▌      | 7/20 [09:16<17:04, 78.77s/it]Task 6, Epoch 8/20 => Loss 2.845, Loss_clf 0.284, Loss_fe 0.337, Loss_kd 1.907, Train_accy 77.92:  35%|███▌      | 7/20 [10:24<17:04, 78.77s/it]Task 6, Epoch 8/20 => Loss 2.845, Loss_clf 0.284, Loss_fe 0.337, Loss_kd 1.907, Train_accy 77.92:  40%|████      | 8/20 [10:24<15:06, 75.52s/it]Task 6, Epoch 9/20 => Loss 2.820, Loss_clf 0.272, Loss_fe 0.316, Loss_kd 1.913, Train_accy 79.05:  40%|████      | 8/20 [11:33<15:06, 75.52s/it]Task 6, Epoch 9/20 => Loss 2.820, Loss_clf 0.272, Loss_fe 0.316, Loss_kd 1.913, Train_accy 79.05:  45%|████▌     | 9/20 [11:33<13:25, 73.20s/it]Task 6, Epoch 10/20 => Loss 2.797, Loss_clf 0.259, Loss_fe 0.300, Loss_kd 1.918, Train_accy 79.61:  45%|████▌     | 9/20 [12:41<13:25, 73.20s/it]Task 6, Epoch 10/20 => Loss 2.797, Loss_clf 0.259, Loss_fe 0.300, Loss_kd 1.918, Train_accy 79.61:  50%|█████     | 10/20 [12:41<11:55, 71.58s/it]Task 6, Epoch 11/20 => Loss 2.808, Loss_clf 0.275, Loss_fe 0.291, Loss_kd 1.922, Train_accy 79.11, Test_accy 90.57:  50%|█████     | 10/20 [14:29<11:55, 71.58s/it]Task 6, Epoch 11/20 => Loss 2.808, Loss_clf 0.275, Loss_fe 0.291, Loss_kd 1.922, Train_accy 79.11, Test_accy 90.57:  55%|█████▌    | 11/20 [14:29<12:25, 82.87s/it]Task 6, Epoch 12/20 => Loss 2.685, Loss_clf 0.230, Loss_fe 0.235, Loss_kd 1.903, Train_accy 82.08:  55%|█████▌    | 11/20 [15:37<12:25, 82.87s/it]                 Task 6, Epoch 12/20 => Loss 2.685, Loss_clf 0.230, Loss_fe 0.235, Loss_kd 1.903, Train_accy 82.08:  60%|██████    | 12/20 [15:37<10:26, 78.34s/it]Task 6, Epoch 13/20 => Loss 2.729, Loss_clf 0.243, Loss_fe 0.250, Loss_kd 1.917, Train_accy 80.77:  60%|██████    | 12/20 [16:45<10:26, 78.34s/it]Task 6, Epoch 13/20 => Loss 2.729, Loss_clf 0.243, Loss_fe 0.250, Loss_kd 1.917, Train_accy 80.77:  65%|██████▌   | 13/20 [16:45<08:46, 75.20s/it]Task 6, Epoch 14/20 => Loss 2.692, Loss_clf 0.233, Loss_fe 0.232, Loss_kd 1.909, Train_accy 81.73:  65%|██████▌   | 13/20 [17:53<08:46, 75.20s/it]Task 6, Epoch 14/20 => Loss 2.692, Loss_clf 0.233, Loss_fe 0.232, Loss_kd 1.909, Train_accy 81.73:  70%|███████   | 14/20 [17:53<07:18, 73.04s/it]Task 6, Epoch 15/20 => Loss 2.681, Loss_clf 0.233, Loss_fe 0.226, Loss_kd 1.904, Train_accy 83.32:  70%|███████   | 14/20 [19:01<07:18, 73.04s/it]Task 6, Epoch 15/20 => Loss 2.681, Loss_clf 0.233, Loss_fe 0.226, Loss_kd 1.904, Train_accy 83.32:  75%|███████▌  | 15/20 [19:01<05:57, 71.50s/it]Task 6, Epoch 16/20 => Loss 2.636, Loss_clf 0.217, Loss_fe 0.206, Loss_kd 1.897, Train_accy 84.32, Test_accy 90.54:  75%|███████▌  | 15/20 [21:32<05:57, 71.50s/it]Task 6, Epoch 16/20 => Loss 2.636, Loss_clf 0.217, Loss_fe 0.206, Loss_kd 1.897, Train_accy 84.32, Test_accy 90.54:  80%|████████  | 16/20 [21:32<06:21, 95.40s/it]Task 6, Epoch 17/20 => Loss 2.606, Loss_clf 0.202, Loss_fe 0.181, Loss_kd 1.906, Train_accy 85.05:  80%|████████  | 16/20 [24:03<06:21, 95.40s/it]                 Task 6, Epoch 17/20 => Loss 2.606, Loss_clf 0.202, Loss_fe 0.181, Loss_kd 1.906, Train_accy 85.05:  85%|████████▌ | 17/20 [24:03<05:36, 112.15s/it]Task 6, Epoch 18/20 => Loss 2.610, Loss_clf 0.194, Loss_fe 0.187, Loss_kd 1.911, Train_accy 84.73:  85%|████████▌ | 17/20 [26:35<05:36, 112.15s/it]Task 6, Epoch 18/20 => Loss 2.610, Loss_clf 0.194, Loss_fe 0.187, Loss_kd 1.911, Train_accy 84.73:  90%|█████████ | 18/20 [26:35<04:08, 124.10s/it]Task 6, Epoch 19/20 => Loss 2.622, Loss_clf 0.205, Loss_fe 0.187, Loss_kd 1.911, Train_accy 84.87:  90%|█████████ | 18/20 [29:07<04:08, 124.10s/it]Task 6, Epoch 19/20 => Loss 2.622, Loss_clf 0.205, Loss_fe 0.187, Loss_kd 1.911, Train_accy 84.87:  95%|█████████▌| 19/20 [29:07<02:12, 132.63s/it]Task 6, Epoch 20/20 => Loss 2.611, Loss_clf 0.201, Loss_fe 0.183, Loss_kd 1.909, Train_accy 84.92:  95%|█████████▌| 19/20 [31:38<02:12, 132.63s/it]Task 6, Epoch 20/20 => Loss 2.611, Loss_clf 0.201, Loss_fe 0.183, Loss_kd 1.909, Train_accy 84.92: 100%|██████████| 20/20 [31:38<00:00, 138.19s/it]Task 6, Epoch 20/20 => Loss 2.611, Loss_clf 0.201, Loss_fe 0.183, Loss_kd 1.909, Train_accy 84.92: 100%|██████████| 20/20 [31:38<00:00, 94.95s/it] 2023-11-22 21:20:01,694 [foster.py] => Task 6, Epoch 20/20 => Loss 2.611, Loss_clf 0.201, Loss_fe 0.183, Loss_kd 1.909, Train_accy 84.92
2023-11-22 21:20:01,695 [foster.py] => do not weight align teacher!
2023-11-22 21:20:01,699 [foster.py] => per cls weights : [1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816 1.08422816
 0.49463102 0.49463102 0.49463102 0.49463102 0.49463102 0.49463102
 0.49463102 0.49463102 0.49463102 0.49463102]

  0%|          | 0/20 [00:00<?, ?it/s]SNet: Task 6, Epoch 1/20 => Loss 1.870,  Train_accy 65.40, Test_accy 89.50:   0%|          | 0/20 [03:55<?, ?it/s]SNet: Task 6, Epoch 1/20 => Loss 1.870,  Train_accy 65.40, Test_accy 89.50:   5%|▌         | 1/20 [03:55<1:14:30, 235.27s/it]SNet: Task 6, Epoch 2/20 => Loss 1.729,  Train_accy 71.53:   5%|▌         | 1/20 [07:03<1:14:30, 235.27s/it]                 SNet: Task 6, Epoch 2/20 => Loss 1.729,  Train_accy 71.53:  10%|█         | 2/20 [07:03<1:02:19, 207.75s/it]SNet: Task 6, Epoch 3/20 => Loss 1.733,  Train_accy 71.66:  10%|█         | 2/20 [10:13<1:02:19, 207.75s/it]SNet: Task 6, Epoch 3/20 => Loss 1.733,  Train_accy 71.66:  15%|█▌        | 3/20 [10:13<56:29, 199.41s/it]  SNet: Task 6, Epoch 4/20 => Loss 1.728,  Train_accy 71.45:  15%|█▌        | 3/20 [13:23<56:29, 199.41s/it]SNet: Task 6, Epoch 4/20 => Loss 1.728,  Train_accy 71.45:  20%|██        | 4/20 [13:23<52:10, 195.64s/it]SNet: Task 6, Epoch 5/20 => Loss 1.730,  Train_accy 72.45:  20%|██        | 4/20 [16:31<52:10, 195.64s/it]SNet: Task 6, Epoch 5/20 => Loss 1.730,  Train_accy 72.45:  25%|██▌       | 5/20 [16:31<48:18, 193.20s/it]SNet: Task 6, Epoch 6/20 => Loss 1.723,  Train_accy 73.02, Test_accy 89.76:  25%|██▌       | 5/20 [20:19<48:18, 193.20s/it]SNet: Task 6, Epoch 6/20 => Loss 1.723,  Train_accy 73.02, Test_accy 89.76:  30%|███       | 6/20 [20:19<47:45, 204.70s/it]SNet: Task 6, Epoch 7/20 => Loss 1.731,  Train_accy 72.69:  30%|███       | 6/20 [23:22<47:45, 204.70s/it]                 SNet: Task 6, Epoch 7/20 => Loss 1.731,  Train_accy 72.69:  35%|███▌      | 7/20 [23:22<42:51, 197.79s/it]SNet: Task 6, Epoch 8/20 => Loss 1.703,  Train_accy 72.89:  35%|███▌      | 7/20 [26:33<42:51, 197.79s/it]SNet: Task 6, Epoch 8/20 => Loss 1.703,  Train_accy 72.89:  40%|████      | 8/20 [26:33<39:05, 195.48s/it]SNet: Task 6, Epoch 9/20 => Loss 1.721,  Train_accy 72.92:  40%|████      | 8/20 [29:43<39:05, 195.48s/it]SNet: Task 6, Epoch 9/20 => Loss 1.721,  Train_accy 72.92:  45%|████▌     | 9/20 [29:43<35:31, 193.81s/it]SNet: Task 6, Epoch 10/20 => Loss 1.727,  Train_accy 72.26:  45%|████▌     | 9/20 [32:53<35:31, 193.81s/it]SNet: Task 6, Epoch 10/20 => Loss 1.727,  Train_accy 72.26:  50%|█████     | 10/20 [32:53<32:08, 192.83s/it]SNet: Task 6, Epoch 11/20 => Loss 1.735,  Train_accy 72.55, Test_accy 89.83:  50%|█████     | 10/20 [36:48<32:08, 192.83s/it]SNet: Task 6, Epoch 11/20 => Loss 1.735,  Train_accy 72.55, Test_accy 89.83:  55%|█████▌    | 11/20 [36:48<30:51, 205.70s/it]SNet: Task 6, Epoch 12/20 => Loss 1.711,  Train_accy 73.45:  55%|█████▌    | 11/20 [39:59<30:51, 205.70s/it]                 SNet: Task 6, Epoch 12/20 => Loss 1.711,  Train_accy 73.45:  60%|██████    | 12/20 [39:59<26:48, 201.08s/it]SNet: Task 6, Epoch 13/20 => Loss 1.713,  Train_accy 73.06:  60%|██████    | 12/20 [43:09<26:48, 201.08s/it]SNet: Task 6, Epoch 13/20 => Loss 1.713,  Train_accy 73.06:  65%|██████▌   | 13/20 [43:09<23:04, 197.79s/it]SNet: Task 6, Epoch 14/20 => Loss 1.711,  Train_accy 72.71:  65%|██████▌   | 13/20 [46:19<23:04, 197.79s/it]SNet: Task 6, Epoch 14/20 => Loss 1.711,  Train_accy 72.71:  70%|███████   | 14/20 [46:19<19:32, 195.35s/it]SNet: Task 6, Epoch 15/20 => Loss 1.698,  Train_accy 73.65:  70%|███████   | 14/20 [49:29<19:32, 195.35s/it]SNet: Task 6, Epoch 15/20 => Loss 1.698,  Train_accy 73.65:  75%|███████▌  | 15/20 [49:29<16:09, 193.93s/it]SNet: Task 6, Epoch 16/20 => Loss 1.715,  Train_accy 72.29, Test_accy 89.63:  75%|███████▌  | 15/20 [53:25<16:09, 193.93s/it]SNet: Task 6, Epoch 16/20 => Loss 1.715,  Train_accy 72.29, Test_accy 89.63:  80%|████████  | 16/20 [53:25<13:45, 206.47s/it]SNet: Task 6, Epoch 17/20 => Loss 1.688,  Train_accy 72.98:  80%|████████  | 16/20 [56:35<13:45, 206.47s/it]                 SNet: Task 6, Epoch 17/20 => Loss 1.688,  Train_accy 72.98:  85%|████████▌ | 17/20 [56:35<10:04, 201.45s/it]SNet: Task 6, Epoch 18/20 => Loss 1.724,  Train_accy 72.74:  85%|████████▌ | 17/20 [59:44<10:04, 201.45s/it]SNet: Task 6, Epoch 18/20 => Loss 1.724,  Train_accy 72.74:  90%|█████████ | 18/20 [59:44<06:35, 197.90s/it]SNet: Task 6, Epoch 19/20 => Loss 1.738,  Train_accy 71.90:  90%|█████████ | 18/20 [1:02:55<06:35, 197.90s/it]SNet: Task 6, Epoch 19/20 => Loss 1.738,  Train_accy 71.90:  95%|█████████▌| 19/20 [1:02:55<03:15, 195.71s/it]SNet: Task 6, Epoch 20/20 => Loss 1.710,  Train_accy 72.66:  95%|█████████▌| 19/20 [1:06:03<03:15, 195.71s/it]SNet: Task 6, Epoch 20/20 => Loss 1.710,  Train_accy 72.66: 100%|██████████| 20/20 [1:06:03<00:00, 193.28s/it]SNet: Task 6, Epoch 20/20 => Loss 1.710,  Train_accy 72.66: 100%|██████████| 20/20 [1:06:03<00:00, 198.15s/it]2023-11-22 22:26:06,560 [foster.py] => SNet: Task 6, Epoch 20/20 => Loss 1.710,  Train_accy 72.66
2023-11-22 22:26:06,561 [foster.py] => do not weight align student!

2023-11-22 22:26:52,531 [foster.py] => darknet eval: 
2023-11-22 22:26:52,532 [foster.py] => CNN top1 curve: 89.63
2023-11-22 22:26:52,532 [foster.py] => CNN top5 curve: 99.43
2023-11-22 22:26:52,534 [base.py] => Constructing exemplars for new classes...(20 per classes)
2023-11-22 22:31:43,043 [foster.py] => Exemplar size: 1400
2023-11-22 22:31:43,044 [trainer.py] => CNN: {'total': 90.69, '00-09': 94.5, '10-19': 93.8, '20-29': 95.3, '30-39': 92.0, '40-49': 88.8, '50-59': 85.0, '60-69': 85.4, 'old': 91.57, 'new': 85.4}
2023-11-22 22:31:43,044 [trainer.py] => NME: {'total': 91.13, '00-09': 92.3, '10-19': 89.7, '20-29': 94.1, '30-39': 90.3, '40-49': 90.9, '50-59': 84.3, '60-69': 96.3, 'old': 90.27, 'new': 96.3}
2023-11-22 22:31:43,044 [trainer.py] => CNN top1 curve: [99.3, 96.8, 95.1, 92.2, 91.38, 91.28, 90.69]
2023-11-22 22:31:43,044 [trainer.py] => CNN top5 curve: [100.0, 99.75, 99.6, 99.6, 99.54, 99.35, 99.36]
2023-11-22 22:31:43,044 [trainer.py] => NME top1 curve: [99.3, 96.55, 95.7, 94.12, 92.5, 92.42, 91.13]
2023-11-22 22:31:43,044 [trainer.py] => NME top5 curve: [100.0, 99.85, 99.6, 99.48, 99.54, 99.38, 99.33]

Average Accuracy (CNN): 93.82142857142857
Average Accuracy (NME): 94.53142857142858
2023-11-22 22:31:43,044 [trainer.py] => Average Accuracy (CNN): 93.82142857142857
2023-11-22 22:31:43,044 [trainer.py] => Average Accuracy (NME): 94.53142857142858
2023-11-22 22:31:43,046 [trainer.py] => All params: 171804872
2023-11-22 22:31:43,047 [trainer.py] => Trainable params: 85960076
2023-11-22 22:31:44,554 [foster.py] => Learning on 70-80
2023-11-22 22:31:44,556 [foster.py] => All params: 171835622
2023-11-22 22:31:44,557 [foster.py] => Trainable params: 85983136
2023-11-22 22:31:44,877 [foster.py] => per cls weights : [1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142 1.05848142
 1.05848142 1.05848142 1.05848142 1.05848142 0.59063006 0.59063006
 0.59063006 0.59063006 0.59063006 0.59063006 0.59063006 0.59063006
 0.59063006 0.59063006]
  0%|          | 0/20 [00:00<?, ?it/s]Task 7, Epoch 1/20 => Loss 4.723, Loss_clf 0.827, Loss_fe 1.573, Loss_kd 2.032, Train_accy 55.94, Test_accy 86.09:   0%|          | 0/20 [04:19<?, ?it/s]Task 7, Epoch 1/20 => Loss 4.723, Loss_clf 0.827, Loss_fe 1.573, Loss_kd 2.032, Train_accy 55.94, Test_accy 86.09:   5%|▌         | 1/20 [04:19<1:22:04, 259.17s/it]Task 7, Epoch 2/20 => Loss 3.695, Loss_clf 0.562, Loss_fe 0.838, Loss_kd 2.007, Train_accy 55.95:   5%|▌         | 1/20 [06:56<1:22:04, 259.17s/it]                 Task 7, Epoch 2/20 => Loss 3.695, Loss_clf 0.562, Loss_fe 0.838, Loss_kd 2.007, Train_accy 55.95:  10%|█         | 2/20 [06:56<59:51, 199.54s/it]  Task 7, Epoch 3/20 => Loss 3.458, Loss_clf 0.492, Loss_fe 0.668, Loss_kd 2.010, Train_accy 58.92:  10%|█         | 2/20 [09:33<59:51, 199.54s/it]Task 7, Epoch 3/20 => Loss 3.458, Loss_clf 0.492, Loss_fe 0.668, Loss_kd 2.010, Train_accy 58.92:  15%|█▌        | 3/20 [09:33<50:59, 179.98s/it]Task 7, Epoch 4/20 => Loss 3.302, Loss_clf 0.435, Loss_fe 0.596, Loss_kd 1.986, Train_accy 62.14:  15%|█▌        | 3/20 [12:11<50:59, 179.98s/it]Task 7, Epoch 4/20 => Loss 3.302, Loss_clf 0.435, Loss_fe 0.596, Loss_kd 1.986, Train_accy 62.14:  20%|██        | 4/20 [12:11<45:39, 171.24s/it]Task 7, Epoch 5/20 => Loss 3.248, Loss_clf 0.430, Loss_fe 0.531, Loss_kd 2.001, Train_accy 63.39:  20%|██        | 4/20 [14:49<45:39, 171.24s/it]Task 7, Epoch 5/20 => Loss 3.248, Loss_clf 0.430, Loss_fe 0.531, Loss_kd 2.001, Train_accy 63.39:  25%|██▌       | 5/20 [14:49<41:36, 166.44s/it]Task 7, Epoch 6/20 => Loss 3.142, Loss_clf 0.396, Loss_fe 0.479, Loss_kd 1.984, Train_accy 64.77, Test_accy 87.19:  25%|██▌       | 5/20 [19:09<41:36, 166.44s/it]Task 7, Epoch 6/20 => Loss 3.142, Loss_clf 0.396, Loss_fe 0.479, Loss_kd 1.984, Train_accy 64.77, Test_accy 87.19:  30%|███       | 6/20 [19:09<46:15, 198.24s/it]Task 7, Epoch 7/20 => Loss 3.094, Loss_clf 0.374, Loss_fe 0.440, Loss_kd 1.995, Train_accy 66.33:  30%|███       | 6/20 [21:47<46:15, 198.24s/it]                 Task 7, Epoch 7/20 => Loss 3.094, Loss_clf 0.374, Loss_fe 0.440, Loss_kd 1.995, Train_accy 66.33:  35%|███▌      | 7/20 [21:47<40:05, 185.06s/it]Task 7, Epoch 8/20 => Loss 3.052, Loss_clf 0.352, Loss_fe 0.401, Loss_kd 2.012, Train_accy 66.38:  35%|███▌      | 7/20 [24:24<40:05, 185.06s/it]Task 7, Epoch 8/20 => Loss 3.052, Loss_clf 0.352, Loss_fe 0.401, Loss_kd 2.012, Train_accy 66.38:  40%|████      | 8/20 [24:24<35:12, 176.03s/it]Task 7, Epoch 9/20 => Loss 3.003, Loss_clf 0.344, Loss_fe 0.385, Loss_kd 1.990, Train_accy 67.70:  40%|████      | 8/20 [27:01<35:12, 176.03s/it]Task 7, Epoch 9/20 => Loss 3.003, Loss_clf 0.344, Loss_fe 0.385, Loss_kd 1.990, Train_accy 67.70:  45%|████▌     | 9/20 [27:01<31:14, 170.36s/it]Task 7, Epoch 10/20 => Loss 2.935, Loss_clf 0.310, Loss_fe 0.354, Loss_kd 1.986, Train_accy 69.11:  45%|████▌     | 9/20 [29:39<31:14, 170.36s/it]Task 7, Epoch 10/20 => Loss 2.935, Loss_clf 0.310, Loss_fe 0.354, Loss_kd 1.986, Train_accy 69.11:  50%|█████     | 10/20 [29:39<27:44, 166.49s/it]Task 7, Epoch 11/20 => Loss 2.921, Loss_clf 0.302, Loss_fe 0.331, Loss_kd 2.002, Train_accy 69.89, Test_accy 87.90:  50%|█████     | 10/20 [33:58<27:44, 166.49s/it]Task 7, Epoch 11/20 => Loss 2.921, Loss_clf 0.302, Loss_fe 0.331, Loss_kd 2.002, Train_accy 69.89, Test_accy 87.90:  55%|█████▌    | 11/20 [33:58<29:13, 194.83s/it]Task 7, Epoch 12/20 => Loss 2.874, Loss_clf 0.278, Loss_fe 0.308, Loss_kd 2.002, Train_accy 71.53:  55%|█████▌    | 11/20 [36:35<29:13, 194.83s/it]                 Task 7, Epoch 12/20 => Loss 2.874, Loss_clf 0.278, Loss_fe 0.308, Loss_kd 2.002, Train_accy 71.53:  60%|██████    | 12/20 [36:35<24:25, 183.21s/it]Task 7, Epoch 13/20 => Loss 2.848, Loss_clf 0.280, Loss_fe 0.285, Loss_kd 1.997, Train_accy 73.17:  60%|██████    | 12/20 [39:13<24:25, 183.21s/it]Task 7, Epoch 13/20 => Loss 2.848, Loss_clf 0.280, Loss_fe 0.285, Loss_kd 1.997, Train_accy 73.17:  65%|██████▌   | 13/20 [39:13<20:28, 175.54s/it]Task 7, Epoch 14/20 => Loss 2.830, Loss_clf 0.274, Loss_fe 0.265, Loss_kd 2.005, Train_accy 73.39:  65%|██████▌   | 13/20 [41:51<20:28, 175.54s/it]Task 7, Epoch 14/20 => Loss 2.830, Loss_clf 0.274, Loss_fe 0.265, Loss_kd 2.005, Train_accy 73.39:  70%|███████   | 14/20 [41:51<17:01, 170.21s/it]Task 7, Epoch 15/20 => Loss 2.763, Loss_clf 0.243, Loss_fe 0.237, Loss_kd 1.997, Train_accy 75.30:  70%|███████   | 14/20 [44:28<17:01, 170.21s/it]Task 7, Epoch 15/20 => Loss 2.763, Loss_clf 0.243, Loss_fe 0.237, Loss_kd 1.997, Train_accy 75.30:  75%|███████▌  | 15/20 [44:28<13:52, 166.43s/it]Task 7, Epoch 16/20 => Loss 2.753, Loss_clf 0.249, Loss_fe 0.232, Loss_kd 1.988, Train_accy 75.09, Test_accy 88.25:  75%|███████▌  | 15/20 [48:33<13:52, 166.43s/it]Task 7, Epoch 16/20 => Loss 2.753, Loss_clf 0.249, Loss_fe 0.232, Loss_kd 1.988, Train_accy 75.09, Test_accy 88.25:  80%|████████  | 16/20 [48:33<12:39, 189.94s/it]Task 7, Epoch 17/20 => Loss 2.739, Loss_clf 0.243, Loss_fe 0.224, Loss_kd 1.988, Train_accy 76.25:  80%|████████  | 16/20 [51:07<12:39, 189.94s/it]                 Task 7, Epoch 17/20 => Loss 2.739, Loss_clf 0.243, Loss_fe 0.224, Loss_kd 1.988, Train_accy 76.25:  85%|████████▌ | 17/20 [51:07<08:57, 179.24s/it]Task 7, Epoch 18/20 => Loss 2.728, Loss_clf 0.235, Loss_fe 0.217, Loss_kd 1.992, Train_accy 75.20:  85%|████████▌ | 17/20 [53:44<08:57, 179.24s/it]Task 7, Epoch 18/20 => Loss 2.728, Loss_clf 0.235, Loss_fe 0.217, Loss_kd 1.992, Train_accy 75.20:  90%|█████████ | 18/20 [53:44<05:44, 172.43s/it]Task 7, Epoch 19/20 => Loss 2.732, Loss_clf 0.238, Loss_fe 0.217, Loss_kd 1.992, Train_accy 75.92:  90%|█████████ | 18/20 [56:22<05:44, 172.43s/it]Task 7, Epoch 19/20 => Loss 2.732, Loss_clf 0.238, Loss_fe 0.217, Loss_kd 1.992, Train_accy 75.92:  95%|█████████▌| 19/20 [56:22<02:48, 168.00s/it]Task 7, Epoch 20/20 => Loss 2.730, Loss_clf 0.238, Loss_fe 0.222, Loss_kd 1.987, Train_accy 75.81:  95%|█████████▌| 19/20 [58:59<02:48, 168.00s/it]Task 7, Epoch 20/20 => Loss 2.730, Loss_clf 0.238, Loss_fe 0.222, Loss_kd 1.987, Train_accy 75.81: 100%|██████████| 20/20 [58:59<00:00, 164.68s/it]Task 7, Epoch 20/20 => Loss 2.730, Loss_clf 0.238, Loss_fe 0.222, Loss_kd 1.987, Train_accy 75.81: 100%|██████████| 20/20 [58:59<00:00, 176.95s/it]2023-11-22 23:30:43,902 [foster.py] => Task 7, Epoch 20/20 => Loss 2.730, Loss_clf 0.238, Loss_fe 0.222, Loss_kd 1.987, Train_accy 75.81
2023-11-22 23:30:43,903 [foster.py] => do not weight align teacher!
2023-11-22 23:30:43,907 [foster.py] => per cls weights : [1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178 1.07293178
 1.07293178 1.07293178 1.07293178 1.07293178 0.48947755 0.48947755
 0.48947755 0.48947755 0.48947755 0.48947755 0.48947755 0.48947755
 0.48947755 0.48947755]

  0%|          | 0/20 [00:00<?, ?it/s]SNet: Task 7, Epoch 1/20 => Loss 2.229,  Train_accy 50.38, Test_accy 86.50:   0%|          | 0/20 [04:08<?, ?it/s]SNet: Task 7, Epoch 1/20 => Loss 2.229,  Train_accy 50.38, Test_accy 86.50:   5%|▌         | 1/20 [04:08<1:18:34, 248.13s/it]SNet: Task 7, Epoch 2/20 => Loss 2.088,  Train_accy 56.39:   5%|▌         | 1/20 [07:23<1:18:34, 248.13s/it]                 SNet: Task 7, Epoch 2/20 => Loss 2.088,  Train_accy 56.39:  10%|█         | 2/20 [07:23<1:05:08, 217.12s/it]SNet: Task 7, Epoch 3/20 => Loss 2.088,  Train_accy 56.00:  10%|█         | 2/20 [10:40<1:05:08, 217.12s/it]SNet: Task 7, Epoch 3/20 => Loss 2.088,  Train_accy 56.00:  15%|█▌        | 3/20 [10:40<58:51, 207.74s/it]  SNet: Task 7, Epoch 4/20 => Loss 2.085,  Train_accy 58.22:  15%|█▌        | 3/20 [13:55<58:51, 207.74s/it]SNet: Task 7, Epoch 4/20 => Loss 2.085,  Train_accy 58.22:  20%|██        | 4/20 [13:55<54:07, 202.97s/it]SNet: Task 7, Epoch 5/20 => Loss 2.076,  Train_accy 58.72:  20%|██        | 4/20 [17:11<54:07, 202.97s/it]SNet: Task 7, Epoch 5/20 => Loss 2.076,  Train_accy 58.72:  25%|██▌       | 5/20 [17:11<50:02, 200.18s/it]SNet: Task 7, Epoch 6/20 => Loss 2.055,  Train_accy 58.56, Test_accy 86.76:  25%|██▌       | 5/20 [21:19<50:02, 200.18s/it]SNet: Task 7, Epoch 6/20 => Loss 2.055,  Train_accy 58.56, Test_accy 86.76:  30%|███       | 6/20 [21:19<50:31, 216.50s/it]SNet: Task 7, Epoch 7/20 => Loss 2.076,  Train_accy 58.36:  30%|███       | 6/20 [24:35<50:31, 216.50s/it]                 SNet: Task 7, Epoch 7/20 => Loss 2.076,  Train_accy 58.36:  35%|███▌      | 7/20 [24:35<45:29, 210.00s/it]SNet: Task 7, Epoch 8/20 => Loss 2.082,  Train_accy 58.48:  35%|███▌      | 7/20 [27:51<45:29, 210.00s/it]SNet: Task 7, Epoch 8/20 => Loss 2.082,  Train_accy 58.48:  40%|████      | 8/20 [27:51<41:05, 205.44s/it]SNet: Task 7, Epoch 9/20 => Loss 2.066,  Train_accy 59.23:  40%|████      | 8/20 [31:06<41:05, 205.44s/it]SNet: Task 7, Epoch 9/20 => Loss 2.066,  Train_accy 59.23:  45%|████▌     | 9/20 [31:06<37:05, 202.30s/it]SNet: Task 7, Epoch 10/20 => Loss 2.084,  Train_accy 58.44:  45%|████▌     | 9/20 [34:23<37:05, 202.30s/it]SNet: Task 7, Epoch 10/20 => Loss 2.084,  Train_accy 58.44:  50%|█████     | 10/20 [34:23<33:25, 200.52s/it]SNet: Task 7, Epoch 11/20 => Loss 2.063,  Train_accy 58.67, Test_accy 86.99:  50%|█████     | 10/20 [38:29<33:25, 200.52s/it]SNet: Task 7, Epoch 11/20 => Loss 2.063,  Train_accy 58.67, Test_accy 86.99:  55%|█████▌    | 11/20 [38:29<32:10, 214.46s/it]SNet: Task 7, Epoch 12/20 => Loss 2.042,  Train_accy 59.16:  55%|█████▌    | 11/20 [41:44<32:10, 214.46s/it]                 SNet: Task 7, Epoch 12/20 => Loss 2.042,  Train_accy 59.16:  60%|██████    | 12/20 [41:44<27:49, 208.66s/it]SNet: Task 7, Epoch 13/20 => Loss 2.062,  Train_accy 59.86:  60%|██████    | 12/20 [45:01<27:49, 208.66s/it]SNet: Task 7, Epoch 13/20 => Loss 2.062,  Train_accy 59.86:  65%|██████▌   | 13/20 [45:01<23:55, 205.09s/it]SNet: Task 7, Epoch 14/20 => Loss 2.051,  Train_accy 58.84:  65%|██████▌   | 13/20 [48:18<23:55, 205.09s/it]SNet: Task 7, Epoch 14/20 => Loss 2.051,  Train_accy 58.84:  70%|███████   | 14/20 [48:18<20:15, 202.60s/it]SNet: Task 7, Epoch 15/20 => Loss 2.057,  Train_accy 59.88:  70%|███████   | 14/20 [51:34<20:15, 202.60s/it]SNet: Task 7, Epoch 15/20 => Loss 2.057,  Train_accy 59.88:  75%|███████▌  | 15/20 [51:34<16:42, 200.59s/it]SNet: Task 7, Epoch 16/20 => Loss 2.053,  Train_accy 60.22, Test_accy 86.90:  75%|███████▌  | 15/20 [55:42<16:42, 200.59s/it]SNet: Task 7, Epoch 16/20 => Loss 2.053,  Train_accy 60.22, Test_accy 86.90:  80%|████████  | 16/20 [55:42<14:19, 214.82s/it]SNet: Task 7, Epoch 17/20 => Loss 2.053,  Train_accy 58.55:  80%|████████  | 16/20 [58:59<14:19, 214.82s/it]                 SNet: Task 7, Epoch 17/20 => Loss 2.053,  Train_accy 58.55:  85%|████████▌ | 17/20 [58:59<10:28, 209.36s/it]SNet: Task 7, Epoch 18/20 => Loss 2.062,  Train_accy 59.53:  85%|████████▌ | 17/20 [1:02:16<10:28, 209.36s/it]SNet: Task 7, Epoch 18/20 => Loss 2.062,  Train_accy 59.53:  90%|█████████ | 18/20 [1:02:16<06:51, 205.78s/it]SNet: Task 7, Epoch 19/20 => Loss 2.051,  Train_accy 59.47:  90%|█████████ | 18/20 [1:05:32<06:51, 205.78s/it]SNet: Task 7, Epoch 19/20 => Loss 2.051,  Train_accy 59.47:  95%|█████████▌| 19/20 [1:05:32<03:22, 202.89s/it]SNet: Task 7, Epoch 20/20 => Loss 2.058,  Train_accy 59.41:  95%|█████████▌| 19/20 [1:08:48<03:22, 202.89s/it]SNet: Task 7, Epoch 20/20 => Loss 2.058,  Train_accy 59.41: 100%|██████████| 20/20 [1:08:48<00:00, 200.63s/it]SNet: Task 7, Epoch 20/20 => Loss 2.058,  Train_accy 59.41: 100%|██████████| 20/20 [1:08:48<00:00, 206.40s/it]2023-11-23 00:39:33,695 [foster.py] => SNet: Task 7, Epoch 20/20 => Loss 2.058,  Train_accy 59.41
2023-11-23 00:39:33,695 [foster.py] => do not weight align student!

2023-11-23 00:40:26,160 [foster.py] => darknet eval: 
2023-11-23 00:40:26,161 [foster.py] => CNN top1 curve: 86.88
2023-11-23 00:40:26,161 [foster.py] => CNN top5 curve: 99.34
2023-11-23 00:40:26,163 [base.py] => Constructing exemplars for new classes...(20 per classes)
2023-11-23 00:45:48,092 [foster.py] => Exemplar size: 1600
2023-11-23 00:45:48,092 [trainer.py] => CNN: {'total': 88.3, '00-09': 93.4, '10-19': 93.5, '20-29': 94.6, '30-39': 92.1, '40-49': 89.9, '50-59': 85.4, '60-69': 85.1, '70-79': 72.4, 'old': 90.57, 'new': 72.4}
2023-11-23 00:45:48,092 [trainer.py] => NME: {'total': 89.01, '00-09': 91.9, '10-19': 89.1, '20-29': 93.5, '30-39': 89.5, '40-49': 88.9, '50-59': 79.3, '60-69': 88.4, '70-79': 91.5, 'old': 88.66, 'new': 91.5}
2023-11-23 00:45:48,093 [trainer.py] => CNN top1 curve: [99.3, 96.8, 95.1, 92.2, 91.38, 91.28, 90.69, 88.3]
2023-11-23 00:45:48,093 [trainer.py] => CNN top5 curve: [100.0, 99.75, 99.6, 99.6, 99.54, 99.35, 99.36, 99.22]
2023-11-23 00:45:48,093 [trainer.py] => NME top1 curve: [99.3, 96.55, 95.7, 94.12, 92.5, 92.42, 91.13, 89.01]
2023-11-23 00:45:48,093 [trainer.py] => NME top5 curve: [100.0, 99.85, 99.6, 99.48, 99.54, 99.38, 99.33, 99.31]

Average Accuracy (CNN): 93.13125
Average Accuracy (NME): 93.84125
2023-11-23 00:45:48,093 [trainer.py] => Average Accuracy (CNN): 93.13125
2023-11-23 00:45:48,093 [trainer.py] => Average Accuracy (NME): 93.84125
2023-11-23 00:45:48,094 [trainer.py] => All params: 171835622
2023-11-23 00:45:48,095 [trainer.py] => Trainable params: 85983136
2023-11-23 00:45:49,708 [foster.py] => Learning on 80-90
2023-11-23 00:45:49,710 [foster.py] => All params: 171866372
2023-11-23 00:45:49,711 [foster.py] => Trainable params: 86006196
2023-11-23 00:45:50,020 [foster.py] => per cls weights : [1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788 1.05164788
 1.05164788 1.05164788 0.58681696 0.58681696 0.58681696 0.58681696
 0.58681696 0.58681696 0.58681696 0.58681696 0.58681696 0.58681696]
  0%|          | 0/20 [00:00<?, ?it/s]Task 8, Epoch 1/20 => Loss 4.625, Loss_clf 0.791, Loss_fe 1.576, Loss_kd 2.007, Train_accy 55.98, Test_accy 84.76:   0%|          | 0/20 [04:36<?, ?it/s]Task 8, Epoch 1/20 => Loss 4.625, Loss_clf 0.791, Loss_fe 1.576, Loss_kd 2.007, Train_accy 55.98, Test_accy 84.76:   5%|▌         | 1/20 [04:36<1:27:39, 276.82s/it]Task 8, Epoch 2/20 => Loss 3.634, Loss_clf 0.502, Loss_fe 0.877, Loss_kd 2.003, Train_accy 59.09:   5%|▌         | 1/20 [07:18<1:27:39, 276.82s/it]                 Task 8, Epoch 2/20 => Loss 3.634, Loss_clf 0.502, Loss_fe 0.877, Loss_kd 2.003, Train_accy 59.09:  10%|█         | 2/20 [07:18<1:02:41, 208.98s/it]Task 8, Epoch 3/20 => Loss 3.407, Loss_clf 0.462, Loss_fe 0.716, Loss_kd 1.981, Train_accy 60.79:  10%|█         | 2/20 [10:01<1:02:41, 208.98s/it]Task 8, Epoch 3/20 => Loss 3.407, Loss_clf 0.462, Loss_fe 0.716, Loss_kd 1.981, Train_accy 60.79:  15%|█▌        | 3/20 [10:01<53:14, 187.92s/it]  Task 8, Epoch 4/20 => Loss 3.232, Loss_clf 0.405, Loss_fe 0.600, Loss_kd 1.980, Train_accy 63.77:  15%|█▌        | 3/20 [12:44<53:14, 187.92s/it]Task 8, Epoch 4/20 => Loss 3.232, Loss_clf 0.405, Loss_fe 0.600, Loss_kd 1.980, Train_accy 63.77:  20%|██        | 4/20 [12:44<47:29, 178.08s/it]Task 8, Epoch 5/20 => Loss 3.219, Loss_clf 0.405, Loss_fe 0.562, Loss_kd 2.002, Train_accy 65.05:  20%|██        | 4/20 [15:26<47:29, 178.08s/it]Task 8, Epoch 5/20 => Loss 3.219, Loss_clf 0.405, Loss_fe 0.562, Loss_kd 2.002, Train_accy 65.05:  25%|██▌       | 5/20 [15:26<43:08, 172.56s/it]Task 8, Epoch 6/20 => Loss 3.078, Loss_clf 0.375, Loss_fe 0.480, Loss_kd 1.976, Train_accy 66.09, Test_accy 86.52:  25%|██▌       | 5/20 [19:43<43:08, 172.56s/it]Task 8, Epoch 6/20 => Loss 3.078, Loss_clf 0.375, Loss_fe 0.480, Loss_kd 1.976, Train_accy 66.09, Test_accy 86.52:  30%|███       | 6/20 [19:43<46:56, 201.20s/it]Task 8, Epoch 7/20 => Loss 3.079, Loss_clf 0.379, Loss_fe 0.474, Loss_kd 1.979, Train_accy 65.85:  30%|███       | 6/20 [22:22<46:56, 201.20s/it]                 Task 8, Epoch 7/20 => Loss 3.079, Loss_clf 0.379, Loss_fe 0.474, Loss_kd 1.979, Train_accy 65.85:  35%|███▌      | 7/20 [22:22<40:34, 187.23s/it]Task 8, Epoch 8/20 => Loss 3.031, Loss_clf 0.361, Loss_fe 0.422, Loss_kd 1.997, Train_accy 67.74:  35%|███▌      | 7/20 [25:03<40:34, 187.23s/it]Task 8, Epoch 8/20 => Loss 3.031, Loss_clf 0.361, Loss_fe 0.422, Loss_kd 1.997, Train_accy 67.74:  40%|████      | 8/20 [25:03<35:46, 178.90s/it]Task 8, Epoch 9/20 => Loss 2.977, Loss_clf 0.348, Loss_fe 0.396, Loss_kd 1.985, Train_accy 70.23:  40%|████      | 8/20 [27:45<35:46, 178.90s/it]Task 8, Epoch 9/20 => Loss 2.977, Loss_clf 0.348, Loss_fe 0.396, Loss_kd 1.985, Train_accy 70.23:  45%|████▌     | 9/20 [27:45<31:51, 173.77s/it]Task 8, Epoch 10/20 => Loss 2.889, Loss_clf 0.311, Loss_fe 0.354, Loss_kd 1.976, Train_accy 71.27:  45%|████▌     | 9/20 [30:28<31:51, 173.77s/it]Task 8, Epoch 10/20 => Loss 2.889, Loss_clf 0.311, Loss_fe 0.354, Loss_kd 1.976, Train_accy 71.27:  50%|█████     | 10/20 [30:28<28:23, 170.36s/it]Task 8, Epoch 11/20 => Loss 2.912, Loss_clf 0.315, Loss_fe 0.341, Loss_kd 2.006, Train_accy 73.41, Test_accy 87.36:  50%|█████     | 10/20 [35:04<28:23, 170.36s/it]Task 8, Epoch 11/20 => Loss 2.912, Loss_clf 0.315, Loss_fe 0.341, Loss_kd 2.006, Train_accy 73.41, Test_accy 87.36:  55%|█████▌    | 11/20 [35:04<30:25, 202.78s/it]Task 8, Epoch 12/20 => Loss 2.840, Loss_clf 0.294, Loss_fe 0.314, Loss_kd 1.984, Train_accy 73.38:  55%|█████▌    | 11/20 [37:45<30:25, 202.78s/it]                 Task 8, Epoch 12/20 => Loss 2.840, Loss_clf 0.294, Loss_fe 0.314, Loss_kd 1.984, Train_accy 73.38:  60%|██████    | 12/20 [37:45<25:20, 190.12s/it]Task 8, Epoch 13/20 => Loss 2.810, Loss_clf 0.299, Loss_fe 0.293, Loss_kd 1.972, Train_accy 72.85:  60%|██████    | 12/20 [40:28<25:20, 190.12s/it]Task 8, Epoch 13/20 => Loss 2.810, Loss_clf 0.299, Loss_fe 0.293, Loss_kd 1.972, Train_accy 72.85:  65%|██████▌   | 13/20 [40:28<21:12, 181.75s/it]Task 8, Epoch 14/20 => Loss 2.811, Loss_clf 0.284, Loss_fe 0.286, Loss_kd 1.992, Train_accy 73.95:  65%|██████▌   | 13/20 [43:10<21:12, 181.75s/it]Task 8, Epoch 14/20 => Loss 2.811, Loss_clf 0.284, Loss_fe 0.286, Loss_kd 1.992, Train_accy 73.95:  70%|███████   | 14/20 [43:10<17:34, 175.74s/it]Task 8, Epoch 15/20 => Loss 2.801, Loss_clf 0.287, Loss_fe 0.270, Loss_kd 1.995, Train_accy 74.24:  70%|███████   | 14/20 [45:52<17:34, 175.74s/it]Task 8, Epoch 15/20 => Loss 2.801, Loss_clf 0.287, Loss_fe 0.270, Loss_kd 1.995, Train_accy 74.24:  75%|███████▌  | 15/20 [45:52<14:18, 171.73s/it]Task 8, Epoch 16/20 => Loss 2.740, Loss_clf 0.259, Loss_fe 0.247, Loss_kd 1.986, Train_accy 76.30, Test_accy 86.94:  75%|███████▌  | 15/20 [50:28<14:18, 171.73s/it]Task 8, Epoch 16/20 => Loss 2.740, Loss_clf 0.259, Loss_fe 0.247, Loss_kd 1.986, Train_accy 76.30, Test_accy 86.94:  80%|████████  | 16/20 [50:28<13:32, 203.09s/it]Task 8, Epoch 17/20 => Loss 2.760, Loss_clf 0.274, Loss_fe 0.265, Loss_kd 1.975, Train_accy 74.67:  80%|████████  | 16/20 [53:10<13:32, 203.09s/it]                 Task 8, Epoch 17/20 => Loss 2.760, Loss_clf 0.274, Loss_fe 0.265, Loss_kd 1.975, Train_accy 74.67:  85%|████████▌ | 17/20 [53:10<09:32, 190.75s/it]Task 8, Epoch 18/20 => Loss 2.686, Loss_clf 0.243, Loss_fe 0.224, Loss_kd 1.972, Train_accy 76.42:  85%|████████▌ | 17/20 [55:53<09:32, 190.75s/it]Task 8, Epoch 18/20 => Loss 2.686, Loss_clf 0.243, Loss_fe 0.224, Loss_kd 1.972, Train_accy 76.42:  90%|█████████ | 18/20 [55:53<06:04, 182.35s/it]Task 8, Epoch 19/20 => Loss 2.705, Loss_clf 0.248, Loss_fe 0.225, Loss_kd 1.984, Train_accy 74.79:  90%|█████████ | 18/20 [58:36<06:04, 182.35s/it]Task 8, Epoch 19/20 => Loss 2.705, Loss_clf 0.248, Loss_fe 0.225, Loss_kd 1.984, Train_accy 74.79:  95%|█████████▌| 19/20 [58:36<02:56, 176.43s/it]Task 8, Epoch 20/20 => Loss 2.697, Loss_clf 0.249, Loss_fe 0.224, Loss_kd 1.977, Train_accy 76.03:  95%|█████████▌| 19/20 [1:01:17<02:56, 176.43s/it]Task 8, Epoch 20/20 => Loss 2.697, Loss_clf 0.249, Loss_fe 0.224, Loss_kd 1.977, Train_accy 76.03: 100%|██████████| 20/20 [1:01:17<00:00, 171.90s/it]Task 8, Epoch 20/20 => Loss 2.697, Loss_clf 0.249, Loss_fe 0.224, Loss_kd 1.977, Train_accy 76.03: 100%|██████████| 20/20 [1:01:17<00:00, 183.87s/it]2023-11-23 01:47:07,474 [foster.py] => Task 8, Epoch 20/20 => Loss 2.697, Loss_clf 0.249, Loss_fe 0.224, Loss_kd 1.977, Train_accy 76.03
2023-11-23 01:47:07,475 [foster.py] => do not weight align teacher!
2023-11-23 01:47:07,478 [foster.py] => per cls weights : [1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713 1.06430713
 1.06430713 1.06430713 0.48554293 0.48554293 0.48554293 0.48554293
 0.48554293 0.48554293 0.48554293 0.48554293 0.48554293 0.48554293]

  0%|          | 0/20 [00:00<?, ?it/s]SNet: Task 8, Epoch 1/20 => Loss 2.100,  Train_accy 52.82, Test_accy 85.34:   0%|          | 0/20 [04:20<?, ?it/s]SNet: Task 8, Epoch 1/20 => Loss 2.100,  Train_accy 52.82, Test_accy 85.34:   5%|▌         | 1/20 [04:20<1:22:38, 260.99s/it]SNet: Task 8, Epoch 2/20 => Loss 1.958,  Train_accy 56.95:   5%|▌         | 1/20 [07:43<1:22:38, 260.99s/it]                 SNet: Task 8, Epoch 2/20 => Loss 1.958,  Train_accy 56.95:  10%|█         | 2/20 [07:43<1:07:59, 226.63s/it]SNet: Task 8, Epoch 3/20 => Loss 1.977,  Train_accy 57.08:  10%|█         | 2/20 [11:04<1:07:59, 226.63s/it]SNet: Task 8, Epoch 3/20 => Loss 1.977,  Train_accy 57.08:  15%|█▌        | 3/20 [11:04<1:00:52, 214.86s/it]SNet: Task 8, Epoch 4/20 => Loss 1.954,  Train_accy 58.48:  15%|█▌        | 3/20 [14:25<1:00:52, 214.86s/it]SNet: Task 8, Epoch 4/20 => Loss 1.954,  Train_accy 58.48:  20%|██        | 4/20 [14:25<55:53, 209.58s/it]  SNet: Task 8, Epoch 5/20 => Loss 1.940,  Train_accy 59.35:  20%|██        | 4/20 [17:49<55:53, 209.58s/it]SNet: Task 8, Epoch 5/20 => Loss 1.940,  Train_accy 59.35:  25%|██▌       | 5/20 [17:49<51:48, 207.24s/it]SNet: Task 8, Epoch 6/20 => Loss 1.934,  Train_accy 60.02, Test_accy 85.73:  25%|██▌       | 5/20 [22:10<51:48, 207.24s/it]SNet: Task 8, Epoch 6/20 => Loss 1.934,  Train_accy 60.02, Test_accy 85.73:  30%|███       | 6/20 [22:10<52:38, 225.59s/it]SNet: Task 8, Epoch 7/20 => Loss 1.956,  Train_accy 58.91:  30%|███       | 6/20 [25:33<52:38, 225.59s/it]                 SNet: Task 8, Epoch 7/20 => Loss 1.956,  Train_accy 58.91:  35%|███▌      | 7/20 [25:33<47:17, 218.29s/it]SNet: Task 8, Epoch 8/20 => Loss 1.929,  Train_accy 60.11:  35%|███▌      | 7/20 [28:54<47:17, 218.29s/it]SNet: Task 8, Epoch 8/20 => Loss 1.929,  Train_accy 60.11:  40%|████      | 8/20 [28:54<42:34, 212.87s/it]SNet: Task 8, Epoch 9/20 => Loss 1.958,  Train_accy 59.48:  40%|████      | 8/20 [32:17<42:34, 212.87s/it]SNet: Task 8, Epoch 9/20 => Loss 1.958,  Train_accy 59.48:  45%|████▌     | 9/20 [32:17<38:27, 209.81s/it]SNet: Task 8, Epoch 10/20 => Loss 1.938,  Train_accy 58.95:  45%|████▌     | 9/20 [35:40<38:27, 209.81s/it]SNet: Task 8, Epoch 10/20 => Loss 1.938,  Train_accy 58.95:  50%|█████     | 10/20 [35:40<34:35, 207.55s/it]SNet: Task 8, Epoch 11/20 => Loss 1.935,  Train_accy 59.97, Test_accy 85.56:  50%|█████     | 10/20 [40:01<34:35, 207.55s/it]SNet: Task 8, Epoch 11/20 => Loss 1.935,  Train_accy 59.97, Test_accy 85.56:  55%|█████▌    | 11/20 [40:01<33:36, 224.08s/it]SNet: Task 8, Epoch 12/20 => Loss 1.957,  Train_accy 59.03:  55%|█████▌    | 11/20 [43:23<33:36, 224.08s/it]                 SNet: Task 8, Epoch 12/20 => Loss 1.957,  Train_accy 59.03:  60%|██████    | 12/20 [43:23<28:56, 217.12s/it]SNet: Task 8, Epoch 13/20 => Loss 1.953,  Train_accy 59.26:  60%|██████    | 12/20 [46:45<28:56, 217.12s/it]SNet: Task 8, Epoch 13/20 => Loss 1.953,  Train_accy 59.26:  65%|██████▌   | 13/20 [46:45<24:49, 212.81s/it]SNet: Task 8, Epoch 14/20 => Loss 1.941,  Train_accy 59.08:  65%|██████▌   | 13/20 [50:08<24:49, 212.81s/it]SNet: Task 8, Epoch 14/20 => Loss 1.941,  Train_accy 59.08:  70%|███████   | 14/20 [50:08<20:58, 209.82s/it]SNet: Task 8, Epoch 15/20 => Loss 1.933,  Train_accy 59.35:  70%|███████   | 14/20 [53:31<20:58, 209.82s/it]SNet: Task 8, Epoch 15/20 => Loss 1.933,  Train_accy 59.35:  75%|███████▌  | 15/20 [53:31<17:17, 207.55s/it]SNet: Task 8, Epoch 16/20 => Loss 1.960,  Train_accy 59.26, Test_accy 85.56:  75%|███████▌  | 15/20 [57:51<17:17, 207.55s/it]SNet: Task 8, Epoch 16/20 => Loss 1.960,  Train_accy 59.26, Test_accy 85.56:  80%|████████  | 16/20 [57:51<14:53, 223.36s/it]SNet: Task 8, Epoch 17/20 => Loss 1.936,  Train_accy 60.20:  80%|████████  | 16/20 [1:01:13<14:53, 223.36s/it]               SNet: Task 8, Epoch 17/20 => Loss 1.936,  Train_accy 60.20:  85%|████████▌ | 17/20 [1:01:13<10:51, 217.16s/it]SNet: Task 8, Epoch 18/20 => Loss 1.943,  Train_accy 59.59:  85%|████████▌ | 17/20 [1:04:36<10:51, 217.16s/it]SNet: Task 8, Epoch 18/20 => Loss 1.943,  Train_accy 59.59:  90%|█████████ | 18/20 [1:04:36<07:05, 212.87s/it]SNet: Task 8, Epoch 19/20 => Loss 1.950,  Train_accy 59.95:  90%|█████████ | 18/20 [1:07:58<07:05, 212.87s/it]SNet: Task 8, Epoch 19/20 => Loss 1.950,  Train_accy 59.95:  95%|█████████▌| 19/20 [1:07:58<03:29, 209.64s/it]SNet: Task 8, Epoch 20/20 => Loss 1.918,  Train_accy 60.44:  95%|█████████▌| 19/20 [1:10:53<03:29, 209.64s/it]SNet: Task 8, Epoch 20/20 => Loss 1.918,  Train_accy 60.44: 100%|██████████| 20/20 [1:10:53<00:00, 199.02s/it]SNet: Task 8, Epoch 20/20 => Loss 1.918,  Train_accy 60.44: 100%|██████████| 20/20 [1:10:53<00:00, 212.66s/it]2023-11-23 02:58:02,560 [foster.py] => SNet: Task 8, Epoch 20/20 => Loss 1.918,  Train_accy 60.44
2023-11-23 02:58:02,561 [foster.py] => do not weight align student!

2023-11-23 02:58:57,997 [foster.py] => darknet eval: 
2023-11-23 02:58:57,998 [foster.py] => CNN top1 curve: 85.53
2023-11-23 02:58:57,998 [foster.py] => CNN top5 curve: 99.11
2023-11-23 02:58:58,000 [base.py] => Constructing exemplars for new classes...(20 per classes)
2023-11-23 03:04:48,766 [foster.py] => Exemplar size: 1800
2023-11-23 03:04:48,767 [trainer.py] => CNN: {'total': 87.04, '00-09': 93.6, '10-19': 92.9, '20-29': 95.1, '30-39': 91.3, '40-49': 88.7, '50-59': 84.2, '60-69': 87.6, '70-79': 79.0, '80-89': 71.0, 'old': 89.05, 'new': 71.0}
2023-11-23 03:04:48,767 [trainer.py] => NME: {'total': 88.04, '00-09': 90.1, '10-19': 88.4, '20-29': 92.2, '30-39': 89.4, '40-49': 86.5, '50-59': 81.9, '60-69': 89.0, '70-79': 81.7, '80-89': 93.2, 'old': 87.4, 'new': 93.2}
2023-11-23 03:04:48,767 [trainer.py] => CNN top1 curve: [99.3, 96.8, 95.1, 92.2, 91.38, 91.28, 90.69, 88.3, 87.04]
2023-11-23 03:04:48,767 [trainer.py] => CNN top5 curve: [100.0, 99.75, 99.6, 99.6, 99.54, 99.35, 99.36, 99.22, 99.08]
2023-11-23 03:04:48,767 [trainer.py] => NME top1 curve: [99.3, 96.55, 95.7, 94.12, 92.5, 92.42, 91.13, 89.01, 88.04]
2023-11-23 03:04:48,767 [trainer.py] => NME top5 curve: [100.0, 99.85, 99.6, 99.48, 99.54, 99.38, 99.33, 99.31, 99.12]

Average Accuracy (CNN): 92.45444444444443
Average Accuracy (NME): 93.19666666666666
2023-11-23 03:04:48,767 [trainer.py] => Average Accuracy (CNN): 92.45444444444443
2023-11-23 03:04:48,767 [trainer.py] => Average Accuracy (NME): 93.19666666666666
2023-11-23 03:04:48,768 [trainer.py] => All params: 171866372
2023-11-23 03:04:48,769 [trainer.py] => Trainable params: 86006196
2023-11-23 03:04:50,484 [foster.py] => Learning on 90-100
2023-11-23 03:04:50,486 [foster.py] => All params: 171897122
2023-11-23 03:04:50,487 [foster.py] => Trainable params: 86029256
2023-11-23 03:04:50,798 [foster.py] => per cls weights : [1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425 1.04624425
 0.58380175 0.58380175 0.58380175 0.58380175 0.58380175 0.58380175
 0.58380175 0.58380175 0.58380175 0.58380175]
  0%|          | 0/20 [00:00<?, ?it/s]Task 9, Epoch 1/20 => Loss 5.101, Loss_clf 0.867, Loss_fe 1.796, Loss_kd 2.194, Train_accy 61.26, Test_accy 86.44:   0%|          | 0/20 [04:53<?, ?it/s]Task 9, Epoch 1/20 => Loss 5.101, Loss_clf 0.867, Loss_fe 1.796, Loss_kd 2.194, Train_accy 61.26, Test_accy 86.44:   5%|▌         | 1/20 [04:53<1:33:01, 293.75s/it]Task 9, Epoch 2/20 => Loss 4.012, Loss_clf 0.577, Loss_fe 0.986, Loss_kd 2.204, Train_accy 65.04:   5%|▌         | 1/20 [07:41<1:33:01, 293.75s/it]                 Task 9, Epoch 2/20 => Loss 4.012, Loss_clf 0.577, Loss_fe 0.986, Loss_kd 2.204, Train_accy 65.04:  10%|█         | 2/20 [07:41<1:05:50, 219.49s/it]Task 9, Epoch 3/20 => Loss 3.639, Loss_clf 0.494, Loss_fe 0.730, Loss_kd 2.173, Train_accy 67.76:  10%|█         | 2/20 [10:26<1:05:50, 219.49s/it]Task 9, Epoch 3/20 => Loss 3.639, Loss_clf 0.494, Loss_fe 0.730, Loss_kd 2.173, Train_accy 67.76:  15%|█▌        | 3/20 [10:26<55:13, 194.93s/it]  Task 9, Epoch 4/20 => Loss 3.517, Loss_clf 0.458, Loss_fe 0.651, Loss_kd 2.167, Train_accy 69.12:  15%|█▌        | 3/20 [13:14<55:13, 194.93s/it]Task 9, Epoch 4/20 => Loss 3.517, Loss_clf 0.458, Loss_fe 0.651, Loss_kd 2.167, Train_accy 69.12:  20%|██        | 4/20 [13:14<49:05, 184.11s/it]Task 9, Epoch 5/20 => Loss 3.396, Loss_clf 0.421, Loss_fe 0.556, Loss_kd 2.177, Train_accy 71.99:  20%|██        | 4/20 [16:01<49:05, 184.11s/it]Task 9, Epoch 5/20 => Loss 3.396, Loss_clf 0.421, Loss_fe 0.556, Loss_kd 2.177, Train_accy 71.99:  25%|██▌       | 5/20 [16:01<44:31, 178.09s/it]Task 9, Epoch 6/20 => Loss 3.358, Loss_clf 0.399, Loss_fe 0.528, Loss_kd 2.187, Train_accy 71.59, Test_accy 87.73:  25%|██▌       | 5/20 [20:55<44:31, 178.09s/it]Task 9, Epoch 6/20 => Loss 3.358, Loss_clf 0.399, Loss_fe 0.528, Loss_kd 2.187, Train_accy 71.59, Test_accy 87.73:  30%|███       | 6/20 [20:55<50:45, 217.52s/it]Task 9, Epoch 7/20 => Loss 3.282, Loss_clf 0.371, Loss_fe 0.494, Loss_kd 2.176, Train_accy 73.82:  30%|███       | 6/20 [23:41<50:45, 217.52s/it]                 Task 9, Epoch 7/20 => Loss 3.282, Loss_clf 0.371, Loss_fe 0.494, Loss_kd 2.176, Train_accy 73.82:  35%|███▌      | 7/20 [23:41<43:28, 200.63s/it]Task 9, Epoch 8/20 => Loss 3.269, Loss_clf 0.376, Loss_fe 0.465, Loss_kd 2.185, Train_accy 74.65:  35%|███▌      | 7/20 [26:29<43:28, 200.63s/it]Task 9, Epoch 8/20 => Loss 3.269, Loss_clf 0.376, Loss_fe 0.465, Loss_kd 2.185, Train_accy 74.65:  40%|████      | 8/20 [26:29<38:00, 190.04s/it]Task 9, Epoch 9/20 => Loss 3.161, Loss_clf 0.349, Loss_fe 0.411, Loss_kd 2.161, Train_accy 75.03:  40%|████      | 8/20 [29:16<38:00, 190.04s/it]Task 9, Epoch 9/20 => Loss 3.161, Loss_clf 0.349, Loss_fe 0.411, Loss_kd 2.161, Train_accy 75.03:  45%|████▌     | 9/20 [29:16<33:33, 183.01s/it]Task 9, Epoch 10/20 => Loss 3.145, Loss_clf 0.332, Loss_fe 0.381, Loss_kd 2.188, Train_accy 76.53:  45%|████▌     | 9/20 [32:03<33:33, 183.01s/it]Task 9, Epoch 10/20 => Loss 3.145, Loss_clf 0.332, Loss_fe 0.381, Loss_kd 2.188, Train_accy 76.53:  50%|█████     | 10/20 [32:03<29:39, 177.95s/it]Task 9, Epoch 11/20 => Loss 3.075, Loss_clf 0.325, Loss_fe 0.350, Loss_kd 2.160, Train_accy 75.85, Test_accy 87.99:  50%|█████     | 10/20 [36:56<29:39, 177.95s/it]Task 9, Epoch 11/20 => Loss 3.075, Loss_clf 0.325, Loss_fe 0.350, Loss_kd 2.160, Train_accy 75.85, Test_accy 87.99:  55%|█████▌    | 11/20 [36:56<31:58, 213.13s/it]Task 9, Epoch 12/20 => Loss 3.061, Loss_clf 0.307, Loss_fe 0.333, Loss_kd 2.179, Train_accy 77.03:  55%|█████▌    | 11/20 [39:43<31:58, 213.13s/it]                 Task 9, Epoch 12/20 => Loss 3.061, Loss_clf 0.307, Loss_fe 0.333, Loss_kd 2.179, Train_accy 77.03:  60%|██████    | 12/20 [39:43<26:33, 199.21s/it]Task 9, Epoch 13/20 => Loss 3.028, Loss_clf 0.305, Loss_fe 0.309, Loss_kd 2.172, Train_accy 77.91:  60%|██████    | 12/20 [42:30<26:33, 199.21s/it]Task 9, Epoch 13/20 => Loss 3.028, Loss_clf 0.305, Loss_fe 0.309, Loss_kd 2.172, Train_accy 77.91:  65%|██████▌   | 13/20 [42:30<22:05, 189.30s/it]Task 9, Epoch 14/20 => Loss 2.985, Loss_clf 0.287, Loss_fe 0.286, Loss_kd 2.171, Train_accy 78.93:  65%|██████▌   | 13/20 [45:15<22:05, 189.30s/it]Task 9, Epoch 14/20 => Loss 2.985, Loss_clf 0.287, Loss_fe 0.286, Loss_kd 2.171, Train_accy 78.93:  70%|███████   | 14/20 [45:15<18:12, 182.07s/it]Task 9, Epoch 15/20 => Loss 2.940, Loss_clf 0.274, Loss_fe 0.253, Loss_kd 2.172, Train_accy 79.10:  70%|███████   | 14/20 [48:02<18:12, 182.07s/it]Task 9, Epoch 15/20 => Loss 2.940, Loss_clf 0.274, Loss_fe 0.253, Loss_kd 2.172, Train_accy 79.10:  75%|███████▌  | 15/20 [48:02<14:47, 177.45s/it]Task 9, Epoch 16/20 => Loss 2.926, Loss_clf 0.268, Loss_fe 0.253, Loss_kd 2.164, Train_accy 79.54, Test_accy 87.53:  75%|███████▌  | 15/20 [52:56<14:47, 177.45s/it]Task 9, Epoch 16/20 => Loss 2.926, Loss_clf 0.268, Loss_fe 0.253, Loss_kd 2.164, Train_accy 79.54, Test_accy 87.53:  80%|████████  | 16/20 [52:56<14:09, 212.47s/it]Task 9, Epoch 17/20 => Loss 2.911, Loss_clf 0.263, Loss_fe 0.243, Loss_kd 2.165, Train_accy 79.53:  80%|████████  | 16/20 [55:43<14:09, 212.47s/it]                 Task 9, Epoch 17/20 => Loss 2.911, Loss_clf 0.263, Loss_fe 0.243, Loss_kd 2.165, Train_accy 79.53:  85%|████████▌ | 17/20 [55:43<09:57, 199.02s/it]Task 9, Epoch 18/20 => Loss 2.986, Loss_clf 0.288, Loss_fe 0.264, Loss_kd 2.191, Train_accy 79.79:  85%|████████▌ | 17/20 [58:31<09:57, 199.02s/it]Task 9, Epoch 18/20 => Loss 2.986, Loss_clf 0.288, Loss_fe 0.264, Loss_kd 2.191, Train_accy 79.79:  90%|█████████ | 18/20 [58:31<06:19, 189.60s/it]Task 9, Epoch 19/20 => Loss 2.898, Loss_clf 0.262, Loss_fe 0.236, Loss_kd 2.160, Train_accy 80.34:  90%|█████████ | 18/20 [1:01:19<06:19, 189.60s/it]Task 9, Epoch 19/20 => Loss 2.898, Loss_clf 0.262, Loss_fe 0.236, Loss_kd 2.160, Train_accy 80.34:  95%|█████████▌| 19/20 [1:01:19<03:03, 183.08s/it]Task 9, Epoch 20/20 => Loss 2.894, Loss_clf 0.251, Loss_fe 0.227, Loss_kd 2.175, Train_accy 80.19:  95%|█████████▌| 19/20 [1:04:04<03:03, 183.08s/it]Task 9, Epoch 20/20 => Loss 2.894, Loss_clf 0.251, Loss_fe 0.227, Loss_kd 2.175, Train_accy 80.19: 100%|██████████| 20/20 [1:04:04<00:00, 177.83s/it]Task 9, Epoch 20/20 => Loss 2.894, Loss_clf 0.251, Loss_fe 0.227, Loss_kd 2.175, Train_accy 80.19: 100%|██████████| 20/20 [1:04:04<00:00, 192.25s/it]2023-11-23 04:08:55,743 [foster.py] => Task 9, Epoch 20/20 => Loss 2.894, Loss_clf 0.251, Loss_fe 0.227, Loss_kd 2.175, Train_accy 80.19
2023-11-23 04:08:55,744 [foster.py] => do not weight align teacher!
2023-11-23 04:08:55,748 [foster.py] => per cls weights : [1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661 1.05750661
 0.4824405  0.4824405  0.4824405  0.4824405  0.4824405  0.4824405
 0.4824405  0.4824405  0.4824405  0.4824405 ]

  0%|          | 0/20 [00:00<?, ?it/s]SNet: Task 9, Epoch 1/20 => Loss 2.177,  Train_accy 59.18, Test_accy 86.77:   0%|          | 0/20 [04:34<?, ?it/s]SNet: Task 9, Epoch 1/20 => Loss 2.177,  Train_accy 59.18, Test_accy 86.77:   5%|▌         | 1/20 [04:34<1:26:51, 274.31s/it]SNet: Task 9, Epoch 2/20 => Loss 2.045,  Train_accy 64.15:   5%|▌         | 1/20 [08:03<1:26:51, 274.31s/it]                 SNet: Task 9, Epoch 2/20 => Loss 2.045,  Train_accy 64.15:  10%|█         | 2/20 [08:03<1:10:45, 235.84s/it]SNet: Task 9, Epoch 3/20 => Loss 2.055,  Train_accy 64.60:  10%|█         | 2/20 [11:31<1:10:45, 235.84s/it]SNet: Task 9, Epoch 3/20 => Loss 2.055,  Train_accy 64.60:  15%|█▌        | 3/20 [11:31<1:03:13, 223.12s/it]SNet: Task 9, Epoch 4/20 => Loss 2.027,  Train_accy 65.51:  15%|█▌        | 3/20 [14:58<1:03:13, 223.12s/it]SNet: Task 9, Epoch 4/20 => Loss 2.027,  Train_accy 65.51:  20%|██        | 4/20 [14:58<57:48, 216.81s/it]  SNet: Task 9, Epoch 5/20 => Loss 2.029,  Train_accy 65.93:  20%|██        | 4/20 [18:27<57:48, 216.81s/it]SNet: Task 9, Epoch 5/20 => Loss 2.029,  Train_accy 65.93:  25%|██▌       | 5/20 [18:27<53:30, 214.02s/it]SNet: Task 9, Epoch 6/20 => Loss 2.022,  Train_accy 66.13, Test_accy 87.18:  25%|██▌       | 5/20 [23:01<53:30, 214.02s/it]SNet: Task 9, Epoch 6/20 => Loss 2.022,  Train_accy 66.13, Test_accy 87.18:  30%|███       | 6/20 [23:01<54:42, 234.48s/it]SNet: Task 9, Epoch 7/20 => Loss 2.033,  Train_accy 65.85:  30%|███       | 6/20 [26:30<54:42, 234.48s/it]                 SNet: Task 9, Epoch 7/20 => Loss 2.033,  Train_accy 65.85:  35%|███▌      | 7/20 [26:30<48:58, 226.05s/it]SNet: Task 9, Epoch 8/20 => Loss 2.024,  Train_accy 65.88:  35%|███▌      | 7/20 [29:57<48:58, 226.05s/it]SNet: Task 9, Epoch 8/20 => Loss 2.024,  Train_accy 65.88:  40%|████      | 8/20 [29:57<44:00, 220.03s/it]SNet: Task 9, Epoch 9/20 => Loss 2.031,  Train_accy 65.78:  40%|████      | 8/20 [33:25<44:00, 220.03s/it]SNet: Task 9, Epoch 9/20 => Loss 2.031,  Train_accy 65.78:  45%|████▌     | 9/20 [33:25<39:37, 216.15s/it]SNet: Task 9, Epoch 10/20 => Loss 2.011,  Train_accy 66.10:  45%|████▌     | 9/20 [36:54<39:37, 216.15s/it]SNet: Task 9, Epoch 10/20 => Loss 2.011,  Train_accy 66.10:  50%|█████     | 10/20 [36:54<35:39, 213.96s/it]SNet: Task 9, Epoch 11/20 => Loss 2.001,  Train_accy 66.53, Test_accy 86.98:  50%|█████     | 10/20 [41:28<35:39, 213.96s/it]SNet: Task 9, Epoch 11/20 => Loss 2.001,  Train_accy 66.53, Test_accy 86.98:  55%|█████▌    | 11/20 [41:28<34:51, 232.40s/it]SNet: Task 9, Epoch 12/20 => Loss 1.997,  Train_accy 66.31:  55%|█████▌    | 11/20 [44:24<34:51, 232.40s/it]                 SNet: Task 9, Epoch 12/20 => Loss 1.997,  Train_accy 66.31:  60%|██████    | 12/20 [44:24<28:43, 215.40s/it]SNet: Task 9, Epoch 13/20 => Loss 2.035,  Train_accy 66.12:  60%|██████    | 12/20 [47:48<28:43, 215.40s/it]SNet: Task 9, Epoch 13/20 => Loss 2.035,  Train_accy 66.12:  65%|██████▌   | 13/20 [47:48<24:43, 211.87s/it]SNet: Task 9, Epoch 14/20 => Loss 2.036,  Train_accy 65.99:  65%|██████▌   | 13/20 [51:15<24:43, 211.87s/it]SNet: Task 9, Epoch 14/20 => Loss 2.036,  Train_accy 65.99:  70%|███████   | 14/20 [51:15<21:02, 210.42s/it]SNet: Task 9, Epoch 15/20 => Loss 2.019,  Train_accy 66.16:  70%|███████   | 14/20 [54:44<21:02, 210.42s/it]SNet: Task 9, Epoch 15/20 => Loss 2.019,  Train_accy 66.16:  75%|███████▌  | 15/20 [54:44<17:29, 209.83s/it]SNet: Task 9, Epoch 16/20 => Loss 2.025,  Train_accy 66.71, Test_accy 87.04:  75%|███████▌  | 15/20 [59:17<17:29, 209.83s/it]SNet: Task 9, Epoch 16/20 => Loss 2.025,  Train_accy 66.71, Test_accy 87.04:  80%|████████  | 16/20 [59:17<15:15, 228.82s/it]SNet: Task 9, Epoch 17/20 => Loss 2.025,  Train_accy 65.81:  80%|████████  | 16/20 [1:02:44<15:15, 228.82s/it]               SNet: Task 9, Epoch 17/20 => Loss 2.025,  Train_accy 65.81:  85%|████████▌ | 17/20 [1:02:44<11:07, 222.42s/it]SNet: Task 9, Epoch 18/20 => Loss 2.032,  Train_accy 66.13:  85%|████████▌ | 17/20 [1:06:11<11:07, 222.42s/it]SNet: Task 9, Epoch 18/20 => Loss 2.032,  Train_accy 66.13:  90%|█████████ | 18/20 [1:06:11<07:15, 217.91s/it]SNet: Task 9, Epoch 19/20 => Loss 2.031,  Train_accy 66.60:  90%|█████████ | 18/20 [1:09:40<07:15, 217.91s/it]SNet: Task 9, Epoch 19/20 => Loss 2.031,  Train_accy 66.60:  95%|█████████▌| 19/20 [1:09:40<03:35, 215.11s/it]SNet: Task 9, Epoch 20/20 => Loss 2.017,  Train_accy 66.69:  95%|█████████▌| 19/20 [1:13:09<03:35, 215.11s/it]SNet: Task 9, Epoch 20/20 => Loss 2.017,  Train_accy 66.69: 100%|██████████| 20/20 [1:13:09<00:00, 213.16s/it]SNet: Task 9, Epoch 20/20 => Loss 2.017,  Train_accy 66.69: 100%|██████████| 20/20 [1:13:09<00:00, 219.46s/it]2023-11-23 05:22:06,922 [foster.py] => SNet: Task 9, Epoch 20/20 => Loss 2.017,  Train_accy 66.69
2023-11-23 05:22:06,922 [foster.py] => do not weight align student!

2023-11-23 05:23:11,457 [foster.py] => darknet eval: 
2023-11-23 05:23:11,457 [foster.py] => CNN top1 curve: 86.95
2023-11-23 05:23:11,457 [foster.py] => CNN top5 curve: 98.92
2023-11-23 05:23:11,459 [base.py] => Constructing exemplars for new classes...(20 per classes)
2023-11-23 05:29:31,998 [foster.py] => Exemplar size: 2000
2023-11-23 05:29:31,999 [trainer.py] => CNN: {'total': 87.74, '00-09': 92.9, '10-19': 92.7, '20-29': 94.7, '30-39': 90.7, '40-49': 88.7, '50-59': 83.5, '60-69': 89.6, '70-79': 82.9, '80-89': 79.0, '90-99': 82.7, 'old': 88.3, 'new': 82.7}
2023-11-23 05:29:31,999 [trainer.py] => NME: {'total': 88.22, '00-09': 90.4, '10-19': 89.0, '20-29': 93.3, '30-39': 88.8, '40-49': 86.5, '50-59': 80.8, '60-69': 90.6, '70-79': 81.3, '80-89': 88.3, '90-99': 93.2, 'old': 87.67, 'new': 93.2}
2023-11-23 05:29:31,999 [trainer.py] => CNN top1 curve: [99.3, 96.8, 95.1, 92.2, 91.38, 91.28, 90.69, 88.3, 87.04, 87.74]
2023-11-23 05:29:31,999 [trainer.py] => CNN top5 curve: [100.0, 99.75, 99.6, 99.6, 99.54, 99.35, 99.36, 99.22, 99.08, 98.98]
2023-11-23 05:29:31,999 [trainer.py] => NME top1 curve: [99.3, 96.55, 95.7, 94.12, 92.5, 92.42, 91.13, 89.01, 88.04, 88.22]
2023-11-23 05:29:31,999 [trainer.py] => NME top5 curve: [100.0, 99.85, 99.6, 99.48, 99.54, 99.38, 99.33, 99.31, 99.12, 98.76]

Average Accuracy (CNN): 91.98299999999999
Average Accuracy (NME): 92.699
2023-11-23 05:29:31,999 [trainer.py] => Average Accuracy (CNN): 91.98299999999999
2023-11-23 05:29:31,999 [trainer.py] => Average Accuracy (NME): 92.699
